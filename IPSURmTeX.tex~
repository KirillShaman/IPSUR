% Created 2011-09-09 Fri 16:57
\documentclass[captions=tableheading]{scrbook}


\input{preamble}
\providecommand{\alert}[1]{\textbf{#1}}

\title{\fontsize{30}{35}\selectfont Introduction to Probability and Statistics Using \textsf{R}}
\author{\fontsize{24}{28}\selectfont G. Jay Kerns}
\date{\fontsize{24}{28}\selectfont \noun{Second Edition}}

\begin{document}

\maketitle

% Org-mode is exporting headings to 3 levels.
\input{frontmatter}
\chapter*{Preface}

This book was expanded from lecture materials I use in a one semester upper-division undergraduate course entitled \emph{Probability and Statistics} at Youngstown State University. Those lecture materials, in turn, were based on notes that I transcribed as a graduate student at Bowling Green State University. The course for which the materials were written is 50-50 Probability and Statistics, and the attendees include mathematics, engineering, and computer science majors (among others). The catalog prerequisites for the course are a full year of calculus.

The book can be subdivided into three basic parts. The first part includes the introductions and elementary \emph{descriptive statistics}; I want the students to be knee-deep in data right out of the gate. The second part is the study of \emph{probability}, which begins at the basics of sets and the equally likely model, journeys past discrete/continuous  random variables, and continues through to multivariate distributions. The chapter on sampling distributions paves the way to the third part, which is \emph{inferential statistics}. This last part includes point and interval estimation, hypothesis testing, and finishes with introductions to selected topics in applied statistics.

I usually only have time in one semester to cover a small subset of this book. I cover the material in Chapter 2 in a class period that is supplemented by a take-home assignment for the students. I spend a lot of time on Data Description, Probability, Discrete, and Continuous Distributions. I mention selected facts from Multivariate Distributions in passing, and discuss the meaty parts of Sampling Distributions before moving right along to Estimation (which is another chapter I dwell on considerably). Hypothesis Testing goes faster after all of the previous work, and by that time the end of the semester is in sight. I normally choose one or two final chapters (sometimes three) from the remaining to survey, and regret at the end that I did not have the chance to cover more.

In an attempt to be correct I have included material in this book which I would normally not mention during the course of a standard lecture. For instance, I normally do not highlight the intricacies of measure theory or integrability conditions when speaking to the class. Moreover, I often stray from the matrix approach to multiple linear regression because many of my students have not yet been formally trained in linear algebra. That being said, it is important to me for the students to hold something in their hands which acknowledges the world of mathematics and statistics beyond the classroom, and which may be useful to them for many semesters to come. It also mirrors my own experience as a student.

The vision for this document is a more or less self contained, essentially complete, correct, introductory textbook. There should be plenty of exercises for the student, with full solutions for some, and no solutions for others (so that the instructor may assign them for grading). By \texttt{Sweave}'s dynamic nature it is possible to write randomly generated exercises and I had planned to implement this idea already throughout the book. Alas, there are only 24 hours in a day. Look for more in future editions.

Seasoned readers will be able to detect my origins: \emph{Probability and Statistical Inference} by Hogg and Tanis \cite{Hogg2006}, \emph{Statistical Inference} by Casella and Berger \cite{Casella2002}, and \emph{Theory of Point Estimation} and \emph{Testing Statistical Hypotheses} by Lehmann \cite{Lehmann1998,Lehmann1986}. I highly recommend each of those books to every reader of this one. Some \textsf{R} books with ``introductory'' in the title that I recommend are \emph{Introductory Statistics with R} 
by Dalgaard \cite{Dalgaard2008} and \emph{Using R for Introductory Statistics} by Verzani \cite{Verzani2005}. Surely there are many, many other good introductory books about \textsf{R}, but frankly, I have tried to steer clear of them for the past year or so to avoid any undue influence on my own writing.

I would like to make special mention of two other books: \emph{Introduction to Statistical Thought} by Michael Lavine \cite{Lavine2009} and \emph{Introduction to Probability} by Grinstead and Snell \cite{Grinstead1997}. Both of these books are \emph{free} and are what ultimately convinced me to release \IPSUR under a free license, too.

Please bear in mind that the title of this book is ``Introduction to Probability and Statistics Using \textsf{R}'', and not ``Introduction to \textsf{R} Using Probability and Statistics'', nor even ``Introduction to Probability and Statistics and \textsf{R} Using Words''. The people at the party are Probability and Statistics; the handshake is \textsf{R}. There are several important topics about \textsf{R} which some individuals will feel are underdeveloped, glossed over, or wantonly omitted. Some will feel the same way about the probabilistic and/or statistical content. Still others will just want to learn \textsf{R} and skip all of the mathematics.

Despite any misgivings: here it is, warts and all. I humbly invite said individuals to take this book, with the GNU Free Documentation License (GNU-FDL) in hand, and make it better. In that spirit there are at least a few ways in my view in which this book could be improved.

\begin{description}
\item[Better data.] The data analyzed in this book are almost entirely from the \texttt{datasets} package in base \textsf{R}, and here is why:
\begin{itemize}
\item I made a conscious effort to minimize dependence on contributed packages,
\item The data are instantly available, already in the correct format, so we need not take time to manage them, and
\item The data are \emph{real}.
\end{itemize}
\end{description}

I made no attempt to choose data sets that would be interesting to the students; rather, data were chosen for their potential to convey a statistical point. Many of the data sets are decades old or more (for instance, the data used to introduce simple linear regression are the speeds and stopping distances of cars in the 1920's).

In a perfect world with infinite time I would research and contribute recent, \emph{real} data in a context crafted to engage the students in \emph{every} example. One day I hope to stumble over said time. In the meantime, I will add new data sets incrementally as time permits.

\begin{description}
\item[More proofs.] I would like to include more proofs for the sake of completeness (I understand that some people would not consider more proofs to be improvement). Many proofs have been skipped entirely, and I am not aware of any rhyme or reason to the current omissions. I will add more when I get a chance.
\item[More and better\~{}graphics.] I have not used the \texttt{ggplot2} package \cite{Wickam2009} because I do not know how to use it yet. It is on my to-do list.
\item[More and better exercises.] There are only a few exercises in the first edition simply because I have not had time to write more. I have toyed with the \texttt{exams} package \cite{exams} and I believe that it is a right way to move forward. As I learn more about what the package can do I would like to incorporate it into later editions of this book.
\end{description}


\section*{About This Document}

\IPSUR contains many interrelated parts: the \emph{Document}, the \emph{Program}, the \emph{Package}, and the \emph{Ancillaries}. In short, the \emph{Document} is what you are reading right now. The \emph{Program} provides an efficient means to modify the Document. The \emph{Package} is an \textsf{R} package that houses the Program and the Document. Finally, the \emph{Ancillaries} are extra materials that reside in the Package and were produced by the Program to supplement use of the Document. We briefly describe each of them in turn.

\subsection*{The Document}

The \emph{Document} is that which you are reading right now -- \IPSUR's \emph{raison d'\^etre}. There are transparent copies (nonproprietary text files) and opaque copies (everything else). See the GNU-FDL in Appendix \ref{cha:GNU-Free-Documentation} for more precise language and details.


\begin{description}
\item[IPSUR.tex] is a transparent copy of the Document to be typeset with a \LaTeX{} distribution such as Mik\TeX{} or \TeX{} Live. Any reader is free to modify the Document and release the modified version in accordance with the provisions of the GNU-FDL. Note that this file cannot be used to generate a randomized copy of the Document. Indeed, in its released form it is only capable of typesetting the exact version of \IPSUR which you are currently reading. Furthermore, the \texttt{.tex} file is unable to generate any of the ancillary materials.
\item[IPSUR-xxx.eps, IPSUR-xxx.pdf] are the image files for every graph in the Document. These are needed when typesetting with \LaTeX{}.
\item[IPSUR.pdf] is an opaque copy of the Document. This is the file that instructors would likely want to distribute to students.
\item[IPSUR.dvi] is another opaque copy of the Document in a different file format.
\end{description}

\subsection*{The Program}

The \emph{Program} includes \texttt{IPSUR.lyx} and its nephew \texttt{IPSUR.Rnw}; the purpose of each is to give individuals a way to quickly customize the Document for their particular purpose(s).


\begin{description}
\item[IPSUR.lyx] is the source \LyX{} file for the Program, released under the GNU General Public License (GNU GPL) Version 3. This file is opened, modified, and compiled with \LyX{}, a sophisticated open-source document processor, and may be used (together with \texttt{Sweave}) to generate a randomized, modified copy of the Document with brand new data sets for some of the exercises and the solution manuals (in the Second Edition). Additionally, \LyX{} can easily activate/deactivate entire blocks of the document, /e.g./\~{}the \textsf{proofs} of the theorems, the student \textsf{solutions} to the exercises, or the instructor \textsf{answers} to the problems, so that the new author may choose which sections (s)he would like to include in the final Document (again, Second Edition). The \texttt{IPSUR.lyx} file is all that a person needs (in addition to a properly configured system -- see Appendix \ref{cha:Instructions-for-Instructors}) to generate/compile/export to all of the other formats described above and below, which includes the ancillary materials \texttt{IPSUR.Rdata} and \texttt{IPSUR.R}.
\item[IPSUR.Rnw] is another form of the source code for the Program, also released under the GNU GPL Version 3. It was produced by exporting \texttt{IPSUR.lyx} into\textsf{ R}/Sweave format (\texttt{.Rnw}). This file may be processed with Sweave to generate a randomized copy of \texttt{IPSUR.tex} -- a transparent copy of the Document -- together with the ancillary materials \texttt{IPSUR.Rdata} and \texttt{IPSUR.R}. Please note, however, that \texttt{IPSUR.Rnw} is just a simple text file which does not support many of the extra features that \LyX{} offers such as WYSIWYM editing, instantly (de)activating branches of the manuscript, and more.
\end{description}



\subsection*{The Package}

There is a contributed package on \texttt{CRAN}, called \texttt{IPSUR}. The package affords many advantages, one being that it houses the  Document in an easy-to-access medium. Indeed, a student can have the Document at his/her fingertips with only three commands:



Another advantage goes hand in hand with the Program's license; since \IPSUR is free, the source code must be freely available to anyone that wants it. A package hosted on \texttt{CRAN} allows the author to obey the license by default.

A much more important advantage is that the excellent facilities at \textsf{R}-Forge are building and checking the package daily against patched and development versions of the absolute latest pre-release of \textsf{R}. If any problems surface then I will know about it within 24 hours.

And finally, suppose there is some sort of problem. The package structure makes it \emph{incredibly} easy for me to distribute bug-fixes and corrected typographical errors. As an author I can make my corrections, upload them to the repository at \textsf{R}-Forge, and they will be reflected \emph{worldwide} within hours. We aren't in Kansas anymore, Toto.

\subsection*{Ancillary Materials}

These are extra materials that accompany \IPSUR. They reside in the \texttt{/etc} subdirectory of the package source. 

\begin{description}
\item[IPSUR.RData] is a saved image of the \textsf{R} workspace at the completion of the Sweave processing of \IPSUR. It can be loaded into memory with \textsf{File} $\triangleright$ \textsf{Load Workspace} or with the command \texttt{load("/path/to/IPSUR.Rdata")}. Either method will make every single object in the file immediately available and in memory. In particular, the data BLANK from Exercise BLANK in Chapter BLANK on page BLANK will be loaded. Type BLANK at the command line (after loading \texttt{IPSUR.RData}) to see for yourself.
\item[IPSUR.R] is the exported \textsf{R} code from \texttt{IPSUR.Rnw}. With this script, literally every \textsf{R} command from the entirety of \IPSUR can be resubmitted at the command line.
\end{description}

\section*{Notation}

We use the notation \texttt{x} or \texttt{stem.leaf} notation to denote objects, functions, \emph{etc}.. The sequence ``\textsf{Statistics} \textsf{$\triangleright$} \textsf{Summaries} \textsf{$\triangleright$} \textsf{Active Dataset}'' means to click the \textsf{Statistics} menu item, next click the \textsf{Summaries} submenu item, and finally click \textsf{Active Dataset}.

\section*{Acknowledgements}

This book would not have been possible without the firm mathematical and statistical foundation provided by the professors at Bowling Green State University, including Drs. G\'\{a\}bor Sz\'\{e\}kely, Craig Zirbel, Arjun K. Gupta, Hanfeng Chen, Truc Nguyen, and James Albert. I would also like to thank Drs.\~{}Neal Carothers and Kit Chan. 

I would also like to thank my colleagues at Youngstown State University for their support. In particular, I would like to thank Dr. G. Andy Chang for showing me what it means to be a statistician.

I would like to thank Richard Heiberger for his insightful comments and improvements to several points and displays in the manuscript. 

Finally, and most importantly, I would like to thank my wife for her patience and understanding while I worked hours, days, months, and years on a \emph{free book}. Looking back, I can't believe I ever got away with it.

\vfill{}
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures

\vfill{}
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{List of Tables}
\listoftables



\chapter{An Introduction to Probability and Statistics}
\label{sec-1}

\pagenumbering{arabic} 
\noindent This chapter has proved to be the hardest to write, by far. The trouble is that there is so much to say -- and so many people have already said it so much better than I could. When I get something I like I will release it here.

In the meantime, there is a lot of information already available to a person with an Internet connection. I recommend to start at Wikipedia, which is not a flawless resource but it has the main ideas with links to reputable sources.

In my lectures I usually tell stories about Fisher, Galton, Gauss, Laplace, Quetelet, and the Chevalier de Mere.
\section{Probability}
\label{sec-1-1}


The common folklore is that probability has been around for millennia but did not gain the attention of mathematicians until approximately 1654 when the Chevalier de Mere had a question regarding the fair division of a game's payoff to the two players, if the game had to end prematurely.
\section{Statistics}
\label{sec-1-2}


Statistics concerns data; their collection, analysis, and interpretation. In this book we distinguish between two types of statistics: descriptive and inferential. 

Descriptive statistics concerns the summarization of data. We have a data set and we would like to describe the data set in multiple ways. Usually this entails calculating numbers from the data, called descriptive measures, such as percentages, sums, averages, and so forth.

Inferential statistics does more. There is an inference associated with the data set, a conclusion drawn about the population from which the data originated.

I would like to mention that there are two schools of thought of statistics: frequentist and bayesian. The difference between the schools is related to how the two groups interpret the underlying probability (see Section \ref{sec:Interpreting-Probabilities}). The frequentist school gained a lot of ground among statisticians due in large part to the work of Fisher, Neyman, and Pearson in the early twentieth century. That dominance lasted until inexpensive computing power became widely available; nowadays the bayesian school is garnering more attention and at an increasing rate.

This book is devoted mostly to the frequentist viewpoint because that is how I was trained, with the conspicuous exception of Sections \ref{sec:Bayes'-Rule} and \ref{sec:Conditional-Distributions}. I plan to add more bayesian material in later editions of this book.

\section*{Chapter Exercises}
\addcontentsline{toc}{section}{Chapter Exercises}
\setcounter{thm}{0}









\appendix
\chapter{\textsf{R} Session Information}
\label{sec-2}

\label{cha:R-Session-Information}

If you ever write the \textsf{R} help mailing list with a question, then you should include your session information in the email; it makes the reader's job easier and is requested by the Posting Guide. Here is how to do that, and below is what the output looks like.


\begin{verbatim}
sessionInfo()
\end{verbatim}


\begin{verbatim}
R version 2.13.1 (2011-07-08)
Platform: i486-pc-linux-gnu (32-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
 [1] grid      stats4    splines   tcltk     stats    
 [6] graphics  grDevices utils     datasets  methods  
[11] base     

other attached packages:
 [1] TeachingDemos_2.7       scatterplot3d_0.3-33   
 [3] RcmdrPlugin.IPSUR_0.1-7 Rcmdr_1.7-0            
 [5] car_2.0-10              nnet_7.3-1             
 [7] MASS_7.3-14             qcc_2.0.1              
 [9] prob_0.9-2              lmtest_0.9-28          
[11] zoo_1.6-5               Hmisc_3.8-3            
[13] HH_2.1-32               leaps_2.9              
[15] multcomp_1.2-6          lattice_0.19-33        
[17] ggplot2_0.8.9           proto_0.3-9.2          
[19] reshape_0.8.4           plyr_1.5.2             
[21] e1071_1.5-26            class_7.3-3            
[23] distrEx_2.3             evd_2.2-4              
[25] distr_2.3.2             SweaveListingUtils_0.5 
[27] sfsmisc_1.0-16          startupmsg_0.7.1       
[29] combinat_0.0-8          coin_1.0-18            
[31] modeltools_0.2-17       mvtnorm_0.9-9991       
[33] survival_2.36-9         boot_1.3-2             
[35] aplpack_1.2.3           actuar_1.1-2           

loaded via a namespace (and not attached):
[1] cluster_1.14.0
\end{verbatim}

\vfill{}
\chapter{GNU Free Documentation License}
\label{sec-3}

\label{cha:GNU-Free-Documentation}

\begin{center}
\textbf{\large Version 1.3, 3 November 2008}\bigskip{}

\par\end{center}

\noindent Copyright (C) 2000, 2001, 2002, 2007, 2008 Free Software
Foundation, Inc.

\begin{center}
\url{[[http://fsf.org/][http://fsf.org/]]}
\par\end{center}

\noindent Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.
\section{0. PREAMBLE}
\label{sec-3-1}


The purpose of this License is to make a manual, textbook, or other functional and useful document free  in the sense of freedom: to assure everyone the effective freedom to copy and redistribute it, with or without modifying it, either commercially or noncommercially. Secondarily, this License preserves for the author and publisher a way to get credit for their work, while not being considered responsible for modifications made by others.

This License is a kind of copyleft, which means that derivative works of the document must themselves be free in the same sense. It complements the GNU General Public License, which is a copyleft license designed for free software.

We have designed this License in order to use it for manuals for free software, because free software needs free documentation: a free program should come with manuals providing the same freedoms that the software does. But this License is not limited to software manuals; it can be used for any textual work, regardless of subject matter or whether it is published as a printed book. We recommend this License principally for works whose purpose is instruction or reference.
\section{1. APPLICABILITY AND DEFINITIONS}
\label{sec-3-2}


This License applies to any manual or other work, in any medium, that contains a notice placed by the copyright holder saying it can be distributed under the terms of this License. Such a notice grants a world-wide, royalty-free license, unlimited in duration, to use that work under the conditions stated herein. The Document, below, refers to any such manual or work. Any member of the public is a licensee, and is addressed as you. You accept the license if you copy, modify or distribute the work in a way requiring permission under copyright law.

A Modified Version of the Document means any work containing the Document or a portion of it, either copied verbatim, or with modifications and/or translated into another language.

A Secondary Section is a named appendix or a front-matter section of the Document that deals exclusively with the relationship of the publishers or authors of the Document to the Document's overall subject (or to related matters) and contains nothing that could fall directly within that overall subject. (Thus, if the Document is in part a textbook of mathematics, a Secondary Section may not explain any mathematics.) The relationship could be a matter of historical connection with the subject or with related matters, or of legal, commercial, philosophical, ethical or political position regarding them.

The Invariant Sections are certain Secondary Sections whose titles are designated, as being those of Invariant Sections, in the notice that says that the Document is released under this License. If a section does not fit the above definition of Secondary then it is not allowed to be designated as Invariant. The Document may contain zero Invariant Sections. If the Document does not identify any Invariant Sections then there are none.

The Cover Texts are certain short passages of text that are listed, as Front-Cover Texts or Back-Cover Texts, in the notice that says that the Document is released under this License. A Front-Cover Text may be at most 5 words, and a Back-Cover Text may be at most 25 words.

A Transparent copy of the Document means a machine-readable copy, represented in a format whose specification is available to the general public, that is suitable for revising the document straightforwardly with generic text editors or (for images composed of pixels) generic paint programs or (for drawings) some widely available drawing editor, and that is suitable for input to text formatters or for automatic translation to a variety of formats suitable for input to text formatters. A copy made in an otherwise Transparent file format whose markup, or absence of markup, has been arranged to thwart or discourage subsequent modification by readers is not Transparent. An image format is not Transparent if used for any substantial amount of text. A copy that is not Transparent is called Opaque.

Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo input format, \LaTeX{} input format, SGML or XML using a publicly available DTD, and standard-conforming simple HTML, PostScript or PDF designed for human modification. Examples of transparent image formats include PNG, XCF and JPG. Opaque formats include proprietary formats that can be read and edited only by proprietary word processors, SGML or XML for which the DTD and/or processing tools are not generally available, and the machine-generated HTML, PostScript or PDF produced by some word processors for output purposes only.

The Title Page means, for a printed book, the title page itself, plus such following pages as are needed to hold, legibly, the material this License requires to appear in the title page. For works in formats which do not have any title page as such, Title Page means the text near the most prominent appearance of the work's title, preceding the beginning of the body of the text.

The publisher means any person or entity that distributes copies of the Document to the public.  A section Entitled XYZ means a named subunit of the Document whose title either is precisely XYZ or contains XYZ in parentheses following text that translates XYZ in another language. (Here XYZ stands for a specific section name mentioned below, such as Acknowledgements, Dedications, Endorsements, or History.) To Preserve the Title of such a section when you modify the Document means that it remains a section Entitled XYZ according to this definition.

The Document may include Warranty Disclaimers next to the notice which states that this License applies to the Document. These Warranty Disclaimers are considered to be included by reference in this License, but only as regards disclaiming warranties: any other implication that these Warranty Disclaimers may have is void and has no effect on the meaning of this License.
\section{2. VERBATIM COPYING}
\label{sec-3-3}


You may copy and distribute the Document in any medium, either commercially or noncommercially, provided that this License, the copyright notices, and the license notice saying this License applies to the Document are reproduced in all copies, and that you add no other conditions whatsoever to those of this License. You may not use technical measures to obstruct or control the reading or further copying of the copies you make or distribute. However, you may accept compensation in exchange for copies. If you distribute a large enough number of copies you must also follow the conditions in section 3.

You may also lend copies, under the same conditions stated above, and you may publicly display copies.
\section{3. COPYING IN QUANTITY}
\label{sec-3-4}


If you publish printed copies (or copies in media that commonly have printed covers) of the Document, numbering more than 100, and the Document's license notice requires Cover Texts, you must enclose the copies in covers that carry, clearly and legibly, all these Cover Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on the back cover. Both covers must also clearly and legibly identify you as the publisher of these copies. The front cover must present the full title with all words of the title equally prominent and visible. You may add other material on the covers in addition. Copying with changes limited to the covers, as long as they preserve the title of the Document and satisfy these conditions, can be treated as verbatim copying in other respects.

If the required texts for either cover are too voluminous to fit legibly, you should put the first ones listed (as many as fit reasonably) on the actual cover, and continue the rest onto adjacent pages.

If you publish or distribute Opaque copies of the Document numbering more than 100, you must either include a machine-readable Transparent copy along with each Opaque copy, or state in or with each Opaque copy a computer-network location from which the general network-using public has access to download using public-standard network protocols a complete Transparent copy of the Document, free of added material. If you use the latter option, you must take reasonably prudent steps, when you begin distribution of Opaque copies in quantity, to ensure that this Transparent copy will remain thus accessible at the stated location until at least one year after the last time you distribute an Opaque copy (directly or through your agents or retailers) of that edition to the public.

It is requested, but not required, that you contact the authors of the Document well before redistributing any large number of copies, to give them a chance to provide you with an updated version of the Document.
\section{4. MODIFICATIONS}
\label{sec-3-5}


You may copy and distribute a Modified Version of the Document under the conditions of sections 2 and 3 above, provided that you release the Modified Version under precisely this License, with the Modified Version filling the role of the Document, thus licensing distribution and modification of the Modified Version to whoever possesses a copy of it. In addition, you must do these things in the Modified Version:

A. Use in the Title Page (and on the covers, if any) a title distinct from that of the Document, and from those of previous versions (which should, if there were any, be listed in the History section of the Document). You may use the same title as a previous version if the original publisher of that version gives permission. 

B. List on the Title Page, as authors, one or more persons or entities responsible for authorship of the modifications in the Modified Version, together with at least five of the principal authors of the Document (all of its principal authors, if it has fewer than five), unless they release you from this requirement. 

C. State on the Title page the name of the publisher of the Modified Version, as the publisher. 

D. Preserve all the copyright notices of the Document. 

E. Add an appropriate copyright notice for your modifications adjacent to the other copyright notices. 

F. Include, immediately after the copyright notices, a license notice giving the public permission to use the Modified Version under the terms of this License, in the form shown in the Addendum below.  

G. Preserve in that license notice the full lists of Invariant Sections and required Cover Texts given in the Document's license notice. 

H. Include an unaltered copy of this License. 

I. Preserve the section Entitled History, Preserve its Title, and add to it an item stating at least the title, year, new authors, and publisher of the Modified Version as given on the Title Page. If there is no section Entitled History in the Document, create one stating the title, year, authors, and publisher of the Document as given on its Title Page, then add an item describing the Modified Version as stated in the previous sentence. 

J. Preserve the network location, if any, given in the Document for public access to a Transparent copy of the Document, and likewise the network locations given in the Document for previous versions it was based on. These may be placed in the History section. You may omit a network location for a work that was published at least four years before the Document itself, or if the original publisher of the version it refers to gives permission. 

K. For any section Entitled Acknowledgements or Dedications, Preserve the Title of the section, and preserve in the section all the substance and tone of each of the contributor acknowledgements and/or dedications given therein. 
L. Preserve all the Invariant Sections of the Document, unaltered in their text and in their titles. Section numbers or the equivalent are not considered part of the section titles. 

M. Delete any section Entitled Endorsements. Such a section may not be included in the Modified Version. 

N. Do not retitle any existing section to be Entitled Endorsements or to conflict in title with any Invariant Section. 

O. Preserve any Warranty Disclaimers.

If the Modified Version includes new front-matter sections or appendices that qualify as Secondary Sections and contain no material copied from the Document, you may at your option designate some or all of these sections as invariant. To do this, add their titles to the list of Invariant Sections in the Modified Version's license notice. These titles must be distinct from any other section titles.

You may add a section Entitled Endorsements, provided it contains nothing but endorsements of your Modified Version by various parties--for example, statements of peer review or that the text has been approved by an organization as the authoritative definition of a standard.

You may add a passage of up to five words as a Front-Cover Text, and a passage of up to 25 words as a Back-Cover Text, to the end of the list of Cover Texts in the Modified Version. Only one passage of Front-Cover Text and one of Back-Cover Text may be added by (or through arrangements made by) any one entity. If the Document already includes a cover text for the same cover, previously added by you or by arrangement made by the same entity you are acting on behalf of, you may not add another; but you may replace the old one, on explicit permission from the previous publisher that added the old one.

The author(s) and publisher(s) of the Document do not by this License give permission to use their names for publicity for or to assert or imply endorsement of any Modified Version.
\section{5. COMBINING DOCUMENTS}
\label{sec-3-6}


You may combine the Document with other documents released under this License, under the terms defined in section 4 above for modified versions, provided that you include in the combination all of the Invariant Sections of all of the original documents, unmodified, and list them all as Invariant Sections of your combined work in its license notice, and that you preserve all their Warranty Disclaimers.

The combined work need only contain one copy of this License, and multiple identical Invariant Sections may be replaced with a single copy. If there are multiple Invariant Sections with the same name but different contents, make the title of each such section unique by adding at the end of it, in parentheses, the name of the original author or publisher of that section if known, or else a unique number. Make the same adjustment to the section titles in the list of Invariant Sections in the license notice of the combined work.

In the combination, you must combine any sections Entitled History in the various original documents, forming one section Entitled History;
likewise combine any sections Entitled Acknowledgements, and any sections Entitled Dedications. You must delete all sections Entitled Endorsements.
\section{6. COLLECTIONS OF DOCUMENTS}
\label{sec-3-7}


You may make a collection consisting of the Document and other documents released under this License, and replace the individual copies of this License in the various documents with a single copy that is included in the collection, provided that you follow the rules of this License for verbatim copying of each of the documents in all other respects. 

You may extract a single document from such a collection, and distribute it individually under this License, provided you insert a copy of this License into the extracted document, and follow this License in all other respects regarding verbatim copying of that document.
\section{7. AGGREGATION WITH INDEPENDENT WORKS}
\label{sec-3-8}


A compilation of the Document or its derivatives with other separate and independent documents or works, in or on a volume of a storage or distribution medium, is called an aggregate if the copyright resulting from the compilation is not used to limit the legal rights of the compilation's users beyond what the individual works permit. When the Document is included in an aggregate, this License does not apply to the other works in the aggregate which are not themselves derivative works of the Document.

If the Cover Text requirement of section 3 is applicable to these copies of the Document, then if the Document is less than one half of the entire aggregate, the Document's Cover Texts may be placed on covers that bracket the Document within the aggregate, or the electronic equivalent of covers if the Document is in electronic form. Otherwise they must appear on printed covers that bracket the whole aggregate.
\section{8. TRANSLATION}
\label{sec-3-9}


Translation is considered a kind of modification, so you may distribute translations of the Document under the terms of section 4. Replacing Invariant Sections with translations requires special permission from their copyright holders, but you may include translations of some or all Invariant Sections in addition to the original versions of these Invariant Sections. You may include a translation of this License, and all the license notices in the Document, and any Warranty Disclaimers, provided that you also include the original English version of this License and the original versions of those notices and disclaimers. In case of a disagreement between the translation and the original version of this License or a notice or disclaimer, the original version will prevail.

If a section in the Document is Entitled Acknowledgements, Dedications, or History, the requirement (section 4) to Preserve its Title (section 1) will typically require changing the actual title.
\section{9. TERMINATION}
\label{sec-3-10}


You may not copy, modify, sublicense, or distribute the Document except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, or distribute it is void, and will automatically terminate your rights under this License.

However, if you cease all violation of this License, then your license from a particular copyright holder is reinstated (a) provisionally, unless and until the copyright holder explicitly and finally terminates your license, and (b) permanently, if the copyright holder fails to notify you of the violation by some reasonable means prior to 60 days after the cessation.

Moreover, your license from a particular copyright holder is reinstated permanently if the copyright holder notifies you of the violation by some reasonable means, this is the first time you have received notice of violation of this License (for any work) from that copyright holder, and you cure the violation prior to 30 days after your receipt of the notice. 

Termination of your rights under this section does not terminate the licenses of parties who have received copies or rights from you under this License. If your rights have been terminated and not permanently reinstated, receipt of a copy of some or all of the same material does not give you any rights to use it.
\section{10. FUTURE REVISIONS OF THIS LICENSE}
\label{sec-3-11}


The Free Software Foundation may publish new, revised versions of the GNU Free Documentation License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns. See \href{http://www.gnu.org/copyleft/}{http://www.gnu.org/copyleft/}.

Each version of the License is given a distinguishing version number. If the Document specifies that a particular numbered version of this License or any later version applies to it, you have the option of following the terms and conditions either of that specified version or of any later version that has been published (not as a draft) by the Free Software Foundation. If the Document does not specify a version number of this License, you may choose any version ever published (not as a draft) by the Free Software Foundation. If the Document specifies that a proxy can decide which future versions of this License can be used, that proxy's public statement of acceptance of a version permanently authorizes you to choose that version for the Document.
\section{11. RELICENSING}
\label{sec-3-12}


Massive Multiauthor Collaboration Site (or MMC Site) means any World Wide Web server that publishes copyrightable works and also provides prominent facilities for anybody to edit those works. A public wiki that anybody can edit is an example of such a server. A Massive Multiauthor Collaboration (or MMC) contained in the site means any set of copyrightable works thus published on the MMC site.

CC-BY-SA means the Creative Commons Attribution-Share Alike 3.0 license published by Creative Commons Corporation, a not-for-profit corporation with a principal place of business in San Francisco, California, as well as future copyleft versions of that license published by that same organization.

Incorporate means to publish or republish a Document, in whole or in part, as part of another Document.

An MMC is eligible for relicensing if it is licensed under this License, and if all works that were first published under this License somewhere other than this MMC, and subsequently incorporated in whole or in part into the MMC, (1) had no cover texts or invariant sections, and (2) were thus incorporated prior to November 1, 2008.

The operator of an MMC Site may republish an MMC contained in the site under CC-BY-SA on the same site at any time before August 1, 2009, provided the MMC is eligible for relicensing.
\section{ADDENDUM: How to use this License for your documents}
\label{sec-3-13}


To use this License in a document you have written, include a copy of the License in the document and put the following copyright and license notices just after the title page: 

\begin{quote}
\noindent Copyright (c) YEAR YOUR NAME. Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts. A copy of the license is included in the section entitled GNU Free Documentation License.
\end{quote}

If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts, replace the with\ldots{}Texts. line with this:

\begin{quote}
\noindent with the Invariant Sections being LIST THEIR TITLES, with the Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.
\end{quote}

If you have Invariant Sections without Cover Texts, or some other combination of the three, merge those two alternatives to suit the situation.

If your document contains nontrivial examples of program code, we recommend releasing these examples in parallel under your choice of free software license, such as the GNU General Public License, to permit their use in free software. 
\chapter{History}
\label{sec-4}

\label{cha:History}


\begin{center}
\begin{tabular}{ll}
 Title:      &  Introduction to Probability and Statistics Using \textsf{R}  \\
 Year:       &  2011                                                         \\
 Authors:    &  G.\~{}Jay Kerns                                              \\
 Publisher:  &  G.\~{}Jay Kerns                                              \\
\end{tabular}
\end{center}



\vfill{}
\chapter{Data}
\label{sec-5}

\label{cha:data}

This appendix is a reference of sorts regarding some of the data structures a statistician is likely to encounter. We discuss their salient features and idiosyncrasies.
\section{Data Structures \label{sec:Data-Structures}}
\label{sec-5-1}
\subsection{Vectors}
\label{sec-5-1-1}


See the ``Vectors and Assignment'' section of \emph{An Introduction to} \textsf{R}. A vector is an ordered sequence of elements, such as numbers, characters, or logical values, and there may be \texttt{NA}'s present. We usually make vectors with the assignment operator \texttt{<-}.


\begin{verbatim}
x <- c(3, 5, 9)
\end{verbatim}


Vectors are atomic in the sense that if you try to mix and match elements of different modes then all elements will be coerced to the most convenient common mode.


\begin{verbatim}
y <- c(3, "5", TRUE)
\end{verbatim}


In the example all elements were coerced to \emph{character} mode. We can test whether a given object is a vector with \texttt{is.vector} and can coerce an object (if possible) to a vector with \texttt{as.vector}.
\subsection{Matrices and Arrays}
\label{sec-5-1-2}


See the ``Arrays and Matrices'' section of \emph{An Introduction to} \textsf{R}. Loosely speaking, a matrix is a vector that has been reshaped into rectangular form, and an array is a multidimensional matrix. Strictly speaking, it is the other way around: an array is a data vector with a dimension attribute (\texttt{dim}), and a matrix is the special case of an array with only two dimensions. We can construct a matrix with the \texttt{matrix} function. 


\begin{verbatim}
matrix(letters[1:6], nrow = 2, ncol = 3)
\end{verbatim}

\begin{verbatim}
      [,1] [,2] [,3]
 [1,] "a"  "c"  "e" 
 [2,] "b"  "d"  "f"
\end{verbatim}

Notice the order of the matrix entries, which shows how the matrix is populated by default. We can change this with the \texttt{byrow} argument:


\begin{verbatim}
matrix(letters[1:6], nrow = 2, ncol = 3, byrow = TRUE)
\end{verbatim}

\begin{verbatim}
      [,1] [,2] [,3]
 [1,] "a"  "b"  "c" 
 [2,] "d"  "e"  "f"
\end{verbatim}

We can test whether a given object is a matrix with \texttt{is.matrix} and can coerce an object (if possible) to a matrix with \texttt{as.matrix}. As a final example watch what happens when we mix and match types in the first argument:


\begin{verbatim}
matrix(c(1,"2",NA, FALSE), nrow = 2, ncol = 3)
\end{verbatim}

\begin{verbatim}
      [,1] [,2]    [,3]
 [1,] "1"  NA      "1" 
 [2,] "2"  "FALSE" "2"
\end{verbatim}

Notice how all of the entries were coerced to character for the final result (except \texttt{NA}). Also notice how the four values were \emph{recycled} to fill up the six entries of the matrix.

The standard arithmetic operations work element-wise with matrices.


\begin{verbatim}
A <- matrix(1:6, 2, 3)
B <- matrix(2:7, 2, 3)
A + B
A * B
\end{verbatim}

\begin{verbatim}
      [,1] [,2] [,3]
 [1,]    3    7   11
 [2,]    5    9   13
      [,1] [,2] [,3]
 [1,]    2   12   30
 [2,]    6   20   42
\end{verbatim}

If you want the standard definition of matrix multiplication then use the \texttt{\%*\%} function. If we were to try \texttt{A \%*\% B} we would get an error because the dimensions do not match correctly, but for fun, we could transpose \texttt{B} to get conformable matrices. The transpose function \texttt{t} only works for matrices (and data frames).


\begin{verbatim}
try(A * B)     # an error
A %*% t(B)     # this is alright
\end{verbatim}

\begin{verbatim}
      [,1] [,2] [,3]
 [1,]    2   12   30
 [2,]    6   20   42
      [,1] [,2]
 [1,]   44   53
 [2,]   56   68
\end{verbatim}

To get the ordinary matrix inverse use the \texttt{solve} function: 


\begin{verbatim}
solve(A %*% t(B))     # input matrix must be square
\end{verbatim}

\begin{verbatim}
           [,1]      [,2]
 [1,]  2.833333 -2.208333
 [2,] -2.333333  1.833333
\end{verbatim}

Arrays more general than matrices, and some functions (like transpose) do not work for the more general array. Here is what an array looks like: 


\begin{verbatim}
array(LETTERS[1:24], dim = c(3,4,2))
\end{verbatim}


\begin{verbatim}
, , 1

     [,1] [,2] [,3] [,4]
[1,] "A"  "D"  "G"  "J" 
[2,] "B"  "E"  "H"  "K" 
[3,] "C"  "F"  "I"  "L" 

, , 2

     [,1] [,2] [,3] [,4]
[1,] "M"  "P"  "S"  "V" 
[2,] "N"  "Q"  "T"  "W" 
[3,] "O"  "R"  "U"  "X"
\end{verbatim}

We can test with \texttt{is.array} and may coerce with \texttt{as.array}.
\subsection{Data Frames}
\label{sec-5-1-3}


A data frame is a rectangular array of information with a special status in \textsf{R}. It is used as the fundamental data structure by many of the modeling functions. It is like a matrix in that all of the columns must be the same length, but it is more general than a matrix in that columns are allowed to have different modes.


\begin{verbatim}
x <- c(1.3, 5.2, 6)
y <- letters[1:3]
z <- c(TRUE, FALSE, TRUE)
A <- data.frame(x, y, z)
A
\end{verbatim}

\begin{verbatim}
     x y     z
 1 1.3 a  TRUE
 2 5.2 b FALSE
 3 6.0 c  TRUE
\end{verbatim}

Notice the \texttt{names} on the columns of \texttt{A}. We can change those with the \texttt{names} function.


\begin{verbatim}
names(A) <- c("Fred","Mary","Sue")
A
\end{verbatim}

\begin{verbatim}
   Fred Mary   Sue
 1  1.3    a  TRUE
 2  5.2    b FALSE
 3  6.0    c  TRUE
\end{verbatim}

Basic command is \texttt{data.frame}. You can test with \texttt{is.data.frame} and you can coerce with \texttt{as.data.frame}.
\subsection{Lists}
\label{sec-5-1-4}

A list is more general than a data frame.
\subsection{Tables}
\label{sec-5-1-5}

The word ``table'' has a special meaning in \textsf{R}. More precisely, a contingency table is an object of class \texttt{table} which is an array.

Suppose you have a contingency table and would like to do descriptive or inferential statistics on it. The default form of the table is usually inconvenient to use unless we are working with a function specially tailored for tables. Here is how to transform your data to a more manageable form, namely, the raw data used to make the table.

First, we coerce the table to a data frame with: 


\begin{verbatim}
A <- as.data.frame(Titanic)
head(A)
\end{verbatim}

\begin{verbatim}
   Class    Sex   Age Survived Freq
 1   1st   Male Child       No    0
 2   2nd   Male Child       No    0
 3   3rd   Male Child       No   35
 4  Crew   Male Child       No    0
 5   1st Female Child       No    0
 6   2nd Female Child       No    0
\end{verbatim}

Note that there are as many preliminary columns of \texttt{A} as there are dimensions to the table. The rows of \texttt{A} contain every possible combination of levels from each of the dimensions. There is also a \texttt{Freq} column, which shows how many observations there were at that particular combination of levels. 

The form of \texttt{A} is often sufficient for our purposes, but more often we need to do more work: we would usually like to repeat each row of \texttt{A} exactly the number of times shown in the \texttt{Freq} column. The \texttt{reshape} package \cite{Wickhamreshape} has the function \texttt{untable} designed for that very purpose: 


\begin{verbatim}
library(reshape)
B <- with(A, untable(A, Freq))
head(B)
\end{verbatim}

\begin{verbatim}
     Class  Sex   Age Survived Freq
 3     3rd Male Child       No   35
 3.1   3rd Male Child       No   35
 3.2   3rd Male Child       No   35
 3.3   3rd Male Child       No   35
 3.4   3rd Male Child       No   35
 3.5   3rd Male Child       No   35
\end{verbatim}

Now, this is more like it. Note that we slipped in a call to the \texttt{with} function, which was done to make the call to \texttt{untable} more pretty; we could just as easily have done
\begin{verbatim}
  untable(TitanicDF, A$Freq)
\end{verbatim}


The only fly in the ointment is the lingering \texttt{Freq} column which has repeated values that do not have any meaning any more. We could just ignore it, but it would be better to get rid of the meaningless column so that it does not cause trouble later. While we are at it, we could clean up the \texttt{rownames}, too.


\begin{verbatim}
C <- B[, -5]
rownames(C) <- 1:dim(C)[1]
head(C)
\end{verbatim}

\begin{verbatim}
   Class  Sex   Age Survived
 1   3rd Male Child       No
 2   3rd Male Child       No
 3   3rd Male Child       No
 4   3rd Male Child       No
 5   3rd Male Child       No
 6   3rd Male Child       No
\end{verbatim}
\subsection{More about Tables}
\label{sec-5-1-6}

Suppose you want to make a table that looks like this:

There are at least two ways to do it.

\begin{itemize}
\item Using a matrix:
\end{itemize}

\begin{verbatim}
  tab <- matrix(1:6, nrow = 2, ncol = 3)
  rownames(tab) <- c('first', 'second')
  colnames(tab) <- c('A', 'B', 'C')
  tab  # Counts
\end{verbatim}

\begin{verbatim}
          A B C
   first  1 3 5
   second 2 4 6
\end{verbatim}

\begin{itemize}
\item note that the columns are filled in consecutively by default. If you want to fill the data in by rows then do \texttt{byrow = TRUE} in the \texttt{matrix} command.
\item Using a dataframe
\end{itemize}

\begin{verbatim}
  p <- c("milk","tea")
  g <- c("milk","tea")
  catgs <- expand.grid(poured = p, guessed = g)
  cnts <- c(3, 1, 1, 3)
  D <- cbind(catgs, count = cnts)
  xtabs(count ~ poured + guessed, data = D)
\end{verbatim}

\begin{verbatim}
         guessed
   poured milk tea
     milk    3   1
     tea     1   3
\end{verbatim}

\begin{itemize}
\item again, the data are filled in column-wise.
\item the object is a dataframe
\item if you want to store it as a table then do \texttt{A <- xtabs(count \textasciitilde{} poured + guessed, data = D)}
\end{itemize}
\section{Importing Data \label{sec:Importing-A-Data}}
\label{sec-5-2}


Statistics is the study of data, so the statistician's first step is usually to obtain data from somewhere or another and read them into \textsf{R}. In this section we describe some of the most common sources of data and how to get data from those sources into a running \textsf{R} session.

For more information please refer to the \textsf{R} \emph{Data Import/Export Manual}, \cite{rstatenv} and \emph{An Introduction to} \textsf{R}, \cite{Venables2010}.
\subsection{Data in Packages}
\label{sec-5-2-1}


There are many data sets stored in the \texttt{datasets} package of base \textsf{R}. To see a list of them all issue the command \texttt{data(package = "datasets")}. The output is omitted here because the list is so long. The names of the data sets are listed in the left column. Any data set in that list is already on the search path by default, which means that a user can use it immediately without any additional work. 

There are many other data sets available in the thousands of contributed packages. To see the data sets available in those packages that are currently loaded into memory issue the single command \texttt{data()}. If you would like to see all of the data sets that are available in all packages that are installed on your computer (but not necessarily loaded), issue the command 

\begin{verbatim}
  data(package = .packages(all.available = TRUE))
\end{verbatim}

To load the data set \texttt{foo} in the contributed package \texttt{bar} issue the commands \texttt{library(bar)} followed by \texttt{data(foo)}, or just the single command  

\begin{verbatim}
  data(foo, package = "bar")
\end{verbatim}
\subsection{Text Files}
\label{sec-5-2-2}

Many sources of data are simple text files. The entries in the file are separated by delimeters such as TABS (tab-delimeted), commas (comma separated values, or \texttt{.csv}, for short) or even just white space (no special name). A lot of data on the Internet are stored with text files, and even if they are not, a person can copy-paste information from a web page to a text file, save it on the computer, and read it into \textsf{R}. 
\subsection{Other Software Files}
\label{sec-5-2-3}

Often the data set of interest is stored in some other, proprietary, format by third-party software such as Minitab, SAS, or SPSS. The \texttt{foreign} package supports import/conversion from many of these formats. Please note, however, that data sets from other software sometimes have properties with no direct analogue in \textsf{R}. In those cases the conversion process may lose some information which will need to be reentered manually from within \textsf{R}. See the \emph{Data Import/Export Manual}.

As an example, suppose the data are stored in the SPSS file \texttt{foo.sav} which the user has copied to the working directory; it can be imported with the commands


\begin{verbatim}
library(foreign)
read.spss("foo.sav")
\end{verbatim}

See \texttt{?read.spss} for the available options to customize the file import. Note that the \textsf{R} Commander will import many of the common file types with a menu driven interface.
\subsection{Importing a Data Frame}
\label{sec-5-2-4}


The basic command is \texttt{read.table}.
\section{Creating New Data Sets \label{sec:Creating-New-Data}}
\label{sec-5-3}

Using \texttt{c}
Using \texttt{scan}
Using the \textsf{R} Commander.
\section{Editing Data \label{sec:Editing-Data-Sets}}
\label{sec-5-4}
\subsection{Editing Data Values}
\label{sec-5-4-1}
\subsection{Inserting Rows and Columns}
\label{sec-5-4-2}
\subsection{Deleting Rows and Columns}
\label{sec-5-4-3}
\subsection{Sorting Data}
\label{sec-5-4-4}


We can sort a vector with the \texttt{sort} function. Normally we have a data frame of several columns (variables) and many, many rows (observations). The goal is to shuffle the rows so that they are ordered by the values of one or more columns. This is done with the \texttt{order} function. 

For example, we may sort all of the rows of the \texttt{Puromycin} data (in ascending order) by the variable \texttt{conc} with the following: 


\begin{verbatim}
Tmp <- Puromycin[order(Puromycin$conc), ]
head(Tmp)
\end{verbatim}

\begin{verbatim}
    conc rate     state
 1  0.02   76   treated
 2  0.02   47   treated
 13 0.02   67 untreated
 14 0.02   51 untreated
 3  0.06   97   treated
 4  0.06  107   treated
\end{verbatim}

We can accomplish the same thing with the command 


\begin{verbatim}
with(Puromycin, Puromycin[order(conc), ])
\end{verbatim}

We can sort by more than one variable. To sort first by \texttt{state} and next by \texttt{conc} do 


\begin{verbatim}
with(Puromycin, Puromycin[order(state, conc), ])
\end{verbatim}

If we would like to sort a numeric variable in descending order then we put a minus sign in front of it. 


\begin{verbatim}
Tmp <- with(Puromycin, Puromycin[order(-conc), ])
head(Tmp)
\end{verbatim}

\begin{verbatim}
    conc rate     state
 11 1.10  207   treated
 12 1.10  200   treated
 23 1.10  160 untreated
 9  0.56  191   treated
 10 0.56  201   treated
 21 0.56  144 untreated
\end{verbatim}

If we would like to sort by a character (or factor) in decreasing order then we can use the \texttt{xtfrm} function which produces a numeric vector in the same order as the character vector.


\begin{verbatim}
Tmp <- with(Puromycin, Puromycin[order(-xtfrm(state)), ])
head(Tmp)
\end{verbatim}

\begin{verbatim}
    conc rate     state
 13 0.02   67 untreated
 14 0.02   51 untreated
 15 0.06   84 untreated
 16 0.06   86 untreated
 17 0.11   98 untreated
 18 0.11  115 untreated
\end{verbatim}
\section{Exporting Data \label{sec:Exporting-a-Data}}
\label{sec-5-5}


The basic function is \texttt{write.table}. The \texttt{MASS} package also has a \texttt{write.matrix} function.
\section{Reshaping Data \label{sec:Reshaping-a-Data}}
\label{sec-5-6}

\begin{itemize}
\item Aggregation
\item Convert Tables to data frames and back
\end{itemize}

\texttt{rbind}, \texttt{cbind}
\texttt{ab[order(ab[,1]),]}
\texttt{complete.cases}
\texttt{aggregate}
\texttt{stack}
\chapter{Mathematical Machinery}
\label{sec-6}

\label{cha:Mathematical-Machinery}

This appendix houses many of the standard definitions and theorems that are used at some point during the narrative. It is targeted for someone reading the book who forgets the precise definition of something and would like a quick reminder of an exact statement. No proofs are given, and the interested reader should consult a good text on Calculus (say, Stewart \cite{Stewart2008} or Apostol \cite{Apostol1967,ApostolI1967}), Linear Algebra (say, Strang \cite{Strang1988} and Magnus \cite{Magnus1999}), Real Analysis (say, Folland \cite{Folland1999}, or Carothers \cite{Carothers2000}), or Measure Theory (Billingsley \cite{Billingsley1995}, Ash \cite{Ash2000}, Resnick \cite{Resnick1999}) for details. 
\section{Set Algebra \label{sec:The-Algebra-of}}
\label{sec-6-1}


We denote sets by capital letters, $A$, $B$, $C$, \emph{etc}. The letter $S$ is reserved for the sample space, also known as the universe or universal set, the set which contains all possible elements. The symbol $\emptyset$ represents the empty set, the set with no elements. 
\subsection{Set Union, Intersection, and Difference}
\label{sec-6-1-1}


Given subsets $A$ and $B$, we may manipulate them in an algebraic fashion. To this end, we have three set operations at our disposal: union, intersection, and difference. Below is a table summarizing the pertinent information about these operations.



\begin{center}
\begin{tabular}{llll}
 Name          &  Denoted              &  Defined by elements    &  \textsf{R} syntax         \\
\hline
 Union         &  $A\cup B$            &  in $A$ or $B$ or both  &  \texttt{union(A, B)}      \\
 Intersection  &  $A\cap B$            &  in both $A$ and $B$    &  \texttt{intersect(A, B)}  \\
 Difference    &  $A\textbackslash B$  &  in $A$ but not in $B$  &  \texttt{setdiff(A, B)}    \\
 Complement    &  $A^{c}$              &  in $S$ but not in $A$  &  \texttt{setdiff(S, A)}    \\
\end{tabular}
\end{center}


\caption{Set operations\label{tab:Set-Operations}}
\subsection{Identities and Properties}
\label{sec-6-1-2}


\begin{enumerate}
\item $A\cup\emptyset=A,\quad A\cap\emptyset=\emptyset$
\item $A\cup S=S,\quad A\cap S=A$
\item $A\cup A^{c}=S$, $A\cap A^{c}=\emptyset$
\item $(A{}^{c})^{c}=A$
\item The Commutative Property: 
   \begin{equation}
   A \cup B = B\cup A,\quad A\cap B = B\cap A
   \end{equation}
\item The Associative Property: 
   \begin{equation}
   (A\cup B)\cup C=A\cup(B\cup C),\quad(A\cap B)\cap C=A\cap(B\cap C)
   \end{equation}
\item The Distributive Property: 
   \begin{equation}
   A\cup(B\cap C)=(A\cup B)\cap(A\cup B),\quad A\cap(B\cup C)=(A\cap B)\cup(A\cap B)
   \end{equation}
\item DeMorgan's Laws
   \begin{equation}
   (A\cup B)^{c}=A^{c}\cap B^{c}\quad\mbox{and}\quad(A\cap B)^{c}=A^{c}\cup B^{c},
   \end{equation}
   or more generally,
   \begin{equation}
   \left(\bigcup_{\alpha}A_{\alpha}\right)^{c}=\bigcap_{\alpha}A_{\alpha}^{c},\quad\mbox{and}\quad\left(\bigcap_{\alpha}A_{\alpha}\right)^{c}=\bigcup_{\alpha}A_{\alpha}^{c}
   \end{equation}
\end{enumerate}
\section{Differential and Integral Calculus \label{sec:Differential-and-Integral}}
\label{sec-6-2}


A function $f$ of one variable is said to be one-to-one if no two distinct $x$ values are mapped to the same $y=f(x)$ value. To show that a function is one-to-one we can either use the horizontal line test or we may start with the equation $f(x_{1}) = f(x_{2})$ and use algebra to show that it implies $x_{1} = x_{2}$.
\subsection{Limits and Continuity}
\label{sec-6-2-1}

\begin{defn}
Let $f$ be a function defined on some open interval that contains the number $a$, except possibly at $a$ itself. Then we say the \emph{limit of} $f(x)$ \emph{as} $x$ \emph{approaches} $a$ \emph{is} $L$, and we write 
\begin{equation}
\lim_{x \to a}f(x) = L,
\end{equation}
if for every $\epsilon > 0$ there exists a number $\delta > 0$ such that $0 < |x-a| < \delta$ implies $|f(x) - L| < \epsilon$.
\end{defn}

\begin{defn}
A function $f$ is \emph{continuous at a number} $a$ if 
\begin{equation}
\lim_{x \to a} f(x) = f(a).
\end{equation}
The function $f$ is \emph{right-continuous at the number} $a$ if $\lim_{x\to a^{+}}f(x)=f(a)$, and \emph{left-continuous} at $a$ if $\lim_{x\to a^{-}}f(x)=f(a)$. Finally, the function $f$ is \emph{continuous on an interval} $I$ if it is continuous at every number in the interval. 
\end{defn}
\subsection{Differentiation}
\label{sec-6-2-2}

\begin{defn}
The \emph{derivative of a function} $f$ \emph{at a number} $a$, denoted by $f'(a)$, is
\begin{equation}
f'(a)=\lim_{h\to0}\frac{f(a+h)-f(a)}{h},
\end{equation}
provided this limit exists.
A function is \emph{differentiable at} $a$ if $f'(a)$ exists. It is \emph{differentiable on an open interval} $(a,b)$ if it is differentiable at every number in the interval.
\end{defn}



\paragraph*{Differentiation Rules}
In the table that follows, $f$ and $g$ are differentiable functions and $c$ is a constant.

\begin{center}
\begin{tabular}{lll}
 $\frac{\mathrm{d}}{\mathrm{d} x}c=0$  &  $\frac{\mathrm{d}}{\mathrm{d} x}x^{n}=nx^{n-1}$  &  $(cf)'=cf'$                                        \\
 $(f\pm g)'=f'\pm g'$                  &  $(fg)'=f'g+fg'$                                  &  $\left(\frac{f}{g}\right)'=\frac{f'g-fg'}{g^{2}}$  \\
\end{tabular}
\end{center}


\caption{Differentiation rules\textbf{\label{tab:Differentiation-Rules}}}

\begin{thm}
Chain Rule: If $f$ and $g$ are both differentiable and $F=f\circ g$ is the composite function defined by $F(x)=f[g(x)]$, then $F$ is differentiable and $F'(x) = f'[ g(x) ] \cdot g'(x)$.  
\end{thm}

\paragraph*{Useful Derivatives}


\begin{center}
\begin{tabular}{lll}
 $\frac{\mathrm{d}}{\mathrm{d} x}\mathrm{e}^{x}=\mathrm{e}^{x}$  &  $\frac{\mathrm{d}}{\mathrm{d} x}\ln x=x^{-1}$      &  $\frac{\mathrm{d}}{\mathrm{d} x}\sin x=\cos x$              \\
 $\frac{\mathrm{d}}{\mathrm{d} x}\cos x=-\sin x$                 &  $\frac{\mathrm{d}}{\mathrm{d} x}\tan x=\sec^{2}x$  &  $\frac{\mathrm{d}}{\mathrm{d} x}\tan^{-1}x=(1+x^{2})^{-1}$  \\
\end{tabular}
\end{center}


\caption{Some derivatives\label{tab:Useful-Derivatives}}
\subsection{Optimization}
\label{sec-6-2-3}

\begin{defn}
A \emph{critical number} of the function $f$ is a value $x^{\ast}$ for which $f'(x^{\ast})=0$ or for which $f'(x^{\ast})$ does not exist.
\end{defn}

\begin{thm}
\label{thm:First-Derivative-Test}
First Derivative Test. If $f$ is differentiable and if $x^{\ast}$ is a critical number of $f$ and if $f'(x)\geq0$ for $x\leq x^{\ast}$ and $f'(x)\leq0$ for $x\geq x^{\ast}$, then $x^{\ast}$ is a local maximum of $f$. If $f'(x)\leq0$ for $x\leq x^{\ast}$ and $f'(x)\geq0$ for $x\geq x^{\ast}$ , then $x^{\ast}$ is a local minimum of $f$.
\end{thm}

\begin{thm}
Second Derivative Test. If $f$ is twice differentiable and if $x^{\ast}$ is a critical number of $f$, then $x^{\ast}$ is a local maximum of $f$ if $f''(x^{\ast})<0$ and $x^{\ast}$ is a local minimum of $f$ if $f''(x^{\ast})>0$.
\end{thm}
\subsection{Integration}
\label{sec-6-2-4}

As it turns out, there are all sorts of things called ``integrals'', each defined in its own idiosyncratic way. There are \emph{Riemann} integrals, \emph{Lebesgue} integrals, variants of these called \emph{Stieltjes} integrals, \emph{Daniell} integrals, \emph{Ito} integrals, and the list continues. Given that this is an introductory book, we will use the Riemannian integral with the caveat that the Riemann integral is \emph{not} the integral that will be used in more advanced study.

\begin{defn}
Let $f$ be defined on $[a,b]$, a closed interval of the real line. For each $n$, divide $[a,b]$ into subintervals $[x_{i},x_{i+1}]$, $i=0,1,\ldots,n-1$, of length $\Delta x_{i}=(b-a)/n$ where $x_{0}=a$ and $x_{n}=b$, and let $x_{i}^{\ast}$ be any points chosen from the respective subintervals. Then the \emph{definite integral} of $f$ from $a$ to $b$ is defined by
\begin{equation}
\int_{a}^{b}f(x)\,\mathrm{d} x=\lim_{n\to\infty}\sum_{i=0}^{n-1}f(x_{i}^{\ast})\,\Delta x_{i},
\end{equation}
provided the limit exists, and in that case, we say that $f$ is \emph{integrable} from $a$ to $b$. 
\end{defn}

\begin{thm}
The Fundamental Theorem of Calculus. Suppose $f$ is continuous on $[a,b]$. Then
\begin{enumerate}
\item the function $g$ defined by $g(x)=\int_{a}^{x}f(t)\:\mathrm{d} t$, $a\leq x\leq b$, is continuous on $[a,b]$ and differentiable on $(a,b)$ with $g'(x)=f(x)$.
\item $\int_{a}^{b}f(x)\,\mathrm{d} x=F(b)-F(a)$, where $F$ is any \emph{antiderivative} of $f$, that is, any function $F$ satisfying $F'=f$.
\end{enumerate}
\end{thm}


\paragraph*{Change of Variables}
\begin{thm}
If $g$ is a differentiable function whose range is the interval $[a,b]$ and if both $f$ and $g'$ are continuous on the range of $u = g(x)$, then
\begin{equation}
\int_{g(a)}^{g(b)}f(u)\:\mathrm{d} u=\int_{a}^{b}f[g(x)]\: g'(x)\:\mathrm{d} x.
\end{equation}
\end{thm}

\paragraph*{Useful Integrals}


\begin{center}
\begin{tabular}{lllll}
 $\int x^{n}\,\mathrm{d} x=x^{n+1}/(n+1),\ n\neq-1$  &  $\int\mathrm{e}^{x}\,\mathrm{d} x=\mathrm{e}^{x}$  &  $\int x^{-1}\,\mathrm{d} x=\ln  &  x                                       &  $                                              \\
 $\int\tan x\:\mathrm{d} x=\ln                       &  \sec x                                             &  $                               &  $\int a^{x}\,\mathrm{d} x=a^{x}/\ln a$  &  $\int(x^{2}+1)^{-1}\,\mathrm{d} x=\tan^{-1}x$  \\
\end{tabular}
\end{center}


\caption{Some integrals (constants of integration omitted)\label{tab:Useful-Integrals}}

\paragraph*{Integration by Parts}

\begin{equation}
\int u\:\mathrm{d} v=uv-\int v\:\mathrm{d} u
\end{equation}
\begin{thm}
L'H\^ opital's Rule. Suppose $f$ and $g$ are differentiable and $g'(x)\neq0$ near $a$, except possibly at $a$. Suppose that the limit 
\begin{equation}
\lim_{x\to a}\frac{f(x)}{g(x)}
\end{equation}
is an indeterminate form of type $\frac{0}{0}$ or $\infty/\infty$. Then
\begin{equation}
\lim_{x\to a}\frac{f(x)}{g(x)}=\lim_{x\to a}\frac{f'(x)}{g'(x)},
\end{equation}
provided the limit on the right-hand side exists or is infinite.
\end{thm}

\paragraph*{Improper Integrals}

If $\int_{a}^{t}f(x)\mathrm{d} x$ exists for every number $t\geq a$, then we define 
\begin{equation}
\int_{a}^{\infty}f(x)\,\mathrm{d} x=\lim_{t\to\infty}\int_{a}^{t}f(x)\,\mathrm{d} x,
\end{equation}
provided this limit exists as a finite number, and in that case we say that $\int_{a}^{\infty}f(x)\,\mathrm{d} x$ is \emph{convergent}. Otherwise, we say that the improper integral is \emph{divergent}.

If $\int_{t}^{b}f(x)\,\mathrm{d} x$ exists for every number $t\leq b$, then we define
\begin{equation}
\int_{-\infty}^{b}f(x)\,\mathrm{d} x=\lim_{t\to-\infty}\int_{t}^{b}f(x)\,\mathrm{d} x,
\end{equation}
provided this limit exists as a finite number, and in that case we say that $\int_{-\infty}^{b}f(x)\,\mathrm{d} x$ is \emph{convergent}. Otherwise, we say that the improper integral is \emph{divergent}.

If both $\int_{a}^{\infty}f(x)\,\mathrm{d} x$ and $\int_{-\infty}^{a}f(x)\,\mathrm{d} x$ are convergent, then we define
\begin{equation}
\int_{-\infty}^{\infty}f(x)\,\mathrm{d} x=\int_{-\infty}^{a}f(x)\,\mathrm{d} x+\int_{a}^{\infty}f(x)\mathrm{d} x,
\end{equation}
and we say that $\int_{-\infty}^{\infty}f(x)\,\mathrm{d} x$ is \emph{convergent}. Otherwise, we say that the improper integral is \emph{divergent}.
\section{Sequences and Series \label{sec:Sequences-and-Series}}
\label{sec-6-3}


A \emph{sequence} is an ordered list of numbers, $a_{1}$, $a_{2}$, $a_{3}$, \ldots{}, $a_{n}$ \$=\left(a$_{k}$\right)$_{\mathrm{k=1}}$$^{n}$\$. A sequence may be finite or infinite. In the latter case we write $a_{1}$, $a_{2}$, $a_{3}$, \ldots{}$=\left(a_{k}\right)_{k=1}^{\infty}$. We say that \emph{the infinite sequence} $\left(a_{k}\right)_{k=1}^{\infty}$ \emph{converges to the finite limit} $L$, and we write
\begin{equation}
\lim_{k\to\infty}a_{k} = L,
\end{equation}
if for every $\epsilon > 0$ there exists an integer $N \geq 1$ such that $|a_{k} - L| < \epsilon$ for all $k \geq N$. We say that \emph{the infinite sequence} $\left(a_{k}\right)_{k=1}^{\infty}$ \emph{diverges to} $+\infty$ (or -$\infty$) if for every $M\geq0$ there exists an integer $N\geq1$ such that $a_{k} \geq M$ for all $k \geq N$ (or $a_{k} \leq - M$ for all $k \geq N$).
\subsection{Finite Series}
\label{sec-6-3-1}


\begin{equation}
\sum_{k=1}^{n}k=1+2+\cdots+n=\frac{n(n+1)}{2}\label{eq:gauss-series}
\end{equation}
\begin{equation}
\sum_{k=1}^{n}k^{2}=1^{2}+2^{2}+\cdots+n^{2}=\frac{n(n+1)(2n+3)}{6}\label{eq:gauss-series-sq}
\end{equation}


\paragraph*{The Binomial Series}
\begin{equation}
\sum_{k=0}^{n}{n \choose k}\, a^{n-k}b^{k}=(a+b)^{n}\label{eq:binom-series}
\end{equation}
\subsection{Infinite Series}
\label{sec-6-3-2}


Given an infinite sequence of numbers $a_{1}$, $a_{2}$, $a_{3}$, \ldots{}$=\left(a_{k}\right)_{k=1}^{\infty}$, let $s_{n}$ denote the \emph{partial sum} of the first $n$ terms:
\begin{equation}
s_{n}=\sum_{k=1}^{n}a_{k}=a_{1}+a_{2}+\cdots+a_{n}.
\end{equation}
If the sequence $\left(s_{n}\right)_{n=1}^{\infty}$ converges to a finite number $S$ then we say that the infinite series $\sum_{k}a_{k}$ is \emph{convergent} and write
\begin{equation}
\sum_{k=1}^{\infty}a_{k}=S.
\end{equation}
Otherwise we say the infinite series is \emph{divergent}.
\subsection{Rules for Series}
\label{sec-6-3-3}


Let $\left(a_{k}\right)_{k=1}^{\infty}$ and $\left(b_{k}\right)_{k=1}^{\infty}$ be infinite sequences and let $c$ be a constant.

\begin{equation}
\sum_{k=1}^{\infty}ca_{k}=c\sum_{k=1}^{\infty}a_{k}
\end{equation}
\begin{equation}
\sum_{k=1}^{\infty}(a_{k}\pm b_{k})=\sum_{k=1}^{\infty}a_{k}\pm\sum_{k=1}^{\infty}b_{k}
\end{equation}

In both of the above the series on the left is convergent if the series on the right is (are) convergent.

\paragraph*{The Geometric Series}
\begin{equation}
\sum_{k=0}^{\infty} x^{k} = \frac{1}{1 - x},\quad|x| < 1.\label{eq:geom-series}
\end{equation}

\paragraph*{The Exponential Series}
\begin{equation}
\sum_{k=0}^{\infty}\frac{x^{k}}{k!} = \mathrm{e}^{x},\quad -\infty < x < \infty. \label{eq:exp-series}
\end{equation}

Other Series
\begin{equation}
\sum_{k=0}^{\infty}{m+k-1 \choose m-1}x^{k}=\frac{1}{(1-x)^{m}},\quad|x|<1.\label{eq:negbin-series}
\end{equation}
\begin{equation}
-\sum_{k=1}^{\infty}\frac{x^{n}}{n}=\ln(1-x),\quad|x|<1.\label{eq:log-series}
\end{equation}
\begin{equation}
\sum_{k=0}^{\infty}{n \choose k}x^{k}=(1+x)^{n},\quad|x|<1.\label{eq:binom-series-infinite}
\end{equation}
\subsection{Taylor Series}
\label{sec-6-3-4}


If the function $f$ has a \emph{power series} representation at the point $a$ with radius of convergence $R>0$, that is, if
\begin{equation}
f(x)=\sum_{k=0}^{\infty}c_{k}(x-a)^{k},\quad|x-a|<R,
\end{equation}
for some constants $\left(c_{k}\right)_{k=0}^{\infty}$, then $c_{k}$ must be
\begin{equation}
c_{k}=\frac{f^{(k)}(a)}{k!},\quad k=0,1,2,\ldots
\end{equation}
Furthermore, the function $f$ is differentiable on the open interval $(a-R,\, a+R)$ with
\begin{equation}
f'(x)=\sum_{k=1}^{\infty}kc_{k}(x-a)^{k-1},\quad|x-a|<R,
\end{equation}
\begin{equation}
\int f(x)\,\mathrm{d} x=C+\sum_{k=0}^{\infty}c_{k}\frac{(x-a)^{k+1}}{k+1},\quad|x-a|<R,
\end{equation}
in which case both of the above series have radius of convergence $R$.
\section{The Gamma Function \label{sec:The-Gamma-Function}}
\label{sec-6-4}


The \emph{Gamma function} $\Gamma$ will be defined in this book according to the formula
\begin{equation}
\Gamma(\alpha)=\int_{0}^{\infty}x^{\alpha-1}\mathrm{e}^{-x}\:\mathrm{d} x,\quad\mbox{for }\alpha > 0.
\end{equation}

\begin{fact}
Properties of the Gamma Function:
\begin{itemize}
\item $\Gamma(\alpha)=(\alpha - 1)\Gamma(\alpha - 1)$ for any $\alpha > 1$, and so $\Gamma(n)=(n-1)!$ for any positive integer $n$.
\item $\Gamma(1/2)=\sqrt{\pi}$.
\end{itemize}
\end{fact}
\section{Linear Algebra \label{sec:Linear-Algebra}}
\label{sec-6-5}
\subsection{Matrices}
\label{sec-6-5-1}

A \emph{matrix} is an ordered array of numbers or expressions; typically we write $\mathbf{A}=\begin{pmatrix}a_{ij}\end{pmatrix}$ or $\mathbf{A}=\begin{bmatrix}a_{ij}\end{bmatrix}$. If $\mathbf{A}$ has $m$ rows and $n$ columns then we write
\begin{equation}
\mathbf{A}_{\mathrm{m}\times\mathrm{n}}=\begin{bmatrix}a_{11} & a_{12} & \cdots & a_{1n}\\
a_{21} & a_{22} & \cdots & a_{2n}\\
\vdots & \vdots & \ddots & \vdots\\
a_{m1} & a_{m2} & \cdots & a_{mn}\end{bmatrix}.
\end{equation}
The \emph{identity matrix} $\mathbf{I}_{\mathrm{n}\times\mathrm{n}}$ is an $\mathrm{n}\times\mathrm{n}$ matrix with zeros everywhere except for 1's along the main diagonal: 
\begin{equation}
\mathbf{I}_{\mathrm{n}\times\mathrm{n}}=\begin{bmatrix}1 & 0 & \cdots & 0\\
0 & 1 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \cdots & 1\end{bmatrix}.
\end{equation}
and the matrix with ones everywhere is denoted $\mathbf{J}_{\mathrm{n}\times\mathrm{n}}$:
\begin{equation}
\mathbf{J}_{\mathrm{n}\times\mathrm{n}}=\begin{bmatrix}1 & 1 & \cdots & 1\\
1 & 1 & \cdots & 1\\
\vdots & \vdots & \ddots & \vdots\\
1 & 1 & \cdots & 1\end{bmatrix}.
\end{equation}

A \emph{vector} is a matrix with one of the dimensions equal to one, such as $\mathbf{A}_{\mathrm{m}\times1}$ (a column vector) or $\mathbf{A}_{\mathrm{1}\times\mathrm{n}}$ (a row vector). The \emph{zero vector} $\mathbf{0}_{\mathrm{n}\times1}$
is an $\mathrm{n}\times1$ matrix of zeros:
\begin{equation}
\mathbf{0}_{\mathrm{n}\times1}=\begin{bmatrix}0 & 0 & \cdots & 0\end{bmatrix}^{\mathrm{T}}.
\end{equation}

The \emph{transpose} of a matrix $\mathbf{A}=\begin{pmatrix}a_{ij}\end{pmatrix}$ is the matrix $\mathbf{A}^{\mathrm{T}}=\begin{pmatrix}a_{ji}\end{pmatrix}$, which is just like $\mathbf{A}$ except the rows are columns and the columns are rows. The matrix $\mathbf{A}$ is said to be \emph{symmetric} if $\mathbf{A}^{\mathrm{T}}=\mathbf{A}$. Note that $\left(\mathbf{A}\mathbf{B}\right)^{\mathrm{T}}=\mathbf{B}^{\mathrm{T}}\mathbf{A}^{\mathrm{T}}$.

The \emph{trace} of a square matrix $\mathbf{A}$ is the sum of its diagonal elements: $\mathrm{tr}(\mathbf{A})=\sum_{i}a_{ii}$. 

The \emph{inverse} of a square matrix $\mathbf{A}_{\mathrm{n}\times\mathrm{n}}$ (when it exists) is the unique matrix denoted $\mathbf{A}^{-1}$ which satisfies $\mathbf{A}\mathbf{A}^{-1}=\mathbf{A}^{-1}\mathbf{A}=\mathbf{I}_{\mathrm{n}\times\mathrm{n}}$. If $\mathbf{A}^{-1}$ exists then we say $\mathbf{A}$ is \emph{invertible}, or \emph{nonsingular}. Note that $\left(\mathbf{A}^{\mathrm{T}}\right)^{-1}=\left(\mathbf{A}^{\mathrm{-1}}\right)^{\mathrm{T}}$.
\begin{fact}
The inverse of the $2\times2$ matrix
\begin{equation}
\mathbf{A}=\begin{bmatrix}a & b\\
c & d\end{bmatrix}\quad\mbox{is}\quad\mathbf{A}^{-1}=\frac{1}{ad-bc}\begin{bmatrix}d & -b\\
-c & a\end{bmatrix},
\end{equation}
provided $ad-bc\neq0$.
\end{fact}
\subsection{Determinants}
\label{sec-6-5-2}

\begin{defn}
The \emph{determinant} of a square matrix $\mathbf{A}_{\mathrm{n}\times n}$ is denoted $\mathrm{det}(\mathbf{A})$ or $|\mathbf{A}|$ and is defined recursively by
\begin{equation}
\mathrm{det}(\mathbf{A})=\sum_{i=1}^{n}(-1)^{i+j}a_{ij}\,\mathrm{det}(\mathbf{M}_{ij}),
\end{equation}
where $\mathbf{M}_{ij}$ is the submatrix formed by deleting the $i^{\mathrm{th}}$ row and $j^{\mathrm{th}}$ column of $\mathbf{A}$. We may choose any fixed $1\leq j\leq n$ we wish to compute the determinant; the final result is independent of the $j$ chosen.
\end{defn}
\begin{fact}
The determinant of the $2\times2$ matrix
\begin{equation}
\mathbf{A}=\begin{bmatrix}a & b\\
c & d\end{bmatrix}\quad\mbox{is}\quad|\mathbf{A}|=ad-bc.
\end{equation}
\end{fact}

\begin{fact}
A square matrix $\mathbf{A}$ is nonsingular if and only if $\mathrm{det}(\mathbf{A})\neq0$.
\end{fact}
\subsection{Positive (Semi)Definite}
\label{sec-6-5-3}

If the matrix $\mathbf{A}$ satisfies $\mathbf{x^{\mathrm{T}}}\mathbf{A}\mathbf{x}\geq0$ for all vectors $\mathbf{x}\neq\mathbf{0}$, then we say that $\mathbf{A}$ is \emph{positive semidefinite}. If strict inequality holds for all $\mathbf{x}\neq\mathbf{0}$, then $\mathbf{A}$ is \emph{positive definite}. The connection to statistics is that covariance matrices (see Chapter \ref{cha:Multivariable-Distributions}) are always positive semidefinite, and many of them are even positive definite.
\section{Multivariable Calculus \label{sec:Multivariable-Calculus}}
\label{sec-6-6}
\subsection{Partial Derivatives}
\label{sec-6-6-1}

If $f$ is a function of two variables, its \emph{first-order partial derivatives} are defined by
\begin{equation}
\frac{\partial f}{\partial x}=\frac{\partial}{\partial x}f(x,y)=\lim_{h\to0}\frac{f(x+h,\, y)-f(x,y)}{h}
\end{equation}
and
\begin{equation}
\frac{\partial f}{\partial y}=\frac{\partial}{\partial y}f(x,y)=\lim_{h\to0}\frac{f(x,\, y+h)-f(x,y)}{h},
\end{equation}
provided these limits exist. The \emph{second-order partial derivatives} of $f$ are defined by
\begin{equation}
\frac{\partial^{2}f}{\partial x^{2}}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial x}\right),\quad\frac{\partial^{2}f}{\partial y^{2}}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial y}\right),\quad\frac{\partial^{2}f}{\partial x\partial y}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial y}\right),\quad\frac{\partial^{2}f}{\partial y\partial x}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial x}\right).
\end{equation}
In many cases (and for all cases in this book) it is true that
\begin{equation}
\frac{\partial^{2}f}{\partial x\partial y}=\frac{\partial^{2}f}{\partial y\partial x}.
\end{equation}
\subsection{Optimization}
\label{sec-6-6-2}

An function $f$ of two variables has a \emph{local maximum} at $(a,b)$ if $f(x,y)\geq f(a,b)$ for all points $(x,y)$ near $(a,b)$, that is, for all points in an open disk centered at $(a,b)$. The number $f(a,b)$ is then called a \emph{local maximum value} of $f$. The function $f$ has a \emph{local minimum} if the same thing happens with the inequality reversed.

Suppose the point $(a,b)$ is a \emph{critical point} of $f$, that is, suppose $(a,b)$ satisfies 
\begin{equation}
\frac{\partial f}{\partial x}(a,b)=\frac{\partial f}{\partial y}(a,b)=0.
\end{equation}
Further suppose $\frac{\partial^{2}f}{\partial x^{2}}$ and $\frac{\partial^{2}f}{\partial y^{2}}$ are continuous near $(a,b)$. Let the \emph{Hessian matrix} $H$ (not to be confused with the \emph{hat matrix} $\mathbf{H}$ of Chapter \ref{cha:multiple-linear-regression}) be defined by
\begin{equation}
H = 
\begin{bmatrix}
\frac{\partial^{2}f}{\partial x^{2}} & \frac{\partial^{2}f}{\partial x\partial y}\\
\frac{\partial^{2}f}{\partial y\partial x} & \frac{\partial^{2}f}{\partial y^{2}}
\end{bmatrix}.
\end{equation}
We use the following rules to decide whether $(a,b)$ is an \emph{extremum} (that is, a local minimum or local maximum) of $f$.
\begin{itemize}
\item If $\mbox{det}(H)>0$ and $\frac{\partial^{2}f}{\partial x^{2}}(a,b)>0$, then $(a,b)$ is a local minimum of $f$.
\item If $\mbox{det}(H)>0$ and $\frac{\partial^{2}f}{\partial x^{2}}(a,b)<0$, then $(a,b)$ is a local maximum of $f$.
\item If $\mbox{det}(H)<0$, then $(a,b)$ is a \emph{saddle point} of $f$ and so is not an extremum of $f$.
\item If $\mbox{det}(H)=0$, then we do not know the status of $(a,b)$; it might be an extremum or it might not be.
\end{itemize}
\subsection{Double and Multiple Integrals}
\label{sec-6-6-3}

Let $f$ be defined on a rectangle $R=[a,b]\times[c,d]$, and for each $m$ and $n$ divide $[a,b]$ (respectively $[c,d]$) into subintervals $[x_{j},x_{j+1}]$, $i=0,1,\ldots,m-1$ (respectively $[y_{i},y_{i+1}]$) of length $\Delta x_{j}=(b-a)/m$ (respectively $\Delta y_{i}=(d-c)/n$) where $x_{0}=a$ and $x_{m}=b$ (and $y_{0}=c$ and $y_{n}=d$ ), and let $x_{j}^{\ast}$ ($y_{i}^{\ast}$) be any points chosen from their respective subintervals. Then the \emph{double integral} of $f$ over the rectangle $R$ is
\begin{equation}
\iintop_{R}f(x,y)\,\mathrm{d} A=\intop_{c}^{d}\!\!\!\intop_{a}^{b}f(x,y)\,\mathrm{d} x\mathrm{d} y=\lim_{m,n\to\infty}\sum_{i=1}^{n}\sum_{j=1}^{m}f(x_{j}^{\ast},y_{i}^{\ast})\Delta x_{j}\Delta y_{i},
\end{equation}
provided this limit exists. Multiple integrals are defined in the same way just with more letters and sums.
\subsection{Bivariate and Multivariate Change of Variables}
\label{sec-6-6-4}

Suppose we have a transformation[fn:inv] $T$ that maps points $(u,v)$ in a set $A$ to points $(x,y)$ in a set $B$. We typically write $x=x(u,v)$ and $y=y(u,v)$, and we assume that $x$ and $y$ have continuous first-order partial derivatives. We say that $T$ is \emph{one-to-one} if no two distinct $(u,v)$ pairs get mapped to the same $(x,y)$ pair; in this book, all of our multivariate transformations $T$ are one-to-one.

[fn:inv] For our purposes $T$ is in fact the \emph{inverse} of a one-to-one transformation that we are initially given. We usually start with functions that map $(x,y) \longmapsto (u,v)$, and one of our first tasks is to solve for the inverse transformation that maps $(u,v)\longmapsto(x,y)$. It is this inverse transformation which we are calling $T$.

The \emph{Jacobian} (pronounced ``yah-KOH-bee-uhn'') of $T$ is denoted by $\partial(x,y)/\partial(u,v)$ and is defined by the determinant of the following matrix of partial derivatives:
\begin{equation}
\frac{\partial(x,y)}{\partial(u,v)}=\left|
\begin{array}{cc}
\frac{\partial x}{\partial u} & \frac{\partial x}{\partial v}\\
\frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}
\end{array}
\right|=\frac{\partial x}{\partial u}\frac{\partial y}{\partial v}-\frac{\partial x}{\partial v}\frac{\partial y}{\partial u}.
\end{equation}

If the function $f$ is continuous on $A$ and if the Jacobian of $T$ is nonzero except perhaps on the boundary of $A$, then 
\begin{equation}
\iint_{B}f(x,y)\,\mathrm{d} x\,\mathrm{d} y=\iint_{A}f\left[x(u,v),\, y(u,v)\right]\ \left|\frac{\partial(x,y)}{\partial(u,v)}\right|\mathrm{d} u\,\mathrm{d} v.
\end{equation} 

A multivariate change of variables is defined in an analogous way: the one-to-one transformation $T$ maps points $(u_{1},u_{2},\ldots,u_{n})$ to points $(x_{1},x_{2},\ldots,x_{n})$, the Jacobian is the determinant of the $\mathrm{n}\times\mathrm{n}$ matrix of first-order partial derivatives of $T$ (lined up in the natural manner), and instead of a double integral we have a multiple integral over multidimensional sets $A$ and $B$.
\chapter{Writing Reports with \textsf{R}}
\label{sec-7}

\label{cha:Writing-Reports-with}

Perhaps the most important part of a statistician's job once the analysis is complete is to communicate the results to others. This is usually done with some type of report that is delivered to the client, manager, or administrator. Other situations that call for reports include term papers, final projects, thesis work, \emph{etc}. This chapter is designed to pass along some tips about writing reports once the work is completed with \textsf{R}.
\section{What to Write \label{sec:What-to-Write}}
\label{sec-7-1}

It is possible to summarize this entire appendix with only one sentence: \emph{the statistician's goal is to communicate with others}. To this end, there are some general guidelines that I give to students which are based on an outline originally written and shared with me by Dr.\~{}G.\~{}Andy Chang.
\subsection{Basic Outline for a Statistical Report}
\label{sec-7-1-1}

\begin{enumerate}
\item Executive Summary (a one page description of the study and conclusion)
\item Introduction
\begin{enumerate}
\item What is the question, and why is it important?
\item Is the study observational or experimental?
\item What are the hypotheses of interest to the researcher?
\item What are the types of analyses employed? (one sample $t$-test, paired-sample $t$-test, ANOVA, chi-square test, regression, \ldots{})
\end{enumerate}
\item Data Collection
\begin{enumerate}
\item Describe how the data were collected in detail.
\item Identify all variable types: quantitative, qualitative, ordered or nominal (with levels), discrete, continuous.
\item Discuss any limitations of the data collection procedure. Look carefully for any sources of bias.
\end{enumerate}
\item Summary Information
\begin{enumerate}
\item Give numeric summaries of all variables of interest.
\begin{enumerate}
\item Discrete: (relative) frequencies, contingency tables, odds ratios, \emph{etc}.
\item Continuous: measures of center, spread, shape.
\end{enumerate}
\item Give visual summaries of all variables of interest.
\begin{enumerate}
\item Side-by-side boxplots, scatterplots, histograms, \emph{etc}.
\end{enumerate}
\item Discuss any unusual features of the data (outliers, clusters, granularity, \emph{etc}.)
\item Report any missing data and identify any potential problems or bias.
\end{enumerate}
\item Analysis
\begin{enumerate}
\item State any hypotheses employed, and check the assumptions.
\item Report test statistics, \emph{p}-values, and confidence intervals.
\item Interpret the results in the context of the study.
\item Attach (labeled) tables and/or graphs and make reference to them in the report as needed.
\end{enumerate}
\item Conclusion
\begin{enumerate}
\item Summarize the results of the study. What did you learn?
\item Discuss any limitations of the study or inferences.
\item Discuss avenues of future research suggested by the study.
\end{enumerate}
\end{enumerate}
\section{How to Write It with R \label{sec:How-to-Write}}
\label{sec-7-2}

Once the decision has been made what to write, the next task is to typeset the information to be shared. To do this the author will need to select software to use to write the documents. There are many options available, and choosing one over another is sometimes a matter of taste. But not all software were created equal, and \textsf{R} plays better with some applications than it does with others. 
In short, \textsf{R} does great with \LaTeX{} and there are many resources available to make writing a document with \textsf{R} and \LaTeX{} easier. But \LaTeX{} is not for the beginner, and there are other word processors which may be acceptable depending on the circumstances.
\subsection{Microsoft$\circledR$ Word}
\label{sec-7-2-1}

It is a fact of life that Microsoft$\circledR$ Windows is currently the most prevalent desktop operating system on the planet. Those who own Windows also typically own some version of Microsoft Office, thus Microsoft Word is the default word processor for many, many people.  

The standard way to write an \textsf{R} report with Microsoft$\circledR$ Word is to generate material with \textsf{R} and then copy-paste the material at selected places in a Word document. An advantage to this approach is that Word is nicely designed to make it easy to copy-and-paste from \textsf{RGui} to the Word document.

A disadvantage to this approach is that the R input/output needs to be edited manually by the author to make it readable for others. Another disadvantage is that the approach does not work on all operating systems (not on Linux, in particular). Yet another disadvantage is that Microsoft$\circledR$ Word is proprietary, and as a result, \textsf{R} does not communicate with Microsoft$\circledR$ Word as well as it does with other software as we shall soon see.

Nevertheless, if you are going to write a report with Word there are some steps that you can take to make the report more amenable to the reader. 

\begin{enumerate}
\item Copy and paste graphs into the document. You can do this by right clicking on the graph and selecting \textsf{Copy as bitmap,} or \textsf{Copy as metafile}, or one of the other options. Then move the cursor to the document where you want the picture, right-click, and select \textsf{Paste}.
\item Resize (most) pictures so that they take up no more than 1/2 page. You may want to put graphs side by side; do this by inserting a table and placing the graphs inside the cells.
\item Copy selected \textsf{R} input and output to the Word document. All code should be separated from the rest of the writing, except when specifically mentioning a function or object in a sentence.
\item The font of \textsf{R} input/output should be Courier New, or some other monowidth font (not Times New Roman or Calibri); the default font size of \texttt{12} is usually too big for \textsf{R} code and should be reduced to, for example, \texttt{10pt}.
\end{enumerate}

It is also possible to communicate with \textsf{R} through OpenOffice.org, which can export to the proprietary (\texttt{.doc}) format.
\subsection{OpenOffice.org and \texttt{odfWeave}}
\label{sec-7-2-2}

OpenOffice.org (OO.o) is an open source desktop productivity suite which mirrors Microsoft$\circledR$ Office. It is especially nice because it works on all operating systems. OO.o can read most document formats, and in particular, it will read \texttt{.doc} files. The standard OO.o file extension for documents is \texttt{.odt}, which stands for ``open document text''.

The \texttt{odfWeave}  package \cite{odfweave} provides a way to generate an \texttt{.odt} file with \textsf{R} input and output code formatted correctly and inserted in the correct places, without any additional work. In this way, one does not need to worry about all of the trouble of typesetting \textsf{R} output. Another advantage of \texttt{odfWeave} is that it allows you to generate the report dynamically; if the data underlying the report change or are updated, then a few clicks (or commands) will generate a brand new report.

One disadvantage is that the source \texttt{.odt}  file is not easy to read, because it is difficult to visually distinguish the noweb parts (where the \textsf{R} code is) from the non-noweb parts. This can be fixed by manually changing the font of the noweb sections to, for instance, Courier font, size \texttt{10pt}. But it is extra work. It would be nice if a program would discriminate between the two different sections and automatically typeset the respective parts in their correct fonts. This is one of the advantages to \LyX{}.

Another advantage of OO.o is that even after you have generated the outfile, it is fully editable just like any other \texttt{.odt} document. If there are errors or formatting problems, they can be fixed at any time.

Here are the basic steps to typeset a statistical report with OO.o.

\begin{enumerate}
\item Write your report as an \texttt{.odt} document in OO.o just as you would any other document. Call this document \texttt{infile.odt}, and make sure that it is saved in your working directory.
\item At the places you would like to insert \textsf{R} code in the document, write the code chunks in the following format:
   \texttt{<\textcompwordmark{}<>\textcompwordmark{}>=}~\\
   \texttt{x <- rnorm(10)}~\\
   \texttt{mean(x)}~\\
   \texttt{@}
   or write whatever code you want between the symbols \texttt{<\textcompwordmark{}<>\textcompwordmark{}>=} and \texttt{@}.
\item Open \textsf{R} and type the following:
\end{enumerate}

\begin{verbatim}
   library(odfWeave)
   odfWeave(file = "infile.odt", dest = "outfile.odt")
\end{verbatim}
\begin{enumerate}
\item The compiled (\texttt{.odt}) file, complete with all of the \textsf{R} output automatically inserted in the correct places, will now be the file \texttt{outfile.odt} located in the working directory. Open \texttt{outfile.odt}, examine it, modify it, and repeat if desired.
\end{enumerate}

There are all sorts of extra things that you can do. For example, the \textsf{R} commands can be suppressed with the tag \texttt{<\textcompwordmark{}<echo = FALSE>\textcompwordmark{}>=}, and the \textsf{R} output may be hidden with \texttt{<\textcompwordmark{}<results = hide>\textcompwordmark{}>=}. See the \texttt{odfWeave} package documentation for details.
\subsection{Sweave and \protect\LaTeX{}}
\label{sec-7-2-3}


This approach is nice because it works for all operating systems. One can quite literally typeset \emph{anything} with \LaTeX{}. All of this power comes at a price, however. The writer must learn the \LaTeX{} language which is a nontrivial enterprise. Even given the language, if there is a single syntax error, or a single delimeter missing in the entire document, then the whole thing breaks.

\LaTeX{} can do anything, but it is relatively difficult to learn  and very grumpy about syntax errors and delimiter matching. There are however programs useful for formatting \LaTeX{}.

A disadvantage is that you cannot see the mathematical formulas until you run the whole file with \LaTeX{}.

A disadvantage is that figures and tables are relatively difficult.

There are programs to make the process easier: AUC\TeX{}.

dev.copy2eps, also dev.copy2pdf

\url{[[http://www.stat.uni-muenchen.de/~leisch/Sweave/][http://www.stat.uni-muenchen.de/~leisch/Sweave/]]}
\subsection{Sweave and \protect\LyX{}}
\label{sec-7-2-4}

This approach is nice because it works for all operating  systems. It gives you everything from the last section and makes it easier to use \LaTeX{}. That being said, it is better to know \LaTeX{} already when migrating to \LyX{}, because you understand all of the machinery going on under the hood.

Program Listings and the \textsf{R} language
\url{[[http://gregor.gorjanc.googlepages.com/lyx-sweave][http://gregor.gorjanc.googlepages.com/lyx-sweave]]}
\section{Formatting Tables \label{sec:Formatting-Tables}}
\label{sec-7-3}


The prettyR package 

The Hmisc package


\begin{verbatim}
library(Hmisc)
summary(cbind(Sepal.Length, Sepal.Width) ~ Species, data = iris)
\end{verbatim}


\begin{verbatim}
cbind(Sepal.Length, Sepal.Width)    N=150
-------+----------+---+------------+-----------+
|       |          |N  |Sepal.Length|Sepal.Width|
-------+----------+---+------------+-----------+
|Species|setosa    | 50|5.006000    |3.428000   |
|       |versicolor| 50|5.936000    |2.770000   |
|       |virginica | 50|6.588000    |2.974000   |
-------+----------+---+------------+-----------+
|Overall|          |150|5.843333    |3.057333   |
-------+----------+---+------------+-----------+
\end{verbatim}

There is a \texttt{method} argument to \texttt{summary}, which is set to \texttt{method = "response"} by default. There are two other methods for summarizing data: \texttt{reverse} and \texttt{cross}. See \texttt{?summary.formula} or the following document from Frank Harrell for more details \url{[[http://biostat.mc.vanderbilt.edu/twiki/bin/view/Main/StatReport][http://biostat.mc.vanderbilt.edu/twiki/bin/view/Main/StatReport]]}.
\section{Other Formats \label{sec:Other-Formats}}
\label{sec-7-4}


HTML and prettyR
R2HTML
\chapter{Instructions for Instructors}
\label{sec-8}

\label{cha:Instructions-for-Instructors}

\noun{WARNING: this appendix is not applicable until the exercises
have been written.} 


Probably this \emph{book} could more accurately be described as \emph{software}. The reason is that the document is one big random variable, one observation realized out of millions. It is electronically distributed under the GNU FDL, and ``free'' in both senses: speech and beer.  

There are four components to \IPSUR: the Document, the Program used to generate it, the \textsf{R} package that holds the Program, and the Ancillaries that accompany it.

The majority of the data and exercises have been designed to be randomly generated. Different realizations of this book will have different graphs and exercises throughout. The advantage of this approach is that a teacher, say, can generate a unique version to be used in his/her class. Students can do the exercises and the teacher will have the answers to all of the problems in their own, unique solutions manual. Students may download a different solutions manual online somewhere else, but none of the answers will match the teacher's copy. 

Then next semester, the teacher can generate a \emph{new} book and the problems will be more or less identical, except the numbers will be changed. This means that students from different sections of the same class will not be able to copy from one another quite so easily. The same will be true for similar classes at different institutions. Indeed, as long as the instructor protects his/her \emph{key} used to generate the book, it will be difficult for students to crack the code. And if they are industrious enough at this level to find a way to (a) download and decipher my version's source code, (b) hack the teacher's password somehow, and (c) generate the teacher's book with all of the answers, then they probably should be testing out of an ``Introduction to Probability and Statistics'' course, anyway. 

The book that you are reading was created with a random seed which was set at the beginning. The original seed is 42. You can choose your own seed, and generate a new book with brand new data for the text and exercises, complete with updated manuals. A method I recommend for finding a seed is to look down at your watch at this very moment and record the 6 digit hour, minute, and second (say, 9:52:59am): choose that for a seed[fn:seed]. This method already provides for over 43,000 books, without taking military time into account. An alternative would be to go to \textsf{R} and type 

[fn:seed] In fact, this is essentially the method used by \textsf{R} to select an initial random seed, see \texttt{?set.seed}. However, the instructor should set the seed manually so that the book can be regenerated at a later time, if necessary.



0.217012941138819

Now choose  2170129411388188.0 as your secret seed\ldots{} write it down in a safe place and do not share it with anyone. Next generate the book with your seed using \LyX{}-Sweave or Sweave-\LaTeX{}. You may wish to also generate Student and Instructor Solution Manuals. Guidance regarding this is given below in the How to Use This Document section.
\section{Generating This Document \label{sec:Generating-This-Document}}
\label{sec-8-1}


You will need three (3) things to generate this document for yourself, in addition to a current \textsf{R} distribution which at the time of this writing is \texttt{  R version 2.13.1 (2011-07-08) } :
\begin{enumerate}
\item a \LaTeX{} distribution,
\item Sweave (which comes with \textsf{R} automatically), and
\item \LyX (optional, but recommended).
\end{enumerate}

We will discuss each of these in turn.

\begin{description}
\item[\LaTeX{}:] The distribution used by the present author was \TeX{} Live (\url{[[http://www.tug.org/texlive/][http://www.tug.org/texlive/]]}). There are plenty of other perfectly suitable \LaTeX{} distributions depending on your operating system, one such alternative being MikTeX (\url{http://miktex.org/}) for Microsoft Windows.
\item[Sweave:] If you have \textsf{R} installed, then the required Sweave files are already on your system\ldots{} somewhere. The only problems that you may have are likely associated with making sure that your \LaTeX{} distribution knows where to find the \texttt{Sweave.sty} file. See the Sweave Homepage (\url{[[http://www.statistik.lmu.de/~leisch/Sweave/][http://www.statistik.lmu.de/~leisch/Sweave/]]}) for guidance on how to get it working on your particular operating system.
\item[LyX:] Strictly speaking, LyX is not needed to generate this document. But this document was written stem to stern with LyX, taking full advantage of all of the bells and whistles that LyX has to offer over plain \LaTeX{} editors. And it's free. See the LyX homepage (\url{[[http://www.lyx.org/][http://www.lyx.org/]]}) for additional information. If you decide to give LyX a try, then you will need to complete some extra steps to coordinate Sweave and LyX with each other. Luckily, Gregor Gorjanc has a website and an \textsf{R} News article \cite{Gorjanc2008} to help you do exactly that. See the LyX-Sweave homepage (\url{http://gregor.gorjanc.googlepages.com/lyx-sweave}) for details.
\end{description}

An attempt was made to not be extravagant with fonts or packages so that a person would not need the entire \texttt{CTAN} (or \texttt{CRAN}) installed on their personal computer to generate the book. Nevertheless, there are a few extra packages required. These packages are listed in the \texttt{preamble} of \texttt{IPSUR.Rnw}, \texttt{IPSUR.tex}, and \texttt{IPSUR.lyx}.
\section{How to Use This Document \label{sec:How-to-Use-Document}}
\label{sec-8-2}


The easiest way to use this document is to install the \texttt{IPSUR} package from \texttt{CRAN} and be all done. This way would be acceptable if there is another, primary, text being used for the course and \IPSUR\textbackslash{} is only meant to play a supplementary role.

If you plan for \IPSUR\textbackslash{} to serve as the primary text for your course, then it would be wise to generate your own version of the document. You will need the source code for the Program which can be downloaded from \texttt{CRAN} or the \IPSUR\textbackslash{} website. Once the source is obtained there are four (4) basic steps to generating your own copy.

\begin{enumerate}
\item Randomly select a secret ``seed'' of integers and replace my seed of 42 with your own seed.
\item Make sure that the \textsf{\textbf{maintext}} branch is turned \textsf{ON} and also make sure that both the \textsf{\textbf{solutions}} branch and the \textsf{\textbf{answers}} branch are turned \textsf{OFF}. Use \LyX{} or your \LaTeX{} editor with Sweave to generate your unique PDF copy of the book and distribute this copy to your students. (See the \LyX{} User's Guide to learn more about branches; the ones referenced above can be found under \textsf{Document $\triangleright$ Settings $\triangleright$ Branches}.)
\item Turn the \textsf{\textbf{maintext}} branch \textsf{OFF}[fn:branch] and the \textsf{\textbf{solutions}} branch \textsf{ON}. Generate a ``Student Solutions Manual'' which has complete solutions to selected exercises and distribute the PDF to the students.
\item Leave the \textsf{\textbf{solutions}} branch \textsf{ON} and also turn the \textsf{\textbf{answers}} branch \textsf{ON} and generate an ``Instructor Solutions and Answers Manual'' with full solutions to some of the exercises and just answers to the remaining exercises. Do NOT distribute this to the students -- unless of course you want them to have the answers to all of the problems.
\end{enumerate}

[fn:branch] You can leave the \textsf{\textbf{maintext}} branch \textsf{ON} when generating the solutions manuals, but (1) all of the page numbers will be different, and (2) the typeset solutions will generate and take up a lot of space between exercises.

To make it easier for those people who do not want to use \LyX{} (or for whatever reason cannot get it working), I have included three (3) Sweave files corresponding to the main text, student solutions, and instructor answers, that are included in the \IPSUR\textbackslash{} source package in the \texttt{/tex} subdirectory. In principle it is possible to change the seed and generate the three parts separately with only Sweave and \LaTeX{}. This method is not recommended by me, but is perhaps desirable for some people.

\paragraph*{Generating Quizzes and Exams}
\begin{itemize}
\item You can copy-paste selected exercises from the text, put them together, and you have a quiz. Since the numbers are randomly generated you do not need to worry about different semesters. And you will have answer keys already for all of your QUIZZES and EXAMS, too.
\end{itemize}
\section{Ancillary Materials \label{sec:Ancillary-Materials}}
\label{sec-8-3}

In addition to the main text, student manual, and instructor manual, there are two other ancillaries. IPSUR.R, and IPSUR.RData.
\section{Modifying This Document \label{sec:Modifying-This-Document}}
\label{sec-8-4}

Since this document is released under the GNU-FDL, you are free to modify this document however you wish (in accordance with the license -- see Appendix \ref{cha:GNU-Free-Documentation}). The immediate benefit of this is that you can generate the book, with brand new problem sets, and distribute it to your students simply as a PDF (in an email, for instance). As long as you distribute less than 100 such \emph{Opaque} copies, you are not even required by the GNU-FDL to share your \emph{Transparent} copy (the source code with the secret key) that you used to generate them. Next semester, choose a new key and generate a new copy to be distributed to the new class. 

\begin{quote}
But more generally, if you are not keen on the way I explained (or failed to explain) something, then you are \underline{free} to rewrite it. If you would like to cover more (or less) material, then you are \underline{free} to add (or delete) whatever Chapters/Sections/Paragraphs that you wish. And since you have the source code, you do not need to retype the wheel. 
\end{quote}

Some individuals will argue that the nature of a statistics textbook like this one, many of the exercises being randomly generated \emph{by design}, does a disservice to the students because the exercises do not use real-world data. That is a valid criticism\ldots{} but in my case the benefits outweighed the detriments and I moved forward to incorporate static data sets whenever it was feasible and effective. Frankly, and most humbly, the only response I have for those individuals is: ``Please refer to the preceding paragraph.''
\chapter{\texttt{RcmdrTestDrive} Story}
\label{sec-9}

\label{cha:RcmdrTestDrive-Story}

The goal of \texttt{RcmdrTestDrive} was to have a data set sufficiently rich in the types of data represented such that a person could load it into the \textsf{R} Commander and be able to explore all of \texttt{Rcmdr}'s menu options at once. I decided early-on that an efficient way to do this would be to generate the data set randomly, and later add to the list of variables as more \texttt{Rcmdr} menu options became available. Generating the data was easy, but generating a story that related all of the respective variables proved to be less so.

In the Summer of 2006 I gave a version of the raw data and variable names to my STAT 3743 Probability and Statistics class and invited each of them to write a short story linking all of the variables together in a coherent narrative. No further direction was given. 

The most colorful of those I received was written by Jeffery Cornfield, submitted July 12, 2006, and is included below with his permission. It was edited slightly by the present author and updated to respond dynamically to the random generation of \texttt{RcmdrTestDrive}; otherwise, the story has been unchanged. 
\section{Case File: ALU-179 ``Murder Madness in Toon Town”}
\label{sec-9-1}

\begin{quote}
\noindent \begin{center}
\textbf{WARNING} 
\par\end{center}
\noindent This file is not for the faint of heart, dear reader, because it is filled with horrible images that will haunt your nightmares. If you are weak of stomach, have irritable bowel syndrome, or are simply paranoid, DO NOT READ FURTHER! Otherwise, read at your own risk.
\end{quote}

One fine sunny day, Police Chief R. Runner called up the forensics department at Acme-Looney University. There had been 
 murders in the past 
 days, approximately one murder every hour, of many of the local Human workers, shop keepers, and residents of Toon Town. These alarming rates threatened to destroy the fragile balance of Toon and Human camaraderie that had developed in Toon Town. 

Professor Twee T.\~{}Bird, a world-renowned forensics specialist and a Czechoslovakian native, received the call. “Professor, we need your expertise in this field to identify the pattern of the killer or killers,” Chief Runner exclaimed. “We need to establish a link between these people to stop this massacre.” 

“Yes, Chief Runner, please give me the details of the case,” Professor Bird declared with a heavy native accent, (though, for the sake of the case file, reader, I have decided to leave out the accent due to the fact that it would obviously drive you -- if you will forgive the pun -- looney!) 

“All prints are wiped clean and there are no identifiable marks on the bodies of the victims. All we are able to come up with is the possibility that perhaps there is some kind of alternative method of which we are unaware. We have sent a secure e-mail with a listing of all of the victims’ \texttt{races}, \texttt{genders}, locations of the bodies, and the sequential \texttt{order} in which they were killed. We have also included other information that might be helpful,” said Chief Runner.

“Thank you very much. Perhaps I will contact my colleague in the Statistics Department here, Dr.\~{}Elmer Fudd-Einstein,” exclaimed Professor Bird. “He might be able to identify a pattern of attack with mathematics and statistics.”

“Good luck trying to find him, Professor. Last I heard, he had a bottle of scotch and was in the Hundred Acre Woods hunting rabbits,” Chief Runner declared in a manner that questioned the beloved doctor’s credibility. 

“Perhaps I will take a drive to find him. The fresh air will do me good.”

\begin{quote}
\noindent I will skip ahead, dear reader, for much occurred during this time. Needless to say, after a fierce battle with a mountain cat that the Toon-ology Department tagged earlier in the year as “Sylvester,” Professor Bird found Dr.\~{}Fudd-Einstein and brought him back, with much bribery of alcohol and the promise of the future slaying of those “wascally wabbits” (it would help to explain that Dr.\~{}Fudd-Einstein had a speech impediment which was only worsened during the consumption of alcohol.)
\end{quote}

Once our two heroes returned to the beautiful Acme-Looney University, and once Dr.\~{}Fudd-Einstein became sober and coherent, they set off to examine the case and begin solving these mysterious murders.

“First off,” Dr.\~{}Fudd-Einstein explained, “these people all worked at the University at some point or another. Also, there also seems to be a trend in the fact that they all had a \texttt{salary} between \$ 
 and \$ 
 when they retired.” 

“That’s not really a lot to live off of,” explained Professor Bird. 

“Yes, but you forget that the Looney Currency System works differently than the rest of the American Currency System. One Looney is equivalent to Ten American Dollars. Also, these faculty members are the ones who faced a cut in their salary, as denoted by \texttt{reduction}. Some of them dropped quite substantially when the University had to fix that little \emph{faux pas} in the Chemistry Department. You remember: when Dr.\~{}D.\~{}Duck tried to create that ‘Everlasting Elixir?’ As a result, these faculty left the university. Speaking of which, when is his memorial service?” inquired Dr.\~{}Fudd-Einstein. 

“This coming Monday. But if there were all of these killings, how in the world could one person do it? It just doesn’t seem to be possible; stay up 
 days straight and be able to kill all of these people and have the energy to continue on,” Professor Bird exclaimed, doubting the guilt of only one person. 

“Perhaps then, it was a group of people, perhaps there was more than one killer placed throughout Toon Town to commit these crimes. If I feed in these variables, along with any others that might have a pattern, the Acme Computer will give us an accurate reading of suspects, with a scant probability of error. As you know, the Acme Computer was developed entirely in house here at Acme-Looney University,” Dr.\~{}Fudd-Einstein said as he began feeding the numbers into the massive server. 

“Hey, look at this,” Professor Bird exclaimed, “What’s with this \texttt{before} and \texttt{after} information?” 

“Scroll down; it shows it as a note from the coroner’s office. Apparently Toon Town Coroner Marvin -- that strange fellow from Mars, Pennsylvania -- feels, in his opinion, that given the fact that the cadavers were either \texttt{smokers} or non-smokers, and given their personal health, and family medical history, that this was their life expectancy before contact with cigarettes or second-hand smoke and after,” Dr.\~{}Fudd-Einstein declared matter-of-factly. 

“Well, would race or gender have something to do with it, Elmer?” inquired Professor Bird.

“Maybe, but I would bet my money on somebody was trying to quiet these faculty before they made a big ruckus about the secret money-laundering of Old Man Acme. You know, most people think that is how the University receives most of its funds, through the mob families out of Chicago. And I would be willing to bet that these faculty figured out the connection and were ready to tell the Looney Police.” Dr.\~{}Fudd-Einstein spoke lower, fearing that somebody would overhear their conversation.  

Dr.\~{}Fudd-Einstein then pressed \textsf{Enter} on the keyboard and waited for the results. The massive computer roared to life\ldots{} and when I say roared, I mean it literally \emph{roared}. All the hidden bells, whistles, and alarm clocks in its secret compartments came out and created such a loud racket that classes across the university had to come to a stand-still until it finished computing. 

Once it was completed, the computer listed 4 names:


\begin{verbatim}
****************************SUSPECTS****************************
- Yosemite Sam (“Looney” Insane Asylum) 
- Wile~E.~Coyote (deceased) 
- Foghorn~Leghorn (whereabouts unknown) 
- Granny (1313 Mockingbird Lane, Toon Town USA)
\end{verbatim}

Dr.\~{}Fudd-Einstein and Professor Bird looked on in silence. They could not believe their eyes. The greatest computer on the Gulf of Mexico seaboard just released the most obscure results imaginable.

“There seems to be a mistake. Perhaps something is off,” Professor Bird asked, still unable to believe the results.

“Not possible; the Acme Computer takes into account every kind of connection available. It considers affiliations to groups, and affiliations those groups have to other groups. It checks the FBI, CIA, British intelligence, NAACP, AARP, NSA, JAG, TWA, EPA, FDA, USWA, \textsf{R}, MAPLE, SPSS, SAS, and Ben \& Jerry’s files to identify possible links, creating the most powerful computer in the world\ldots{} with a tweak of Toon fanaticism,” Dr.\~{}Fudd-Einstein proclaimed, being a proud co-founder of the Acme Computer Technology.

“Wait a minute, Ben \& Jerry? What would eating ice cream have to do with anything?” Professor Bird inquired.

“It is in the works now, but a few of my fellow statistician colleagues are trying to find a mathematical model to link the type of ice cream consumed to the type of person they might become. Assassins always ate vanilla with chocolate sprinkles, a little known fact they would tell you about Oswald and Booth,” Dr.\~{}Fudd-Einstein declared.

“I’ve heard about this. My forensics graduate students are trying to identify car thieves with either rocky road or mint chocolate chip… so far, the pattern is showing a clear trend with chocolate chip,” Professor Bird declared. 
“Well, what do we know about these suspects, Twee?” Dr.\~{}Fudd-Einstein asked.

“Yosemite Sam was locked up after trying to rob that bank in the West Borough. Apparently his guns were switched and he was sent the Acme Kids Joke Gun and they blew up in his face. The containers of peroxide they contained turned all of his facial hair red. Some little child is running around Toon Town with a pair of .38’s to this day. 

“Wile E.\~{}Coyote was that psychopath working for the Yahtzee - the fanatics who believed that Toons were superior to Humans. He strapped sticks of Acme Dynamite to his chest to be a martyr for the cause, but before he got to the middle of Toon Town, this defective TNT blew him up. Not a single other person -- Toon or Human -- was even close.

“Foghorn Leghorn is the most infamous Dog Kidnapper of all times. He goes to the homes of prominent Dog citizens and holds one of their relatives for ransom. If they refuse to pay, he sends them to the pound. Either way, they’re sure stuck in the dog house,” Professor Bird laughed. Dr.\~{}Fudd-Einstein didn’t seem amused, so Professor Bird continued. 

“Granny is the most beloved alumnus of Acme-Looney University. She was in the first graduating class and gives graciously each year to the university. Without her continued financial support, we wouldn’t have the jobs we do. She worked as a parking attendant at the University lots\ldots{} wait a minute, take a look at this,” Professor Bird said as he scrolled down in the police information. “Granny’s signature is on each of these faculty members’ \texttt{parking} tickets. Kind of odd, considering the Chief-of-Parking signed each personally. The deceased had from as few as 
 ticket to as many as 
. All tickets were unpaid.

“And look at this, Granny married Old Man Acme after graduation. He was a resident of Chicago and rumored to be a consigliere to one of the most prominent crime families in Chicago, the Chuck Jones/Warner Crime Family,” Professor Bird read from the screen as a cold feeling of terror rose from the pit of his stomach. 

“Say, don’t you live at her house? Wow, you’re living under the same roof as one of the greatest criminals/murderers of all time!” Dr.\~{}Fudd-Einstein said in awe and sarcasm.

“I would never have suspected her, but I guess it makes sense. She is older, so she doesn’t need near the amount of sleep as a younger person. She has access to all of the vehicles so she can copy license plate numbers and follow them to their houses. She has the finances to pay for this kind of massive campaign on behalf of the Mob, and she hates anyone that even remotely smells like smoke,” Professor Bird explained, wishing to have his hit of nicotine at this time.

“Well, I guess there is nothing left to do but to call Police Chief Runner and have him arrest her,” Dr.\~{}Fudd-Einstein explained as he began dialing. “What I can’t understand is how in the world the Police Chief sent me all of this information and somehow seemed to screw it up.”

“What do you mean?” inquired Professor Bird.

“Well, look here. The data file from the Chief's email shows 
 murders, but there have only been 
. This doesn’t make any sense. I’ll have to straighten it out. Hey, wait a minute. Look at this, Person number 
 and Person number 
 seem to match our stats. But how can that be?”

It was at this moment that our two heroes were shot from behind and fell over the computer, dead. The killer hit \textsf{Delete} on the computer and walked out slowly (considering they had arthritis) and cackling loudly in the now quiet computer lab.  

And so, I guess my question to you the reader is, did Granny murder 
 people, or did the murderer slip through the cracks of justice? You be the statistician and come to your own conclusion. 

Detective Pyork E. Pig 

\begin{verbatim}
 ***End File***
\end{verbatim}

\vfill{}

\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{\bibname}
\bibliographystyle{plainurl}
\nocite{*}
\bibliography{IPSUR}
\vfill{}
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{\indexname} 
\printindex{}


\end{document}

\end{document}