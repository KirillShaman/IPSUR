<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Introduction to Probability and Statistics Using R</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Introduction to Probability and Statistics Using R"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2011-12-20 22:24:09 EST"/>
<meta name="author" content="G. Jay Kerns"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
<script type="text/javascript" src="http://orgmode.org/org-info.js"></script>
<script type="text/javascript" >
<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "2");
org_html_manager.set("LINK_HOME", "http://ipsur.org/index.html");
org_html_manager.set("LINK_UP", "IPSUR.html   ");
org_html_manager.set("LOCAL_TOC", "0");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "0");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="IPSUR.html   "> UP </a>
 |
 <a accesskey="H" href="http://ipsur.org/index.html"> HOME </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Introduction to Probability and Statistics Using R</h1>




<link REL="SHORTCUT ICON" HREF="http://ipsur.org/img/favicon.ico">


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 An Introduction to Probability and Statistics</a>
<ul>
<li><a href="#sec-1-1">1.1 Probability</a></li>
<li><a href="#sec-1-2">1.2 Statistics</a></li>
<li><a href="#sec-1-3">1.3 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-introduction-to-R">2 An Introduction to R</a>
<ul>
<li><a href="#sec-download-install-R">2.1 Downloading and Installing \(\mathsf{R}\)</a></li>
<li><a href="#sec-Communicating-with-R">2.2 Communicating with \(\mathsf{R}\)</a></li>
<li><a href="#sec-Basic-R-Operations">2.3 Basic \(\mathsf{R}\) Operations and Concepts</a></li>
<li><a href="#sec-Getting-Help">2.4 Getting Help</a></li>
<li><a href="#sec-External-Resources">2.5 External Resources</a></li>
<li><a href="#sec-2-6">2.6 Other Tips</a></li>
<li><a href="#sec-2-7">2.7 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Describing-Data-Distributions">3 Data Description</a>
<ul>
<li><a href="#sec-Types-of-Data">3.1 Types of Data</a></li>
<li><a href="#sec-features-of-data">3.2 Features of Data Distributions</a></li>
<li><a href="#sec-Descriptive-Statistics">3.3 Descriptive Statistics</a></li>
<li><a href="#sec-Exploratory-Data-Analysis">3.4 Exploratory Data Analysis</a></li>
<li><a href="#sec-multivariate-data">3.5 Multivariate Data and Data Frames</a></li>
<li><a href="#sec-Comparing-Data-Sets">3.6 Comparing Populations</a></li>
<li><a href="#sec-3-7">3.7 Some Remarks about Plotting</a></li>
<li><a href="#sec-3-8">3.8 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Probability">4 Probability</a>
<ul>
<li><a href="#sec-Sample-Spaces">4.1 Sample Spaces</a></li>
<li><a href="#sec-Events">4.2 Events</a></li>
<li><a href="#sec-Interpreting-Probabilities">4.3 Model Assignment</a></li>
<li><a href="#sec-Properties-of-Probability">4.4 Properties of Probability</a></li>
<li><a href="#sec-Methods-of-Counting">4.5 Counting Methods</a></li>
<li><a href="#sec-Conditional-Probability">4.6 Conditional Probability</a></li>
<li><a href="#sec-Independent-Events">4.7 Independent Events</a></li>
<li><a href="#sec-Bayes--Rule">4.8 Bayes' Rule</a></li>
<li><a href="#sec-Random-Variables">4.9 Random Variables</a></li>
<li><a href="#sec-4-10">4.10 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Discrete-Distributions">5 Discrete Distributions</a>
<ul>
<li><a href="#sec-discrete-random-variables">5.1 Discrete Random Variables</a></li>
<li><a href="#sec-disc-uniform-dist">5.2 The Discrete Uniform Distribution</a></li>
<li><a href="#sec-binom-dist">5.3 The Binomial Distribution</a></li>
<li><a href="#sec-expectation-and-mgfs">5.4 Expectation and Moment Generating Functions</a></li>
<li><a href="#sec-empirical-distribution">5.5 The Empirical Distribution</a></li>
<li><a href="#sec-other-discrete-distributions">5.6 Other Discrete Distributions</a></li>
<li><a href="#sec-functions-discrete-rvs">5.7 Functions of Discrete Random Variables</a></li>
<li><a href="#sec-5-8">5.8 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Continuous-Distributions">6 Continuous Distributions</a>
<ul>
<li><a href="#sec-continuous-random-variables">6.1 Continuous Random Variables</a></li>
<li><a href="#sec-The-Continuous-Uniform">6.2 The Continuous Uniform Distribution</a></li>
<li><a href="#sec-The-Normal-Distribution">6.3 The Normal Distribution</a></li>
<li><a href="#sec-Functions-of-Continuous">6.4 Functions of Continuous Random Variables</a></li>
<li><a href="#sec-Other-Continuous-Distributions">6.5 Other Continuous Distributions</a></li>
<li><a href="#sec-6-6">6.6 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Multivariable-Distributions">7 Multivariate Distributions</a>
<ul>
<li><a href="#sec-Joint-Probability-Distributions">7.1 Joint and Marginal Probability Distributions</a></li>
<li><a href="#sec-Joint-and-Marginal-Expectation">7.2 Joint and Marginal Expectation</a></li>
<li><a href="#sec-Conditional-Distributions">7.3 Conditional Distributions</a></li>
<li><a href="#sec-Independent-Random-Variables">7.4 Independent Random Variables</a></li>
<li><a href="#sec-Exchangeable-Random-Variables">7.5 Exchangeable Random Variables</a></li>
<li><a href="#sec-The-Bivariate-Normal">7.6 The Bivariate Normal Distribution</a></li>
<li><a href="#sec-Transformations-Multivariate">7.7 Bivariate Transformations of Random Variables</a></li>
<li><a href="#sec-Remarks-for-the-Multivariate">7.8 Remarks for the Multivariate Case</a></li>
<li><a href="#sec-Multinomial">7.9 The Multinomial Distribution</a></li>
<li><a href="#sec-7-10">7.10 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Sampling-Distributions">8 Sampling Distributions</a>
<ul>
<li><a href="#sec-simple-random-samples">8.1 Simple Random Samples</a></li>
<li><a href="#sec-sampling-from-normal-dist">8.2 Sampling from a Normal Distribution</a></li>
<li><a href="#sec-Central-Limit-Theorem">8.3 The Central Limit Theorem</a></li>
<li><a href="#sec-Samp-Dist-Two-Samp">8.4 Sampling Distributions of Two-Sample Statistics</a></li>
<li><a href="#sec-Simulated-Sampling-Distributions">8.5 Simulated Sampling Distributions</a></li>
<li><a href="#sec-8-6">8.6 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Estimation">9 Estimation</a>
<ul>
<li><a href="#sec-Point-Estimation-1">9.1 Point Estimation</a></li>
<li><a href="#sec-Confidence-Intervals-for-Means">9.2 Confidence Intervals for Means</a></li>
<li><a href="#sec-Conf-Interv-for-Diff-Means">9.3 Confidence Intervals for Differences of Means</a></li>
<li><a href="#sec-Confidence-Intervals-Proportions">9.4 Confidence Intervals for Proportions</a></li>
<li><a href="#sec-Confidence-Intervals-for-Variances">9.5 Confidence Intervals for Variances</a></li>
<li><a href="#sec-Fitting-Distributions">9.6 Fitting Distributions</a></li>
<li><a href="#sec-Sample-Size-and-MOE">9.7 Sample Size and Margin of Error</a></li>
<li><a href="#sec-Other-Topics">9.8 Other Topics</a></li>
<li><a href="#sec-9-9">9.9 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Hypothesis-Testing">10 Hypothesis Testing</a>
<ul>
<li><a href="#sec-Introduction-Hypothesis">10.1 Introduction</a></li>
<li><a href="#sec-Tests-for-Proportions">10.2 Tests for Proportions</a></li>
<li><a href="#sec-One-Sample-Tests">10.3 One Sample Tests for Means and Variances</a></li>
<li><a href="#sec-Two-Sample-Tests-for-Means">10.4 Two-Sample Tests for Means and Variances</a></li>
<li><a href="#sec-Other-Hypothesis-Tests">10.5 Other Hypothesis Tests</a></li>
<li><a href="#sec-Analysis-of-Variance">10.6 Analysis of Variance</a></li>
<li><a href="#sec-Sample-Size-and-Power">10.7 Sample Size and Power</a></li>
<li><a href="#sec-10-8">10.8 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-simple-linear-regression">11 Simple Linear Regression</a>
<ul>
<li><a href="#sec-Basic-Philosophy">11.1 Basic Philosophy</a></li>
<li><a href="#sec-SLR-Estimation">11.2 Estimation</a></li>
<li><a href="#sec-Model-Utility-SLR">11.3 Model Utility and Inference</a></li>
<li><a href="#sec-Residual-Analysis-SLR">11.4 Residual Analysis</a></li>
<li><a href="#sec-Other-Diagnostic-Tools-SLR">11.5 Other Diagnostic Tools</a></li>
<li><a href="#sec-11-6">11.6 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-multiple-linear-regression">12 Multiple Linear Regression</a>
<ul>
<li><a href="#sec-The-MLR-Model">12.1 The Multiple Linear Regression Model</a></li>
<li><a href="#sec-Estimation-and-Prediction-MLR">12.2 Estimation and Prediction</a></li>
<li><a href="#sec-Model-Utility-and-MLR">12.3 Model Utility and Inference</a></li>
<li><a href="#sec-Polynomial-Regression">12.4 Polynomial Regression</a></li>
<li><a href="#sec-Interaction">12.5 Interaction</a></li>
<li><a href="#sec-Qualitative-Explanatory-Variables">12.6 Qualitative Explanatory Variables</a></li>
<li><a href="#sec-Partial-F-Statistic">12.7 Partial <i>F</i> Statistic</a></li>
<li><a href="#sec-Residual-Analysis-MLR">12.8 Residual Analysis and Diagnostic Tools</a></li>
<li><a href="#sec-Additional-Topics-MLR">12.9 Additional Topics</a></li>
<li><a href="#sec-12-10">12.10 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-resampling-methods">13 Resampling Methods</a>
<ul>
<li><a href="#sec-Introduction-Resampling">13.1 Introduction</a></li>
<li><a href="#sec-Bootstrap-Standard-Errors">13.2 Bootstrap Standard Errors</a></li>
<li><a href="#sec-Bootstrap-Confidence-Intervals">13.3 Bootstrap Confidence Intervals</a></li>
<li><a href="#sec-Resampling-in-Hypothesis">13.4 Resampling in Hypothesis Tests</a></li>
<li><a href="#sec-13-5">13.5 Exercises</a></li>
</ul>
</li>
<li><a href="#cha-Nonparametric-Statistics">14 Nonparametric Statistics</a></li>
<li><a href="#cha-Categorical-Data-Analysis">15 Categorical Data Analysis</a></li>
<li><a href="#cha-Time-Series">16 Time Series</a></li>
<li><a href="#cha-R-Session-Information">17 R Session Information</a></li>
<li><a href="#cha-GNU-Free-Documentation">18 GNU Free Documentation License</a>
<ul>
<li><a href="#sec-18-1">18.1 0. PREAMBLE</a></li>
<li><a href="#sec-18-2">18.2 1. APPLICABILITY AND DEFINITIONS</a></li>
<li><a href="#sec-18-3">18.3 2. VERBATIM COPYING</a></li>
<li><a href="#sec-18-4">18.4 3. COPYING IN QUANTITY</a></li>
<li><a href="#sec-18-5">18.5 4. MODIFICATIONS</a></li>
<li><a href="#sec-18-6">18.6 5. COMBINING DOCUMENTS</a></li>
<li><a href="#sec-18-7">18.7 6. COLLECTIONS OF DOCUMENTS</a></li>
<li><a href="#sec-18-8">18.8 7. AGGREGATION WITH INDEPENDENT WORKS</a></li>
<li><a href="#sec-18-9">18.9 8. TRANSLATION</a></li>
<li><a href="#sec-18-10">18.10 9. TERMINATION</a></li>
<li><a href="#sec-18-11">18.11 10. FUTURE REVISIONS OF THIS LICENSE</a></li>
<li><a href="#sec-18-12">18.12 11. RELICENSING</a></li>
<li><a href="#sec-18-13">18.13 ADDENDUM: How to use this License for your documents</a></li>
</ul>
</li>
<li><a href="#cha-History">19 History</a></li>
<li><a href="#cha-data">20 Data</a>
<ul>
<li><a href="#sec-Data-Structures">20.1 Data Structures</a></li>
<li><a href="#sec-Importing-A-Data">20.2 Importing Data</a></li>
<li><a href="#sec-Creating-New-Data">20.3 Creating New Data Sets</a></li>
<li><a href="#sec-Editing-Data-Sets">20.4 Editing Data</a></li>
<li><a href="#sec-Exporting-a-Data">20.5 Exporting Data</a></li>
<li><a href="#sec-Reshaping-a-Data">20.6 Reshaping Data</a></li>
</ul>
</li>
<li><a href="#cha-Mathematical-Machinery">21 Mathematical Machinery</a>
<ul>
<li><a href="#sec-The-Algebra-of">21.1 Set Algebra</a></li>
<li><a href="#sec-Differential-and-Integral">21.2 Differential and Integral Calculus</a></li>
<li><a href="#sec-Sequences-and-Series">21.3 Sequences and Series</a></li>
<li><a href="#sec-The-Gamma-Function">21.4 The Gamma Function</a></li>
<li><a href="#sec-Linear-Algebra">21.5 Linear Algebra</a></li>
<li><a href="#sec-Multivariable-Calculus">21.6 Multivariable Calculus</a></li>
</ul>
</li>
<li><a href="#cha-Writing-Reports-with">22 Writing Reports with \(\mathsf{R}\)</a>
<ul>
<li><a href="#sec-What-to-Write">22.1 What to Write</a></li>
<li><a href="#sec-How-to-Write">22.2 How to Write It with R</a></li>
<li><a href="#sec-Formatting-Tables">22.3 Formatting Tables</a></li>
<li><a href="#sec-Other-Formats">22.4 Other Formats</a></li>
</ul>
</li>
<li><a href="#cha-Instructions-for-Instructors">23 Instructions for Instructors</a>
<ul>
<li><a href="#sec-Generating-This-Document">23.1 Generating This Document</a></li>
<li><a href="#sec-How-to-Use-Document">23.2 How to Use This Document</a></li>
<li><a href="#sec-Ancillary-Materials">23.3 Ancillary Materials</a></li>
<li><a href="#sec-Modifying-This-Document">23.4 Modifying This Document</a></li>
</ul>
</li>
<li><a href="#cha-RcmdrTestDrive-Story">24 <code>RcmdrTestDrive</code> Story</a>
<ul>
<li><a href="#sec-24-1">24.1 Case File: ALU-179 ``Murder Madness in Toon Town”</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> An Introduction to Probability and Statistics</h2>
<div class="outline-text-2" id="text-1">


<p>
This chapter has proved to be the hardest to write, by far. The trouble is that there is so much to say &ndash; and so many people have already said it so much better than I could. When I get something I like I will release it here.
</p>
<p>
In the meantime, there is a lot of information already available to a person with an Internet connection. I recommend to start at Wikipedia, which is not a flawless resource but it has the main ideas with links to reputable sources.
</p>
<p>
In my lectures I usually tell stories about Fisher, Galton, Gauss, Laplace, Quetelet, and the Chevalier de Mere.
</p>

</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Probability</h3>
<div class="outline-text-3" id="text-1-1">


<p>
The common folklore is that probability has been around for millennia but did not gain the attention of mathematicians until approximately 1654 when the Chevalier de Mere had a question regarding the fair division of a game's payoff to the two players, supposing the game had to end prematurely.
</p>
</div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Statistics</h3>
<div class="outline-text-3" id="text-1-2">


<p>
Statistics concerns data; their collection, analysis, and interpretation. In this book we distinguish between two types of statistics: descriptive and inferential. 
</p>
<p>
Descriptive statistics concerns the summarization of data. We have a data set and we would like to describe the data set in multiple ways. Usually this entails calculating numbers from the data, called descriptive measures, such as percentages, sums, averages, and so forth.
</p>
<p>
Inferential statistics does more. There is an inference associated with the data set, a conclusion drawn about the population from which the data originated.
</p>
<p>
I would like to mention that there are two schools of thought of statistics: frequentist and bayesian. The difference between the schools is related to how the two groups interpret the underlying probability (see Section <a href="#sec-4-3">Interpreting Probabilities</a>). The frequentist school gained a lot of ground among statisticians due in large part to the work of Fisher, Neyman, and Pearson in the early twentieth century. That dominance lasted until inexpensive computing power became widely available; nowadays the bayesian school is garnering more attention and at an increasing rate.
</p>
<p>
This book is devoted mostly to the frequentist viewpoint because that is how I was trained, with the conspicuous exception of Sections <a href="#sec-Bayes--Rule">Bayes' Rule</a> and <a href="#sec-7-3">Conditional Distributions</a>. I plan to add more bayesian material in later editions of this book.
</p>

</div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Exercises</h3>
<div class="outline-text-3" id="text-1-3">


</div>
</div>

</div>

<div id="outline-container-cha-introduction-to-R" class="outline-2">
<h2 id="cha-introduction-to-R"><a name="sec-2" id="sec-2"></a><span class="section-number-2">2</span> An Introduction to R</h2>
<div class="outline-text-2" id="text-cha-introduction-to-R">




<p>
Every \(\mathsf{R}\) book I have ever seen has had a section/chapter that is an introduction to \(\mathsf{R}\), and so does this one.  The goal of this chapter is for a person to get up and running, ready for the material that follows.  See Section <a href="#sec-2-5">External Resources</a> for links to other material which the reader may find useful. 
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>Where to find \(\mathsf{R}\) to install on a home computer, and a few comments to help with the usual hiccups that occur when installing something.
</li>
<li>Abbreviated remarks about the available options to interact with \(\mathsf{R}\).
</li>
<li>Basic operations (arithmetic, entering data, vectors) at the command prompt.
</li>
<li>How and where to find help when they get in trouble.
</li>
<li>Other little shortcuts I am usually asked when introducing \(\mathsf{R}\).
</li>
</ul>



</div>

<div id="outline-container-sec-download-install-R" class="outline-3">
<h3 id="sec-download-install-R"><a name="sec-2-1" id="sec-2-1"></a><span class="section-number-3">2.1</span> Downloading and Installing \(\mathsf{R}\)</h3>
<div class="outline-text-3" id="text-sec-download-install-R">


<p>
The instructions for obtaining \(\mathsf{R}\) largely depend on the user's hardware and operating system. The \(\mathsf{R}\)  Project has written an \(\mathsf{R}\)  Installation and Administration manual with complete, precise instructions about what to do, together with all sorts of additional information. The following is just a primer to get a person started.
</p>

</div>

<div id="outline-container-2-1-1" class="outline-4">
<h4 id="sec-2-1-1"><span class="section-number-4">2.1.1</span> Installing \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-2-1-1">


<p>
Visit one of the links below to download the latest version of \(\mathsf{R}\) 
for your operating system:
</p>
<dl>
<dt>Microsoft Windows:</dt><dd><a href="http://cran.r-project.org/bin/windows/base/">http://cran.r-project.org/bin/windows/base/</a>
</dd>
<dt>MacOS:</dt><dd><a href="http://cran.r-project.org/bin/macosx/">http://cran.r-project.org/bin/macosx/</a>
</dd>
<dt>Linux:</dt><dd><a href="http://cran.r-project.org/bin/linux/">http://cran.r-project.org/bin/linux/</a>
</dd>
</dl>


<p>
On Microsoft Windows, click the <code>R-x.y.z.exe</code> installer to start installation. When it asks for "Customized startup options", specify <code>Yes</code>. In the next window, be sure to select the SDI (single document interface) option; this is useful later when we discuss three dimensional plots with the <code>rgl</code> package \cite{rgl}.
</p>

</div>

<div id="outline-container-2-1-1-1" class="outline-5">
<h5 id="sec-2-1-1-1"><span class="section-number-5">2.1.1.1</span> Installing \(\mathsf{R}\) on a USB drive (Windows)</h5>
<div class="outline-text-5" id="text-2-1-1-1">


<p>
With this option you can use \(\mathsf{R}\) portably and without administrative privileges. There is an entry in the \(\mathsf{R}\) for Windows FAQ about this. Here is the procedure I use:  
</p><ol>
<li>Download the Windows installer above and start installation as usual. When it asks <i>where</i> to install, navigate to the top-level directory of the USB drive instead of the default <code>C</code> drive.
</li>
<li>When it asks whether to modify the Windows registry, uncheck the box; we do NOT want to tamper with the registry. 
</li>
<li>After installation, change the name of the folder from <code>R-x.y.z</code> to just plain \(\mathsf{R}\). (Even quicker: do this in step 1.) 
</li>
<li><a href="http://ipsur.r-forge.r-project.org/book/download/R.exe">Download this shortcut</a> and move it to the top-level directory of the USB drive, right beside the \(\mathsf{R}\) folder, not inside the folder. Use the downloaded shortcut to run \(\mathsf{R}\).
</li>
</ol>


<p>
Steps 3 and 4 are not required but save you the trouble of navigating to the <code>R-x.y.z/bin</code> directory to double-click <code>Rgui.exe</code> every time you want to run the program. It is useless to create your own shortcut to <code>Rgui.exe</code>. Windows does not allow shortcuts to have relative paths; they always have a drive letter associated with them. So if you make your own shortcut and plug your USB drive into some <i>other</i> machine that happens to assign your drive a different letter, then your shortcut will no longer be pointing to the right place. 
</p>
</div>
</div>

</div>

<div id="outline-container-sub-installing-loading-packages" class="outline-4">
<h4 id="sub-installing-loading-packages"><a name="sec-2-1-2" id="sec-2-1-2"></a><span class="section-number-4">2.1.2</span> Installing and Loading Add-on Packages</h4>
<div class="outline-text-4" id="text-sub-installing-loading-packages">


<p>
There are <i>base</i> packages (which come with \(\mathsf{R}\) automatically), and <i>contributed</i> packages (which must be downloaded for installation). For example, on the version of \(\mathsf{R}\) being used for this document the default base packages loaded at startup are 
</p>



<pre class="src src-R">getOption(<span style="font-style: italic;">"defaultPackages"</span>)
</pre>


<pre class="example">
[1] "datasets"  "utils"     "grDevices" "graphics" 
[5] "stats"     "methods"
</pre>


<p>
The base packages are maintained by a select group of volunteers, called \(\mathsf{R}\) Core. In addition to the base packages, there are literally thousands of additional contributed packages written by individuals all over the world. These are stored worldwide on mirrors of the Comprehensive \(\mathsf{R}\) Archive Network, or <code>CRAN</code> for short. Given an active Internet connection, anybody is free to download and install these packages and even inspect the source code.
</p>
<p>
To install a package named <code>foo</code>, open up \(\mathsf{R}\) and type <code>install.packages("foo")</code>\index{install.packages@\texttt{install.packages}}. To install <code>foo</code> and additionally install all of the other packages on which <code>foo</code> depends, instead type <code>install.packages("foo", depends = TRUE)</code>.
</p>
<p>
The general command <code>install.packages()</code> will (on most operating systems) open a window containing a huge list of available packages; simply choose one or more to install.
</p>
<p>
No matter how many packages are installed onto the system, each one must first be loaded for use with the <code>library</code>\index{library@\texttt{library}} function. For instance, the <code>foreign</code> package \cite{foreign} contains all sorts of functions needed to import data sets into \(\mathsf{R}\) from other software such as SPSS, SAS, <i>etc</i>. But none of those functions will be available until the command <code>library("foreign")</code> is issued. 
</p>
<p>
Type <code>library()</code> at the command prompt (described below) to see a list of all available
packages in your library.
</p>
<p>
For complete, precise information regarding installation of \(\mathsf{R}\) and add-on packages, see the <a href="http://cran.r-project.org/manuals.html">\(\mathsf{R}\) Installation and Administration manual</a>.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Communicating-with-R" class="outline-3">
<h3 id="sec-Communicating-with-R"><a name="sec-2-2" id="sec-2-2"></a><span class="section-number-3">2.2</span> Communicating with \(\mathsf{R}\)</h3>
<div class="outline-text-3" id="text-sec-Communicating-with-R">



</div>

<div id="outline-container-2-2-1" class="outline-4">
<h4 id="sec-2-2-1"><span class="section-number-4">2.2.1</span> One line at a time</h4>
<div class="outline-text-4" id="text-2-2-1">


<p>
This is the most basic method and is the first one that beginners will use.
</p><ul>
<li>RGui (Microsoft \(\circledR\) Windows)
</li>
<li>Terminal
</li>
<li>Emacs/ESS, XEmacs
</li>
<li>JGR
</li>
</ul>


</div>

</div>

<div id="outline-container-2-2-2" class="outline-4">
<h4 id="sec-2-2-2"><span class="section-number-4">2.2.2</span> Multiple lines at a time</h4>
<div class="outline-text-4" id="text-2-2-2">


<p>
For longer programs (called <i>scripts</i>) there is too much code to write all at once at the command prompt. Furthermore, for longer scripts it is convenient to be able to only modify a certain piece of the script and run it again in \(\mathsf{R}\). Programs called <i>script editors</i> are specially designed to aid the communication and code writing process. They have all sorts of helpful features including \(\mathsf{R}\) syntax highlighting, automatic code completion, delimiter matching, and dynamic help on the \(\mathsf{R}\) functions as they are being written. Even more, they often have all of the text editing features of programs like Microsoft\(\circledR\)Word. Lastly, most script editors are fully customizable in the sense that the user can customize the appearance of the interface to choose what colors to display, when to display them, and how to display them.
</p>
<dl>
<dt>\(\mathsf{R}\) Editor (Windows):\index{R Editor@\textsf{R} Editor}</dt><dd>In Microsoft\(\circledR\) Windows, \(\mathsf{R}\) Gui has its own built-in script editor, called \(\mathsf{R}\) Editor. From the console window, select <code>File</code> \(\triangleright\) <code>New Script</code>. A script window opens, and the lines of code can be written in the window. When satisfied with the code, the user highlights all of the commands and presses \textsf{Ctrl+R}. The commands are automatically run at once in \(\mathsf{R}\) and the output is shown. To save the script for later, click <code>File</code> \(\triangleright\) <code>Save as...</code> in \(\mathsf{R}\) Editor. The script can be reopened later with <code>File</code> \(\triangleright\)} <code>Open Script...</code> in <code>RGui</code>. Note that \(\mathsf{R}\) Editor does not have the fancy syntax highlighting that the others do.
</dd>
<dt>\(\mathsf{R}\) WinEdt:\index{RWinEdt@\textsf{R}WinEdt}</dt><dd>This option is coordinated with WinEdt for \LaTeX{} and has additional features such as code highlighting, remote sourcing, and a ton of other things. However, one first needs to download and install a shareware version of another program, WinEdt, which is only free for a while &ndash; pop-up windows will eventually appear that ask for a registration code. \(\mathsf{R}\) WinEdt is nevertheless a very fine choice if you already own WinEdt or are planning to purchase it in the near future.
</dd>
<dt>Tinn \(\mathsf{R}\) / Sciviews K:\index{Tinn R@Tinn \textsf{R}}\index{Sciviews K}</dt><dd>This one is completely free and has all of the above mentioned options and more. It is simple enough to use that the user can virtually begin working with it immediately after installation. But Tinn \(\mathsf{R}\) proper is only available for Microsoft\(\circledR\) Windows operating systems. If you are on MacOS or Linux, a comparable alternative is Sci-Views - Komodo Edit.
</dd>
<dt>Emacs/ESS:\index{Emacs}\index{ESS}</dt><dd>Emacs is an all purpose text editor. It can do absolutely anything with respect to modifying, searching, editing, and manipulating, text. And if Emacs can't do it, then you can write a program that extends Emacs to do it. Once such extension is called <code>ESS</code>, which stands for <i>E</i>-macs <i>S</i>-peaks <i>S</i>-tatistics. With ESS a person can speak to \(\mathsf{R}\), do all of the tricks that the other script editors offer, and much, much, more. Please see the following for installation details, documentation, reference cards, and a whole lot more: <a href="http://ess.r-project.org">http://ess.r-project.org</a>.
     <i>Fair warning</i>: if you want to try Emacs and if you grew up with Microsoft\(\circledR\) Windows or Macintosh, then you are going to need to relearn everything you thought you knew about computers your whole life. (Or, since Emacs is completely customizable, you can reconfigure Emacs to behave the way you want.) I have personally experienced this transformation and I will never go back.
</dd>
<dt>JGR (read ``Jaguar''):\index{JGR}</dt><dd>This one has the bells and whistles of <code>RGui</code> plus it is based on Java, so it works on multiple operating systems. It has its own script editor like \(\mathsf{R}\) Editor but with additional features such as syntax highlighting and code-completion. If you do not use Microsoft\(\circledR\) Windows (or even if you do) you definitely want to check out this one. 
</dd>
<dt>Kate, Bluefish, <i>etc</i></dt><dd>There are literally dozens of other text editors available, many of them free, and each has its own (dis)advantages. I only have mentioned the ones with which I have had substantial personal experience and have enjoyed at some point. Play around, and let me know what you find.
</dd>
</dl>


</div>

</div>

<div id="outline-container-2-2-3" class="outline-4">
<h4 id="sec-2-2-3"><span class="section-number-4">2.2.3</span> Graphical User Interfaces (GUIs)</h4>
<div class="outline-text-4" id="text-2-2-3">


<p>
By the word ``GUI'' I mean an interface in which the user communicates with \(\mathsf{R}\) by way of points-and-clicks in a menu of some sort. Again, there are many, many options and I only mention ones that I have used and enjoyed. Some of the other more popular script editors can be downloaded from the \(\mathsf{R}\)-Project website at <a href="http://www.sciviews.org/_rgui/">http://www.sciviews.org/_rgui/</a>. On the left side of the screen (under <b>Projects</b>) there are several choices available. 
</p>
<dl>
<dt>\(\mathsf{R}\) Commander</dt><dd>provides\index{R Commander@\textsf{R} Commander} a point-and-click interface to many basic statistical tasks. It is called the ``Commander'' because every time one makes a selection from the menus, the code corresponding to the task is listed in the output window. One can take this code, copy-and-paste it to a text file, then re-run it again at a later time without the \(\mathsf{R}\) Commander's assistance. It is well suited for the introductory level. <code>Rcmdr</code> also allows for user-contributed ``Plugins'' which are separate packages on <code>CRAN</code> that add extra functionality to the <code>Rcmdr</code> package. The plugins are typically named with the prefix <code>RcmdrPlugin</code> to make them easy to identify in the <code>CRAN</code> package list. One such plugin is the <code>RcmdrPlugin.IPSUR</code> package which accompanies this text.
</dd>
<dt>Poor Man's GUI\index{Poor Man's GUI}</dt><dd>is an alternative to the <code>Rcmdr</code> which is based on GTk instead of Tcl/Tk. It has been a while since I used it but I remember liking it very much when I did. One thing that stood out was that the user could drag-and-drop data sets for plots. See here for more information: <a href="http://wiener.math.csi.cuny.edu/pmg/">http://wiener.math.csi.cuny.edu/pmg/</a>. 
</dd>
<dt>Rattle\index{Rattle}</dt><dd>is a data mining toolkit which was designed to manage/analyze very large data sets, but it provides enough other general functionality to merit mention here. See \cite{rattle} for more information.
</dd>
<dt>Deducer\index{Deducer}</dt><dd>is relatively new and shows promise from what I have seen, but I have not actually used it in the classroom yet.
</dd>
</dl>


</div>
</div>

</div>

<div id="outline-container-sec-Basic-R-Operations" class="outline-3">
<h3 id="sec-Basic-R-Operations"><a name="sec-2-3" id="sec-2-3"></a><span class="section-number-3">2.3</span> Basic \(\mathsf{R}\) Operations and Concepts</h3>
<div class="outline-text-3" id="text-sec-Basic-R-Operations">


<p>
The \(\mathsf{R}\) developers have written an introductory document entitled ``An Introduction to \(\mathsf{R}\)''. There is a sample session included which shows what basic interaction with \(\mathsf{R}\) looks like. I recommend that all new users of \(\mathsf{R}\) read that document, but bear in mind that there are concepts mentioned which will be unfamiliar to the beginner.
</p>
<p>
Below are some of the most basic operations that can be done with \(\mathsf{R}\). Almost every book about \(\mathsf{R}\) begins with a section like the one below; look around to see all sorts of things that can be done at this most basic level.
</p>

</div>

<div id="outline-container-sub-Arithmetic" class="outline-4">
<h4 id="sub-Arithmetic"><a name="sec-2-3-1" id="sec-2-3-1"></a><span class="section-number-4">2.3.1</span> Arithmetic</h4>
<div class="outline-text-4" id="text-sub-Arithmetic">





<pre class="src src-R">2 + 3       <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">add</span>
4 * 5 / 6   <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">multiply and divide</span>
7^8         <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">7 to the 8th power</span>
</pre>


<pre class="example">
[1] 5
[1] 3.333333333333333
[1] 5764801
</pre>


<p>
Notice the comment character <code>#</code>\index{#@\texttt{\#}}. Anything typed after a <code>#</code> symbol is ignored by \(\mathsf{R}\). We know that \(20/6\) is a repeating decimal, but the above example shows only 7 digits. We can change the number of digits displayed with <code>options</code>\index{options@\texttt{options}}:
</p>



<pre class="src src-R">options(digits = 16)
10/3                 <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">see more digits</span>
sqrt(2)              <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">square root</span>
exp(1)               <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Euler's constant, e</span>
pi       
options(digits = 7)  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">back to default</span>
</pre>


<pre class="example">
[1] 3.333333333333333
[1] 1.414213562373095
[1] 2.718281828459045
[1] 3.141592653589793
</pre>


<p>
Note that it is possible to set <code>digits</code>\index{digits@\texttt{digits}} up to 22, but setting them over 16 is not recommended (the extra significant digits are not necessarily reliable). Above notice the <code>sqrt</code>\index{sqrt@\texttt{sqrt}} function for square roots and the <code>exp</code>\index{exp@\texttt{exp}} function for powers of \(\mathrm{e}\), Euler's number.
</p>
</div>

</div>

<div id="outline-container-sub-Assignment-Object-names" class="outline-4">
<h4 id="sub-Assignment-Object-names"><a name="sec-2-3-2" id="sec-2-3-2"></a><span class="section-number-4">2.3.2</span> Assignment, Object names, and Data types</h4>
<div class="outline-text-4" id="text-sub-Assignment-Object-names">


<p>
It is often convenient to assign numbers and values to variables (objects) to be used later. The proper way to assign values to a variable is with the <code>&lt;-</code> operator (with a space on either side). The <code>=</code> symbol works too, but it is recommended by the \(\mathsf{R}\) masters to reserve <code>=</code> for specifying arguments to functions (discussed later). In this book we will follow their advice and use <code>&lt;-</code> for assignment. Once a variable is assigned, its value can be printed by simply entering the variable name by itself.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 7*41/pi   <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">don't see the calculated value</span>
x              <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">take a look</span>
</pre>


<pre class="example">
[1] 91.35494
</pre>


<p>
When choosing a variable name you can use letters, numbers, dots ``\texttt{.}'', or underscore ``\texttt{_}'' characters. You cannot use mathematical operators, and a leading dot may not be followed by a number. Examples of valid names are: <code>x</code>, <code>x1</code>, <code>y.value</code>, and <code>!y_hat</code>. (More precisely, the set of allowable characters in object names depends on one's particular system and locale; see An Introduction to \(\mathsf{R}\) for more discussion on this.)
</p>
<p>
Objects can be of many <i>types</i>, <i>modes</i>, and <i>classes</i>. At this level, it is not necessary to investigate all of the intricacies of the respective types, but there are some with which you need to become familiar:
</p>
<dl>
<dt>integer:</dt><dd>the values \(0\), \(\pm1\), \(\pm2\), &hellip;; these are represented exactly by \(\mathsf{R}\).
</dd>
<dt>double:</dt><dd>real numbers (rational and irrational); these numbers are not represented exactly (save integers or fractions with a denominator that is a power of 2, see \cite{Venables2010}).
</dd>
<dt>character:</dt><dd>elements that are wrapped with pairs of ="= or ';
</dd>
<dt>logical:</dt><dd>includes <code>TRUE</code>, <code>FALSE</code>, and <code>NA</code> (which are reserved words); the <code>NA</code>\index{NA@\texttt{NA}} stands for ``not available'', <i>i.e.</i>, a missing value.
</dd>
</dl>


<p>
You can determine an object's type with the <code>typeof</code>\index{typeof@\texttt{typeof}} function. In addition to the above, there is the <code>complex</code>\index{complex@\texttt{complex}}\index{as.complex@\texttt{as.complex}} data type:
</p>



<pre class="src src-R">sqrt(-1)              <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">isn't defined</span>
sqrt(-1+0i)           <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">is defined</span>
sqrt(as.complex(-1))  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">same thing</span>
(0 + 1i)^2            <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">should be -1</span>
typeof((0 + 1i)^2)
</pre>


<pre class="example">
[1] NaN
[1] 0+1i
[1] 0+1i
[1] -1+0i
[1] "complex"
</pre>


<p>
Note that you can just type <code>(1i)^2</code> to get the same answer. The <code>NaN</code>\index{NaN@\texttt{NaN}} stands for ``not a number''; it is represented internally as <code>double</code>\index{double}. 
</p>
</div>

</div>

<div id="outline-container-sub-Vectors" class="outline-4">
<h4 id="sub-Vectors"><a name="sec-2-3-3" id="sec-2-3-3"></a><span class="section-number-4">2.3.3</span> Vectors</h4>
<div class="outline-text-4" id="text-sub-Vectors">


<p>
All of this time we have been manipulating vectors of length 1. Now let us move to vectors with multiple entries.
</p>

</div>

<div id="outline-container-2-3-3-1" class="outline-5">
<h5 id="sec-2-3-3-1"><span class="section-number-5">2.3.3.1</span> Entering data vectors</h5>
<div class="outline-text-5" id="text-2-3-3-1">


<p>
<b>The long way:</b>\index{c@\texttt{c}} If you would like to enter the data <code>74,31,95,61,76,34,23,54,96</code> into \(\mathsf{R}\), you may create a data vector with the <code>c</code> function (which is short for <i>concatenate</i>).
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(74, 31, 95, 61, 76, 34, 23, 54, 96)
x
</pre>


<pre class="example">
[1] 74 31 95 61 76 34 23 54 96
</pre>


<p>
The elements of a vector are usually coerced by \(\mathsf{R}\) to the the most general type of any of the elements, so if you do <code>c(1, "2")</code> then the result will be <code>c("1", "2")</code>.
</p>
<p>
<b>A shorter way:</b> \index{scan@\texttt{scan}}: The <code>scan</code> method is useful when the data are stored somewhere else. For instance, you may type <code>x &lt;- scan()</code> at the command prompt and \(\mathsf{R}\) will display <code>1:</code> to indicate that it is waiting for the first data value. Type a value and press <code>Enter</code>, at which point \(\mathsf{R}\) will display <code>2:</code>, and so forth. Note that entering an empty line stops the scan. This method is especially handy when you have a column of values, say, stored in a text file or spreadsheet. You may copy and paste them all at the <code>1:</code> prompt, and \(\mathsf{R}\) will store all of the values instantly in the vector <code>x</code>. 
</p>
<p>
<b>Repeated data; regular patterns:</b> the <code>seq</code>\index{seq@\texttt{seq}} function will generate all sorts of sequences of numbers. It has the arguments <code>from</code>, <code>to</code>, <code>by</code>, and <code>length.out</code> which can be set in concert with one another. We will do a couple of examples to show you how it works.
</p>



<pre class="src src-R">seq(from = 1, to = 5)
seq(from = 2, by = -0.1, length.out = 4)
</pre>


<pre class="example">
[1] 1 2 3 4 5
[1] 2.0 1.9 1.8 1.7
</pre>


<p>
Note that we can get the first line much quicker with the colon operator.
</p>



<pre class="src src-R">1:5
</pre>


<pre class="example">
[1] 1 2 3 4 5
</pre>


<p>
The vector <code>LETTERS</code>\index{LETTERS@\texttt{LETTERS}} has the 26 letters of the English alphabet in uppercase and <code>letters</code>\index{letters@\texttt{letters}} has all of them in lowercase.
</p>
</div>

</div>

<div id="outline-container-2-3-3-2" class="outline-5">
<h5 id="sec-2-3-3-2"><span class="section-number-5">2.3.3.2</span> Indexing data vectors</h5>
<div class="outline-text-5" id="text-2-3-3-2">


<p>
Sometimes we do not want the whole vector, but just a piece of it. We can access the intermediate parts with the <code>[]</code>\index{[]@\texttt{{[}{]}}} operator. Observe (with <code>x</code> defined above)
</p>



<pre class="src src-R">x[1]
x[2:4]
x[c(1,3,4,8)]
x[-c(1,3,4,8)]
</pre>


<pre class="example">
[1] 74
[1] 31 95 61
[1] 74 95 61 54
[1] 31 76 34 23 96
</pre>


<p>
Notice that we used the minus sign to specify those elements that we do <i>not</i> want. 
</p>



<pre class="src src-R">LETTERS[1:5]
letters[-(6:24)]
</pre>


<pre class="example">
[1] "A" "B" "C" "D" "E"
[1] "a" "b" "c" "d" "e" "y" "z"
</pre>


</div>
</div>

</div>

<div id="outline-container-sub-Functions-and-Expressions" class="outline-4">
<h4 id="sub-Functions-and-Expressions"><a name="sec-2-3-4" id="sec-2-3-4"></a><span class="section-number-4">2.3.4</span> Functions and Expressions</h4>
<div class="outline-text-4" id="text-sub-Functions-and-Expressions">


<p>
A function takes arguments as input and returns an object as output. There are functions to do all sorts of things. We show some examples below.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 1:5
sum(x)
length(x)
min(x)
mean(x)      <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">sample mean</span>
sd(x)        <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">sample standard deviation</span>
</pre>


<pre class="example">
[1] 15
[1] 5
[1] 1
[1] 3
[1] 1.581139
</pre>


<p>
It will not be long before the user starts to wonder how a particular function is doing its job, and since \(\mathsf{R}\) is open-source, anybody is free to look under the hood of a function to see how things are calculated. For detailed instructions see the article ``Accessing the Sources'' by Uwe Ligges \cite{Ligges2006}. In short:
</p>
<p>
<b>Type the name of the function</b> without any parentheses or arguments. If you are lucky then the code for the entire function will be printed, right there looking at you. For instance, suppose that we would like to see how the <code>intersect</code>\index{intersect@\texttt{intersect}} function works:
</p>



<pre class="src src-R">intersect
</pre>


<pre class="example">
function (x, ...) 
UseMethod("intersect")
&lt;environment: namespace:prob&gt;
</pre>


<p>
<b>If instead</b> it shows <code>UseMethod(something)</code>\index{UseMethod@\texttt{UseMethod}} then you will need to choose the <i>class</i> of the object to be inputted and next look at the <i>method</i> that will be <i>dispatched</i> to the object. For instance, typing <code>rev</code>\index{rev@\texttt{rev}} says 
</p>



<pre class="src src-R">rev
</pre>


<pre class="example">
function (x) 
UseMethod("rev")
&lt;bytecode: 0xa00d620&gt;
&lt;environment: namespace:base&gt;
</pre>


<p>
The output is telling us that there are multiple methods associated with the <code>rev</code> function. To see what these are, type
</p>



<pre class="src src-R">methods(rev)
</pre>


<pre class="example">
[1] rev.default     rev.dendrogram* rev.zoo        
[4] rev.zooreg*    

   Non-visible functions are asterisked
</pre>


<p>
Now we learn that there are two different <code>rev(x)</code> functions, only one of which being chosen at each call depending on what <code>x</code> is. There is one for <code>dendrogram</code> objects and a <code>default</code> method for everything else. Simply type the name to see what each method does. For example, the <code>default</code> method can be viewed with
</p>



<pre class="src src-R">rev.default
</pre>


<pre class="example">
function (x) 
if (length(x)) x[length(x):1L] else x
&lt;bytecode: 0xb57f920&gt;
&lt;environment: namespace:base&gt;
</pre>


<p>
<b>Some functions are hidden</b> by a <i>namespace</i> (see An Introduction to \(\mathsf{R}\) \cite{Venables2010}), and are not visible on the first try. For example, if we try to look at the code for <code>wilcox.test</code>\index{wilcox.test@\texttt{wilcox.test}} (see Chapter <a href="#sec-14">Nonparametric Statistics</a>) we get the following:
</p>



<pre class="src src-R">wilcox.test
methods(wilcox.test)
</pre>


<pre class="example">
function (x, ...) 
UseMethod("wilcox.test")
&lt;bytecode: 0xa6ad330&gt;
&lt;environment: namespace:stats&gt;
[1] wilcox.test.default* wilcox.test.formula*

   Non-visible functions are asterisked
</pre>


<p>
If we were to try <code>wilcox.test.default</code>  we would get a ``not found'' error, because it is hidden behind the namespace for the package <code>stats</code> (shown in the last line when we tried <code>wilcox.test</code>). In cases like these we prefix the package name to the front of the function name with three colons; the command <code>stats:::wilcox.test.default</code> will show the source code, omitted here for brevity.
</p>
<p>
<b>If it shows</b> <code>.Internal(something)</code>\index{.Internal@\texttt{.Internal}} or <code>.Primitive(something)</code>\index{.Primitive@\texttt{.Primitive}}, then it will be necessary to download the source code of \(\mathsf{R}\) (which is <i>not</i> a binary version with an <code>.exe</code> extension) and search inside the code there. See Ligges \cite{Ligges2006} for more discussion on this. An example is <code>exp</code>:
</p>



<pre class="src src-R">exp
</pre>


<pre class="example">
function (x)  .Primitive("exp")
</pre>


<p>
Be warned that most of the <code>.Internal</code> functions are written in other computer languages which the beginner may not understand, at least initially.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Getting-Help" class="outline-3">
<h3 id="sec-Getting-Help"><a name="sec-2-4" id="sec-2-4"></a><span class="section-number-3">2.4</span> Getting Help</h3>
<div class="outline-text-3" id="text-sec-Getting-Help">


<p>
When you are using \(\mathsf{R}\), it will not take long before you find yourself needing help. Fortunately, \(\mathsf{R}\) has extensive help resources and you should immediately become familiar with them. Begin by clicking <code>Help</code> on <code>RGui</code>. The following options are available. 
</p><dl>
<dt>Console:</dt><dd>gives useful shortcuts, for instance, <code>Ctrl+L</code>, to clear the \(\mathsf{R}\) console screen. 
</dd>
<dt>FAQ on \(\mathsf{R}\):</dt><dd>frequently asked questions concerning general \(\mathsf{R}\) operation.
</dd>
<dt>FAQ on \(\mathsf{R}\) for Windows:</dt><dd>frequently asked questions about \(\mathsf{R}\), tailored to the Microsoft Windows operating system.
</dd>
<dt>Manuals:</dt><dd>technical manuals about all features of the \(\mathsf{R}\) system including installation, the complete language definition, and add-on packages.
</dd>
<dt>\(\mathsf{R}\) functions (text)&hellip;:</dt><dd>use this if you know the <i>exact</i> name of the function you want to know more about, for example, <code>mean</code> or <code>plot</code>. Typing <code>mean</code> in the window is equivalent to typing <code>help("mean")</code>\index{help@\texttt{help}} at the command line, or more simply, <code>?mean</code>\index{?@\texttt{?}}. Note that this method only works if the function of interest is contained in a package that is already loaded into the search path with <code>library</code>. 
</dd>
<dt>HTML Help:</dt><dd>use this to browse the manuals with point-and-click links. It also has a Search Engine \&amp; Keywords for searching the help page titles, with point-and-click links for the search results. This is possibly the best help method for beginners. It can be started from the command line with the command <code>help.start()</code>\index{help.start@\texttt{help.start}}.
</dd>
<dt>Search help &hellip;:</dt><dd>use this if you do not know the exact name of the function of interest, or if the function is in a package that has not been loaded yet. For example, you may enter <code>plo</code> and a text window will return listing all the help files with an alias, concept, or title matching `=plo=' using regular expression matching; it is equivalent to typing <code>help.search("plo")</code>\index{help.search@\texttt{help.search}} at the command line. The advantage is that you do not need to know the exact name of the function; the disadvantage is that you cannot point-and-click the results. Therefore, one may wish to use the HTML Help search engine instead. An equivalent way is <code>??plo</code>\index{??@\texttt{??}} at the command line.
</dd>
<dt>search.r-project.org &hellip;:</dt><dd>this will search for words in help lists and email archives of the \(\mathsf{R}\) Project. It can be very useful for finding other questions that other users have asked. 
</dd>
<dt>Apropos &hellip;:</dt><dd>use this for more sophisticated partial name matching of functions. See <code>?apropos</code>\index{apropos@\texttt{apropos}} for details.
</dd>
</dl>


<p>
On the help pages for a function there are sometimes ``Examples'' listed at the bottom of the page, which will work if copy-pasted at the command line (unless marked otherwise). The <code>example</code>\index{example@\texttt{example}} function will run the code automatically, skipping the intermediate step. For instance, we may try <code>example(mean)</code> to see a few examples of how the <code>mean</code> function works.
</p>

</div>

<div id="outline-container-2-4-1" class="outline-4">
<h4 id="sec-2-4-1"><span class="section-number-4">2.4.1</span> \(\mathsf{R}\) Help Mailing Lists</h4>
<div class="outline-text-4" id="text-2-4-1">


<p>
There are several mailing lists associated with \(\mathsf{R}\), and there is a huge community of people that read and answer questions related to \(\mathsf{R}\). See <a href="http://www.r-project.org/mail.html">here</a> for an idea of what is available. Particularly pay attention to the bottom of the page which lists several special interest groups (SIGs) related to \(\mathsf{R}\).
</p>
<p>
Bear in mind that \(\mathsf{R}\) is free software, which means that it was written by volunteers, and the people that frequent the mailing lists are also volunteers who are not paid by customer support fees. Consequently, if you want to use the mailing lists for free advice then you must adhere to some basic etiquette, or else you may not get a reply, or even worse, you may receive a reply which is a bit less cordial than you are used to. Below are a few considerations: 
</p><ol>
<li>Read the <a href="http://cran.r-project.org/faqs.html">FAQ</a>. Note that there are different FAQs for different operating systems. You should read these now, even without a question at the moment, to learn a lot about the idiosyncrasies of \(\mathsf{R}\).
</li>
<li>Search the archives. Even if your question is not a FAQ, there is a very high likelihood that your question has been asked before on the mailing list. If you want to know about topic <code>foo</code>, then you can do <code>RSiteSearch("foo")</code>\index{RSiteSearch@\texttt{RSiteSearch}} to search the mailing list archives (and the online help) for it. 
</li>
<li>Do a Google search and an \texttt{RSeek.org} search.
</li>
</ol>


<p>
If your question is not a FAQ, has not been asked on \(\mathsf{R}\)-help before, and does not yield to a Google (or alternative) search, then, and only then, should you even consider writing to \(\mathsf{R}\)-help. Below are a few additional considerations. 
</p>
<ul>
<li>Read the <a href="http://www.r-project.org/posting-guide.html">posting guide</a> before posting. This will save you a lot of trouble and pain. 
</li>
<li>Get rid of the command prompts (<code>&gt;</code>) from output. Readers of your message will take the text from your mail and copy-paste into an \(\mathsf{R}\) session. If you make the readers' job easier then it will increase the likelihood of a response. 
</li>
<li>Questions are often related to a specific data set, and the best way to communicate the data is with a <code>dump</code>\index{dump@\texttt{dump}} command. For instance, if your question involves data stored in a vector <code>x</code>, you can type <code>dump("x","")</code> at the command prompt and copy-paste the output into the body of your email message. Then the reader may easily copy-paste the message from your email into \(\mathsf{R}\) and <code>x</code> will be available to him/her.
</li>
<li>Sometimes the answer the question is related to the operating system used, the attached packages, or the exact version of \(\mathsf{R}\) being used. The <code>sessionInfo()</code>\index{sessionInfo@\texttt{sessionInfo}} command collects all of this information to be copy-pasted into an email (and the Posting Guide requests this information). See Appendix <a href="#sec-17">R Session Info</a> for an example.
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-sec-External-Resources" class="outline-3">
<h3 id="sec-External-Resources"><a name="sec-2-5" id="sec-2-5"></a><span class="section-number-3">2.5</span> External Resources</h3>
<div class="outline-text-3" id="text-sec-External-Resources">


<p>
There is a mountain of information on the Internet about \(\mathsf{R}\). Below are a few of the important ones. 
</p><ul>
<li>The \(\mathsf{R}\)- Project for Statistical Computing:\index{The R-Project@The \textsf{R}-Project}: Go <a href="http://www.r-project.org/">there</a> first.
</li>
<li>The Comprehensive \(\mathsf{R}\) Archive Network:\index{CRAN}: <a href="http://cran.r-project.org/">That is where</a> \(\mathsf{R}\) is stored along with thousands of contributed packages. There are also loads of contributed information (books, tutorials, <i>etc</i>.). There are mirrors all over the world with duplicate information.
</li>
<li>\(\mathsf{R}\)-Forge:\index{R-Forge@\textsf{R}-Forge}: <a href="http://r-forge.r-project.org/">This is another location</a> where \(\mathsf{R}\) packages are stored. Here you can find development code which has not yet been released to <code>CRAN</code>. 
</li>
<li>\(\mathsf{R}\)-Wiki:\index{R-Wiki@\textsf{R}-Wiki}: There are many tips, tricks, and general advice <a href="http://wiki.r-project.org/rwiki/doku.php">listed here</a>. If you find a trick of your own, login and share it with the world. 
</li>
<li>Other: the <a href="http://addictedtor.free.fr/graphiques/">\(\mathsf{R}\) Graph Gallery</a>\index{R Graph Gallery@\textsf{R} Graph Gallery} and <a href="http://bm2.genes.nig.ac.jp/RGM2/index.php">\(\mathsf{R}\) Graphical Manual</a>\index{R Graphical Manual@\textsf{R} Graphical Manual} have literally thousands of graphs to peruse. <a href="http://www.rseek.org">\(\mathsf{R}\) Seek</a> is a search engine based on Google specifically tailored for \(\mathsf{R}\) queries. 
</li>
</ul>


</div>

</div>

<div id="outline-container-2-6" class="outline-3">
<h3 id="sec-2-6"><span class="section-number-3">2.6</span> Other Tips</h3>
<div class="outline-text-3" id="text-2-6">


<p>
It is unnecessary to retype commands repeatedly, since \(\mathsf{R}\) remembers what you have recently entered on the command line. On the Microsoft\(\circledR\) Windows \(\mathsf{R}\) Gui, to cycle through the previous commands just push the \(\uparrow\) (up arrow) key. On Emacs/ESS the command is <code>M-p</code> (which means hold down the <code>Alt</code> button and press ``p''). More generally, the command <code>history()</code>\index{history@\texttt{history}} will show a whole list of recently entered commands. 
</p><ul>
<li>To find out what all variables are in the current work environment, use the commands <code>objects()</code>\index{objects@\texttt{objects}} or <code>ls()</code>\index{ls@\texttt{ls}}. These list all available objects in the workspace. If you wish to remove one or more variables, use <code>remove(var1, var2, var3)</code>\index{remove@\texttt{remove}}, or more simply use <code>rm(var1, var2, var3)</code>, and to remove all objects use <code>rm(list = ls())</code>.
</li>
<li>Another use of <code>scan</code> is when you have a long list of numbers (separated by spaces or on different lines) already typed somewhere else, say in a text file. To enter all the data in one fell swoop, first highlight and copy the list of numbers to the Clipboard with <code>Edit</code> \(\triangleright\) <code>Copy</code> (or by right-clicking and selecting <code>Copy</code>). Next type the <code>x &lt;- scan()</code> command in the \(\mathsf{R}\) console, and paste the numbers at the <code>1:</code> prompt with <code>Edit</code> \(\triangleright\) <code>Paste</code>. All of the numbers will automatically be entered into the vector <code>x</code>.
</li>
<li>The command <code>Ctrl+l</code> clears the display in the Microsoft\(\circledR\) Windows \(\mathsf{R}\) Gui. In Emacs/ESS, press <code>Ctrl+l</code> repeatedly to cycle point (the place where the cursor is) to the bottom, middle, and top of the display.  
</li>
<li>Once you use \(\mathsf{R}\) for awhile there may be some commands that you wish to run automatically whenever \(\mathsf{R}\) starts. These commands may be saved in a file called <code>Rprofile.site</code>\index{Rprofile.site@\texttt{Rprofile.site}} which is usually in the <code>etc</code> folder, which lives in the \(\mathsf{R}\) home directory (which on Microsoft\(\circledR\) Windows usually is <code>C:\Program Files\R</code>). Alternatively, you can make a file <code>.Rprofile</code>\index{.Rprofile@\texttt{.Rprofile}} to be stored in the user's home directory, or anywhere \(\mathsf{R}\) is invoked. This allows for multiple configurations for different projects or users. See ``Customizing the Environment'' of <i>An Introduction to R</i> for more details.
</li>
<li>When exiting \(\mathsf{R}\) the user is given the option to ``save the workspace''. I recommend that beginners DO NOT save the workspace when quitting. If <code>Yes</code> is selected, then all of the objects and data currently in \(\mathsf{R}\)'s memory is saved in a file located in the working directory called <code>.RData</code>\index{.RData@\texttt{.RData}}. This file is then automatically loaded the next time \(\mathsf{R}\) starts (in which case \(\mathsf{R}\) will say <code>[previously saved workspace restored]</code>). This is a valuable feature for experienced users of \(\mathsf{R}\), but I find that it causes more trouble than it saves with beginners. 
</li>
</ul>



</div>

</div>

<div id="outline-container-2-7" class="outline-3">
<h3 id="sec-2-7"><span class="section-number-3">2.7</span> Exercises</h3>
<div class="outline-text-3" id="text-2-7">


</div>
</div>

</div>

<div id="outline-container-cha-Describing-Data-Distributions" class="outline-2">
<h2 id="cha-Describing-Data-Distributions"><a name="sec-3" id="sec-3"></a><span class="section-number-2">3</span> Data Description</h2>
<div class="outline-text-2" id="text-cha-Describing-Data-Distributions">




<p>
In this chapter we introduce the different types of data that a statistician is likely to encounter, and in each subsection we give some examples of how to display the data of that particular type. Once we see how to display data distributions, we next introduce the basic properties of data distributions. We qualitatively explore several data sets. Once that we have intuitive properties of data sets, we next discuss how we may numerically measure and describe those properties with descriptive statistics.
</p>
<p>
 <b>What do I want them to know?</b>
</p>
<ul>
<li>different data types, such as quantitative versus qualitative, nominal versus ordinal, and discrete versus continuous
</li>
<li>basic graphical displays for assorted data types, and some of their (dis)advantages 
</li>
<li>fundamental properties of data distributions, including center, spread, shape, and crazy observations
</li>
<li>methods to describe data (visually/numerically) with respect to the properties, and how the methods differ depending on the data type
</li>
<li>all of the above in the context of grouped data, and in particular, the concept of a factor
</li>
</ul>



</div>

<div id="outline-container-sec-Types-of-Data" class="outline-3">
<h3 id="sec-Types-of-Data"><a name="sec-3-1" id="sec-3-1"></a><span class="section-number-3">3.1</span> Types of Data</h3>
<div class="outline-text-3" id="text-sec-Types-of-Data">


<p>
Loosely speaking, a datum is any piece of collected information, and a data set is a collection of data related to each other in some way. We will categorize data into five types and describe each in turn:
</p>
<dl>
<dt>Quantitative</dt><dd>data associated with a measurement of some quantity on an observational unit,
</dd>
<dt>Qualitative</dt><dd>data associated with some quality or property of an observational unit,
</dd>
<dt>Logical</dt><dd>data which represent true or false and play an important role later,
</dd>
<dt>Missing</dt><dd>data which should be there but are not, and
</dd>
<dt>Other types</dt><dd>everything else under the sun.
</dd>
</dl>


<p>
In each subsection we look at some examples of the type in question and introduce methods to display them.
</p>

</div>

<div id="outline-container-sub-Quantitative-Data" class="outline-4">
<h4 id="sub-Quantitative-Data"><a name="sec-3-1-1" id="sec-3-1-1"></a><span class="section-number-4">3.1.1</span> Quantitative data</h4>
<div class="outline-text-4" id="text-sub-Quantitative-Data">


<p>
Quantitative data are any data that measure or are associated with a measurement of the quantity of something. They invariably assume numerical values. Quantitative data can be further subdivided into two categories. 
</p>
<ul>
<li><i>Discrete data</i> take values in a finite or countably infinite set of numbers, that is, all possible values could (at least in principle) be written down in an ordered list. Examples include: counts, number of arrivals, or number of successes. They are often represented by integers, say, 0, 1, 2, <i>etc</i>.
</li>
<li><i>Continuous data</i> take values in an interval of numbers. These are also known as scale data, interval data, or measurement data. Examples include: height, weight, length, time, <i>etc</i>. Continuous data are often characterized by fractions or decimals: 3.82, 7.0001, 4 \(\frac{5}{8}\), <i>etc</i>.
</li>
</ul>


<p>
Note that the distinction between discrete and continuous data is not always clear-cut. Sometimes it is convenient to treat data as if they were continuous, even though strictly speaking they are not continuous. See the examples.
</p>

<div class="exampletoo">
<p><b>Annual Precipitation in US Cities.</b> The vector <code>precip</code>\index{Data sets!precip@\texttt{precip}} contains average amount of rainfall (in inches) for each of 70 cities in the United States and Puerto Rico. Let us take a look at the data:
</p>



<pre class="src src-R">str(precip)
</pre>



<pre class="src src-R">precip[1:4]
</pre>


<p>
The output shows that <code>precip</code> is a numeric vector which has been <i>named</i>, that is, each value has a name associated with it (which can be set with the <code>names</code>\index{names@\texttt{names}} function). These are quantitative continuous data. 
</p>
</div>


<div class="exampletoo">
<p><b>Lengths of Major North American Rivers.</b> The U.S. Geological Survey recorded the lengths (in miles) of several rivers in North America. They are stored in the vector <code>rivers</code>\index{Data sets!rivers@\texttt{rivers}} in the <code>datasets</code> package (which ships with base \(\mathsf{R}\)). See <code>?rivers</code>. Let us take a look at the data with the <code>str</code>\index{str@\texttt{str}} function.
</p>



<pre class="src src-R">str(rivers)
</pre>


<p>
The output says that <code>rivers</code> is a numeric vector of length 141, and the first few values are 735, 320, 325, <i>etc</i>. These data are definitely quantitative and it appears that the measurements have been rounded to the nearest mile. Thus, strictly speaking, these are discrete data. But we will find it convenient later to take data like these to be continuous for some of our statistical procedures. 
</p>
</div>


<div class="exampletoo">
<p><b>Yearly Numbers of Important Discoveries.</b> The vector <code>discoveries</code>\index{Data sets!discoveries@\texttt{discoveries}} contains numbers of “great” inventions/discoveries in each year from 1860 to 1959, as reported by the 1975 World Almanac. Let us take a look at the data:
</p>



<pre class="src src-R">str(discoveries)
</pre>



</div>

<p>
The output is telling us that <code>discoveries</code> is a <i>time series</i> (see Section <a href="data-description#sub-other-data-types">Other Data Types</a> for more) of length 100. The entries are integers, and since they represent counts this is a good example of discrete quantitative data. We will take a closer look in the following sections.
</p>
</div>

</div>

<div id="outline-container-sub-Displaying-Quantitative-Data" class="outline-4">
<h4 id="sub-Displaying-Quantitative-Data"><a name="sec-3-1-2" id="sec-3-1-2"></a><span class="section-number-4">3.1.2</span> Displaying Quantitative Data</h4>
<div class="outline-text-4" id="text-sub-Displaying-Quantitative-Data">


<p>
One of the first things to do when confronted by quantitative data (or any data, for that matter) is to make some sort of visual display to gain some insight into the data's structure. There are almost as many display types from which to choose as there are data sets to plot. We describe some of the more popular alternatives. 
</p>

</div>

<div id="outline-container-par-Strip-charts" class="outline-5">
<h5 id="par-Strip-charts"><a name="sec-3-1-2-1" id="sec-3-1-2-1"></a><span class="section-number-5">3.1.2.1</span> Strip charts\index{strip chart} (also known as Dot plots)\index{dot plot| see\{strip chart\}}</h5>
<div class="outline-text-5" id="text-par-Strip-charts">


<p>
These can be used for discrete or continuous data, and usually look best when the data set is not too large. Along the horizontal axis is a numerical scale above which the data values are plotted. We can do it in \(\mathsf{R}\) with a call to the <code>stripchart</code>\index{stripchart@\texttt{stripchart}} function. There are three available methods.
</p>
<dl>
<dt>overplot</dt><dd>plots ties covering each other. This method is good to display only the distinct values assumed by the data set.

</dd>
<dt>jitter</dt><dd>adds some noise to the data in the \(y\) direction in which case the data values are not covered up by ties.

</dd>
<dt>stack</dt><dd>plots repeated values stacked on top of one another. This method is best used for discrete data with a lot of ties; if there are no repeats then this method is identical to overplot.
</dd>
</dl>


<p>
See Figure <a href="#fig-stripcharts">stripcharts</a>, which was produced by the following code.
</p>



<pre class="src src-R">stripchart(precip, xlab=<span style="font-style: italic;">"rainfall"</span>)
stripchart(rivers, method=<span style="font-style: italic;">"jitter"</span>, xlab=<span style="font-style: italic;">"length"</span>)
stripchart(discoveries, method=<span style="font-style: italic;">"stack"</span>, xlab=<span style="font-style: italic;">"number"</span>)
</pre>


<p>
The leftmost graph is a strip chart of the <code>precip</code> data. The graph shows tightly clustered values in the middle with some others falling balanced on either side, with perhaps slightly more falling to the left. Later we will call this a symmetric distribution, see Section <a href="#sec-3-2-3">Shape</a>. The middle graph is of the <code>rivers</code> data, a vector of length 141. There are several repeated values in the rivers data, and if we were to use the overplot method we would lose some of them in the display. This plot shows a what we will later call a right-skewed shape with perhaps some extreme values on the far right of the display. The third graph strip charts <code>discoveries</code> data which are literally a textbook example of a right skewed distribution.
</p>









  <div id="fig-stripcharts" class="figure">
    <p><img src="svg/datadesc/stripcharts.svg" width=500 alt="svg/datadesc/stripcharts.svg" /></p>
    <p>Three stripcharts of three data sets.  The first graph uses the <code>overplot</code> method, the second the <code>jitter</code> method, and the third the <code>stack</code> method.</p>
  </div>

<p>
The <code>DOTplot</code>\index{DOTplot@\texttt{DOTplot}} function in the <code>UsingR</code>\index{R packages!UsingR@\texttt{UsingR}} package \cite{usingr} is another alternative.
</p>
</div>

</div>

<div id="outline-container-3-1-2-2" class="outline-5">
<h5 id="sec-3-1-2-2"><span class="section-number-5">3.1.2.2</span> Histogram\index{Histogram}</h5>
<div class="outline-text-5" id="text-3-1-2-2">


<p>
These are typically used for continuous data. A histogram is constructed by first deciding on a set of classes, or bins, which partition the real line into a set of boxes into which the data values fall. Then vertical bars are drawn over the bins with height proportional to the number of observations that fell into the bin. 
</p>
<p>
These are one of the most common summary displays, and they are often misidentified as ``Bar Graphs'' (see below.) The scale on the \(y\) axis can be frequency, percentage, or density (relative frequency). The term histogram was coined by Karl Pearson in 1891, see \cite{Miller}.
</p>

<div class="exampletoo">
<p><a name="exa-annual" id="exa-annual"></a>
<b>Annual Precipitation in US Cities.</b> We are going to take another look at the <code>precip</code>\index{Data sets!precip@\texttt{precip}} data that we investigated earlier. The strip chart in Figure <a href="#fig-Various-stripchart-methods">Various-stripchart-methods</a> suggested a loosely balanced distribution; let us now look to see what a histogram says. 
</p>
<p>
There are many ways to plot histograms in \(\mathsf{R}\), and one of the easiest is with the <code>hist</code>\index{hist@\texttt{hist}} function. The following code produces the plots in Figure <a href="#fig-histograms">histograms</a>.
</p>



<pre class="src src-R">hist(precip, main = <span style="font-style: italic;">""</span>)
hist(precip, freq = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, main = <span style="font-style: italic;">""</span>)
</pre>


<p>
Notice the argument \(\mathtt{main = ""}\) which suppresses the main title from being displayed &ndash; it would have said ``Histogram of <code>precip</code>'' otherwise. The plot on the left is a frequency histogram (the default), and the plot on the right is a relative frequency histogram (<code>freq = FALSE</code>). 
</p>



<pre class="src src-R">m <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(as.data.frame(precip), aes(x = precip))
m + geom_histogram()
m + geom_histogram(aes(y = ..density..))
</pre>



<pre class="src src-R">m <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(as.data.frame(precip), aes(x = precip))
a <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> m + geom_histogram()
b <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> m + geom_histogram(aes(y = ..density..))
grid.newpage()
pushViewport(viewport(layout = grid.layout(2, 1)))
<span style="font-weight: bold;">vplayout</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x, y)
viewport(layout.pos.row = x, layout.pos.col = y)
print(a, vp = vplayout(1, 1))
print(b, vp = vplayout(2, 1))
</pre>



<pre class="src src-R">  &lt;&lt;histograms&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;histograms&gt;&gt;
</pre>



<pre class="src src-R">par(mfrow = c(1,2)) <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">2 plots: 1 row, 2 columns</span>
hist(precip, main = <span style="font-style: italic;">""</span>)
hist(precip, freq = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, main = <span style="font-style: italic;">""</span>)
par(mfrow = c(1,1)) <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">back to normal</span>
</pre>



<div id="fig-histograms" class="figure">
  <p><img src="svg/datadesc/histograms.svg" width=500 alt="svg/datadesc/histograms.svg" /></p>
  <p>(Relative) frequency histograms of the <code>precip</code> data.</p>
</div>


</div>

<p>
Please mind the biggest weakness of histograms: the graph obtained strongly depends on the bins chosen. Choose another set of bins, and you will get a different histogram. Moreover, there are not any definitive criteria by which bins should be defined; the best choice for a given data set is the one which illuminates the data set's underlying structure (if any). Luckily for us there are algorithms to automatically choose bins that are likely to display well, and more often than not the default bins do a good job. This is not always the case, however, and a responsible statistician will investigate many bin choices to test the stability of the display.
</p>

<div class="exampletoo">
<p>Recall that the strip chart in Figure <a href="#fig-Various-stripchart-methods">Various-stripchart-methods</a> suggested a relatively balanced shape to the <code>precip</code> data distribution. Watch what happens when we change the bins slightly (with the <code>breaks</code> argument to <code>hist</code>). See Figure <a href="#fig-histograms-bins">histograms-bins</a> which was produced by the following code.
</p>




<pre class="src src-R">qplot(precip, geom = <span style="font-style: italic;">"histogram"</span>, binwidth = 1)
qplot(precip, geom = <span style="font-style: italic;">"histogram"</span>, binwidth = 5)
qplot(precip, geom = <span style="font-style: italic;">"histogram"</span>, binwidth = 20)
m <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(as.data.frame(precip), aes(x = precip))
m + geom_histogram(binwidth = 1)
m + geom_histogram(binwidth = 5)
m + geom_histogram(binwidth = 20)
</pre>



<pre class="src src-R">m <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(as.data.frame(precip), aes(x = precip))
a1 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> m + geom_histogram(binwidth = 1)
a2 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> m + geom_histogram(binwidth = 5)
a3 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> m + geom_histogram(binwidth = 20)
grid.newpage()
pushViewport(viewport(layout = grid.layout(3, 1)))
<span style="font-weight: bold;">vplayout</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x, y)
viewport(layout.pos.row = x, layout.pos.col = y)
print(a1, vp = vplayout(1, 1))
print(a2, vp = vplayout(2, 1))
print(a3, vp = vplayout(3, 1))
</pre>



<pre class="src src-R">  &lt;&lt;histograms-bins&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;histograms-bins&gt;&gt;
</pre>



<div id="fig-histograms-bins" class="figure">
  <p><img src="svg/datadesc/histograms-bins.svg" width=500 alt="svg/datadesc/histograms-bins.svg" /></p>
  <p>More histograms of the <code>precip</code> data.</p>
</div>

<p>
The leftmost graph (with <code>breaks = 10</code>) shows that the distribution is not balanced at all. There are two humps: a big one in the middle and a smaller one to the left. Graphs like this often indicate some underlying group structure to the data; we could now investigate whether the cities for which rainfall was measured were similar in some way, with respect to geographic region, for example.
</p>
<p>
The rightmost graph in Figure <a href="#fig-histograms-bins">histograms-bins</a> shows what happens when the number of bins is too large: the histogram is too grainy and hides the rounded appearance of the earlier histograms. If we were to continue increasing the number of bins we would eventually get all observed bins to have exactly one element, which is nothing more than a glorified strip chart.
</p>

</div>

</div>

</div>

<div id="outline-container-3-1-2-3" class="outline-5">
<h5 id="sec-3-1-2-3"><span class="section-number-5">3.1.2.3</span> Stemplots (more to be said in Section <a href="#sec-3-4">Exploratory Data Analysis</a>)</h5>
<div class="outline-text-5" id="text-3-1-2-3">


<p>
Stemplots have two basic parts: <i>stems</i> and <i>leaves</i>. The final digit of the data values is taken to be a <i>leaf</i>, and the leading digit(s) is (are) taken to be <i>stems</i>. We draw a vertical line, and to the left of the line we list the stems. To the right of the line, we list the leaves beside their corresponding stem. There will typically be several leaves for each stem, in which case the leaves accumulate to the right. It is sometimes necessary to round the data values, especially for larger data sets.
</p>

<div class="exampletoo">
<p><a name="exa-ukdriverdeaths-first" id="exa-ukdriverdeaths-first"></a>
<code>UKDriverDeaths</code>\index{Data sets!UKDriverDeaths@\texttt{UKDriverDeaths}} is a time series that contains the total car drivers killed or seriously injured in Great Britain monthly from Jan 1969 to Dec 1984. See <code>?UKDriverDeaths</code>. Compulsory seat belt use was introduced on January 31, 1983. We construct a stem and leaf diagram in \(\mathsf{R}\) with the <code>stem.leaf</code>\index{stem.leaf@\texttt{stem.leaf}} function from the <code>aplpack</code>\index{R packages@\textsf{R} packages!aplpack@\texttt{aplpack}} package\cite{aplpack}.
</p>
</div>




<pre class="src src-R">stem.leaf(UKDriverDeaths, depth = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>



<pre class="example">1 | 2: represents 120
 leaf unit: 10
            n: 192
   10 | 57
   11 | 136678
   12 | 123889
   13 | 0255666888899
   14 | 00001222344444555556667788889
   15 | 0000111112222223444455555566677779
   16 | 01222333444445555555678888889
   17 | 11233344566667799
   18 | 00011235568
   19 | 01234455667799
   20 | 0000113557788899
   21 | 145599
   22 | 013467
   23 | 9
   24 | 7
HI: 2654
</pre>


<p>
The display shows a more or less balanced mound-shaped distribution, with one or maybe two humps, a big one and a smaller one just to its right. Note that the data have been rounded to the tens place so that each datum gets only one leaf to the right of the dividing line.
</p>
<p>
Notice that the \texttt{depth}s\index{depths} have been suppressed. To learn more about this option and many others, see Section <a href="#sec-3-4">Exploratory Data Analysis</a>. Unlike a histogram, the original data values may be recovered from the stemplot display &ndash; modulo the rounding &ndash; that is, starting from the top and working down we can read off the data values 1050, 1070, 1110, 1130, and so forth. 
</p>
</div>

</div>

<div id="outline-container-3-1-2-4" class="outline-5">
<h5 id="sec-3-1-2-4"><span class="section-number-5">3.1.2.4</span> Index plots</h5>
<div class="outline-text-5" id="text-3-1-2-4">


<p>
Done with the <code>plot</code>\index{plot@\texttt{plot}} function. These are good for plotting data which are ordered, for example, when the data are measured over time. That is, the first observation was measured at time 1, the second at time 2, <i>etc</i>. It is a two dimensional plot, in which the index (or time) is the \(x\) variable and the measured value is the \(y\) variable. There are several plotting methods for index plots, and we mention two of them:
</p>
<dl>
<dt>spikes</dt><dd>draws a vertical line from the \(x\)-axis to the observation height.
</dd>
<dt>points</dt><dd>plots a simple point at the observation height.
</dd>
</dl>




<div class="exampletoo">
<p><b>Level of Lake Huron 1875-1972.</b> Brockwell and Davis \cite{Brockwell1991} give the annual measurements of the level (in feet) of Lake Huron from 1875&ndash;1972. The data are stored in the time series <code>LakeHuron</code>\index{Data sets!LakeHuron@\texttt{LakeHuron}}. See <code>?LakeHuron</code>. Figure <a href="#fig-indpl-lakehuron">indpl-lakehuron</a> was produced with the following code:
</p>
<p>
Here is how to do it with base \(\mathsf{R}\).
</p>



<pre class="src src-R">plot(LakeHuron)
plot(LakeHuron, type = <span style="font-style: italic;">"p"</span>)
plot(LakeHuron, type = <span style="font-style: italic;">"h"</span>)
</pre>


<p>
Here is how to do it with <code>ggplot2</code>.
</p>



<pre class="src src-R">huron <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(year = time(LakeHuron), level = as.vector(LakeHuron))
h <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(huron, aes(x=year)) 
h + geom_path(aes(y = level))
h + geom_point(aes(y = level))
h + geom_ribbon(aes(ymin = 576, ymax = level))
</pre>


<p>
Here is how to do it with <code>lattice</code>.
</p>



<pre class="src src-R"><span style="font-weight: bold; text-decoration: underline;">library</span>(lattice)
xyplot(level ~ year, data = huron, type = <span style="font-style: italic;">"l"</span>)
xyplot(level ~ year, data = huron, type = <span style="font-style: italic;">"p"</span>)
</pre>



<p>
The plots show an overall decreasing trend to the observations, and there appears to be some seasonal variation that increases over time. 
</p>



<pre class="src src-R">par(mfrow = c(3,1))
plot(LakeHuron)
plot(LakeHuron, type = <span style="font-style: italic;">"p"</span>)
plot(LakeHuron, type = <span style="font-style: italic;">"h"</span>)
par(mfrow = c(1,1))
</pre>



<pre class="src src-R">  &lt;&lt;indpl-lakehuron&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;indpl-lakehuron&gt;&gt;
</pre>



<div id="fig-indpl-lakehuron" class="figure">
  <p><img src="svg/datadesc/indpl-lakehuron.svg" width=500 alt="svg/datadesc/indpl-lakehuron.svg" /></p>
  <p>Index plots of the <code>LakeHuron</code> data.</p>
</div>


</div>

</div>

</div>

<div id="outline-container-3-1-2-5" class="outline-5">
<h5 id="sec-3-1-2-5"><span class="section-number-5">3.1.2.5</span> Density estimates</h5>
<div class="outline-text-5" id="text-3-1-2-5">


<p>
The default method uses a Gaussian kernel density estimate.
</p>


</div>
</div>

</div>

<div id="outline-container-sub-Qualitative-Data" class="outline-4">
<h4 id="sub-Qualitative-Data"><a name="sec-3-1-3" id="sec-3-1-3"></a><span class="section-number-4">3.1.3</span> Qualitative Data, Categorical Data, and Factors</h4>
<div class="outline-text-4" id="text-sub-Qualitative-Data">


<p>
Qualitative data are simply any type of data that are not numerical, or do not represent numerical quantities. Examples of qualitative variables include a subject's name, gender, race/ethnicity, political party, socioeconomic status, class rank, driver's license number, and social security number (SSN).
</p>
<p>
Please bear in mind that some data <i>look</i> to be quantitative but are <i>not</i>, because they do not represent numerical quantities and do not obey mathematical rules. For example, a person's shoe size is typically written with numbers: 8, or 9, or 12, or \(12\,\frac{1}{2}\). Shoe size is not quantitative, however, because if we take a size 8 and combine with a size 9 we do not get a size 17.
</p>
<p>
Some qualitative data serve merely to <i>identify</i> the observation (such a subject's name, driver's license number, or SSN). This type of data does not usually play much of a role in statistics. But other qualitative variables serve to <i>subdivide</i> the data set into categories; we call these <i>factors</i>. In the above examples, gender, race, political party, and socioeconomic status would be considered factors (shoe size would be another one). The possible values of a factor are called its <i>levels</i>. For instance, the factor <i>gender</i> would have two levels, namely, male and female. Socioeconomic status typically has three levels: high, middle, and low.
</p>
<p>
Factors may be of two types: <i>nominal</i>\index{nominal data} and <i>ordinal</i>\index{ordinal data}. Nominal factors have levels that correspond to names of the categories, with no implied ordering. Examples of nominal factors would be hair color, gender, race, or political party. There is no natural ordering to ``Democrat'' and ``Republican''; the categories are just names associated with different groups of people. 
</p>
<p>
In contrast, ordinal factors have some sort of ordered structure to the underlying factor levels. For instance, socioeconomic status would be an ordinal categorical variable because the levels correspond to ranks associated with income, education, and occupation. Another example of ordinal categorical data would be class rank.
</p>
<p>
Factors have special status in \(\mathsf{R}\). They are represented internally by numbers, but even when they are written numerically their values do not convey any numeric meaning or obey any mathematical rules (that is, Stage III cancer is not Stage I cancer + Stage II cancer).
</p>

<div class="exampletoo">
<p>The <code>state.abb</code>\index{Data sets!state.abb@\texttt{state.abb}}
vector gives the two letter postal abbreviations for all 50 states.
</p>



<pre class="src src-R">str(state.abb)
</pre>


<p>
These would be ID data. The <code>state.name</code>\index{Data sets!state.name@\texttt{state.name}} vector lists all of the complete names and those data would also be ID.
</p>
</div>


<div class="exampletoo">
<p><b>U.S. State Facts and Features.</b> The U.S. Department of Commerce of the U.S. Census Bureau releases all sorts of information in the <i>Statistical Abstract of the United States</i>, and the <code>state.region</code>\index{Data sets!state.region@\texttt{state.region}} data lists each of the 50 states and the region to which it belongs, be it Northeast, South, North Central, or West. See <code>?state.region</code>.
</p>



<pre class="src src-R">str(state.region)
state.region[1:5]
</pre>


<p>
The <code>str</code>\index{str@\texttt{str}} output shows that <code>state.region</code> is already stored internally as a factor and it lists a couple of the factor levels. To see all of the levels we printed the first five entries of the vector in the second line.
</p>
</div>

</div>

</div>

<div id="outline-container-sub-Displaying-Qualitative-Data" class="outline-4">
<h4 id="sub-Displaying-Qualitative-Data"><a name="sec-3-1-4" id="sec-3-1-4"></a><span class="section-number-4">3.1.4</span> Displaying Qualitative Data</h4>
<div class="outline-text-4" id="text-sub-Displaying-Qualitative-Data">



</div>

<div id="outline-container-par-Tables" class="outline-5">
<h5 id="par-Tables"><a name="sec-3-1-4-1" id="sec-3-1-4-1"></a><span class="section-number-5">3.1.4.1</span> Tables</h5>
<div class="outline-text-5" id="text-par-Tables">


<p>
One of the best ways to summarize qualitative data is with a table of the data values. We may count frequencies with the <code>table</code> function or list proportions with the <code>prop.table</code>\index{prop.table@\texttt{prop.table}} function (whose input is a frequency table). In the \(\mathsf{R}\) Commander you can do it with <code>Statistics</code> \(\triangleright\) <code>Frequency Distribution...</code> Alternatively, to look at tables for all factors in the <code>Active data set</code>\index{Active data set@\texttt{Active data set}} you can do <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Active Dataset</code>.
</p>



<pre class="src src-R">Tbl <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> table(state.division)
</pre>



<pre class="src src-R">Tbl
</pre>


<pre class="example">
state.division
       New England    Middle Atlantic     South Atlantic 
                 6                  3                  8 
East South Central West South Central East North Central 
                 4                  4                  5 
West North Central           Mountain            Pacific 
                 7                  8                  5
</pre>





<pre class="src src-R">Tbl/sum(Tbl)      <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">relative frequencies</span>
</pre>


<pre class="example">
state.division
       New England    Middle Atlantic     South Atlantic 
              0.12               0.06               0.16 
East South Central West South Central East North Central 
              0.08               0.08               0.10 
West North Central           Mountain            Pacific 
              0.14               0.16               0.10
</pre>





<pre class="src src-R">prop.table(Tbl)   <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">same thing</span>
</pre>


<pre class="example">
state.division
       New England    Middle Atlantic     South Atlantic 
              0.12               0.06               0.16 
East South Central West South Central East North Central 
              0.08               0.08               0.10 
West North Central           Mountain            Pacific 
              0.14               0.16               0.10
</pre>


</div>

</div>

<div id="outline-container-par-Bar-Graphs" class="outline-5">
<h5 id="par-Bar-Graphs"><a name="sec-3-1-4-2" id="sec-3-1-4-2"></a><span class="section-number-5">3.1.4.2</span> Bar Graphs</h5>
<div class="outline-text-5" id="text-par-Bar-Graphs">


<p>
A bar graph is the analogue of a histogram for categorical data. A bar is displayed for each level of a factor, with the heights of the bars proportional to the frequencies of observations falling in the respective categories. A disadvantage of bar graphs is that the levels are ordered alphabetically (by default), which may sometimes obscure patterns in the display. 
</p>

<div class="exampletoo">
<p><b>U.S. State Facts and Features.</b> The <code>state.region</code> data lists each of the 50 states and the region to which it belongs, be it Northeast, South, North Central, or West. See <code>?state.region</code>. It is already stored internally as a factor. We make a bar graph with the <code>barplot</code>\index{barplot@\texttt{barplot}} function: 
</p>




<pre class="src src-R">barplot(table(state.region), cex.names = 0.50)
barplot(prop.table(table(state.region)), cex.names = 0.50)
</pre>


<p>
See Figure <a href="#fig-bar-gr-stateregion">bar-gr-stateregion</a>. The display on the left is a frequency bar graph because the \(y\) axis shows counts, while the display on the left is a relative frequency bar graph. The only difference between the two is the scale. Looking at the graph we see that the majority of the fifty states are in the South, followed by West, North Central, and finally Northeast. Over 30% of the states are in the South.
</p>
<p>
Notice the <code>cex.names</code>\index{cex.names@\texttt{cex.names}} argument that we used, above. It shrinks the names on the \(x\) axis by 50% which makes them easier to read. See <code>?par</code>\index{par@\texttt{par}} for a detailed list of additional plot parameters.
</p>



<pre class="src src-R">par(mfrow = c(1,2)) <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">2 plots: 1 row, 2 columns</span>
barplot(table(state.region), cex.names = 0.50)
barplot(prop.table(table(state.region)), cex.names = 0.50)
par(mfrow = c(1,1)) <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">back to normal</span>
</pre>



<pre class="src src-R">  &lt;&lt;bar-gr-stateregion&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;bar-gr-stateregion&gt;&gt;
</pre>



<div id="fig-bar-gr-stateregion" class="figure">
  <p><img src="svg/datadesc/bar-gr-stateregion.svg" width=500 alt="svg/datadesc/bar-gr-stateregion.svg" /></p>
  <p>The left graph is a frequency barplot made with <code>table</code> and the right is a relative frequency barplot made with <code>prop.table</code>.</p>
</div>


</div>

</div>

</div>

<div id="outline-container-par-Pareto-Diagrams" class="outline-5">
<h5 id="par-Pareto-Diagrams"><a name="sec-3-1-4-3" id="sec-3-1-4-3"></a><span class="section-number-5">3.1.4.3</span> Pareto Diagrams</h5>
<div class="outline-text-5" id="text-par-Pareto-Diagrams">


<p>
A pareto diagram is a lot like a bar graph except the bars are rearranged such that they decrease in height going from left to right. The rearrangement is handy because it can visually reveal structure (if any) in how fast the bars decrease &ndash; this is much more difficult when the bars are jumbled. 
</p>

<div class="exampletoo">
<p><b>U.S. State Facts and Features.</b> The <code>state.division</code>\index{Data sets!state.division@\texttt{state.division}} data record the division (New England, Middle Atlantic, South Atlantic, East South Central, West South Central, East North Central, West North Central, Mountain, and Pacific) of the fifty states. We can make a pareto diagram with either the <code>RcmdrPlugin.IPSUR</code>\index{R packages@\textsf{R} packages!RcmdrPlugin.IPSUR@\texttt{RcmdrPlugin.IPSUR}} package or with the <code>pareto.chart</code>\index{pareto.chart@\texttt{pareto.chart}} function from the <code>qcc</code>\index{R packages@\textsf{R} packages!qcc@\texttt{qcc}} package \cite{qcc}. See Figure <a href="#fig-Pareto-chart">Pareto-chart</a>. The code follows.
</p>



<pre class="src src-R">pareto.chart(table(state.division), ylab=<span style="font-style: italic;">"Frequency"</span>)
</pre>



<pre class="src src-R">  &lt;&lt;Pareto-chart&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;Pareto-chart&gt;&gt;
</pre>



<div id="fig-Pareto-chart" class="figure">
  <p><img src="svg/datadesc/Pareto-chart.svg" width=500 alt="svg/datadesc/Pareto-chart.svg" /></p>
  <p>Pareto chart of the <code>state.division</code> data.</p>
</div>


</div>

</div>

</div>

<div id="outline-container-par-Dotcharts" class="outline-5">
<h5 id="par-Dotcharts"><a name="sec-3-1-4-4" id="sec-3-1-4-4"></a><span class="section-number-5">3.1.4.4</span> Dot Charts</h5>
<div class="outline-text-5" id="text-par-Dotcharts">


<p>
These are a lot like a bar graph that has been turned on its side with the bars replaced by dots on horizontal lines. They do not convey any more (or less) information than the associated bar graph, but the strength lies in the economy of the display. Dot charts are so compact that it is easy to graph very complicated multi-variable interactions together in one graph. See Section <a href="#sec-3-6">Comparing Data Sets</a>. We will give an example here using the same data as above for comparison. The graph was produced by the following code.
</p>

<div class="exampletoo">




<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> table(state.region)
dotchart(as.vector(x), labels = names(x))
</pre>



<pre class="src src-R">  &lt;&lt;dot-charts&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;dot-charts&gt;&gt;
</pre>



<div id="fig-dot-charts" class="figure">
  <p><img src="svg/datadesc/dot-charts.svg" width=500 alt="svg/datadesc/dot-charts.svg" /></p>
  <p>Dot chart of the <code>state.region</code> data.</p>
</div>

<p>
See Figure <a href="#fig-dot-charts">dot-charts</a>. Compare it to Figure <a href="#fig-bar-gr-stateregion">bar-gr-stateregion</a>.
</p>

</div>

</div>

</div>

<div id="outline-container-par-Pie-Graphs" class="outline-5">
<h5 id="par-Pie-Graphs"><a name="sec-3-1-4-5" id="sec-3-1-4-5"></a><span class="section-number-5">3.1.4.5</span> Pie Graphs</h5>
<div class="outline-text-5" id="text-par-Pie-Graphs">


<p>
These can be done with \(\mathsf{R}\) and the \(\mathsf{R}\) Commander, but they fallen out of favor in recent years because researchers have determined that while the human eye is good at judging linear measures, it is notoriously bad at judging relative areas (such as those displayed by a pie graph). Pie charts are consequently a very bad way of displaying information. A bar chart or dot chart is a preferable way of displaying qualitative data. See <code>?pie</code>\index{pie@\texttt{pie}} for more information.
</p>
<p>
We are not going to do any examples of a pie graph and discourage their use elsewhere. 
</p>
</div>
</div>

</div>

<div id="outline-container-sub-Logical-Data" class="outline-4">
<h4 id="sub-Logical-Data"><a name="sec-3-1-5" id="sec-3-1-5"></a><span class="section-number-4">3.1.5</span> Logical Data</h4>
<div class="outline-text-4" id="text-sub-Logical-Data">


<p>
There is another type of information recognized by \(\mathsf{R}\) which does not fall into the above categories. The value is either <code>TRUE</code> or <code>FALSE</code> (note that equivalently you can use <code>1 = TRUE</code>, <code>0 = FALSE</code>). Here is an example of a logical vector:
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 5:9
y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> (x &lt; 7.3)
y
</pre>


<pre class="example">
[1]  TRUE  TRUE  TRUE FALSE FALSE
</pre>


<p>
Many functions in \(\mathsf{R}\) have options that the user may or may not want to activate in the function call. For example, the <code>stem.leaf</code> function has the <code>depths</code> argument which is <code>TRUE</code> by default. We saw in Section <a href="#sec-3-1-1">Quantitative Data</a> how to turn the option off, simply enter <code>stem.leaf(x, depths = FALSE)</code> and they will not be shown on the display.
</p>
<p>
We can swap <code>TRUE</code> with <code>FALSE</code> with the exclamation point <code>!</code>.
</p>



<pre class="src src-R">!y
</pre>


<pre class="example">
[1] FALSE FALSE FALSE  TRUE  TRUE
</pre>


</div>

</div>

<div id="outline-container-sub-Missing-Data" class="outline-4">
<h4 id="sub-Missing-Data"><a name="sec-3-1-6" id="sec-3-1-6"></a><span class="section-number-4">3.1.6</span> Missing Data</h4>
<div class="outline-text-4" id="text-sub-Missing-Data">


<p>
Missing data are a persistent and prevalent problem in many statistical analyses, especially those associated with the social sciences. \(\mathsf{R}\) reserves the special symbol <code>NA</code> to representing missing data.
</p>
<p>
Ordinary arithmetic with <code>NA</code> values give <code>NA</code>'s (addition, subtraction, <i>etc</i>.) and applying a function to a vector that has an <code>NA</code> in it will usually give an <code>NA</code>.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(3, 7, <span style="font-weight: bold; text-decoration: underline;">NA</span>, 4, 7)
y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(5, <span style="font-weight: bold; text-decoration: underline;">NA</span>, 1, 2, 2)
x + y
</pre>


<pre class="example">
[1]  8 NA NA  6  9
</pre>


<p>
Some functions have a <code>na.rm</code> argument which when <code>TRUE</code> will ignore missing data as if they were not there (such as <code>mean</code>, <code>var</code>, <code>sd</code>, <code>IQR</code>, <code>mad</code>, &hellip;). 
</p>



<pre class="src src-R">sum(x)
sum(x, na.rm = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<pre class="example">
[1] NA
[1] 21
</pre>


<p>
Other functions do not have a <code>na.rm</code> argument and will return <code>NA</code> or an error if the argument has \texttt{NA}s. In those cases we can find the locations of any \texttt{NA}s with the <code>is.na</code> function and remove those cases with the <code>[]</code> operator.
</p>



<pre class="src src-R">is.na(x)
z <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> x[!is.na(x)]
sum(z)
</pre>


<pre class="example">
[1] FALSE FALSE  TRUE FALSE FALSE
[1] 21
</pre>


<p>
The analogue of <code>is.na</code> for rectangular data sets (or data frames) is the <code>complete.cases</code> function. See Appendix <a href="#sec-20-4">Editing Data Sets</a>.
</p>
</div>

</div>

<div id="outline-container-sub-other-data-types" class="outline-4">
<h4 id="sub-other-data-types"><a name="sec-3-1-7" id="sec-3-1-7"></a><span class="section-number-4">3.1.7</span> Other Data Types</h4>
<div class="outline-text-4" id="text-sub-other-data-types">


</div>
</div>

</div>

<div id="outline-container-sec-features-of-data" class="outline-3">
<h3 id="sec-features-of-data"><a name="sec-3-2" id="sec-3-2"></a><span class="section-number-3">3.2</span> Features of Data Distributions</h3>
<div class="outline-text-3" id="text-sec-features-of-data">


<p>
Given that the data have been appropriately displayed, the next step is to try to identify salient features represented in the graph. The acronym to remember is <i>C</i>-enter, <i>U</i>-nusual features, <i>S</i>-pread, and <i>S</i>-hape. (CUSS).
</p>

</div>

<div id="outline-container-sub-Center" class="outline-4">
<h4 id="sub-Center"><a name="sec-3-2-1" id="sec-3-2-1"></a><span class="section-number-4">3.2.1</span> Center</h4>
<div class="outline-text-4" id="text-sub-Center">


<p>
One of the most basic features of a data set is its center. Loosely speaking, the center of a data set is associated with a number that represents a middle or general tendency of the data. Of course, there are usually several values that would serve as a center, and our later tasks will be focused on choosing an appropriate one for the data at hand. Judging from the histogram that we saw in Figure <a href="#fig-histograms-bins">histograms-bins</a>, a measure of center would be about \(  35 \). 
</p>
</div>

</div>

<div id="outline-container-sub-Spread" class="outline-4">
<h4 id="sub-Spread"><a name="sec-3-2-2" id="sec-3-2-2"></a><span class="section-number-4">3.2.2</span> Spread</h4>
<div class="outline-text-4" id="text-sub-Spread">


<p>
The spread of a data set is associated with its variability; data sets with a large spread tend to cover a large interval of values, while data sets with small spread tend to cluster tightly around a central value. 
</p>
</div>

</div>

<div id="outline-container-sub-Shape" class="outline-4">
<h4 id="sub-Shape"><a name="sec-3-2-3" id="sec-3-2-3"></a><span class="section-number-4">3.2.3</span> Shape</h4>
<div class="outline-text-4" id="text-sub-Shape">


<p>
When we speak of the <i>shape</i> of a data set, we are usually referring to the shape exhibited by an associated graphical display, such as a histogram. The shape can tell us a lot about any underlying structure to the data, and can help us decide which statistical procedure we should use to analyze them.
</p>

</div>

<div id="outline-container-3-2-3-1" class="outline-5">
<h5 id="sec-3-2-3-1"><span class="section-number-5">3.2.3.1</span> Symmetry and Skewness</h5>
<div class="outline-text-5" id="text-3-2-3-1">


<p>
A distribution is said to be <i>right-skewed</i> (or <i>positively skewed</i>) if the right tail seems to be stretched from the center. A <i>left-skewed</i> (or <i>negatively skewed</i>) distribution is stretched to the left side. A symmetric distribution has a graph that is balanced about its center, in the sense that half of the graph may be reflected about a central line of symmetry to match the other
half.
</p>
<p>
We have already encountered skewed distributions: both the discoveries data in Figure <a href="#fig-stripcharts">stripcharts</a> and the <code>precip</code> data in Figure <a href="#fig-histograms-bins">histograms-bins</a> appear right-skewed. The <code>UKDriverDeaths</code> data in Example <a href="#exa-ukdriverdeaths-first">UK Driver Deaths</a> is relatively symmetric (but note the one extreme value 2654 identified at the bottom of the stemplot).
</p>
</div>

</div>

<div id="outline-container-3-2-3-2" class="outline-5">
<h5 id="sec-3-2-3-2"><span class="section-number-5">3.2.3.2</span> Kurtosis</h5>
<div class="outline-text-5" id="text-3-2-3-2">


<p>
Another component to the shape of a distribution is how ``peaked'' it is. Some distributions tend to have a flat shape with thin tails. These are called <i>platykurtic</i>, and an example of a platykurtic distribution is the uniform distribution; see Section <a href="#sec-6-2">Continuous Uniform</a>. On the other end of the spectrum are distributions with a steep peak, or spike, accompanied by heavy tails; these are called <i>leptokurtic</i>. Examples of leptokurtic distributions are the Laplace distribution and the logistic distribution. See Section <a href="#sec-6-5">Other Continuous Distributions</a>. In between are distributions (called <i>mesokurtic</i>) with a rounded peak and moderately sized tails. The standard example of a mesokurtic distribution is the famous bell-shaped curve, also known as the Gaussian, or normal, distribution, and the binomial distribution can be mesokurtic for specific choices of \(p\). See Sections <a href="#sec-5-3">Binomial Distribution</a> and <a href="#sec-6-3">The Normal Distribution</a>.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-clusters-and-gaps" class="outline-4">
<h4 id="sub-clusters-and-gaps"><a name="sec-3-2-4" id="sec-3-2-4"></a><span class="section-number-4">3.2.4</span> Clusters and Gaps</h4>
<div class="outline-text-4" id="text-sub-clusters-and-gaps">


<p>
Clusters or gaps are sometimes observed in quantitative data distributions. They indicate clumping of the data about distinct values, and gaps may exist between clusters. Clusters often suggest an underlying grouping to the data. For example, take a look at the <code>faithful</code> data which contains the duration of <code>eruptions</code> and the <code>waiting</code> time between eruptions of the Old Faithful geyser in Yellowstone National Park. Do not be frightened by the complicated information at the left of the display for now; we will learn how to interpret it in Section <a href="#sec-3-4">Exploratory Data Analysis</a>.
</p>



<pre class="src src-R">with(faithful, stem.leaf(eruptions))
</pre>



<pre class="example">1 | 2: represents 1.2
 leaf unit: 0.1
            n: 272
   12     s | 667777777777
   51    1. | 888888888888888888888888888899999999999
   71    2* | 00000000000011111111
   87     t | 2222222222333333
   92     f | 44444
   94     s | 66
   97    2. | 889
   98    3* | 0
  102     t | 3333
  108     f | 445555
  118     s | 6666677777
  (16)   3. | 8888888889999999
  138    4* | 0000000000000000111111111111111
  107     t | 22222222222233333333333333333
   78     f | 44444444444445555555555555555555555
   43     s | 6666666666677777777777
   21    4. | 88888888888899999
    4    5* | 0001
</pre>


<p>
There are definitely two clusters of data here; an upper cluster and a lower cluster. 
</p>
</div>

</div>

<div id="outline-container-sub-Extreme-Observations-and" class="outline-4">
<h4 id="sub-Extreme-Observations-and"><a name="sec-3-2-5" id="sec-3-2-5"></a><span class="section-number-4">3.2.5</span> Extreme Observations and other Unusual Features</h4>
<div class="outline-text-4" id="text-sub-Extreme-Observations-and">


<p>
Extreme observations fall far from the rest of the data. Such observations are troublesome to many statistical procedures; they cause exaggerated estimates and instability. It is important to identify extreme observations and examine the source of the data more closely. There are many possible reasons underlying an extreme observation:
</p>
<ul>
<li><b>Maybe the value is a typographical error.</b> Especially with large data sets becoming more prevalent, many of which being recorded by hand, mistakes are a common problem. After closer scrutiny, these can often be fixed.

</li>
<li><b>Maybe the observation was not meant for the study</b>, because it does not belong to the population of interest. For example, in medical research some subjects may have relevant complications in their genealogical history that would rule out their participation in the experiment. Or when a manufacturing company investigates the properties of one of its devices, perhaps a particular product is malfunctioning and is not representative of the majority of the items.

</li>
<li><b>Maybe it indicates a deeper trend or phenomenon.</b> Many of the most influential scientific discoveries were made when the investigator noticed an unexpected result, a value that was not predicted by the classical theory. Albert Einstein, Louis Pasteur, and others built their careers on exactly this circumstance.
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-sec-Descriptive-Statistics" class="outline-3">
<h3 id="sec-Descriptive-Statistics"><a name="sec-3-3" id="sec-3-3"></a><span class="section-number-3">3.3</span> Descriptive Statistics</h3>
<div class="outline-text-3" id="text-sec-Descriptive-Statistics">


<p>
One of my favorite professors would repeatedly harp, ``You cannot do statistics without data.''  
</p>

<p>
<b>What do I want them to know?</b>
</p><ul>
<li>The fundamental data types we encounter most often, how to classify given data into a likely type, and that sometimes the distinction is blurry.\
</li>
</ul>



</div>

<div id="outline-container-sub-Frequencies-and-Relative" class="outline-4">
<h4 id="sub-Frequencies-and-Relative"><a name="sec-3-3-1" id="sec-3-3-1"></a><span class="section-number-4">3.3.1</span> Frequencies and Relative Frequencies</h4>
<div class="outline-text-4" id="text-sub-Frequencies-and-Relative">


<p>
These are used for categorical data. The idea is that there are a number of different categories, and we would like to get some idea about how the categories are represented in the population. 
</p>
</div>

</div>

<div id="outline-container-sub-Measures-of-Center" class="outline-4">
<h4 id="sub-Measures-of-Center"><a name="sec-3-3-2" id="sec-3-3-2"></a><span class="section-number-4">3.3.2</span> Measures of Center</h4>
<div class="outline-text-4" id="text-sub-Measures-of-Center">


<p>
The <i>sample mean</i> is denoted \(\overline{x}\) (read ``\(x\)-bar'') and is simply the arithmetic average of the observations:
\begin{equation} 
\overline{x}=\frac{x_{1}+x_{2}+\cdots+x_{n}}{n}=\frac{1}{n}\sum_{i=1}^{n}x_{i}.
\end{equation}
</p><ul>
<li>Good: natural, easy to compute, has nice mathematical properties
</li>
<li>Bad: sensitive to extreme values
</li>
</ul>


<p>
It is appropriate for use with data sets that are not highly skewed without extreme observations.
</p>
<p>
The <i>sample median</i> is another popular measure of center and is denoted \(\tilde{x}\). To calculate its value, first sort the data into an increasing sequence of numbers. If the data set has an odd number of observations then \(\tilde{x}\) is the value of the middle observation, which lies in position \((n+1)/2\); otherwise, there are two middle observations and \(\tilde{x}\) is the average of those middle values.
</p>
<ul>
<li>Good: resistant to extreme values, easy to describe
</li>
<li>Bad: not as mathematically tractable, need to sort the data to calculate
</li>
</ul>


<p>
One desirable property of the sample median is that it is <i>resistant</i> to extreme observations, in the sense that the value of \(\tilde{x}\) depends only on those data values in the middle, and is quite unaffected by the actual values of the outer observations in the ordered list. The same cannot be said for the sample mean. Any significant changes in the magnitude of an observation \(x_{k}\) results in a corresponding change in the value of the mean. Consequently, the sample mean is said to be <i>sensitive</i> to extreme observations.
</p>
<p>
The <i>trimmed mean</i> is a measure designed to address the sensitivity of the sample mean to extreme observations. The idea is to ``trim'' a fraction (less than 1/2) of the observations off each end of the ordered list, and then calculate the sample mean of what remains. We will denote it by \(\overline{x}_{t=0.05}\).
</p>
<ul>
<li>Good: resistant to extreme values, shares nice statistical properties
</li>
<li>Bad: need to sort the data
</li>
</ul>



</div>

<div id="outline-container-3-3-2-1" class="outline-5">
<h5 id="sec-3-3-2-1"><span class="section-number-5">3.3.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-3-2-1">


<ul>
<li>You can calculate frequencies or relative frequencies with the <code>table</code> function, and relative frequencies with <code>prop.table(table())</code>. 
</li>
<li>You can calculate the sample mean of a data vector <code>x</code> with the command <code>mean(x)</code>. 
</li>
<li>You can calculate the sample median of <code>x</code> with the command <code>median(x)</code>.
</li>
<li>You can calculate the trimmed mean with the <code>trim</code> argument; <code>mean(x, trim = 0.05)</code>.
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-sub-Order-Statistics-and" class="outline-4">
<h4 id="sub-Order-Statistics-and"><a name="sec-3-3-3" id="sec-3-3-3"></a><span class="section-number-4">3.3.3</span> Order Statistics and the Sample Quantiles</h4>
<div class="outline-text-4" id="text-sub-Order-Statistics-and">


<p>
A common first step in an analysis of a data set is to sort the values. Given a data set \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\), we may sort the values to obtain an increasing sequence
\begin{equation} 
x_{(1)}\leq x_{(2)}\leq x_{(3)}\leq\cdots\leq x_{(n)}
\end{equation}
and the resulting values are called the <i>order statistics</i>. The \(k^{\mathrm{th}}\) entry in the list, \(x_{(k)}\), is the \(k^{\mathrm{th}}\) order statistic, and approximately \(100(k/n)\)% of the observations fall below \(x_{(k)}\). The order statistics give an indication of the shape of the data distribution, in the sense that a person can look at the order statistics and have an idea about where the data are concentrated, and where they are sparse.
</p>
<p>
The <i>sample quantiles</i> are related to the order statistics. Unfortunately, there is not a universally accepted definition of them. Indeed, \(\mathsf{R}\) is equipped to calculate quantiles using nine distinct definitions! We will describe the default method (<code>type = 7</code>), but the interested reader can see the details for the other methods with <code>?quantile</code>.
</p>
<p>
Suppose the data set has \(n\) observations. Find the sample quantile of order \(p\) (\(0&lt;p&lt;1\)), denoted \(\tilde{q}_{p}\) , as follows: 
</p>
<dl>
<dt>First step:</dt><dd>sort the data to obtain the order statistics \(x_{(1)}\), \(x_{(2)}\), &hellip;,\(x_{(n)}\). 
</dd>
<dt>Second step:</dt><dd>calculate \((n-1)p+1\) and write it in the form \(k.d\), where \(k\) is an integer and \(d\) is a decimal.
</dd>
<dt>Third step:</dt><dd>The sample quantile \(\tilde{q}_{p}\) is
   \begin{equation}
      \tilde{q}_{p}=x_{(k)}+d(x_{(k+1)}-x_{(k)}).
   \end{equation}
</dd>
</dl>


<p>
The interpretation of \(\tilde{q}_{p}\) is that approximately \(100p\) % of the data fall below the value \(\tilde{q}_{p}\) . 
</p>
<p>
Keep in mind that there is not a unique definition of percentiles, quartiles, <i>etc</i>. Open a different book, and you'll find a different definition. The difference is small and seldom plays a role except in small data sets with repeated values. In fact, most people do not even notice in common use.
</p>
<p>
Clearly, the most popular sample quantile is \(\tilde{q}_{0.50}\), also known as the sample median, \(\tilde{x}\). The closest runners-up are the <i>first quartile</i> \(\tilde{q}_{0.25}\) and the <i>third quartile</i> \(\tilde{q}_{0.75}\) (the <i>second quartile</i> is the median). 
</p>

</div>

<div id="outline-container-3-3-3-1" class="outline-5">
<h5 id="sec-3-3-3-1"><span class="section-number-5">3.3.3.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-3-3-1">


<p>
<b>At the command prompt</b>
We can find the order statistics of a data set stored in a vector <code>x</code> with the command <code>sort(x)</code>.
</p>
<p>
We can calculate the sample quantiles of any order \(p\) where \(0&lt;p&lt;1\) for a data set stored in a data vector <code>x</code> with the <code>quantile</code> function, for instance, the command <code>quantile(x, probs = c(0, 0.25, 0.37))</code> will return the smallest observation, the first quartile, \(\tilde{q}_{0.25}\), and the 37th sample quantile, \(\tilde{q}_{0.37}\). For \(\tilde{q}_{p}\) simply change the values in the <code>probs</code> argument to the value \(p\).
</p>

<p>
<b>With the R Commander</b>
we can find the order statistics of a variable in the <code>Active data set</code> by doing <code>Data</code> \(\triangleright\) <code>Manage variables in Active data set...</code> \(\triangleright\) <code>Compute new variable...</code> In the <code>Expression to compute</code> dialog simply type <code>sort(varname)</code>, where <code>varname</code> is the variable that it is desired to sort.
</p>
<p>
In <code>Rcmdr</code>, we can calculate the sample quantiles for a particular variable with the sequence <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Numerical Summaries...</code> We can automatically calculate the quartiles for all variables in the <code>Active data set</code> with the sequence <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Active Dataset</code>.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-Measures-of-Spread" class="outline-4">
<h4 id="sub-Measures-of-Spread"><a name="sec-3-3-4" id="sec-3-3-4"></a><span class="section-number-4">3.3.4</span> Measures of Spread</h4>
<div class="outline-text-4" id="text-sub-Measures-of-Spread">



</div>

<div id="outline-container-3-3-4-1" class="outline-5">
<h5 id="sec-3-3-4-1"><span class="section-number-5">3.3.4.1</span> Sample Variance and Standard Deviation</h5>
<div class="outline-text-5" id="text-3-3-4-1">


<p>
The <i>sample variance</i> is denoted \(s^{2}\) and is calculated with the formula
\begin{equation}
s^{2}=\frac{1}{n-1}\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}.
\end{equation}
The <i>sample standard deviation</i> is \(s=\sqrt{s^{2}}\). Intuitively, the sample variance is approximately the average squared distance of the observations from the sample mean. The sample standard deviation is used to scale the estimate back to the measurement units of the original data.
</p><ul>
<li>Good: tractable, has nice mathematical/statistical properties
</li>
<li>Bad: sensitive to extreme values
</li>
</ul>

<p>We will spend a lot of time with the variance and standard deviation in the coming chapters. In the meantime, the following two rules give some meaning to the standard deviation, in that there are bounds on how much of the data can fall past a certain distance from the mean.
</p>

<div class="fact">
<p>Chebychev's Rule: The proportion of observations within \(k\) standard deviations of the mean is at least \(1-1/k^{2}\), <i>i.e.</i>, at least 75%, 89%, and 94% of the data are within 2, 3, and 4 standard deviations of the mean, respectively.
</p>
</div>

<p>
Note that Chebychev's Rule does not say anything about when \(k=1\), because \(1-1/1^{2}=0\), which states that at least 0% of the observations are within one standard deviation of the mean (which is not saying much).
</p>
<p>
Chebychev's Rule applies to any data distribution, <i>any</i> list of numbers, no matter where it came from or what the histogram looks like. The price for such generality is that the bounds are not very tight; if we know more about how the data are shaped then we can say more about how much of the data can fall a given distance from the mean.
</p>

<div class="fact">
<p><a name="fac-Empirical-Rule" id="fac-Empirical-Rule"></a>
Empirical Rule: If data follow a bell-shaped curve, then approximately 68%, 95%, and 99.7% of the data are within 1, 2, and 3 standard deviations of the mean, respectively. 
</p>
</div>

</div>

</div>

<div id="outline-container-3-3-4-2" class="outline-5">
<h5 id="sec-3-3-4-2"><span class="section-number-5">3.3.4.2</span> Interquartile Range</h5>
<div class="outline-text-5" id="text-3-3-4-2">


<p>
Just as the sample mean is sensitive to extreme values, so the associated measure of spread is similarly sensitive to extremes. Further, the problem is exacerbated by the fact that the extreme distances are squared. We know that the sample quartiles are resistant to extremes, and a measure of spread associated with them is the <i>interquartile range</i> (\(IQR\)) defined by \(IQR=q_{0.75}-q_{0.25}\).
</p>
<ul>
<li>Good: stable, resistant to outliers, robust to nonnormality, easy to explain
</li>
<li>Bad: not as tractable, need to sort the data, only involves the middle 50% of the data.
</li>
</ul>


</div>

</div>

<div id="outline-container-3-3-4-3" class="outline-5">
<h5 id="sec-3-3-4-3"><span class="section-number-5">3.3.4.3</span> Median Absolute Deviation</h5>
<div class="outline-text-5" id="text-3-3-4-3">


<p>
A measure even more robust than the \(IQR\) is the <i>median absolute deviation</i> (\(MAD\)). To calculate it we first get the median \(\widetilde{x}\), next the <i>absolute deviations</i> \(|x_{1}-\tilde{x}|\), \(|x_{2}-\tilde{x}|\), &hellip;, \(|x_{n}-\tilde{x}|\), and the \(MAD\) is proportional to the median of those deviations:
\begin{equation}
MAD\propto\mbox{median}(|x_{1}-\tilde{x}|,\ |x_{2}-\tilde{x}|,\ldots,|x_{n}-\tilde{x}|).
\end{equation}
That is, the \(MAD=c\cdot\mbox{median}(|x_{1}-\tilde{x}|,\ |x_{2}-\tilde{x}|,\ldots,|x_{n}-\tilde{x}|)\), where \(c\) is a constant chosen so that the \(MAD\) has nice properties. The value of \(c\) in \(\mathsf{R}\) is by default \(c=1.4286\). This value is chosen to ensure that the estimator of \(\sigma\) is correct, on the average, under suitable sampling assumptions (see Section <a href="#sec-9-1">Point Estimation 1</a>).
</p><ul>
<li>Good: stable, very robust, even more so than the \(IQR\).
</li>
<li>Bad: not tractable, not well known and less easy to explain.
</li>
</ul>


</div>

</div>

<div id="outline-container-3-3-4-4" class="outline-5">
<h5 id="sec-3-3-4-4"><span class="section-number-5">3.3.4.4</span> Comparing Apples to Apples</h5>
<div class="outline-text-5" id="text-3-3-4-4">


<p>
We have seen three different measures of spread which, for a given data set, will give three different answers. Which one should we use? It depends on the data set. If the data are well behaved, with an approximate bell-shaped distribution, then the sample mean and sample standard deviation are natural choices with nice mathematical properties. However, if the data have an unusual or skewed shape with several extreme values, perhaps the more resistant choices among the \(IQR\) or \(MAD\) would be more appropriate.
</p>
<p>
However, once we are looking at the three numbers it is important to understand that the estimators are not all measuring the same quantity, on the average. In particular, it can be shown that when the data follow an approximately bell-shaped distribution, then on the average, the sample standard deviation \(s\) and the \(MAD\) will be the approximately the same value, namely, \(\sigma\), but the \(IQR\) will be on the average 1.349 times larger than \(s\) and the \(MAD\). See <a href="#sec-8">Sampling Distributions</a> for more details.
</p>
</div>

</div>

<div id="outline-container-3-3-4-5" class="outline-5">
<h5 id="sec-3-3-4-5"><span class="section-number-5">3.3.4.5</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-3-4-5">


<p>
<b>At the command prompt</b>
we may compute the sample range with <code>range(x)</code> and the sample variance with <code>var(x)</code>, where <code>x</code> is a numeric vector. The sample standard deviation is <code>sqrt(var(x))</code> or just <code>sd(x)</code>. The \(IQR\) is <code>IQR(x)</code> and the median absolute deviation is <code>mad(x)</code>.
</p>
<p>
<b>With the R Commander</b>
we can calculate the sample standard deviation with the <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Numerical Summaries...</code> combination. \(\mathsf{R}\) Commander does not calculate the \(IQR\) or \(MAD\) in any of the menu selections, by default.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-Measures-of-Shape" class="outline-4">
<h4 id="sub-Measures-of-Shape"><a name="sec-3-3-5" id="sec-3-3-5"></a><span class="section-number-4">3.3.5</span> Measures of Shape</h4>
<div class="outline-text-4" id="text-sub-Measures-of-Shape">



</div>

<div id="outline-container-3-3-5-1" class="outline-5">
<h5 id="sec-3-3-5-1"><span class="section-number-5">3.3.5.1</span> Sample Skewness</h5>
<div class="outline-text-5" id="text-3-3-5-1">


<p>
The <i>sample skewness</i>, denoted by \(g_{1}\), is defined by the formula
\begin{equation}
g_{1}=\frac{1}{n}\frac{\sum_{i=1}^{n}(x_{i}-\overline{x})^{3}}{s^{3}}.
\end{equation}
The sample skewness can be any value \(-\infty&lt;g_{1}&lt;\infty\). The sign of \(g_{1}\) indicates the direction of skewness of the distribution. Samples that have \(g_{1}&gt;0\) indicate right-skewed distributions (or positively skewed), and samples with \(g_{1}&lt;0\) indicate left-skewed distributions (or negatively skewed). Values of \(g_{1}\) near zero indicate a symmetric distribution. These are not hard and fast rules, however. The value of \(g_{1}\) is subject to sampling variability and thus only provides a suggestion to the skewness of the underlying distribution. 
</p>
<p>
We still need to know how big is ``big'', that is, how do we judge whether an observed value of \(g_{1}\) is far enough away from zero for the data set to be considered skewed to the right or left? A good rule of thumb is that data sets with skewness larger than \(2\sqrt{6/n}\) in magnitude are substantially skewed, in the direction of the sign of \(g_{1}\). See Tabachnick &amp; Fidell \cite{Tabachnick2006} for details.
</p>
</div>

</div>

<div id="outline-container-3-3-5-2" class="outline-5">
<h5 id="sec-3-3-5-2"><span class="section-number-5">3.3.5.2</span> Sample Excess Kurtosis</h5>
<div class="outline-text-5" id="text-3-3-5-2">


<p>
The <i>sample excess kurtosis</i>, denoted by \(g_{2}\), is given by the formula
\begin{equation}
g_{2}=\frac{1}{n}\frac{\sum_{i=1}^{n}(x_{i}-\overline{x})^{4}}{s^{4}}-3.
\end{equation}
The sample excess kurtosis takes values \(-2\leq g_{2}&lt;\infty\). The subtraction of 3 may seem mysterious but it is done so that mound shaped samples have values of \(g_{2}\) near zero. Samples with \(g_{2}&gt;0\) are called <i>leptokurtic</i>, and samples with \(g_{2}&lt;0\) are called <i>platykurtic</i>. Samples with \(g_{2}\approx0\) are called <i>mesokurtic</i>.
</p>
<p>
As a rule of thumb, if \(|g_{2}|&gt;4\sqrt{6/n}\) then the sample excess kurtosis is substantially different from zero in the direction of the sign of \(g_{2}\). See Tabachnick &amp; Fidell \cite{Tabachnick2006} for details.
</p>
<p>
Notice that both the sample skewness and the sample kurtosis are invariant with respect to location and scale, that is, the values of \(g_{1}\) and \(g_{2}\) do not depend on the measurement units of the data. 
</p>
</div>

</div>

<div id="outline-container-3-3-5-3" class="outline-5">
<h5 id="sec-3-3-5-3"><span class="section-number-5">3.3.5.3</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-3-5-3">


<p>
The <code>e1071</code> package \cite{Dimitriadoue1071} has the <code>skewness</code> function for the sample skewness and the <code>kurtosis</code> function for the sample excess kurtosis. Both functions have a <code>na.rm</code> argument which is <code>FALSE</code> by default.
</p>

<div class="exampletoo">
<p>We said earlier that the <code>discoveries</code> data looked positively skewed; let's see what the statistics say:
</p>
</div>




<pre class="src src-R">skewness(discoveries)
2*sqrt(6/length(discoveries))
</pre>


<pre class="example">
[1] 1.2076
[1] 0.4898979
</pre>


<p>
The data are definitely skewed to the right. Let us check the sample excess kurtosis of the <code>UKDriverDeaths</code> data:
</p>



<pre class="src src-R">kurtosis(UKDriverDeaths)
4*sqrt(6/length(UKDriverDeaths))
</pre>


<pre class="example">
[1] 0.07133848
[1] 0.7071068
</pre>


<p>
so that the <code>UKDriverDeaths</code> data appear to be mesokurtic, or at least not substantially leptokurtic.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Exploratory-Data-Analysis" class="outline-3">
<h3 id="sec-Exploratory-Data-Analysis"><a name="sec-3-4" id="sec-3-4"></a><span class="section-number-3">3.4</span> Exploratory Data Analysis</h3>
<div class="outline-text-3" id="text-sec-Exploratory-Data-Analysis">


<p>
This field was founded (mostly) by John Tukey (1915-2000). Its tools are useful when not much is known regarding the underlying causes associated with the data set, and are often used for checking assumptions. For example, suppose we perform an experiment and collect some data&hellip; now what? We look at the data using exploratory visual tools.
</p>

</div>

<div id="outline-container-3-4-1" class="outline-4">
<h4 id="sec-3-4-1"><span class="section-number-4">3.4.1</span> More About Stemplots</h4>
<div class="outline-text-4" id="text-3-4-1">


<p>
There are many bells and whistles associated with stemplots, and the <code>stem.leaf</code> function can do many of them.
</p>
<dl>
<dt>Trim Outliers:</dt><dd>Some data sets have observations that fall far from the bulk of the other data (in a sense made more precise in Section <a href="#sec-3-4-4">Outliers</a>). These extreme observations often obscure the underlying structure to the data and are best left out of the data display. The <code>trim.outliers</code> argument (which is <code>TRUE</code> by default) will separate the extreme observations from the others and graph the stemplot without them; they are listed at the bottom (respectively, top) of the stemplot with the label <code>HI</code> (respectively <code>LO</code>). 

</dd>
<dt>Split Stems:</dt><dd>The standard stemplot has only one line per stem, which means that all observations with first digit <code>3</code> are plotted on the same line, regardless of the value of the second digit. But this gives some stemplots a ``skyscraper'' appearance, with too many observations stacked onto the same stem. We can often fix the display by increasing the number of lines available for a given stem. For example, we could make two lines per stem, say, <code>3*</code> and <code>3.</code>. Observations with second digit 0 through 4 would go on the upper line, while observations with second digit 5 through 9 would go on the lower line. (We could do a similar thing with five lines per stem, or even ten lines per stem.) The end result is a more spread out stemplot which often looks better. A good example of this was shown on page \pageref{exa-stemleaf-multiple-lines-stem}. 

</dd>
<dt>Depths:</dt><dd>these are used to give insight into the balance of the observations as they accumulate toward the median. In a column beside the standard stemplot, the frequency of the stem containing the sample median is shown in parentheses. Next, frequencies are accumulated from the outside inward, including the outliers. Distributions that are more symmetric will have better balanced depths on either side of the sample median.
</dd>
</dl>



</div>

<div id="outline-container-3-4-1-1" class="outline-5">
<h5 id="sec-3-4-1-1"><span class="section-number-5">3.4.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-4-1-1">


<p>
The basic command is <code>stem(x)</code> or a more sophisticated version written by Peter Wolf called <code>stem.leaf(x)</code> in the \(\mathsf{R}\) Commander. We will describe <code>stem.leaf</code> since that is the one used by \(\mathsf{R}\) Commander.
</p>

<p>
WARNING: Sometimes when making a stem plot the result will not be what you expected. There are several reasons for this: 
</p><ul>
<li>Stemplots by default will trim extreme observations (defined in Section <a href="#sec-3-4-4">Outliers</a>) from the display. This in some cases will result in stemplots that are not as wide as expected.
</li>
<li>The leafs digit is chosen automatically by <code>stem.leaf</code> according to an algorithm that the computer believes will represent the data well. Depending on the choice of the digit, <code>stem.leaf</code> may drop digits from the data or round the values in unexpected ways.
</li>
</ul>


<p>
Let us take a look at the <code>rivers</code> data set
<a name="ite-stemplot-rivers" id="ite-stemplot-rivers"></a>
</p>



<pre class="src src-R">stem.leaf(rivers)
</pre>



<pre class="example">1 | 2: represents 120
 leaf unit: 10
            n: 141
    1     1 | 3
   29     2 | 0111133334555556666778888899
   64     3 | 00000111122223333455555666677888999
  (18)    4 | 011222233344566679
   59     5 | 000222234467
   47     6 | 0000112235789
   34     7 | 12233368
   26     8 | 04579
   21     9 | 0008
   17    10 | 035
   14    11 | 07
   12    12 | 047
    9    13 | 0
HI: 1450 1459 1770 1885 2315 2348 2533 3710
</pre>


<p>
The stemplot shows a right-skewed shape to the <code>rivers</code> data distribution. Notice that the last digit of each of the data values were dropped from the display. Notice also that there were eight extreme observations identified by the computer, and their exact values are listed at the bottom of the stemplot. Look at the scale on the left of the stemplot and try to imagine how ridiculous the graph would have looked had we tried to include enough stems to include these other eight observations; the stemplot would have stretched over several pages. Notice finally that we can use the depths to approximate the sample median for these data. The median lies in the row identified by <code>(18)</code>, which means that the median is the average of the ninth and tenth observation on that row. Those two values correspond to <code>43</code> and <code>43</code>, so a good guess for the median would be 430. (For the record, the sample median is \(\widetilde{x}=425\). Recall that stemplots round the data to the nearest stem-leaf pair.) 
</p>
<p>
Next let us see what the <code>precip</code> data look like.
</p>



<pre class="src src-R">stem.leaf(precip)
</pre>



<pre class="example">1 | 2: represents 12
 leaf unit: 1
            n: 70
LO: 7 7.2 7.8 7.8
    8    1* | 1344
   13    1. | 55677
   16    2* | 024
   18    2. | 59
   28    3* | 0000111234
  (15)   3. | 555566677788899
   27    4* | 0000122222334
   14    4. | 56688899
    6    5* | 44
    4    5. | 699
HI: 67
</pre>


<p>
Here is an example of split stems, with two lines per stem. The final digit of each datum has been dropped for the display. The data appear to be left skewed with four extreme values to the left and one extreme value to the right. The sample median is approximately 37 (it turns out to be 36.6).
</p>
</div>
</div>

</div>

<div id="outline-container-sub-hinges-and-5NS" class="outline-4">
<h4 id="sub-hinges-and-5NS"><a name="sec-3-4-2" id="sec-3-4-2"></a><span class="section-number-4">3.4.2</span> Hinges and the Five Number Summary</h4>
<div class="outline-text-4" id="text-sub-hinges-and-5NS">


<p>
Given a data set \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\), the hinges are found by the following method:  
</p><ul>
<li>Find the order statistics \(x_{(1)}\), \(x_{(2)}\), &hellip;, \(x_{(n)}\). 
</li>
<li>The <i>lower hinge</i> \(h_{L}\) is in position \(L=\left\lfloor (n+3)/2\right\rfloor / 2\), where the symbol \( \left\lfloor x\right\rfloor \) denotes the largest integer less than or equal to \(x\). If the position \(L\) is not an integer, then the hinge \(h_{L}\) is the average of the adjacent order statistics. 
</li>
<li>The <i>upper hinge</i> \(h_{U}\) is in position \(n+1-L\).
</li>
</ul>

<p>Given the hinges, the <i>five number summary</i> (\(5NS\)) is 
\begin{equation} 
5NS=(x_{(1)},\ h_{L},\ \tilde{x},\ h_{U},\ x_{(n)}).
\end{equation}
An advantage of the \(5NS\) is that it reduces a potentially large data set to a shorter list of only five numbers, and further, these numbers give insight regarding the shape of the data distribution similar to the sample quantiles in Section <a href="#sec-3-3-3">Order Statistics</a>.
</p>

</div>

<div id="outline-container-3-4-2-1" class="outline-5">
<h5 id="sec-3-4-2-1"><span class="section-number-5">3.4.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-4-2-1">


<p>
If the data are stored in a vector <code>x</code>, then you can compute the \(5NS\) with the <code>fivenum</code> function.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-boxplots" class="outline-4">
<h4 id="sub-boxplots"><a name="sec-3-4-3" id="sec-3-4-3"></a><span class="section-number-4">3.4.3</span> Boxplots</h4>
<div class="outline-text-4" id="text-sub-boxplots">


<p>
A boxplot is essentially a graphical representation of the \(5NS\). It can be a handy alternative to a stripchart when the sample size is large.
</p>
<p>
A boxplot is constructed by drawing a box alongside the data axis with sides located at the upper and lower hinges. A line is drawn parallel to the sides to denote the sample median. Lastly, whiskers are extended from the sides of the box to the maximum and minimum data values (more precisely, to the most extreme values that are not potential outliers, defined below).
</p>
<p>
Boxplots are good for quick visual summaries of data sets, and the relative positions of the values in the \(5NS\) are good at indicating the underlying shape of the data distribution, although perhaps not as effectively as a histogram. Perhaps the greatest advantage of a boxplot is that it can help to objectively identify extreme observations in the data set as described in the next section.
</p>
<p>
Boxplots are also good because one can visually assess multiple features of the data set simultaneously:
</p>
<dl>
<dt>Center</dt><dd>can be estimated by the sample median, \(\tilde{x}\).

</dd>
<dt>Spread</dt><dd>can be judged by the width of the box, \(h_{U}-h_{L}\). We know that this will be close to the \(IQR\), which can be compared to \(s\) and the \(MAD\), perhaps after rescaling if appropriate.

</dd>
<dt>Shape</dt><dd>is indicated by the relative lengths of the whiskers, and the position of the median inside the box. Boxes with unbalanced whiskers indicate skewness in the direction of the long whisker. Skewed distributions often have the median tending in the opposite direction of skewness. Kurtosis can be assessed using the box and whiskers. A wide box with short whiskers will tend to be platykurtic, while a skinny box with wide whiskers indicates leptokurtic distributions.

</dd>
<dt>Extreme observations</dt><dd>are identified with open circles (see below).
</dd>
</dl>


</div>

</div>

<div id="outline-container-sub-Outliers" class="outline-4">
<h4 id="sub-Outliers"><a name="sec-3-4-4" id="sec-3-4-4"></a><span class="section-number-4">3.4.4</span> Outliers</h4>
<div class="outline-text-4" id="text-sub-Outliers">


<p>
A <i>potential outlier</i> is any observation that falls beyond 1.5 times the width of the box on either side, that is, any observation less than \(h_{L}-1.5(h_{U}-h_{L})\) or greater than \(h_{U}+1.5(h_{U}-h_{L})\). A <i>suspected outlier</i> is any observation that falls beyond 3 times the width of the box on either side. In \(\mathsf{R}\), both potential and suspected outliers (if present) are denoted by open circles; there is no distinction between the two. 
</p>
<p>
When potential outliers are present, the whiskers of the boxplot are then shortened to extend to the most extreme observation that is not a potential outlier. If an outlier is displayed in a boxplot, the index of the observation may be identified in a subsequent plot in <code>Rcmdr</code> by clicking the <code>Identify outliers with mouse</code> option in the <code>Boxplot</code> dialog.
</p>
<p>
What do we do about outliers? They merit further investigation. The primary goal is to determine why the observation is outlying, if possible. If the observation is a typographical error, then it should be corrected before continuing. If the observation is from a subject that does not belong to the population of interest, then perhaps the datum should be removed. Otherwise, perhaps the value is hinting at some hidden structure to the data.
</p>

</div>

<div id="outline-container-3-4-4-1" class="outline-5">
<h5 id="sec-3-4-4-1"><span class="section-number-5">3.4.4.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-4-4-1">


<p>
The quickest way to visually identify outliers is with a boxplot, described above. Another way is with the <code>boxplot.stats</code> function.
</p>

<div class="exampletoo">
<p>The <code>rivers</code> data. We will look for potential outliers in the <code>rivers</code> data.
</p>



<pre class="src src-R">boxplot.stats(rivers)$out
</pre>


<p>
We may change the <code>coef</code> argument to 3 (it is 1.5 by default) to identify suspected outliers.
</p>



<pre class="src src-R">boxplot.stats(rivers, coef = 3)$out
</pre>



</div>

</div>
</div>

</div>

<div id="outline-container-3-4-5" class="outline-4">
<h4 id="sec-3-4-5"><span class="section-number-4">3.4.5</span> Standardizing variables</h4>
<div class="outline-text-4" id="text-3-4-5">


<p>
It is sometimes useful to compare data sets with each other on a scale that is independent of the measurement units. Given a set of observed data \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\) we get \(z\) scores, denoted \(z_{1}\), \(z_{2}\), &hellip;, \(z_{n}\), by means of the following formula
\[
z_{i}=\frac{x_{i}-\overline{x}}{s},\quad i=1,\,2,\,\ldots,\, n.
\]

</p>
</div>

<div id="outline-container-3-4-5-1" class="outline-5">
<h5 id="sec-3-4-5-1"><span class="section-number-5">3.4.5.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-3-4-5-1">


<p>
The <code>scale</code> function will rescale a numeric vector (or data frame) by subtracting the sample mean from each value (column) and/or by dividing each observation by the sample standard deviation.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-multivariate-data" class="outline-3">
<h3 id="sec-multivariate-data"><a name="sec-3-5" id="sec-3-5"></a><span class="section-number-3">3.5</span> Multivariate Data and Data Frames</h3>
<div class="outline-text-3" id="text-sec-multivariate-data">


<p>
We have had experience with vectors of data, which are long lists of numbers. Typically, each entry in the vector is a single measurement on a subject or experimental unit in the study. We saw in Section <a href="#sec-2-3-3">Vectors</a> how to form vectors with the <code>c</code> function or the <code>scan</code> function. 
</p>
<p>
However, statistical studies often involve experiments where there are two (or more) measurements associated with each subject. We display the measured information in a rectangular array in which each row corresponds to a subject, and the columns contain the measurements for each respective variable. For instance, if one were to measure the height and weight and hair color of each of 11 persons in a research study, the information could be represented with a rectangular array. There would be 11 rows. Each row would have the person's height in the first column and hair color in the second column.
</p>
<p>
The corresponding objects in \(\mathsf{R}\) are called <i>data frames</i>, and they can be constructed with the <code>data.frame</code> function. Each row is an observation, and each column is a variable.
</p>

<div class="exampletoo">
<p>Suppose we have two vectors <code>x</code> and <code>y</code> and we want to make a data frame out of them.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 5:8
y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> letters[3:6]
A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(v1 = x, v2 = y)
</pre>



</div>

<p>
Notice that <code>x</code> and <code>y</code> are the same length. This is <i>necessary</i>. Also notice that <code>x</code> is a numeric vector and <code>y</code> is a character vector. We may choose numeric and character vectors (or even factors) for the columns of the data frame, but each column must be of exactly one type. That is, we can have a column for <code>height</code> and a column for <code>gender</code>, but we will get an error if we try to mix function <code>height</code> (numeric) and <code>gender</code> (character or factor) information in the same column.
</p>
<p>
Indexing of data frames is similar to indexing of vectors. To get the entry in row \(i\) and column \(j\) do <code>A[i,j]</code>. We can get entire rows and columns by omitting the other index. 
</p>



<pre class="src src-R">A[3, ]
A[1, ]
A[ , 2]
</pre>



<p>
There are several things happening above. Notice that <code>A[3,]</code> gave a data frame (with the same entries as the third row of <code>A</code>) yet <code>A[1, ]</code> is a numeric vector. <code>A[ ,2]</code> is a factor vector because the default setting for <code>data.frame</code> is <code>stringsAsFactors = TRUE</code>.
</p>
<p>
Data frames have a <code>names</code> attribute and the names may be extracted with the <code>names</code> function. Once we have the names we may extract given columns by way of the dollar sign.
</p>



<pre class="src src-R">names(A)
A$v1
</pre>



<p>
The above is identical to <code>A[ ,1]</code>. 
</p>

</div>

<div id="outline-container-sub-Bivariate-Data" class="outline-4">
<h4 id="sub-Bivariate-Data"><a name="sec-3-5-1" id="sec-3-5-1"></a><span class="section-number-4">3.5.1</span> Bivariate Data</h4>
<div class="outline-text-4" id="text-sub-Bivariate-Data">


<ul>
<li>Stacked bar charts
</li>
<li>odds ratio and relative risk
</li>
<li>Introduce the sample correlation coefficient.
</li>
</ul>


<p>
The <b>sample Pearson product-moment correlation coefficient</b>:
</p>


\[
r=\frac{\sum_{i=1}^{n}(x_{i}-\overline{x})(y_{i}-\overline{y})}{\sqrt{\sum_{i=1}^{n}(x_{i}-\overline{x})}\sqrt{\sum_{i=1}^{n}(y_{i}-\overline{y})}}
\]

<ul>
<li>independent of scale
</li>
<li>\(-1&lt; r &lt;1\)
</li>
<li>measures <i>strength</i> and <i>direction</i> of linear association
</li>
<li>Two-Way Tables. Done with <code>table</code>, or in the \(\mathsf{R}\) Commander by following <code>Statistics</code> \(\triangleright\) <code>Contingency Tables</code> \(\triangleright\)} <code>Two-way Tables</code>. You can also enter and analyze a two-way table.
<ul>
<li>table
</li>
<li>prop.table
</li>
<li>addmargins
</li>
<li>rowPercents (Rcmdr)
</li>
<li>colPercents (Rcmdr)
</li>
<li>totPercents(Rcmdr)
</li>
<li>A &lt;- xtabs(~ gender + race, data = RcmdrTestDrive)
</li>
<li>xtabs( Freq ~ Class + Sex, data = Titanic) from built in table
</li>
<li>barplot(A, legend.text=TRUE) 
</li>
<li>barplot(t(A), legend.text=TRUE) 
</li>
<li>barplot(A, legend.text=TRUE, beside = TRUE)
</li>
<li>spineplot(gender ~ race, data = RcmdrTestDrive)
</li>
<li>Spine plot: plots categorical versus categorical
</li>
</ul>

</li>
</ul>



<ul>
<li>Scatterplot: look for linear association and correlation. 
<ul>
<li>carb ~ optden, data = Formaldehyde (boring)
</li>
<li>conc ~ rate, data = Puromycin
</li>
<li>xyplot(accel ~ dist, data = attenu) nonlinear association
</li>
<li>xyplot(eruptions ~ waiting, data = faithful) (linear, two groups)
</li>
<li>xyplot(Petal.Width ~ Petal.Length, data = iris)
</li>
<li>xyplot(pressure ~ temperature, data = pressure) (exponential growth)
</li>
<li>xyplot(weight ~ height, data = women) (strong positive linear)
</li>
</ul>

</li>
</ul>


</div>

</div>

<div id="outline-container-sub-Multivariate-Data" class="outline-4">
<h4 id="sub-Multivariate-Data"><a name="sec-3-5-2" id="sec-3-5-2"></a><span class="section-number-4">3.5.2</span> Multivariate Data</h4>
<div class="outline-text-4" id="text-sub-Multivariate-Data">


<p>
Multivariate Data Display
</p>
<ul>
<li>Multi-Way Tables. You can do this with <code>table</code>,
</li>
</ul>

<p>or in \(\mathsf{R}\) Commander by following <code>Statistics</code> \(\triangleright\) <code>Contingency Tables</code> \(\triangleright\) <code>Multi-way Tables</code>.
</p><ul>
<li>Scatterplot matrix. used for displaying pairwise scatterplots simultaneously. Again, look for linear association and correlation.
</li>
<li>3D Scatterplot. See Figure <a href="#fig-3D-scatterplot-trees">3D-scatterplot-trees</a>
</li>
<li><code>plot(state.region, state.division)</code> 
</li>
<li><code>barplot(table(state.division,state.region), legend.text=TRUE)</code>
</li>
</ul>




</div>
</div>

</div>

<div id="outline-container-sec-Comparing-Data-Sets" class="outline-3">
<h3 id="sec-Comparing-Data-Sets"><a name="sec-3-6" id="sec-3-6"></a><span class="section-number-3">3.6</span> Comparing Populations</h3>
<div class="outline-text-3" id="text-sec-Comparing-Data-Sets">


<p>
Sometimes we have data from two or more groups (or populations) and we would like to compare them and draw conclusions. Some issues that we would like to address:
</p>
<ul>
<li>Comparing centers and spreads: variation within versus between groups
</li>
<li>Comparing clusters and gaps
</li>
<li>Comparing outliers and unusual features
</li>
<li>Comparing shapes.
</li>
</ul>



</div>

<div id="outline-container-3-6-1" class="outline-4">
<h4 id="sec-3-6-1"><span class="section-number-4">3.6.1</span> Numerically</h4>
<div class="outline-text-4" id="text-3-6-1">


<p>
I am thinking here about the <code>Statistics</code> \(\triangleright\) <code>Numerical Summaries</code> \(\triangleright\) <code>Summarize by groups</code> option or the <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Table of Statistics</code> option. 
</p>
</div>

</div>

<div id="outline-container-3-6-2" class="outline-4">
<h4 id="sec-3-6-2"><span class="section-number-4">3.6.2</span> Graphically</h4>
<div class="outline-text-4" id="text-3-6-2">


<ul>
<li>Boxplots
<ul>
<li>Variable width: the width of the drawn boxplots are proportional to \(\sqrt{n_{i}}\), where \(n_{i}\) is the size of the \(i^{\mathrm{th}}\) group. Why? Because many statistics have variability proportional to the reciprocal of the square root of the sample size.
</li>
<li>Notches: extend to \(1.58\cdot(h_{U}-h_{L})/\sqrt{n}\). The idea is to give roughly a 95% confidence interval for the difference in two medians. See Chapter <a href="#sec-10">Hypothesis Testing</a>.
</li>
</ul>

</li>
<li>Stripcharts
<ul>
<li>stripchart(weight ~ feed, method= "stack", data=chickwts) 
</li>
</ul>

</li>
<li>Bar Graphs
<ul>
<li>barplot(xtabs(Freq ~ Admit + Gender, data = UCBAdmissions)) stacked bar chart
</li>
<li>barplot(xtabs(Freq ~ Admit, data = UCBAdmissions))
</li>
<li>barplot(xtabs(Freq ~ Gender + Admit, data = UCBAdmissions, legend = TRUE, beside = TRUE)  oops, discrimination.
</li>
<li>barplot(xtabs(Freq ~ Admit+Dept, data = UCBAdmissions), legend = TRUE, beside = TRUE) different departments have different standards
</li>
<li>barplot(xtabs(Freq ~ Gender+Dept, data = UCBAdmissions), legend = TRUE, beside = TRUE) men mostly applied to easy departments, women mostly applied to difficult departments
</li>
<li>barplot(xtabs(Freq ~ Gender+Dept, data = UCBAdmissions), legend = TRUE, beside = TRUE)
</li>
<li>barchart(Admit ~ Freq, data = C)
</li>
<li>barchart(Admit ~ Freq|Gender, data = C)
</li>
<li>barchart(Admit ~ Freq | Dept, groups = Gender, data = C)
</li>
<li>barchart(Admit ~ Freq | Dept, groups = Gender, data = C, auto.key = TRUE)

</li>
</ul>

</li>
<li>Histograms
<ul>
<li>~ breaks | wool{*}tension, data = warpbreaks
</li>
<li>~ weight | feed, data = chickwts
</li>
<li>~ weight | group, data = PlantGrowth 
</li>
<li>~ count | spray, data = InsectSprays
</li>
<li>~ len | dose, data = ToothGrowth
</li>
<li>~ decrease | treatment, data = OrchardSprays (or rowpos or colpos)

</li>
</ul>

</li>
<li>Scatterplots
</li>
</ul>





<pre class="src src-R">xyplot(Petal.Width ~ Petal.Length, data = iris, group = Species)
</pre>









<div id="fig-xyplot-group" class="figure">
  <p><img src="svg/datadesc/xyplot-group.svg" width=500 alt="svg/datadesc/xyplot-group.svg" /></p>
  <p>Thre  <code>overplot</code> method.</p>
</div>

<ul>
<li>Scatterplot matrices
<ul>
<li>splom( ~ cbind(GNP.deflator,GNP,Unemployed,Armed.Forces,Population,Year,Employed),  data = longley) 
</li>
<li>splom( ~ cbind(pop15,pop75,dpi), data = LifeCycleSavings)
</li>
<li>splom( ~ cbind(Murder, Assault, Rape), data = USArrests)
</li>
<li>splom( ~ cbind(CONT, INTG, DMNR), data = USJudgeRatings)
</li>
<li>splom( ~ cbind(area,peri,shape,perm), data = rock)
</li>
<li>splom( ~ cbind(Air.Flow, Water.Temp, Acid.Conc., stack.loss), data = stackloss)
</li>
<li>splom( ~ cbind(Fertility,Agriculture,Examination,Education,Catholic,Infant.Mortality), data = swiss)
</li>
<li>splom(~ cbind(Fertility,Agriculture,Examination), data = swiss) (positive and negative)

</li>
</ul>

</li>
<li>Dot charts
<ul>
<li>dotchart(USPersonalExpenditure)
</li>
<li>dotchart(t(USPersonalExpenditure))
</li>
<li>dotchart(WorldPhones) (transpose is no good)
</li>
<li>freeny.x is no good, neither is volcano
</li>
<li>dotchart(UCBAdmissions{[},,1{]})
</li>
<li>dotplot(Survived ~ Freq | Class, groups = Sex, data = B)
</li>
<li>dotplot(Admit ~ Freq | Dept, groups = Gender, data = C)

</li>
</ul>

</li>
<li>Mosaic plot
<ul>
<li>mosaic( ~ Survived + Class + Age + Sex, data = Titanic) (or just mosaic(Titanic))
</li>
<li>mosaic( ~ Admit + Dept + Gender, data = UCBAdmissions)

</li>
</ul>

</li>
<li>Spine plots
<ul>
<li>spineplot(xtabs(Freq ~ Admit + Gender, data = UCBAdmissions))
</li>
<li># rescaled barplot

</li>
</ul>

</li>
<li>Quantile-quantile plots: There are two ways to do this. One way is to compare two independent samples (of the same size). qqplot(x,y). Another way is to compare the sample quantiles of one variable to the theoretical quantiles of another distribution. 
</li>
</ul>



<p>
Given two samples \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\), and \(y_{1}\), \(y_{2}\), &hellip;, \(y_{n}\), we may find the order statistics \(x_{(1)}\leq x_{(2)}\leq\cdots\leq x_{(n)}\) and \(y_{(1)}\leq y_{(2)}\leq\cdots\leq y_{(n)}\). Next, plot the \(n\) points \((x_{(1)},y_{(1)})\), \((x_{(2)},y_{(2)})\), &hellip;, \((x_{(n)},y_{(n)})\).
</p>
<p>
It is clear that if \(x_{(k)}=y_{(k)}\) for all \(k=1,2,\ldots,n\), then we will have a straight line. It is also clear that in the real world, a straight line is NEVER observed, and instead we have a scatterplot that hopefully had a general linear trend. What do the rules tell us? 
</p>
<ul>
<li>If the \(y\)-intercept of the line is greater (less) than zero, then the center of the \(Y\) data is greater (less) than the center of the \(X\) data.

</li>
<li>If the slope of the line is greater (less) than one, then the spread of the \(Y\) data is greater (less) than the spread of the \(X\) data.
</li>
</ul>


</div>

</div>

<div id="outline-container-sub-Lattice-Graphics" class="outline-4">
<h4 id="sub-Lattice-Graphics"><a name="sec-3-6-3" id="sec-3-6-3"></a><span class="section-number-4">3.6.3</span> Lattice Graphics</h4>
<div class="outline-text-4" id="text-sub-Lattice-Graphics">


<p>
The following types of plots are useful when there is one variable of interest and there is a factor in the data set by which the variable is categorized. 
</p>
<p>
It is sometimes nice to set <code>lattice.options(default.theme = "col.whitebg")</code>
</p>

</div>

<div id="outline-container-3-6-3-1" class="outline-5">
<h5 id="sec-3-6-3-1"><span class="section-number-5">3.6.3.1</span> Side by side boxplots</h5>
<div class="outline-text-5" id="text-3-6-3-1">





<pre class="src src-R">bwplot(~weight | feed, data = chickwts)
</pre>









<div id="fig-bwplot" class="figure">
  <p><img src="svg/datadesc/bwplot.svg" width=500 alt="svg/datadesc/bwplot.svg" /></p>
  <p>Boxplots of <code>weight</code> by <code>feed</code> type in the <code>chickwts</code> data.</p>
</div>

</div>

</div>

<div id="outline-container-3-6-3-2" class="outline-5">
<h5 id="sec-3-6-3-2"><span class="section-number-5">3.6.3.2</span> Histograms</h5>
<div class="outline-text-5" id="text-3-6-3-2">





<pre class="src src-R">histogram(~age | education, data = infert)
</pre>









<div id="fig-histograms-lattice" class="figure">
  <p><img src="svg/datadesc/histograms-lattice.svg" width=500 alt="svg/datadesc/histograms-lattice.svg" /></p>
  <p>Histograms of <code>age</code> by <code>education</code> level from the <code>infert</code> data.</p>
</div>

</div>

</div>

<div id="outline-container-3-6-3-3" class="outline-5">
<h5 id="sec-3-6-3-3"><span class="section-number-5">3.6.3.3</span> Scatterplots</h5>
<div class="outline-text-5" id="text-3-6-3-3">





<pre class="src src-R">xyplot(Petal.Length ~ Petal.Width | Species, data = iris)
</pre>









<div id="fig-xyplot" class="figure">
  <p><img src="svg/datadesc/xyplot.svg" width=500 alt="svg/datadesc/xyplot.svg" /></p>
  <p>An <code>xyplot</code> of <code>Petal.Length</code> versus <code>Petal.Width</code> by <code>Species</code> in the <code>iris</code> data.</p>
</div>

</div>

</div>

<div id="outline-container-3-6-3-4" class="outline-5">
<h5 id="sec-3-6-3-4"><span class="section-number-5">3.6.3.4</span> Coplots</h5>
<div class="outline-text-5" id="text-3-6-3-4">





<pre class="src src-R">coplot(conc ~ uptake | Type * Treatment, data = CO2)
</pre>









<div id="fig-coplot" class="figure">
  <p><img src="svg/datadesc/coplot.svg" width=500 alt="svg/datadesc/coplot.svg" /></p>
  <p>A <code>coplot</code> of <code>conc</code> versus <code>uptake</code> by <code>Type</code> and <code>Treatment</code> in the <code>CO2</code> data.</p>
</div>



</div>
</div>
</div>

</div>

<div id="outline-container-3-7" class="outline-3">
<h3 id="sec-3-7"><span class="section-number-3">3.7</span> Some Remarks about Plotting</h3>
<div class="outline-text-3" id="text-3-7">


<p>
Getting your labels to look right
</p>




</div>

</div>

<div id="outline-container-3-8" class="outline-3">
<h3 id="sec-3-8"><span class="section-number-3">3.8</span> Exercises</h3>
<div class="outline-text-3" id="text-3-8">


<p>
Open \(\mathsf{R}\) and issue the following commands at the command line to get started. Note that you need to have the <code>RcmdrPlugin.IPSUR</code> package installed, and for some exercises you need the <code>e1071</code> package.
</p>



<pre class="src src-R"><span style="font-weight: bold; text-decoration: underline;">library</span>(<span style="font-style: italic;">"RcmdrPlugin.IPSUR"</span>)
data(RcmdrTestDrive)
<span style="font-weight: bold; text-decoration: underline;">attach</span>(RcmdrTestDrive)
names(RcmdrTestDrive)
</pre>


<p>
To load the data in the \(\mathsf{R}\) Commander (<code>Rcmdr</code>), click the <code>Data Set</code> button, and select <code>RcmdrTestDrive</code> as the active data set. To learn more about the data set and where it comes from, type <code>?RcmdrTestDrive</code> at the command line.
</p>

<div class="xca">
<p><a name="xca-summary-RcmdrTestDrive" id="xca-summary-RcmdrTestDrive"></a>
</p>
<p>
Perform a summary of all variables in <code>RcmdrTestDrive</code>. You can do this with the command <code>summary(RcmdrTestDrive)</code>.
</p>
<p>
Alternatively, you can do this in the <code>Rcmdr</code> with the sequence <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Active Data Set</code>. Report the values of the summary statistics for each variable.
</p>
</div>


<div class="xca">
<p>Make a table of the <code>race</code> variable. Do this with <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Frequency Distributions - IPSUR...</code>
</p><ol>
<li>Which ethnicity has the highest frequency?
</li>
<li>Which ethnicity has the lowest frequency?
</li>
<li>Include a bar graph of <code>race</code>. Do this with <code>Graphs</code> \(\triangleright\) <code>IPSUR - Bar Graph...</code>
</li>
</ol>



</div>


<div class="xca">
<p>Calculate the average <code>salary</code> by the factor <code>gender</code>. Do this with <code>Statistics</code> \(\triangleright\) <code>Summaries</code> \(\triangleright\) <code>Table of Statistics...</code> 
</p><ol>
<li>Which <code>gender</code> has the highest mean <code>salary</code>? 
</li>
<li>Report the highest mean <code>salary</code>.
</li>
<li>Compare the spreads for the genders by calculating the standard deviation of <code>salary</code> by <code>gender</code>. Which <code>gender</code> has the biggest standard deviation?
</li>
<li>Make boxplots of <code>salary</code> by <code>gender</code> with the following method:
<blockquote>

<p>On the <code>Rcmdr</code>, click <code>Graphs</code> \(\triangleright\) <code>IPSUR - Boxplot...</code>
In the <code>Variable</code> box, select <code>salary</code>.
Click the <code>Plot by groups...</code> box and select <code>gender</code>. Click <code>OK</code>.
Click <code>OK</code> to graph the boxplot.
</p>
</blockquote>


<p>
   How does the boxplot compare to your answers to (1) and (3)?
</p></li>
</ol>


</div>


<div class="xca">
<p>For this problem we will study the variable <code>reduction</code>.
</p><ol>
<li>Find the order statistics and store them in a vector <code>x</code>. <i>Hint:</i> <code>x &lt;- sort(reduction)</code>
</li>
<li>Find \(x_{(137)}\), the 137\(^{\mathrm{th}}\) order statistic.
</li>
<li>Find the IQR.
</li>
<li>Find the Five Number Summary (5NS).
</li>
<li>Use the 5NS to calculate what the width of a boxplot of <code>reduction</code> would be.
</li>
<li>Compare your answers (3) and (5). Are they the same? If not, are they close?
</li>
<li>Make a boxplot of <code>reduction</code>, and include the boxplot in your report. You can do this with the <code>boxplot</code> function, or in <code>Rcmdr</code> with <code>Graphs</code> \(\triangleright\) <code>IPSUR - Boxplot...</code>
</li>
<li>Are there any potential/suspected outliers? If so, list their values. <i>Hint:</i> use your answer to (a).
</li>
<li>Using the rules discussed in the text, classify answers to (8), if any, as <i>potential</i> or <i>suspected</i> outliers.
</li>
</ol>



</div>


<div class="xca">
<p>In this problem we will compare the variables <code>before</code> and <code>after</code>. Don't forget <code>library("e1071")</code>.
</p><ol>
<li>Examine the two measures of center for both variables. Judging from these measures, which variable has a higher center?
</li>
<li>Which measure of center is more appropriate for <code>before</code>? (You may want to look at a boxplot.) Which measure of center is more appropriate for <code>after</code>?
</li>
<li>Based on your answer to (2), choose an appropriate measure of spread for each variable, calculate it, and report its value. Which variable has the biggest spread? (Note that you need to make sure that your measures are on the same scale.) 
</li>
<li>Calculate and report the skewness and kurtosis for <code>before</code>. Based on these values, how would you describe the shape of <code>before</code>?
</li>
<li>Calculate and report the skewness and kurtosis for <code>after</code>. Based on these values, how would you describe the shape of <code>after</code>?
</li>
<li>Plot histograms of <code>before</code> and <code>after</code> and compare them to your answers to (4) and (5).
</li>
</ol>



</div>


<div class="xca">
<p>Describe the following data sets just as if you were communicating with an alien, but one who has had a statistics class. Mention the salient features (data type, important properties, anything special). Support your answers with the appropriate visual displays and descriptive statistics.
</p><ol>
<li>Conversion rates of Euro currencies stored in <code>euro</code>.
</li>
<li>State abbreviations stored in <code>state.abb</code>.
</li>
</ol>



</div>

</div>
</div>

</div>

<div id="outline-container-cha-Probability" class="outline-2">
<h2 id="cha-Probability"><a name="sec-4" id="sec-4"></a><span class="section-number-2">4</span> Probability</h2>
<div class="outline-text-2" id="text-cha-Probability">




<p>
In this chapter we define the basic terminology associated with probability and derive some of its properties. We discuss three interpretations of probability. We discuss conditional probability and independent events, along with Bayes' Theorem. We finish the chapter with an introduction to random variables, which paves the way for the next two chapters.
</p>
<p>
In this book we distinguish between two types of experiments: <i>deterministic</i> and <i>random</i>. A <i>deterministic</i> experiment is one whose outcome may be predicted with certainty beforehand, such as combining Hydrogen and Oxygen, or adding two numbers such as \(2+3\). A <i>random</i> experiment is one whose outcome is determined by chance. We posit that the outcome of a random experiment may not be predicted with certainty beforehand, even in principle. Examples of random experiments include tossing a coin, rolling a die, and throwing a dart on a board, how many red lights you encounter on the drive home, how many ants traverse a certain patch of sidewalk over a short period, <i>etc</i>.
</p>
<p>
 <b>What do I want them to know?</b>
</p><ul>
<li>that there are multiple interpretations of probability, and the methods used depend somewhat on the philosophy chosen 
</li>
<li>nuts and bolts of basic probability jargon: sample spaces, events, probability functions, <i>etc</i>.
</li>
<li>how to count
</li>
<li>conditional probability and its relationship with independence
</li>
<li>Bayes' Rule and how it relates to the subjective view of probability
</li>
<li>what we mean by 'random variables', and where they come from
</li>
</ul>











<div id="fig-diagram" class="figure">
  <p><img src="svg/prob/diagram.svg" width=500 alt="svg/prob/diagram.svg" /></p>
  <p>Two types of experiments.</p>
</div>


</div>

<div id="outline-container-sec-Sample-Spaces" class="outline-3">
<h3 id="sec-Sample-Spaces"><a name="sec-4-1" id="sec-4-1"></a><span class="section-number-3">4.1</span> Sample Spaces</h3>
<div class="outline-text-3" id="text-sec-Sample-Spaces">


<p>
For a random experiment \(E\), the set of all possible outcomes of \(E\) is called the <i>sample space</i>\index{sample space} and is denoted by the letter \(S\). For a coin-toss experiment, \(S\) would be the results ``Head'' and ``Tail'', which we may represent by \( S = \{H,T \} \). Formally, the performance of a random experiment is the unpredictable selection of an outcome in \(S\).
</p>

</div>

<div id="outline-container-4-1-1" class="outline-4">
<h4 id="sec-4-1-1"><span class="section-number-4">4.1.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-4-1-1">


<p>
Most of the probability work in this book is done with the <code>prob</code> package \cite{Kernsprob}. A sample space is (usually) represented by a <i>data frame</i>, that is, a rectangular collection of variables (see Section <a href="#sec-3-5-2">Multivariate Data</a>). Each row of the data frame corresponds to an outcome of the experiment. The data frame choice is convenient both for its simplicity and its compatibility with the \(\mathsf{R}\) Commander. Data frames alone are, however, not sufficient to describe some of the more interesting probabilistic applications we will study later; to handle those we will need to consider a more general <i>list</i> data structure. See Section <a href="#sec-4-6-2-1">How to <code>ps</code></a> for details.
</p>

<div class="exampletoo">
<p>Consider the random experiment of dropping a Styrofoam cup onto the floor from a height of four feet. The cup hits the ground and eventually comes to rest. It could land upside down, right side up, or it could land on its side. We represent these possible outcomes of the random experiment by the following.
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(lands = c(<span style="font-style: italic;">"down"</span>,<span style="font-style: italic;">"up"</span>,<span style="font-style: italic;">"side"</span>))
S
</pre>


<p>
The sample space <code>S</code> contains the column <code>lands</code> which stores the outcomes <code>down</code>, <code>up</code>, and <code>side</code>. 
</p>

</div>

<p>
Some sample spaces are so common that convenience wrappers were written to set them up with minimal effort. The underlying machinery that does the work includes the <code>expand.grid</code> function in the <code>base</code> package, <code>combn</code> in the <code>combinat</code> package \cite{combinat}, and <code>permsn</code> in the <code>prob</code> package
Consider the random experiment of tossing a coin. The outcomes are \(H\) and \(T\). We can set up the sample space quickly with the <code>tosscoin</code> function:
</p>



<pre class="src src-R">tosscoin(1)
</pre>


<pre class="example">
  toss1
1     H
2     T
</pre>


<p>
The number <code>1</code> tells <code>tosscoin</code> that we only want to toss the coin once. We could toss it three times: 
</p>



<pre class="src src-R">tosscoin(3)
</pre>


<pre class="example">
  toss1 toss2 toss3
1     H     H     H
2     T     H     H
3     H     T     H
4     T     T     H
5     H     H     T
6     T     H     T
7     H     T     T
8     T     T     T
</pre>


<p>
Alternatively we could roll a fair die: 
</p>



<pre class="src src-R">rolldie(1) 
</pre>


<pre class="example">
  X1
1  1
2  2
3  3
4  4
5  5
6  6
</pre>


<p>
The <code>rolldie</code> function defaults to a 6-sided die, but we can specify others with the <code>nsides</code> argument. The command <code>rolldie(3, nsides = 4)</code> would be used to roll a 4-sided die three times.
</p>
<p>
Perhaps we would like to draw one card from a standard set of playing cards (it is a long data frame):
</p>



<pre class="src src-R">head(cards()) 
</pre>


<pre class="example">
  rank suit
1    2 Club
2    3 Club
3    4 Club
4    5 Club
5    6 Club
6    7 Club
</pre>


<p>
The <code>cards</code> function that we just used has optional arguments <code>jokers</code> (if you would like Jokers to be in the deck) and <code>makespace</code> which we will discuss later. There is also a <code>roulette</code> function which returns the sample space associated with one spin on a roulette wheel. There are EU and USA versions available. Interested readers may contribute any other game or sample spaces that may be of general interest.
</p>
</div>

</div>

<div id="outline-container-sub-sampling-from-urns" class="outline-4">
<h4 id="sub-sampling-from-urns"><a name="sec-4-1-2" id="sec-4-1-2"></a><span class="section-number-4">4.1.2</span> Sampling from Urns</h4>
<div class="outline-text-4" id="text-sub-sampling-from-urns">


<p>
This is perhaps the most fundamental type of random experiment. We have an urn that contains a bunch of distinguishable objects (balls) inside. We shake up the urn, reach inside, grab a ball, and take a look. That's all.
</p>
<p>
But there are all sorts of variations on this theme. Maybe we would like to grab more than one ball &ndash; say, two balls. What are all of the possible outcomes of the experiment now? It depends on how we sample. We could select a ball, take a look, put it back, and sample again. Another way would be to select a ball, take a look &ndash; but do not put it back &ndash; and sample again (equivalently, just reach in and grab two balls). There are certainly more possible outcomes of the experiment in the former case than in the latter. In the first (second) case we say that sampling is done <i>with (without) replacement</i>.
</p>
<p>
There is more. Suppose we do not actually keep track of which ball came first. All we observe are the two balls, and we have no idea about the order in which they were selected. We call this <i>unordered sampling</i> (in contrast to <i>ordered</i>) because the order of the selections does not matter with respect to what we observe. We might as well have selected the balls and put them in a bag before looking.
</p>
<p>
Note that this one general class of random experiments contains as a special case all of the common elementary random experiments. Tossing a coin twice is equivalent to selecting two balls labeled \(H\) and \(T\) from an urn, with replacement. The die-roll experiment is equivalent to selecting a ball from an urn with six elements, labeled 1 through 6.
</p>

</div>

<div id="outline-container-4-1-2-1" class="outline-5">
<h5 id="sec-4-1-2-1"><span class="section-number-5">4.1.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-4-1-2-1">


<p>
The <code>prob</code> package accomplishes sampling from urns with the <code>urnsamples</code>\index{urnsamples@\texttt{urnsamples}} function, which has arguments <code>x</code>, <code>size</code>, <code>replace</code>, and <code>ordered</code>. The argument <code>x</code> represents the urn from which sampling is to be done. The <code>size</code> argument tells how large the sample will be. The <code>ordered</code> and <code>replace</code> arguments are logical and specify how sampling will be performed. We will discuss each in turn.
</p>

<div class="exampletoo">
<p><a name="exa-sample-urn-two-from-three" id="exa-sample-urn-two-from-three"></a>
Let our urn simply contain three balls, labeled 1, 2, and 3, respectively. We are going to take a sample of size 2 from the urn. 
</p>
</div>

</div>

<div id="outline-container-4-1-2-2" class="outline-5">
<h5 id="sec-4-1-2-2"><span class="section-number-5">4.1.2.2</span> Ordered, With Replacement</h5>
<div class="outline-text-5" id="text-4-1-2-2">


<p>
If sampling is with replacement, then we can get any outcome 1, 2, or 3 on any draw. Further, by ``ordered'' we mean that we shall keep track of the order of the draws that we observe. We can accomplish this in \(\mathsf{R}\) with
</p>



<pre class="src src-R">urnsamples(1:3, size = 2, replace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<p>
Notice that rows 2 and 4 are identical, save for the order in which the numbers are shown. Further, note that every possible pair of the numbers 1 through 3 are listed. This experiment is equivalent to rolling a 3-sided die twice, which we could have accomplished with <code>rolldie(2, nsides = 3)</code>.
</p>
</div>

</div>

<div id="outline-container-4-1-2-3" class="outline-5">
<h5 id="sec-4-1-2-3"><span class="section-number-5">4.1.2.3</span> Ordered, Without Replacement</h5>
<div class="outline-text-5" id="text-4-1-2-3">


<p>
Here sampling is without replacement, so we may not observe the same number twice in any row. Order is still important, however, so we expect to see the outcomes <code>1,2</code> and <code>2,1</code> somewhere in our data frame. 
</p>



<pre class="src src-R">urnsamples(1:3, size = 2, replace = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<p>
This is just as we expected. Notice that there are less rows in this answer due to the more restrictive sampling procedure. If the numbers 1, 2, and 3 represented ``Fred'', ``Mary'', and ``Sue'', respectively, then this experiment would be equivalent to selecting two people of the three to serve as president and vice-president of a company, respectively, and the sample space shown above lists all possible ways that this could be done.
</p>
</div>

</div>

<div id="outline-container-4-1-2-4" class="outline-5">
<h5 id="sec-4-1-2-4"><span class="section-number-5">4.1.2.4</span> Unordered, Without Replacement</h5>
<div class="outline-text-5" id="text-4-1-2-4">


<p>
Again, we may not observe the same outcome twice, but in this case, we will only retain those outcomes which (when jumbled) would not duplicate earlier ones. 
</p>



<pre class="src src-R">urnsamples(1:3, size = 2, replace = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>) 
</pre>


<p>
This experiment is equivalent to reaching in the urn, picking a pair, and looking to see what they are. This is the default setting of <code>urnsamples</code>, so we would have received the same output by simply typing <code>urnsamples(1:3, 2)</code>.
</p>
</div>

</div>

<div id="outline-container-4-1-2-5" class="outline-5">
<h5 id="sec-4-1-2-5"><span class="section-number-5">4.1.2.5</span> Unordered, With Replacement</h5>
<div class="outline-text-5" id="text-4-1-2-5">


<p>
The last possibility is perhaps the most interesting. We replace the balls after every draw, but we do not remember the order in which the draws came. 
</p>



<pre class="src src-R">urnsamples(1:3, size = 2, replace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>) 
</pre>


<p>
We may interpret this experiment in a number of alternative ways. One way is to consider this as simply putting two 3-sided dice in a cup, shaking the cup, and looking inside &ndash; as in a game of <i>Liar's Dice</i>, for instance. Each row of the sample space is a potential pair we could observe. Another way is to view each outcome as a separate method to distribute two identical golf balls into three boxes labeled 1, 2, and 3. Regardless of the interpretation, <code>urnsamples</code> lists every possible way that the experiment can conclude.
</p>

</div>
<p>Note that the urn does not need to contain numbers; we could have just as easily taken our urn to be <code>x = c("Red","Blue","Green")</code>. But, there is an <b>important</b> point to mention before proceeding. Astute readers will notice that in our example, the balls in the urn were <i>distinguishable</i> in the sense that each had a unique label to distinguish it from the others in the urn. A natural question would be, ``What happens if your urn has indistinguishable elements, for example, what if <code>x = c("Red","Red","Blue")</code>?'' The answer is that <code>urnsamples</code> behaves as if each ball in the urn is distinguishable, regardless of its actual contents. We may thus imagine that while there are two red balls in the urn, the balls are such that we can tell them apart (in principle) by looking closely enough at the imperfections on their
surface.
</p>
<p>
In this way, when the <code>x</code> argument of <code>urnsamples</code> has repeated elements, the resulting sample space may appear to be <code>ordered = TRUE</code> even when, in fact, the call to the function was <code>urnsamples(..., ordered = FALSE)</code>. Similar remarks apply for the <code>replace</code> argument. 
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Events" class="outline-3">
<h3 id="sec-Events"><a name="sec-4-2" id="sec-4-2"></a><span class="section-number-3">4.2</span> Events</h3>
<div class="outline-text-3" id="text-sec-Events">


<p>
An <i>event</i>\index{event} \(A\) is merely a collection of outcomes, or in other words, a subset of the sample space
After the performance of a random experiment \(E\) we say that the event \(A\) <i>occurred</i> if the experiment's outcome belongs to \(A\). We say that a bunch of events \(A_{1}\), \(A_{2}\), \(A_{3}\), &hellip; are <i>mutually exclusive</i>\index{mutually exclusive} or <i>disjoint</i> if \(A_{i}\cap A_{j}=\emptyset\) for any distinct pair \(A_{i}\neq A_{j}\). For instance, in the coin-toss experiment the events \( A = \{ \mbox{Heads} \}\) and \( B = \{ \mbox{Tails} \} \) would be mutually exclusive. Now would be a good time to review the algebra of sets in Appendix <a href="#sec-21-1">Algebra of Sets</a>.
</p>

</div>

<div id="outline-container-4-2-1" class="outline-4">
<h4 id="sec-4-2-1"><span class="section-number-4">4.2.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-4-2-1">


<p>
Given a data frame sample/probability space <code>S</code>, we may extract rows using the <code>[]</code> operator: 
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> tosscoin(2, makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
S[1:3, ] 
</pre>


<pre class="example">
  toss1 toss2 probs
1     H     H  0.25
2     T     H  0.25
3     H     T  0.25
</pre>





<pre class="src src-R">S[c(2,4), ] 
</pre>


<pre class="example">
  toss1 toss2 probs
2     T     H  0.25
4     T     T  0.25
</pre>


<p>
and so forth. We may also extract rows that satisfy a logical expression using the <code>subset</code> function, for instance 
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cards() 
</pre>



<pre class="src src-R">subset(S, suit == <span style="font-style: italic;">"Heart"</span>) 
</pre>



<pre class="example">   rank  suit
27    2 Heart
28    3 Heart
29    4 Heart
30    5 Heart
31    6 Heart
32    7 Heart
33    8 Heart
34    9 Heart
35   10 Heart
36    J Heart
37    Q Heart
38    K Heart
39    A Heart
</pre>



<pre class="src src-R">subset(S, rank %<span style="font-weight: bold;">in</span>% 7:9)
</pre>



<pre class="example">   rank    suit
6     7    Club
7     8    Club
8     9    Club
19    7 Diamond
20    8 Diamond
21    9 Diamond
32    7   Heart
33    8   Heart
34    9   Heart
45    7   Spade
46    8   Spade
47    9   Spade
</pre>


<p>
We could continue indefinitely. Also note that mathematical expressions are allowed: 
</p>



<pre class="src src-R">subset(rolldie(3), X1+X2+X3 &gt; 16) 
</pre>


<pre class="example">
    X1 X2 X3
180  6  6  5
210  6  5  6
215  5  6  6
216  6  6  6
</pre>


</div>

</div>

<div id="outline-container-4-2-2" class="outline-4">
<h4 id="sec-4-2-2"><span class="section-number-4">4.2.2</span> Functions for Finding Subsets</h4>
<div class="outline-text-4" id="text-4-2-2">


<p>
It does not take long before the subsets of interest become complicated to specify. Yet the main idea remains: we have a particular logical condition to apply to each row. If the row satisfies the condition, then it should be in the subset. It should not be in the subset otherwise. The ease with which the condition may be coded depends of course on the question being asked. Here are a few functions to get started.
</p>

</div>

<div id="outline-container-4-2-2-1" class="outline-5">
<h5 id="sec-4-2-2-1"><span class="section-number-5">4.2.2.1</span> The <code>%in%</code> function</h5>
<div class="outline-text-5" id="text-4-2-2-1">


<p>
The function <code>%in%</code> helps to learn whether each value of one vector lies somewhere inside another vector. 
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 1:10 
y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 8:12 
y %<span style="font-weight: bold;">in</span>% x
</pre>


<pre class="example">
[1]  TRUE  TRUE  TRUE FALSE FALSE
</pre>


<p>
Notice that the returned value is a vector of length 5 which tests whether each element of <code>y</code> is in <code>x</code>, in turn.
</p>
</div>

</div>

<div id="outline-container-4-2-2-2" class="outline-5">
<h5 id="sec-4-2-2-2"><span class="section-number-5">4.2.2.2</span> The <code>isin</code> function</h5>
<div class="outline-text-5" id="text-4-2-2-2">


<p>
It is more common to want to know whether the <i>whole</i> vector <code>y</code> is in <code>x</code>. We can do this with the <code>isin</code> function. 
</p>



<pre class="src src-R">isin(x,y) 
</pre>


<pre class="example">
[1] FALSE
</pre>


<p>
Of course, one may ask why we did not try something like <code>all(y %in% x)</code>, which would give a single result, <code>TRUE</code>. The reason is that the answers are different in the case that <code>y</code> has repeated values. Compare: 
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 1:10 
y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(3,3,7) 
</pre>



<pre class="src src-R">all(y %<span style="font-weight: bold;">in</span>% x)
isin(x,y) 
</pre>


<pre class="example">
[1] TRUE
[1] FALSE
</pre>


<p>
The reason for the above is of course that <code>x</code> contains the value 3, but <code>x</code> does not have <i>two</i> 3's. The difference is important when rolling multiple dice, playing cards, <i>etc</i>. Note that there is an optional argument <code>ordered</code> which tests whether the elements of <code>y</code> appear in <code>x</code> in the order in which they are appear in <code>y</code>. The consequences are 
</p>



<pre class="src src-R">isin(x, c(3,4,5), ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
isin(x, c(3,5,4), ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
</pre>


<pre class="example">
[1] TRUE
[1] FALSE
</pre>


<p>
The connection to probability is that have a data frame sample space and we would like to find a subset of that space. A <code>data.frame</code> method was written for <code>isin</code> that simply applies the function to each row of the data frame. We can see the method in action with the following: 
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rolldie(4) 
subset(S, isin(S, c(2,2,6), ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)) 
</pre>



<pre class="example">     X1 X2 X3 X4
188   2  2  6  1
404   2  2  6  2
620   2  2  6  3
836   2  2  6  4
1052  2  2  6  5
1088  2  2  1  6
1118  2  1  2  6
1123  1  2  2  6
1124  2  2  2  6
1125  3  2  2  6
1126  4  2  2  6
1127  5  2  2  6
1128  6  2  2  6
1130  2  3  2  6
1136  2  4  2  6
1142  2  5  2  6
1148  2  6  2  6
1160  2  2  3  6
1196  2  2  4  6
1232  2  2  5  6
1268  2  2  6  6
</pre>


<p>
There are a few other functions written to find useful subsets, namely, <code>countrep</code> and <code>isrep</code>. Essentially these were written to test for (or count) a specific number of designated values in outcomes. See the documentation for details.
</p>
</div>
</div>

</div>

<div id="outline-container-4-2-3" class="outline-4">
<h4 id="sec-4-2-3"><span class="section-number-4">4.2.3</span> Set Union, Intersection, and Difference</h4>
<div class="outline-text-4" id="text-4-2-3">


<p>
Given subsets \(A\) and \(B\), it is often useful to manipulate them in an algebraic fashion. To this end, we have three set operations at our disposal: union, intersection, and difference. Below is a table that summarizes the pertinent information about these operations.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption>Basic set operations.  The first column lists the name, the second shows the typical notation, the third describes set membership, and the fourth shows how to accomplish it with R.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">Name</th><th scope="col" class="left">Denoted</th><th scope="col" class="left">Defined by elements</th><th scope="col" class="left">Code</th></tr>
</thead>
<tbody>
<tr><td class="left">Union</td><td class="left">\(A\cup B\)</td><td class="left">in \(A\) or \(B\) or both</td><td class="left"><code>union(A,B)</code></td></tr>
<tr><td class="left">Intersection</td><td class="left">\(A\cap B\)</td><td class="left">in both \(A\) and \(B\)</td><td class="left"><code>intersect(A,B)</code></td></tr>
<tr><td class="left">Difference</td><td class="left">\(A\backslash B\)</td><td class="left">in \(A\) but not in \(B\)</td><td class="left"><code>setdiff(A,B)</code></td></tr>
</tbody>
</table>



<p>
Some examples follow. 
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cards() 
A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(S, suit == <span style="font-style: italic;">"Heart"</span>) 
B <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(S, rank %<span style="font-weight: bold;">in</span>% 7:9)
</pre>


<p>
We can now do some set algebra: 
</p>



<pre class="src src-R">union(A,B)
</pre>



<pre class="example">   rank    suit
6     7    Club
7     8    Club
8     9    Club
19    7 Diamond
20    8 Diamond
21    9 Diamond
27    2   Heart
28    3   Heart
29    4   Heart
30    5   Heart
31    6   Heart
32    7   Heart
33    8   Heart
34    9   Heart
35   10   Heart
36    J   Heart
37    Q   Heart
38    K   Heart
39    A   Heart
45    7   Spade
46    8   Spade
47    9   Spade
</pre>



<pre class="src src-R">intersect(A,B)
</pre>


<pre class="example">
   rank  suit
32    7 Heart
33    8 Heart
34    9 Heart
</pre>





<pre class="src src-R">setdiff(A,B)
</pre>



<pre class="example">   rank  suit
27    2 Heart
28    3 Heart
29    4 Heart
30    5 Heart
31    6 Heart
35   10 Heart
36    J Heart
37    Q Heart
38    K Heart
39    A Heart
</pre>



<pre class="src src-R">setdiff(B,A) 
</pre>



<pre class="example">   rank    suit
6     7    Club
7     8    Club
8     9    Club
19    7 Diamond
20    8 Diamond
21    9 Diamond
45    7   Spade
46    8   Spade
47    9   Spade
</pre>


<p>
Notice that <code>setdiff</code> is not symmetric. Further, note that we can calculate the <i>complement</i> of a set \(A\), denoted \(A^{c}\) and defined to be the elements of \(S\) that are not in \(A\) simply with <code>setdiff(S,A)</code>. There have been methods written for <code>intersect</code>, <code>setdiff</code>, <code>subset</code>, and <code>union</code> in the case that the input objects are of class <code>ps</code>. See Section <a href="#sec-4-6-2-1">How to <code>ps</code></a>.
</p>

<div class="note">

<p>
When the <code>prob</code> package loads you will notice a message: <code>The following object(s) are masked from package:base: intersect, setdiff</code>. The reason for this message is that there already exist methods for the functions <code>intersect</code>, <code>setdiff</code>, <code>subset</code>, and <code>union</code> in the <code>base</code> package which ships with \(\mathsf{R}\). However, these methods were designed for when the arguments are vectors of the same mode. Since we are manipulating sample spaces which are data frames and lists, it was necessary to write methods to handle those cases as well. When the <code>prob</code> package is loaded, \(\mathsf{R}\) recognizes that there are multiple versions of the same function in the search path and acts to shield the new definitions from the existing ones. But there is no cause for alarm, thankfully, because the <code>prob</code> functions have been carefully defined to match the usual <code>base</code> package definition in the case that the arguments are vectors. 
</p>

</div>

</div>
</div>

</div>

<div id="outline-container-sec-Interpreting-Probabilities" class="outline-3">
<h3 id="sec-Interpreting-Probabilities"><a name="sec-4-3" id="sec-4-3"></a><span class="section-number-3">4.3</span> Model Assignment</h3>
<div class="outline-text-3" id="text-sec-Interpreting-Probabilities">


<p>
Let us take a look at the coin-toss experiment more closely. What do we mean when we say ``the probability of Heads'' or write \(\mathbb{P}(\mbox{Heads})\)? Given a coin and an itchy thumb, how do we go about finding what \(\mathbb{P}(\mbox{Heads})\) should be?
</p>

</div>

<div id="outline-container-4-3-1" class="outline-4">
<h4 id="sec-4-3-1"><span class="section-number-4">4.3.1</span> The Measure Theory Approach</h4>
<div class="outline-text-4" id="text-4-3-1">


<p>
This approach states that the way to handle \(\mathbb{P}(\mbox{Heads})\) is to define a mathematical function, called a <i>probability measure</i>, on the sample space. Probability measures satisfy certain axioms (to be introduced later) and have special mathematical properties, so not just any mathematical function will do. But in any given physical circumstance there are typically all sorts of probability measures from which to choose, and it is left to the experimenter to make a reasonable choice &ndash; one usually based on considerations of objectivity. For the tossing coin example, a valid probability measure assigns probability \(p\) to the event \( \{ \mbox{Heads} \} \), where \(p\) is some number \(0\leq p\leq1\). An experimenter that wishes to incorporate the symmetry of the coin would choose \(p=1/2\) to balance the likelihood of \( \{\mbox{Heads} \} \) and \( \{ \mbox{Tails} \} \).
</p>
<p>
Once the probability measure is chosen (or determined), there is not much left to do. All assignments of probability are made by the probability function, and the experimenter needs only to plug the event \(\{ \mbox{Heads} \}\) into to the probability function to find \(\mathbb{P}(\mbox{Heads})\). In this way, the probability of an event is simply a calculated value, nothing more, nothing less. Of course this is not the whole story; there are many theorems and consequences associated with this approach that will keep us occupied for the remainder of this book. The approach is called <i>measure theory</i> because the measure (probability) of a set (event) is associated with how big it is (how likely it is to occur).
</p>
<p>
The measure theory approach is well suited for situations where there is symmetry to the experiment, such as flipping a balanced coin or spinning an arrow around a circle with well-defined pie slices. It is also handy because of its mathematical simplicity, elegance, and flexibility. There are literally volumes of information that one can prove about probability measures, and the cold rules of mathematics allow us to analyze intricate probabilistic problems with vigor. 
</p>
<p>
The large degree of flexibility is also a disadvantage, however. When symmetry fails it is not always obvious what an ``objective'' choice of probability measure should be; for instance, what probability should we assign to \( \{ \mbox{Heads} \} \) if we spin the coin rather than flip it? (It is not \(1/2\).) Furthermore, the mathematical rules are restrictive when we wish to incorporate subjective knowledge into the model, knowledge which changes over time and depends on the experimenter, such as personal knowledge about the properties of the specific coin being flipped, or of the person doing the flipping.
</p>
<p>
The mathematician who revolutionized this way to do probability theory was Andrey Kolmogorov, who published a landmark monograph in 1933. See <a href="http://www-history.mcs.st-andrews.ac.uk/Mathematicians/Kolmogorov.html">here</a> for more information.
</p>
</div>

</div>

<div id="outline-container-4-3-2" class="outline-4">
<h4 id="sec-4-3-2"><span class="section-number-4">4.3.2</span> Relative Frequency Approach</h4>
<div class="outline-text-4" id="text-4-3-2">


<p>
This approach states that the way to determine \(\mathbb{P}(\mbox{Heads})\) is to flip the coin repeatedly, in exactly the same way each time. Keep a tally of the number of flips and the number of Heads observed. Then a good approximation to \(\mathbb{P}(\mbox{Heads})\) will be
\begin{equation} 
\mathbb{P}(\mbox{Heads})\approx\frac{\mbox{number of observed Heads}}{\mbox{total number of flips}}.
\end{equation}
The mathematical underpinning of this approach is the celebrated <b>Law of Large Numbers</b> which may be loosely described as follows. Let \(E\) be a random experiment in which the event \(A\) either does or does not occur. Perform the experiment repeatedly, in an identical manner, in such a way that the successive experiments do not influence each other. After each experiment, keep a running tally of whether or not the event \(A\) occurred. Let \(S_{n}\) count the number of times that \(A\) occurred in the \(n\) experiments. Then the law of large numbers says that 
\begin{equation}
\frac{S_{n}}{n}\to\mathbb{P}(A)\mbox{ as }n\to\infty.
\end{equation}
As the reasoning goes, to learn about the probability of an event \(A\) we need only repeat the random experiment to get a reasonable estimate of the probability's value, and if we are not satisfied with our estimate then we may simply repeat the experiment more times all the while confident that with more and more experiments our estimate will stabilize to the true value. 
</p>
<p>
The frequentist approach is good because it is relatively light on assumptions and does not worry about symmetry or claims of objectivity like the measure-theoretic approach does. It is perfect for the spinning coin experiment. One drawback to the method is that one can never know the exact value of a probability, only a long-run approximation. It also does not work well with experiments that can not be repeated indefinitely, say, the probability that it will rain today, the chances that you get will get an A in your Statistics class, or the probability that the world is destroyed by nuclear war.
</p>
<p>
This approach was espoused by Richard von Mises in the early twentieth century, and some of his main ideas were incorporated into the measure theory approach. See <a href="http://www-history.mcs.st-andrews.ac.uk/Biographies/Mises.html">here</a> for more.
</p>
</div>

</div>

<div id="outline-container-4-3-3" class="outline-4">
<h4 id="sec-4-3-3"><span class="section-number-4">4.3.3</span> The Subjective Approach</h4>
<div class="outline-text-4" id="text-4-3-3">


<p>
The subjective approach interprets probability as the experimenter's <i>degree of belief</i> that the event will occur. The estimate of the probability of an event is based on the totality of the individual's knowledge at the time. As new information becomes available, the estimate is modified accordingly to best reflect his/her current knowledge. The method by which the probabilities are updated is commonly done with Bayes' Rule, discussed in Section <a href="#sec-Bayes--Rule">Bayes' Rule</a>. 
</p>
<p>
So for the coin toss example, a person may have \(\mathbb{P}(\mbox{Heads})=1/2\) in the absence of additional information. But perhaps the observer knows additional information about the coin or the thrower that would shift the probability in a certain direction. For instance, parlor magicians may be trained to be quite skilled at tossing coins, and some are so skilled that they may toss a fair coin and get nothing but Heads, indefinitely. I have <i>seen</i> this. It was similarly claimed in <i>Bringing Down the House</i> \cite{Mezrich2003} that MIT students were accomplished enough with cards to be able to cut a deck to the same location, every single time. In such cases, one clearly should use the additional information to assign \(\mathbb{P}(\mbox{Heads})\) away from the symmetry value of \(1/2\).
</p>
<p>
This approach works well in situations that cannot be repeated indefinitely, for example, to assign your probability that you will get an A in this class, the chances of a devastating nuclear war, or the likelihood that a cure for the common cold will be discovered.
</p>
<p>
The roots of subjective probability reach back a long time. See <a href="http://en.wikipedia.org/wiki/Subjective_probability">here</a> for a short discussion and links to references about the subjective approach.
</p>
</div>

</div>

<div id="outline-container-4-3-4" class="outline-4">
<h4 id="sec-4-3-4"><span class="section-number-4">4.3.4</span> Equally Likely Model (ELM)</h4>
<div class="outline-text-4" id="text-4-3-4">


<p>
We have seen several approaches to the assignment of a probability model to a given random experiment and they are very different in their underlying interpretation. But they all cross paths when it comes to the equally likely model which assigns equal probability to all elementary outcomes of the experiment.
</p>
<p>
The ELM appears in the measure theory approach when the experiment boasts symmetry of some kind. If symmetry guarantees that all outcomes have equal ``size'', and if outcomes with equal ``size'' should get the same probability, then the ELM is a logical objective choice for the experimenter. Consider the balanced 6-sided die, the fair coin, or the dart board with equal-sized wedges.
</p>
<p>
The ELM appears in the subjective approach when the experimenter resorts to indifference or ignorance with respect to his/her knowledge of the outcome of the experiment. If the experimenter has no prior knowledge to suggest that (s)he prefer Heads over Tails, then it is reasonable for the him/her to assign equal subjective probability to both possible outcomes.
</p>
<p>
The ELM appears in the relative frequency approach as a fascinating fact of Nature: when we flip balanced coins over and over again, we observe that the proportion of times that the coin comes up Heads tends to \(1/2\). Of course if we assume that the measure theory applies then we can prove that the sample proportion must tend to 1/2 as expected, but that is putting the cart before the horse, in a manner of speaking.
</p>
<p>
The ELM is only available when there are finitely many elements in the sample space.
</p>

</div>

<div id="outline-container-4-3-4-1" class="outline-5">
<h5 id="sec-4-3-4-1"><span class="section-number-5">4.3.4.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-4-3-4-1">


<p>
In the <code>prob</code> package, a probability space is an object of outcomes <code>S</code> and a vector of probabilities (called <code>probs</code>) with entries that correspond to each outcome in <code>S</code>. When <code>S</code> is a data frame, we may simply add a column called <code>probs</code> to <code>S</code> and we will be finished; the probability space will simply be a data frame which we may call <code>S</code>. In the case that S is a list, we may combine the <code>outcomes</code> and <code>probs</code> into a larger list, <code>space</code>; it will have two components: <code>outcomes</code> and <code>probs</code>. The only requirements we need are for the entries of <code>probs</code> to be nonnegative and <code>sum(probs)</code> to be one.
</p>
<p>
To accomplish this in \(\mathsf{R}\), we may use the <code>probspace</code> function. The general syntax is <code>probspace(x, probs)</code>, where <code>x</code> is a sample space of outcomes and <code>probs</code> is a vector (of the same length as the number of outcomes in <code>x</code>). The specific choice of <code>probs</code> depends on the context of the problem, and some examples follow to demonstrate some of the more common choices. 
</p>

<div class="exampletoo">
<p>The Equally Likely Model asserts that every outcome of the sample space has the same probability, thus, if a sample space has \(n\) outcomes, then <code>probs</code> would be a vector of length \(n\) with identical entries \(1/n\). The quickest way to generate <code>probs</code> is with the <code>rep</code> function. We will start with the experiment of rolling a die, so that \(n=6\). We will construct the sample space, generate the <code>probs</code> vector, and put them together with <code>probspace</code>. 
</p>



<pre class="src src-R">outcomes <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rolldie(1) 
p <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rep(1/6, times = 6) 
probspace(outcomes, probs = p) 
</pre>


<p>
The <code>probspace</code> function is designed to save us some time in the most common situations. For example, due to the especial simplicity of the sample space in this case, we could have achieved the same result with only (note the name change for the first column) 
</p>



<pre class="src src-R">probspace(1:6, probs = p) 
</pre>


<p>
Further, since the equally likely model plays such a fundamental role in the study of probability the <code>probspace</code> function will assume that the equally model is desired if no <code>probs</code> are specified. Thus, we get the same answer with only 
</p>



<pre class="src src-R">probspace(1:6) 
</pre>


<p>
And finally, since rolling dice is such a common experiment in probability classes, the <code>rolldie</code> function has an additional logical argument <code>makespace</code> that will add a column of equally likely <code>probs</code> to the generated sample space: 
</p>



<pre class="src src-R">rolldie(1, makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<p>
or just <code>rolldie(1, TRUE)</code>. Many of the other sample space functions (<code>tosscoin</code>, <code>cards</code>, <code>roulette</code>, <i>etc</i>.) have similar <code>makespace</code> arguments. Check the documentation for details.
</p>

</div>

<p>
One sample space function that does NOT have a <code>makespace</code> option is the <code>urnsamples</code> function. This was intentional. The reason is that under the varied sampling assumptions the outcomes in the respective sample spaces are NOT, in general, equally likely. It is important for the user to carefully consider the experiment to decide whether or not the outcomes are equally likely and then use <code>probspace</code> to assign the model.
</p>

<div class="exampletoo">
<p><a name="exa-unbalanced-coin" id="exa-unbalanced-coin"></a>
<b>An unbalanced coin.</b> While the <code>makespace</code> argument to <code>tosscoin</code> is useful to represent the tossing of a <i>fair</i> coin, it is not always appropriate. For example, suppose our coin is not perfectly balanced, for instance, maybe the \(H\) side is somewhat heavier such that the chances of a \(H\) appearing in a single toss is 0.70 instead of 0.5. We may set up the probability space with 
</p>



<pre class="src src-R">probspace(tosscoin(1), probs = c(0.70, 0.30)) 
</pre>


<p>
The same procedure can be used to represent an unbalanced die, roulette wheel, <i>etc</i>.
</p>

</div>

</div>
</div>

</div>

<div id="outline-container-4-3-5" class="outline-4">
<h4 id="sec-4-3-5"><span class="section-number-4">4.3.5</span> Words of Warning</h4>
<div class="outline-text-4" id="text-4-3-5">


<p>
It should be mentioned that while the splendour of \(\mathsf{R}\) is uncontested,  it, like everything else, has limits both with respect to the sample/probability spaces it can manage and with respect to the finite accuracy of the representation of most numbers (see the \(\mathsf{R}\) FAQ 7.31). When playing around with probability, one may be tempted to set up a probability space for tossing 100 coins or rolling 50 dice in an attempt to answer some scintillating question. (Bear in mind: rolling a die just 9 times has a sample space with over <i>10 million</i> outcomes.)
</p>
<p>
Alas, even if there were enough RAM to barely hold the sample space (and there were enough time to wait for it to be generated), the infinitesimal probabilities that are associated with <i>so many</i> outcomes make it difficult for the underlying machinery to handle reliably. In some cases, special algorithms need to be called just to give something
that holds asymptotically. User beware.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Properties-of-Probability" class="outline-3">
<h3 id="sec-Properties-of-Probability"><a name="sec-4-4" id="sec-4-4"></a><span class="section-number-3">4.4</span> Properties of Probability</h3>
<div class="outline-text-3" id="text-sec-Properties-of-Probability">



</div>

<div id="outline-container-sub-Probability-Functions" class="outline-4">
<h4 id="sub-Probability-Functions"><a name="sec-4-4-1" id="sec-4-4-1"></a><span class="section-number-4">4.4.1</span> Probability Functions</h4>
<div class="outline-text-4" id="text-sub-Probability-Functions">


<p>
A <i>probability function</i> is a rule that associates with each event \(A\) of the sample space a single number \(\mathbb{P}(A)=p\), called the <i>probability of</i> \(A\). Any probability function \(\mathbb{P}\) satisfies the following three Kolmogorov Axioms: 
</p>

<div class="ax">
<p><a name="ax-prob-nonnegative" id="ax-prob-nonnegative"></a>
\(\mathbb{P}(A)\geq0\) for any event \(A\subset S\).
</p>
</div>


<div class="ax">
<p><a name="ax-total-mass-one" id="ax-total-mass-one"></a>
\(\mathbb{P}(S)=1\).
</p>
</div>


<div class="ax">
<p><a name="ax-countable-additivity" id="ax-countable-additivity"></a>
If the events \(A_{1}\), \(A_{2}\), \(A_{3}\)&hellip; are disjoint then
\begin{equation}
\mathbb{P}\left(\bigcup_{i=1}^{n}A_{i}\right)=\sum_{i=1}^{n}\mathbb{P}(A_{i})\mbox{ for every }n,
\end{equation}
and furthermore,
\begin{equation}
\mathbb{P}\left(\bigcup_{i=1}^{\infty}A_{i}\right)=\sum_{i=1}^{\infty}\mathbb{P}(A_{i}).
\end{equation}
</p>
</div>

<p>
The intuition behind the axioms goes like this: first, the probability of an event should never be negative. Second, since the sample space contains all possible outcomes, its probability should be one, or 100%. The last axiom may look intimidating but it simply means that in a sequence of disjoint events (in other words, sets that do not overlap), the total probability (measure) should equal the sum of its parts. For example, the chance of rolling a 1 or a 2 on a die should be the chance of rolling a 1 plus the chance of rolling a 2.
</p>
</div>

</div>

<div id="outline-container-4-4-2" class="outline-4">
<h4 id="sec-4-4-2"><span class="section-number-4">4.4.2</span> Properties</h4>
<div class="outline-text-4" id="text-4-4-2">


<p>
For any events \(A\) and \(B\),
<a name="enu-prop-prob-complement" id="enu-prop-prob-complement"></a>
</p><ol>
<li>\(\mathbb{P}(A^{c})=1-\mathbb{P}(A)\).

<div class="proof">
<p>  Since \(A\cup A^{c}=S\) and \(A\cap A^{c}=\emptyset\), we have
  \[
  1=\mathbb{P}(S)=\mathbb{P}(A\cup A^{c})=\mathbb{P}(A)+\mathbb{P}(A^{c}).
  \]
</p>
</div>
</li>
<li>\(\mathbb{P}(\emptyset)=0\).

<div class="proof">
<p>  Note that \(\emptyset=S^{c}\), and use Property 1.
</p>
</div>
</li>
<li>If \(A\subset B\) , then \(\mathbb{P}(A)\leq\mathbb{P}(B)\).

<div class="proof">
<p>  Write \(B=A\cup\left(B\cap A^{c}\right)\), and notice that \(A\cap\left(B\cap A^{c}\right)=\emptyset\); thus
  \[
  \mathbb{P}(B)=\mathbb{P}(A\cup\left(B\cap A^{c}\right))=\mathbb{P}(A)+\mathbb{P}\left(B\cap A^{c}\right)\geq\mathbb{P}(A),
  \]
  since \(\mathbb{P}\left(B\cap A^{c}\right)\ge0\). 
</p>
</div>
</li>
<li>\(0\leq\mathbb{P}(A)\leq1\).

<div class="proof">
<p>  The left inequality is immediate from Axiom <a href="#ax-prob-nonnegative">Probability is Nonnegative</a>, and the second inequality follows from Property 3 since \(A\subset S\).
</p>
</div>

</li>
<li><b>The General Addition Rule.</b>
  \begin{equation}
  \mathbb{P}(A\cup B)=\mathbb{P}(A)+\mathbb{P}(B)-\mathbb{P}(A\cap B).
  \end{equation}
  <a name="eq-general-addition-rule-1" class="target">eq-general-addition-rule-1</a> 
  More generally, for events \(A_{1}\), \(A_{2}\), \(A_{3}\),&hellip;, \(A_{n}\),
  \begin{equation}
  \mathbb{P}\left(\bigcup_{i=1}^{n}A_{i}\right)=\sum_{i=1}^{n}\mathbb{P}(A_{i})-\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}\mathbb{P}(A_{i}\cap A_{j})+\cdots+(-1)^{n-1}\mathbb{P}\left(\bigcap_{i=1}^{n}A_{i}\right)
  \end{equation}

</li>
<li><b>The Theorem of Total Probability.</b> 
  Let \(B_{1}\), \(B_{2}\), &hellip;, \(B_{n}\) be mutually exclusive and exhaustive. Then
  \begin{equation}
  \mathbb{P}(A)=\mathbb{P}(A\cap B_{1})+\mathbb{P}(A\cap B_{2})+\cdots+\mathbb{P}(A\cap B_{n}).
  \end{equation}
  <a name="eq-theorem-total-probability" class="target">eq-theorem-total-probability</a> 
</li>
</ol>


</div>

</div>

<div id="outline-container-4-4-3" class="outline-4">
<h4 id="sec-4-4-3"><span class="section-number-4">4.4.3</span> Assigning Probabilities</h4>
<div class="outline-text-4" id="text-4-4-3">


<p>
A model of particular interest is the <i>equally likely model</i>. The idea is to divide the sample space \(S\) into a finite collection of elementary events \( \{ a_{1},\ a_{2}, \ldots, a_{N} \} \) that are equally likely in the sense that each \(a_{i}\) has equal chances of occurring. The probability function associated with this model must satisfy \(\mathbb{P}(S)=1\), by Axiom 2. On the other hand, it must also satisfy
\[
\mathbb{P}(S)=\mathbb{P}( \{ a_{1},\ a_{2},\ldots,a_{N} \} )=\mathbb{P}(a_{1}\cup a_{2}\cup\cdots\cup a_{N})=\sum_{i=1}^{N}\mathbb{P}(a_{i}),
\]
by Axiom 3. Since \(\mathbb{P}(a_{i})\) is the same for all \(i\), each one necessarily equals \(1/N\). 
</p>
<p>
For an event \(A\subset S\), we write \(A\) as a collection of elementary outcomes: if \( A = \{ a_{i_{1}}, a_{i_{2}}, \ldots, a_{i_{k}} \} \) then \(A\) has \(k\) elements and 
\begin{align*}
\mathbb{P}(A) & =\mathbb{P}(a_{i_{1}})+\mathbb{P}(a_{i_{2}})+\cdots+\mathbb{P}(a_{i_{k}}),\\
 & =\frac{1}{N}+\frac{1}{N}+\cdots+\frac{1}{N},\\  & =\frac{k}{N}=\frac{\#(A)}{\#(S)}.
\end{align*}
In other words, under the equally likely model, the probability of an event \(A\) is determined by the number of elementary events that \(A\) contains. 
</p>

<div class="exampletoo">
<p>Consider the random experiment \(E\) of tossing a coin. Then the sample space is \(S=\{H,T\}\), and under the equally likely model, these two outcomes have \(\mathbb{P}(H)=\mathbb{P}(T)=1/2\). This model is taken when it is reasonable to assume that the coin is fair.
</p>
</div>


<div class="exampletoo">
<p>Suppose the experiment \(E\) consists of tossing a fair coin twice. The sample space may be represented by \(S=\{HH,\, HT,\, TH,\, TT\}\). Given that the coin is fair and that the coin is tossed in an independent and identical manner, it is reasonable to apply the equally likely model. 
</p>
<p>
What is \(\mathbb{P}(\mbox{at least 1 Head})\)? Looking at the sample space we see the elements \(HH\), \(HT\), and \(TH\) have at least one Head; thus, \(\mathbb{P}(\mbox{at least 1 Head})=3/4\). 
</p>
<p>
What is \(\mathbb{P}(\mbox{no Heads})\)? Notice that the event \(\{ \mbox{no Heads} \} = \{ \mbox{at least one Head} \} ^{c}\), which by Property <a href="#enu-prop-prob-complement">prob-comp</a> means \(\mathbb{P}(\mbox{no Heads})=1-\mathbb{P}(\mbox{at least one head})=1-3/4=1/4\). It is obvious in this simple example that the only outcome with no Heads is \(TT\), however, this complementation trick can be handy in more complicated problems.
</p>
</div>


<div class="exampletoo">
<p><a name="exa-three-child-family" id="exa-three-child-family"></a>
Imagine a three child family, each child being either Boy (\(B\)) or Girl (\(G\)). An example sequence of siblings would be \(BGB\). The sample space may be written
\[
S=\left\{ 
\begin{array}{cccc}
BBB, & BGB, & GBB, & GGB,\\
BBG, & BGG, & GBG, & GGG
\end{array}
\right\}.
\]
Note that for many reasons (for instance, it turns out that girls are slightly more likely to be born than boys), this sample space is <i>not</i> equally likely. For the sake of argument, however, we will assume that the elementary outcomes each have probability \(1/8\).
</p>
<p>
What is \(\mathbb{P}(\mbox{exactly 2 Boys})\)? Inspecting the sample space reveals three outcomes with exactly two boys: \( \{ BBG,\, BGB,\, GBB \} \).  Therefore \(\mathbb{P}(\mbox{exactly 2 Boys})=3/8\). 
</p>
<p>
What is \(\mathbb{P}(\mbox{at most 2 Boys})\)? One way to solve the problem would be to count the outcomes that have 2 or less Boys, but a quicker way would be to recognize that the only way that the event \(\{ \mbox{at most 2 Boys} \}\) does <i>not</i> occur is the event \(\{ \mbox{all Girls} \}\).
</p>
<p>
Thus
\[
\mathbb{P}(\mbox{at most 2 Boys})=1-\mathbb{P}(GGG)=1-1/8=7/8.
\]

</p>
</div>


<div class="exampletoo">
<p>Consider the experiment of rolling a six-sided die, and let the outcome be the face showing up when the die comes to rest. Then \( S = \{ 1,\,2,\,3,\,4,\,5,\,6 \} \). It is usually reasonable to suppose that the die is fair, so that the six outcomes are equally likely.
</p>
</div>


<div class="exampletoo">
<p>Consider a standard deck of 52 cards. These are usually labeled with the four <i>suits</i>: Clubs, Diamonds, Hearts, and Spades, and the 13 <i>ranks</i>: 2, 3, 4, &hellip;, 10, Jack (J), Queen (Q), King (K), and Ace (A). Depending on the game played, the Ace may be ranked below 2 or above King. 
</p>
<p>
Let the random experiment \(E\) consist of drawing exactly one card from a well-shuffled deck, and let the outcome be the face of the card. Define the events \( A = \{ \mbox{draw an Ace} \} \) and \( B = \{ \mbox{draw a Club} \} \). Bear in mind: we are only drawing one card.
</p>
<p>
Immediately we have \(\mathbb{P}(A)=4/52\) since there are four Aces in the deck; similarly, there are \(13\) Clubs which implies \(\mathbb{P}(B)=13/52\).
</p>
<p>
What is \(\mathbb{P}(A\cap B)\)? We realize that there is only one card of the 52 which is an Ace and a Club at the same time, namely, the Ace of Clubs. Therefore \(\mathbb{P}(A\cap B)=1/52\).
</p>
<p>
To find \(\mathbb{P}(A\cup B)\) we may use the above with the General Addition Rule to get
\begin{eqnarray*}
\mathbb{P}(A\cup B) & = & \mathbb{P}(A)+\mathbb{P}(B)-\mathbb{P}(A\cap B),\\
 & = & 4/52+13/52-1/52,\\
 & = & 16/52.
\end{eqnarray*}

</p>
</div>


<div class="exampletoo">
<p>Staying with the deck of cards, let another random experiment be the selection of a five card stud poker hand, where ``five card stud'' means that we draw exactly five cards from the deck without replacement, no more, and no less. It turns out that the sample space \(S\) is so large and complicated that we will be obliged to settle for the trivial description \( S = \{ \mbox{all possible 5 card hands} \} \) for the time being. We will have a more precise description later.
</p>
<p>
What is \(\mathbb{P}(\mbox{Royal Flush})\), or in other words, \(\mathbb{P}(\mbox{A, K, Q, J, 10 all in the same suit})\)? 
</p>
<p>
It should be clear that there are only four possible royal flushes. Thus, if we could only count the number of outcomes in \(S\) then we could simply divide four by that number and we would have our answer under the equally likely model. This is the subject of Section <a href="#sec-4-5">Counting Methods</a>.
</p>

</div>


</div>

<div id="outline-container-4-4-3-1" class="outline-5">
<h5 id="sec-4-4-3-1"><span class="section-number-5">4.4.3.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-4-4-3-1">


<p>
Probabilities are calculated in the <code>prob</code> package with the <code>prob</code> function.
</p>
<p>
Consider the experiment of drawing a card from a standard deck of playing cards. Let's denote the probability space associated with the experiment as <code>S</code>, and let the subsets <code>A</code> and <code>B</code> be defined by the following: 
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cards(makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(S, suit == <span style="font-style: italic;">"Heart"</span>) 
B <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(S, rank %<span style="font-weight: bold;">in</span>% 7:9)
</pre>


<p>
Now it is easy to calculate 
</p>



<pre class="src src-R">prob::prob(A) 
</pre>


<pre class="example">
[1] 0.25
</pre>


<p>
Note that we can get the same answer with 
</p>



<pre class="src src-R">prob::prob(S, suit == <span style="font-style: italic;">"Heart"</span>) 
</pre>


<pre class="example">
[1] 0.25
</pre>


<p>
We also find <code>prob::prob(B) = 0.23</code> (listed here approximately, but 12/52 actually) and <code>prob::prob(S) = 1</code>. Internally, the <code>prob</code> function operates by summing the <code>probs</code> column of its argument. It will find subsets on-the-fly if desired.
</p>
<p>
We have as yet glossed over the details. More specifically, <code>prob</code> has three arguments: <code>x</code>, which is a probability space (or a subset of one), <code>event</code>, which is a logical expression used to define a subset, and <code>given</code>, which is described in Section <a href="#sec-4-6">Conditional Probability</a>.
</p>
<p>
<i>WARNING</i>. The <code>event</code> argument is used to define a subset of <code>x</code>, that is, the only outcomes used in the probability calculation will be those that are elements of <code>x</code> and satisfy <code>event</code> simultaneously. In other words, <code>prob::prob(x, event)</code> calculates 
</p>
<pre class="example">
prob::prob(intersect(x, subset(x, event)))
</pre>


<p>
Consequently, <code>x</code> should be the entire probability space in the case that <code>event</code> is non-null.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Methods-of-Counting" class="outline-3">
<h3 id="sec-Methods-of-Counting"><a name="sec-4-5" id="sec-4-5"></a><span class="section-number-3">4.5</span> Counting Methods</h3>
<div class="outline-text-3" id="text-sec-Methods-of-Counting">


<p>
The equally-likely model is a convenient and popular way to analyze random experiments. And when the equally likely model applies, finding the probability of an event \(A\) amounts to nothing more than counting the number of outcomes that \(A\) contains (together with the number of events in \(S\)). Hence, to be a master of probability one must be skilled at counting outcomes in events of all kinds.
</p>

<div class="prop">
<p>The Multiplication Principle. Suppose that an experiment is composed of two successive steps. Further suppose that the first step may be performed in \(n_{1}\) distinct ways while the second step may be performed in \(n_{2}\) distinct ways. Then the experiment may be performed in \(n_{1}n_{2}\) distinct ways.
</p>
<p>
More generally, if the experiment is composed of \(k\) successive steps which may be performed in \(n_{1}\), \(n_{2}\), &hellip;, \(n_{k}\) distinct ways, respectively, then the experiment may be performed in \(n_{1}n_{2}\cdots n_{k}\) distinct ways.
</p>
</div>


<div class="exampletoo">
<p>We would like to order a pizza. It will be sure to have cheese (and marinara sauce), but we may elect to add one or more of the following five (5) available toppings:
\[
\mbox{pepperoni, sausage, anchovies, olives, and green peppers.}
\]
How many distinct pizzas are possible?
</p>
<p>
There are many ways to approach the problem, but the quickest avenue employs the Multiplication Principle directly. We will separate the action of ordering the pizza into a series of stages. At the first stage, we will decide whether or not to include pepperoni on the pizza (two possibilities). At the next stage, we will decide whether or not to include sausage on the pizza (again, two possibilities). We will continue in this fashion until at last we will decide whether or not to include green peppers on the pizza.
</p>
<p>
At each stage we will have had two options, or ways, to select a pizza to be made. The Multiplication Principle says that we should multiply the 2's to find the total number of possible pizzas: \(2\cdot2\cdot2\cdot2\cdot2=2^{5}=32\).
</p>

</div>


<div class="exampletoo">
<p>We would like to buy a desktop computer to study statistics. We go to a website to build our computer our way. Given a line of products we have many options to customize our computer. In particular, there are 2 choices for a processor, 3 different operating systems, 4 levels of memory, 4 hard drives of differing sizes, and 10 choices for a monitor. How many possible types of computer must the company be prepared to build? <b>Answer:</b> \(2\cdot3\cdot4\cdot4\cdot10=960\)
</p>
</div>


</div>

<div id="outline-container-4-5-1" class="outline-4">
<h4 id="sec-4-5-1"><span class="section-number-4">4.5.1</span> Ordered Samples</h4>
<div class="outline-text-4" id="text-4-5-1">


<p>
Imagine a bag with \(n\) distinguishable balls inside. Now shake up the bag and select \(k\) balls at random. How many possible sequences might we observe?
</p>

<div class="prop">
<p>The number of ways in which one may select an ordered sample of \(k\) subjects from a population that has \(n\) distinguishable members is
</p><ul>
<li>\(n^{k}\) if sampling is done with replacement,
</li>
<li>\(n(n-1)(n-2)\cdots(n-k+1)\) if sampling is done without replacement.
</li>
</ul>



</div>

<p>
Recall from calculus the notation for <i>factorials</i>: 
\begin{eqnarray*}
1! & = & 1,\\
2! & = & 2\cdot1=2,\\
3! & = & 3\cdot2\cdot1=6,\\
 & \vdots\\
n! & = & n(n-1)(n-2)\cdots3\cdot2\cdot1.
\end{eqnarray*}

</p>
<div class="fact">
<p>The number of permutations of \(n\) elements is \(n!\).
</p>
</div>


<div class="exampletoo">
<p>Take a coin and flip it 7 times. How many sequences of Heads and Tails are possible? <b>Answer:</b> \(2^{7}=128\).
</p>
</div>


<div class="exampletoo">
<p>In a class of 20 students, we randomly select a class president, a class vice-president, and a treasurer. How many ways can this be done? <b>Answer:</b> \(20\cdot19\cdot18=6840\).
</p>
</div>


<div class="exampletoo">
<p>We rent five movies to watch over the span of two nights. We wish to watch 3 movies on the first night. How many distinct sequences of 3 movies could we possibly watch? <b>Answer:</b> \(5\cdot4\cdot3=60\).
</p>
</div>

</div>

</div>

<div id="outline-container-4-5-2" class="outline-4">
<h4 id="sec-4-5-2"><span class="section-number-4">4.5.2</span> Unordered Samples</h4>
<div class="outline-text-4" id="text-4-5-2">



<div class="prop">
<p>The number of ways in which one may select an unordered sample of \(k\) subjects from a population that has \(n\) distinguishable members is
</p><ul>
<li>\((n-1+k)!/[(n-1)!k!]\) if sampling is done with replacement,
</li>
<li>\(n!/[k!(n-k)!]\) if sampling is done without replacement.
</li>
</ul>



</div>

<p>
The quantity \(n!/[k!(n-k)!]\) is called a <i>binomial coefficient</i> and plays a special role in mathematics; it is denoted
\begin{equation}
{n \choose k}=\frac{n!}{k!(n-k)!}
\end{equation}
<a name="eq-binomial-coefficient" id="eq-binomial-coefficient"></a>
and is read ``\(n\) choose \(k\)''.
</p>

<div class="exampletoo">
<p>You rent five movies to watch over the span of two nights, but only wish to watch 3 movies the first night. Your friend, Fred, wishes to borrow some movies to watch at his house on the first night. You owe Fred a favor, and allow him to select 2 movies from the set of 5. How many choices does Fred have? <b>Answer:</b> \({5 \choose 2}=10\).
</p>
</div>


<div class="exampletoo">
<p>Place 3 six-sided dice into a cup. Next, shake the cup well and pour out the dice. How many distinct rolls are possible? <b>Answer:</b> \((6-1+3)!/[(6-1)!3!]={8 \choose 5}=56\). 
</p>
</div>


</div>

<div id="outline-container-4-5-2-1" class="outline-5">
<h5 id="sec-4-5-2-1"><span class="section-number-5">4.5.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-4-5-2-1">


<p>
The factorial \(n!\) is computed with the command <code>factorial(n)</code> and the binomial coefficient \({n \choose k}\) with the command <code>choose(n,k)</code>.
</p>
<p>
The sample spaces we have computed so far have been relatively small, and we can visually study them without much trouble. However, it is <i>very</i> easy to generate sample spaces that are prohibitively large. And while \(\mathsf{R}\) is wonderful and powerful and does almost everything except wash windows, even \(\mathsf{R}\) has limits of which we should be mindful.
</p>
<p>
But we often do not need to actually generate the sample space; it suffices to count the number of outcomes. The <code>nsamp</code> function will calculate the number of rows in a sample space made by <code>urnsamples</code> without actually devoting the memory resources necessary to generate the space. The arguments are <code>n</code>, the number of (distinguishable) objects in the urn, <code>k</code>, the sample size, and <code>replace</code>, <code>ordered</code>, as above.
</p>

<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-Sampling-k-from-n">
<caption>Sampling \(k\) from \(n\) objects with \texttt{urnsamples}</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left"></th><th scope="col" class="left"><code>ordered = TRUE</code></th><th scope="col" class="left"><code>ordered = FALSE</code></th></tr>
</thead>
<tbody>
<tr><td class="left"><code>replace = TRUE</code></td><td class="left">\(n^{k}\)</td><td class="left">\((n-1+k)! / [(n-1)!k!]\)</td></tr>
<tr><td class="left"><code>replace = FALSE</code></td><td class="left">\( n! / (n-k)! \)</td><td class="left">\( {n \choose k} \)</td></tr>
</tbody>
</table>




<div class="exampletoo">
<p>We will compute the number of outcomes for each of the four <code>urnsamples</code> examples that we saw in Example <a href="#exa-sample-urn-two-from-three">Sample-urn-2-from-3</a>. Recall that we took a sample of size two from an urn with three distinguishable elements.
</p>
</div>




<pre class="src src-R">nsamp(n=3, k=2, replace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
nsamp(n=3, k=2, replace = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
nsamp(n=3, k=2, replace = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>) 
nsamp(n=3, k=2, replace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>) 
</pre>


<pre class="example">
[1] 9
[1] 6
[1] 3
[1] 6
</pre>


<p>
Compare these answers with the length of the data frames generated above.
</p>
</div>

</div>

<div id="outline-container-4-5-2-2" class="outline-5">
<h5 id="sec-4-5-2-2"><span class="section-number-5">4.5.2.2</span> The Multiplication Principle</h5>
<div class="outline-text-5" id="text-4-5-2-2">


<p>
A benefit of <code>nsamp</code> is that it is <i>vectorized</i> so that entering vectors instead of numbers for <code>n</code>, <code>k</code>, <code>replace</code>, and <code>ordered</code> results in a vector of corresponding answers. This becomes particularly convenient for combinatorics problems.
</p>

<div class="exampletoo">
<p>There are 11 artists who each submit a portfolio containing 7 paintings for competition in an art exhibition. Unfortunately, the gallery director only has space in the winners' section to accommodate 12 paintings in a row equally spread over three consecutive walls. The director decides to give the first, second, and third place winners each a wall to display the work of their choice. The walls boast 31 separate lighting options apiece. How many displays are possible?
</p>
<p>
<b>Answer:</b> The judges will pick 3 (ranked) winners out of 11 (with <code>rep = FALSE</code>, <code>ord = TRUE</code>). Each artist will select 4 of his/her paintings from 7 for display in a row (<code>rep = FALSE</code>, <code>ord = TRUE</code>), and lastly, each of the 3 walls has 31 lighting possibilities (<code>rep = TRUE</code>, <code>ord = TRUE</code>). These three numbers can be calculated quickly with 
</p>



<pre class="src src-R">n <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(11,7,31) 
k <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(3,4,3) 
r <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(<span style="font-weight: bold; text-decoration: underline;">FALSE</span>,<span style="font-weight: bold; text-decoration: underline;">FALSE</span>,<span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
</pre>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> nsamp(n, k, rep = r, ord = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
</pre>


<p>
(Notice that <code>ordered</code> is always <code>TRUE</code>; <code>nsamp</code> will recycle <code>ordered</code> and <code>replace</code> to the appropriate length.) By the Multiplication Principle, the number of ways to complete the experiment is the product of the entries of <code>x</code>: 
</p>



<pre class="src src-R">prod(x) 
</pre>


<p>
Compare this with the some other ways to compute the same thing: 
</p>



<pre class="src src-R">(11*10*9)*(7*6*5*4)*313 
</pre>


<p>
or alternatively 
</p>



<pre class="src src-R">prod(9:11)*prod(4:7)*313 
</pre>


<p>
or even 
</p>



<pre class="src src-R">prod(factorial(c(11,7))/factorial(c(8,3)))*313 
</pre>



</div>

<p>
As one can guess, in many of the standard counting problems there aren't substantial savings in the amount of typing; it is about the same using <code>nsamp</code> versus <code>factorial</code> and <code>choose</code>. But the virtue of <code>nsamp</code> lies in its collecting the relevant counting formulas in a one-stop shop. Ultimately, it is up to the user to choose the method that works best for him/herself. 
</p>

<div class="exampletoo">
<p><b>The Birthday Problem.</b> Suppose that there are \(n\) people together in a room. Each person announces the date of his/her birthday in turn. The question is: what is the probability of at least one match? If we let the event \(A\) represent 
\[
\{ \mbox{there is at least one match}, \}
\]
then would like to know \(\mathbb{P}(A)\), but as we will see, it is more convenient to calculate \(\mathbb{P}(A^{c})\).
</p>
<p>
For starters we will ignore leap years and assume that there are only 365 days in a year. Second, we will assume that births are equally distributed over the course of a year (which is not true due to all sorts of complications such as hospital delivery schedules). See <a href="http://en.wikipedia.org/wiki/Birthday_problem">here</a> for more.
</p>
<p>
Let us next think about the sample space. There are 365 possibilities for the first person's birthday, 365 possibilities for the second, and so forth. The total number of possible birthday sequences is therefore \(\#(S)=365^{n}\).
</p>
<p>
Now we will use the complementation trick we saw in Example <a href="#exa-three-child-family">Three Child Family</a>. We realize that the only situation in which \(A\) does <i>not</i> occur is if there are <i>no</i> matches among all people in the room, that is, only when everybody's birthday is different, so
\[
\mathbb{P}(A)=1-\mathbb{P}(A^{c})=1-\frac{\#(A^{c})}{\#(S)},
\]
since the outcomes are equally likely. Let us then suppose that there are no matches. The first person has one of 365 possible birthdays. The second person must not match the first, thus, the second person has only 364 available birthdays from which to choose. Similarly, the third person has only 363 possible birthdays, and so forth, until we reach the \(n^{\mathrm{th}}\) person, who has only \(365-n+1\) remaining possible days for a birthday. By the Multiplication Principle, we have \(\#(A^{c})=365\cdot364\cdots(365-n+1)\), and
\begin{equation}
\mathbb{P}(A)=1-\frac{365\cdot364\cdots(365-n+1)}{365^{n}}=1-\frac{364}{365}\cdot\frac{363}{365}\cdots\frac{(365-n+1)}{365}.
\end{equation}
As a surprising consequence, consider this: how many people does it take to be in the room so that the probability of at least one match is at least 0.50? Clearly, if there is only \(n=1\) person in the room then the probability of a match is zero, and when there are \(n=366\) people in the room there is a 100% chance of a match (recall that we are ignoring leap years). So how many people does it take so that there is an equal chance of a match and no match?
</p>
<p>
When I have asked this question to students, the usual response is ``somewhere around \(n=180\) people'' in the room. The reasoning seems to be that in order to get a 50% chance of a match, there should be 50% of the available days to be occupied. The number of students in a typical classroom is 25, so as a companion question I ask students to estimate the probability of a match when there are \(n=25\) students in the room. Common estimates are a 1%, or 0.5%, or even 0.1% chance of a match. After they have given their estimates, we go around the room and each student announces their birthday. More often than not, we observe a match in the class, to the students' disbelief.
</p>
<p>
Students are usually surprised to hear that, using the formula above, one needs only \(n=23\) students to have a greater than 50% chance of at least one match. Figure <a href="#fig-birthday">birthday</a> shows a graph of the birthday probabilities:
</p>
</div>










<div id="fig-birthday" class="figure">
  <p><img src="svg/prob/birthday.svg" width=500 alt="svg/prob/birthday.svg" /></p>
  <p>The birthday problem. The horizontal line is at <code>p = 0.50</code> and the vertical line is at <code>n = 23</code>.</p>
</div>

</div>

</div>

<div id="outline-container-4-5-2-3" class="outline-5">
<h5 id="sec-4-5-2-3"><span class="section-number-5">4.5.2.3</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-4-5-2-3">


<p>
We can make the plot in Figure <a href="#fig-birthday">birthday</a> with the following sequence of commands.
</p>



<pre class="src src-R"><span style="font-weight: bold; text-decoration: underline;">library</span>(RcmdrPlugin.IPSUR)
g <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> Vectorize(pbirthday.ipsur)
plot(1:50, g(1:50), xlab = <span style="font-style: italic;">"Number of people in room"</span>, 
  ylab = <span style="font-style: italic;">"Prob(at least one match)"</span> )
abline(h = 0.5)
abline(v = 23, lty = 2)
remove(g)
</pre>


<p>
There is a <code>Birthday problem</code> item in the <code>Probability</code> menu of <code>RcmdrPlugin.IPSUR</code>. In the base \(\mathsf{R}\) version, one can compute approximate probabilities for the more general case of probabilities other than 1/2, for differing total number of days in the year, and even for more than two matches.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Conditional-Probability" class="outline-3">
<h3 id="sec-Conditional-Probability"><a name="sec-4-6" id="sec-4-6"></a><span class="section-number-3">4.6</span> Conditional Probability</h3>
<div class="outline-text-3" id="text-sec-Conditional-Probability">


<p>
Consider a full deck of 52 standard playing cards. Now select two cards from the deck, in succession. Let \( A = \{ \mbox{first card drawn is an Ace} \} \) and \( B = \{ \mbox{second card drawn is an Ace} \} \). Since there are four Aces in the deck, it is natural to assign \( \mathbb{P}(A) = 4/52 \). Suppose we look at the first card. What now is the probability of \(B\)? Of course, the answer depends on the value of the first card. If the first card is an Ace, then the probability that the second also is an Ace should be \( 3/51 \), but if the first card is not an Ace, then the probability that the second is an Ace should be \( 4/51 \). As notation for these two situations we write
\[
\mathbb{P}(B|A)=3/51,\quad \mathbb{P}(B|A^{c})=4/51.
\]

</p>
<div class="defn">
<p>The conditional probability of \(B\) given \(A\), denoted \(\mathbb{P}(B|A)\), is defined by
\begin{equation}
\mathbb{P}(B|A)=\frac{\mathbb{P}(A\cap B)}{\mathbb{P}(A)},\quad \mbox{if }\mathbb{P}(A)>0.
\end{equation}
We will not be discussing a conditional probability of \(B\) given \(A\) when \(\mathbb{P}(A)=0\), even though this theory exists, is well developed, and forms the foundation for the study of stochastic processes
</p>
</div>


<div class="exampletoo">
<p>Toss a coin twice. The sample space is given by \(S=\{ HH,\ HT,\ TH,\ TT \} \). Let \(A= \{ \mbox{a head occurs} \} \) and \(B= \{ \mbox{a head and tail occur} \} \). It should be clear that \(\mathbb{P}(A)=3/4\), \(\mathbb{P}(B)=2/4\), and \(\mathbb{P}(A\cap B)=2/4\). What now are the probabilities \(\mathbb{P}(A|B)\) and \(\mathbb{P}(B|A)\)?
\[
\mathbb{P}(A|B)=\frac{\mathbb{P}(A\cap B)}{\mathbb{P}(B)}=\frac{2/4}{2/4}=1,
\]
in other words, once we know that a Head and Tail occur, we may be certain that a Head occurs. Next
\[
\mathbb{P}(B|A)=\frac{\mathbb{P}(A\cap B)}{\mathbb{P}(A)}=\frac{2/4}{3/4}=\frac{2}{3},
\]
which means that given the information that a Head has occurred, we no longer need to account for the outcome \(TT\), and the remaining three outcomes are equally likely with exactly two outcomes lying in the set \(B\). 
</p>
</div>


<div class="exampletoo">
<p><a name="exa-Toss-a-six-sided-die-twice" id="exa-Toss-a-six-sided-die-twice"></a>
Toss a six-sided die twice. The sample space consists of all ordered pairs \((i,j)\) of the numbers \(1,2,\ldots,6\), that is, \( S = \{ (1,1),\ (1,2),\ldots,(6,6) \} \). We know from Section <a href="#sec-4-5">Counting Methods</a> that \( \# (S) = 6^{2} = 36 \). Let \( A = \{ \mbox{outcomes match} \} \) and \( B = \{ \mbox{sum of outcomes at least 8} \} \). The sample space may be represented by a matrix:
</p>




<pre class="src src-R">A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rolldie(2)
B <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(A, X1==X2)
C <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(A, X1+X2 &gt; 7)
B$lab <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rep(<span style="font-style: italic;">"X"</span>, dim(B)[1])
C$lab <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rep(<span style="font-style: italic;">"O"</span>, dim(C)[1])
p <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(rbind(B, C), aes(x=X1, y=X2, label=lab))
p + geom_text(size = 15) + xlab(<span style="font-style: italic;">"First roll"</span>) + ylab(<span style="font-style: italic;">"Second roll"</span>)
</pre>



<pre class="src src-R">  &lt;&lt;twodiceAB&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;twodiceAB&gt;&gt;
</pre>



<div id="fig-twodiceAB" class="figure">
  <p><img src="svg/prob/twodiceAB.svg" width=500 alt="svg/prob/twodiceAB.svg" /></p>
  <p>Rolling two dice. The outcomes in A are marked with X, the outcomes in B are marked with O.</p>
</div>

<p>
The outcomes lying in the event \(A\) are marked with the symbol ``X'', the outcomes falling in \(B\) are marked with ``O'', and the outcomes in \(A\cap B\) are those where the letters overlap. Now it is clear that \(\mathbb{P}(A)=6/36\), \(\mathbb{P}(B)=15/36\), and \(\mathbb{P}(A\cap B)=3/36\).  Finally, 
\[
\mathbb{P}(A|B)=\frac{3/36}{15/36}=\frac{1}{5},\quad \mathbb{P}(B|A)=\frac{3/36}{6/36}=\frac{1}{2}.
\]
Again, we see that given the knowledge that \(B\) occurred (the 15 outcomes in the upper right triangle), there are 3 of the 15 that fall into the set \(A\), thus the probability is \(3/15\). Similarly, given that \(A\) occurred (we are on the diagonal), there are 3 out of 6 outcomes that also fall in \(B\), thus, the probability of \(B\) given \(A\) is 1/2. 
</p>
</div>


</div>

<div id="outline-container-4-6-1" class="outline-4">
<h4 id="sec-4-6-1"><span class="section-number-4">4.6.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-4-6-1">


<p>
Continuing with Example <a href="#exa-Toss-a-six-sided-die-twice">Toss die twice</a>, the first thing to do is set up the probability space with the <code>rolldie</code> function.
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rolldie(2, makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">assumes ELM</span>
head(S)                            <span style="font-weight: bold; font-style: italic;">#  </span><span style="font-weight: bold; font-style: italic;">first few rows</span>
</pre>


<pre class="example">
  X1 X2      probs
1  1  1 0.02777778
2  2  1 0.02777778
3  3  1 0.02777778
4  4  1 0.02777778
5  5  1 0.02777778
6  6  1 0.02777778
</pre>


<p>
Next we define the events
</p>



<pre class="src src-R">A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(S, X1 == X2)
B <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(S, X1 + X2 &gt;= 8)
</pre>


<p>
And now we are ready to calculate probabilities. To do conditional probability, we use the <code>given</code> argument of the <code>prob</code> function:
</p>



<pre class="src src-R">prob::prob(A, given = B)
prob::prob(B, given = A)
</pre>


<pre class="example">
[1] 0.2
[1] 0.5
</pre>


<p>
Note that we do not actually need to define the events \(A\) and \(B\) separately as long as we reference the original probability space \(S\) as the first argument of the <code>prob</code> calculation:
</p>



<pre class="src src-R">prob::prob(S, X1==X2, given = (X1 + X2 &gt;= 8) )
prob::prob(S, X1+X2 &gt;= 8, given = (X1==X2) )
</pre>


<pre class="example">
[1] 0.2
[1] 0.5
</pre>


</div>

</div>

<div id="outline-container-4-6-2" class="outline-4">
<h4 id="sec-4-6-2"><span class="section-number-4">4.6.2</span> Properties and Rules</h4>
<div class="outline-text-4" id="text-4-6-2">


<p>
The following theorem establishes that conditional probabilities behave just like regular probabilities when the conditioned event is fixed. 
</p>

<div class="thm">
<p>For any fixed event \(A\) with \(\mathbb{P}(A)&gt;0\),
</p><ol>
<li>\( \mathbb{P} (B|A)\geq 0 \), for all events \( B \subset S\),
</li>
<li>\( \mathbb{P} (S|A) = 1 \), and
</li>
<li>If \(B_{1}\), \(B_{2}\), \(B_{3}\),&hellip; are disjoint events, then
  \begin{equation}
  \mathbb{P}\left(\left.\bigcup_{k=1}^{\infty}B_{k}\:\right|A\right)=\sum_{k=1}^{\infty}\mathbb{P}(B_{k}|A).
  \end{equation}
</li>
</ol>



</div>
<p>In other words, \(\mathbb{P}(\cdot|A)\) is a legitimate probability function. With this fact in mind, the following properties are immediate:
</p>

<div class="prop">
<p>For any events \(A\), \(B\), and \(C\) with \(\mathbb{P}(A)&gt;0\),
</p><ol>
<li>\( \mathbb{P} ( B^{c} | A ) = 1 - \mathbb{P} (B|A).\)
</li>
<li>If \(B\subset C\) then \(\mathbb{P}(B|A)\leq\mathbb{P}(C|A)\).
</li>
<li>\( \mathbb{P} [ ( B\cup C ) | A ] = \mathbb{P} (B|A) + \mathbb{P}(C|A) - \mathbb{P} [ (B \cap C|A) ].\)
</li>
<li><b>The Multiplication Rule.</b> For any two events \(A\) and \(B\),
  \begin{equation}
  \mathbb{P}(A\cap B)=\mathbb{P}(A)\mathbb{P}(B|A).
  \end{equation}
  <a name="eq-multiplication-rule-short" class="target">eq-multiplication-rule-short</a> 
  And more generally, for events \(A_{1}\), \(A_{2}\), \(A_{3}\),&hellip;, \(A_{n}\),
  \begin{equation}
  \mathbb{P}(A_{1}\cap A_{2}\cap\cdots\cap A_{n})=\mathbb{P}(A_{1})\mathbb{P}(A_{2}|A_{1})\cdots\mathbb{P}(A_{n}|A_{1}\cap A_{2}\cap\cdots\cap A_{n-1}).
  \end{equation}
  <a name="eq-multiplication-rule-long" class="target">eq-multiplication-rule-long</a> 
</li>
</ol>



</div>
<p>The Multiplication Rule is very important because it allows us to find probabilities in random experiments that have a sequential structure, as the next example shows. 
</p>

<div class="exampletoo">
<p><a name="exa-two-cards-both-aces" id="exa-two-cards-both-aces"></a>
At the beginning of the section we drew two cards from a standard playing deck. Now we may answer our original question, what is \(\mathbb{P}(\mbox{both Aces})\)?
\[
\mathbb{P}(\mbox{both Aces})=\mathbb{P}(A\cap B)=\mathbb{P}(A)\mathbb{P}(B|A)=\frac{4}{52}\cdot\frac{3}{51}\approx0.00452.
\]
</p>
</div>


</div>

<div id="outline-container-sub-howto-ps-objects" class="outline-5">
<h5 id="sub-howto-ps-objects"><a name="sec-4-6-2-1" id="sec-4-6-2-1"></a><span class="section-number-5">4.6.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-sub-howto-ps-objects">


<p>
Continuing Example <a href="#exa-two-cards-both-aces">Both Aces</a>, we set up the probability space by way of a three step process. First we employ the <code>cards</code> function to get a data frame <code>L</code> with two columns: <code>rank</code> and <code>suit</code>. Both columns are stored internally as factors with 13 and 4 levels, respectively.
</p>
<p>
Next we sample two cards randomly from the <code>L</code> data frame by way of the <code>urnsamples</code> function. It returns a list <code>M</code> which contains all possible pairs of rows from <code>L</code> (there are <code>choose(52,2)</code> of them). The sample space for this experiment is exactly the list <code>M</code>.
</p>
<p>
At long last we associate a probability model with the sample space. This is right down the <code>probspace</code> function's alley. It assumes the equally likely model by default. We call this result <code>N</code> which is an object of class <code>ps</code> &ndash; short for ``probability space''.
</p>
<p>
But do not be intimidated. The object <code>N</code> is nothing more than a list with two elements: <code>outcomes</code> and <code>probs</code>. The <code>outcomes</code> element is itself just another list, with <code>choose(52,2)</code> entries, each one a data frame with two rows which correspond to the pair of cards chosen. The <code>probs</code> element is just a vector with <code>choose(52,2)</code> entries all the same: <code>1/choose(52,2)</code>.
</p>
<p>
Putting all of this together we do 
</p>



<pre class="src src-R">L <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cards()
M <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> urnsamples(L, size = 2)
N <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> probspace(M)
</pre>


<p>
Now that we have the probability space <code>N</code> we are ready to do some probability. We use the <code>prob</code> function, just like before. The only trick is to specify the event of interest correctly, and recall that we were interested in \(\mathbb{P}(\mbox{both Aces})\). But if the cards are both Aces then the <code>rank</code> of both cards should be <code>A</code>, which sounds like a job for the <code>all</code> function:
</p>



<pre class="src src-R">prob::prob(N, all(rank == <span style="font-style: italic;">"A"</span>))
</pre>


<pre class="example">
[1] 0.004524887
</pre>


<p>
Note that this value matches what we found in Example <a href="#exa-two-cards-both-aces">Both Aces</a>, above. We could calculate all sorts of probabilities at this point; we are limited only by the complexity of the event's computer representation. 
</p>


<div class="exampletoo">
<p><a name="exa-urn-7-red-3-green" id="exa-urn-7-red-3-green"></a>
Consider an urn with 10 balls inside, 7 of which are red and 3 of which are green. Select 3 balls successively from the urn. Let \( A = \{ 1^{\mathrm{st}} \mbox{ ball is red} \} \), \( B = \{ 2^{\mathrm{nd}} \mbox{ ball is red} \} \), and \( C = \{ 3^{\mathrm{rd}} \mbox{ ball is red} \} \). Then
\[
\mathbb{P}(\mbox{all 3 balls are red})=\mathbb{P}(A\cap B\cap C)=\frac{7}{10}\cdot\frac{6}{9}\cdot\frac{5}{8}\approx 0.2917.
\]

</p>
</div>

</div>

</div>

<div id="outline-container-4-6-2-2" class="outline-5">
<h5 id="sec-4-6-2-2"><span class="section-number-5">4.6.2.2</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-4-6-2-2">


<p>
Example <a href="#exa-urn-7-red-3-green">Urn 7 red 3 green</a> is similar to Example <a href="#exa-two-cards-both-aces">Both Aces</a>, but it is even easier. We need to set up an urn (vector <code>L</code>) to hold the balls, we sample from <code>L</code> to get the sample space (data frame <code>M</code>), and we associate a probability vector (column <code>probs</code>) with the outcomes (rows of <code>M</code>) of the sample space. The final result is a probability space (an ordinary data frame <code>N</code>).
</p>
<p>
It is easier for us this time because our urn is a vector instead of a <code>cards()</code> data frame. Before there were two dimensions of information associated with the outcomes (rank and suit) but presently we have only one dimension (color).
</p>



<pre class="src src-R">L <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rep(c(<span style="font-style: italic;">"red"</span>,<span style="font-style: italic;">"green"</span>), times = c(7,3))
M <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> urnsamples(L, size = 3, replace = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
N <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> probspace(M)
</pre>


<p>
Now let us think about how to set up the event \(\{ \mbox{all 3 balls are red}\} \). Rows of <code>N</code> that satisfy this condition have \(\mathtt{X1=="red"\ \&amp;\ X2=="red"\ \&amp;\ X3=="red"}\), but there must be an easier way. Indeed, there is. The <code>isrep</code> function (short for ``is repeated'') in the <code>prob</code> package was written for this purpose. The command <code>isrep(N,"red",3)</code> will test each row of <code>N</code> to see whether the value <code>red</code> appears <code>3</code> times. The result is exactly what we need to define an event with the <code>prob</code> function. Observe
</p>



<pre class="src src-R">prob::prob(N, isrep(N, <span style="font-style: italic;">"red"</span>, 3))
</pre>


<pre class="example">
[1] 0.2916667
</pre>


<p>
Note that this answer matches what we found in Example <a href="#exa-urn-7-red-3-green">Urn 7 red 3 green</a>. Now let us try some other probability questions. What is the probability of getting two <code>red</code>'s?
</p>



<pre class="src src-R">prob::prob(N, isrep(N, <span style="font-style: italic;">"red"</span>, 2))
</pre>


<pre class="example">
[1] 0.525
</pre>


<p>
Note that the exact value is \(21/40\); we will learn a quick way to compute this in Section <a href="#sec-5-6">Other Discrete Distributions</a>. What is the probability of observing <code>red</code>, then <code>green</code>, then <code>red</code>?
</p>



<pre class="src src-R">prob::prob(N, isin(N, c(<span style="font-style: italic;">"red"</span>,<span style="font-style: italic;">"green"</span>,<span style="font-style: italic;">"red"</span>), ordered = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>))
</pre>


<pre class="example">
[1] 0.175
</pre>


<p>
Note that the exact value is \(7/20\) (do it with the Multiplication Rule). What is the probability of observing <code>red</code>, <code>green</code>, and <code>red</code>, in no particular order?
</p>



<pre class="src src-R">prob::prob(N, isin(N, c(<span style="font-style: italic;">"red"</span>,<span style="font-style: italic;">"green"</span>,<span style="font-style: italic;">"red"</span>)))
</pre>


<pre class="example">
[1] 0.525
</pre>


<p>
We already knew this. It is the probability of observing two <code>red</code>'s, above.
</p>

<div class="exampletoo">
<p>Consider two urns, the first with 5 red balls and 3 green balls, and the second with 2 red balls and 6 green balls. Your friend randomly selects one ball from the first urn and transfers it to the second urn, without disclosing the color of the ball. You select one ball from the second urn. What is the probability that the selected ball is red? Let \( A = \{ \mbox{transferred ball is red} \} \) and \( B = \{ \mbox{selected ball is red} \} \). Write
\begin{align*}
B & =S\cap B\\
 & =(A\cup A^{c})\cap B\\
 & =(A\cap B)\cup(A^{c}\cap B)
\end{align*}
and notice that \(A\cap B\) and \(A^{c}\cap B\) are disjoint. Therefore
\begin{align*}
\mathbb{P}(B) & =\mathbb{P}(A\cap B)+\mathbb{P}(A^{c}\cap B)\\
 & =\mathbb{P}(A)\mathbb{P}(B|A)+\mathbb{P}(A^{c})\mathbb{P}(B|A^{c})\\
 & =\frac{5}{8}\cdot\frac{3}{9}+\frac{3}{8}\cdot\frac{2}{9}\\
 & =\frac{21}{72}\ 
\end{align*}
(which is 7/24 in lowest terms).
</p>

</div>


<div class="exampletoo">
<p>We saw the <code>RcmdrTestDrive</code> data set in Chapter <a href="#sec-2">Intro to R</a> in which a two-way table of the smoking status versus the gender was 
</p>



<pre class="src src-R"><span style="font-weight: bold; text-decoration: underline;">library</span>(RcmdrPlugin.IPSUR)
data(RcmdrTestDrive)  
.Table <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> xtabs( ~ smoking + gender, data = RcmdrTestDrive)
addmargins(.Table) <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Table with marginal distributions</span>
</pre>


<p>
If one person were selected at random from the data set, then we see from the two-way table that \(\mathbb{P}(\mbox{Female})=70/168\) and \(\mathbb{P}(\mbox{Smoker})=32/168\). Now suppose that one of the subjects quits smoking, but we do not know the person's gender. If we now select one nonsmoker at random, what would be \(\mathbb{P}(\mbox{Female})\)? This example is just like the last example, but with different labels. Let \( A = \{ \mbox{the quitter is a female} \} \) and \( B = \{ \mbox{selected nonsmoker is a female} \} \). Write
\begin{align*}
B & =S\cap B\\
 & =(A\cup A^{c})\cap B\\
 & =(A\cap B)\cup(A^{c}\cap B)
\end{align*}
and notice that \(A\cap B\) and \(A^{c}\cap B\) are disjoint. Therefore
\begin{align*}
\mathbb{P}(B) & =\mathbb{P}(A\cap B)+\mathbb{P}(A^{c}\cap B),\\
 & =\mathbb{P}(A)\mathbb{P}(B|A)+\mathbb{P}(A^{c})\mathbb{P}(B|A^{c}),\\
 & =\frac{9}{32}\cdot\frac{62}{137}+\frac{23}{32}\cdot\frac{76}{137},\\
 & =\frac{2306}{4384},
\end{align*}
(which is 1153/2192 in lowest terms).
</p>

</div>
<p>Using the same reasoning, we can return to the example from the beginning of the section and show that
\[
\mathbb{P}(\{ \mbox{second card is an Ace} \} )=4/52.
\]
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Independent-Events" class="outline-3">
<h3 id="sec-Independent-Events"><a name="sec-4-7" id="sec-4-7"></a><span class="section-number-3">4.7</span> Independent Events</h3>
<div class="outline-text-3" id="text-sec-Independent-Events">


<p>
Toss a coin twice. The sample space is \(S= \{ HH,\ HT,\ TH,\ TT \} \). We know that \(\mathbb{P}(1^{\mathrm{st}}\mbox{ toss is }H)=2/4\), \(\mathbb{P}(2^{\mathrm{nd}}\mbox{ toss is }H)=2/4\), and \(\mathbb{P}(\mbox{both }H)=1/4\). Then
\begin{align*} \mathbb{P}(2^{\mathrm{nd}}\mbox{ toss is }H\ |\ 1^{\mathrm{st}}\mbox{ toss is }H) & =\frac{\mathbb{P}(\mbox{both }H)}{\mathbb{P}(1^{\mathrm{st}}\mbox{ toss is }H)},\\
 & =\frac{1/4}{2/4},\\
 & =\mathbb{P}(2^{\mathrm{nd}}\mbox{ toss is }H).
\end{align*}
Intuitively, this means that the information that the first toss is \(H\) has no bearing on the probability that the second toss is \(H\). The coin does not remember the result of the first toss. 
</p>

<div class="defn">
<p>Events \(A\) and \(B\) are said to be <i>independent</i> if 
\begin{equation}
\mathbb{P}(A\cap B)=\mathbb{P}(A)\mathbb{P}(B).
\end{equation}
Otherwise, the events are said to be <i>dependent</i>. 
</p>
</div>

<p>
The connection with the above example stems from the following. We know from Section <a href="#sec-4-6">Conditional Probability</a> that when \(\mathbb{P}(B)&gt;0\) we may write
\begin{equation}
\mathbb{P}(A|B)=\frac{\mathbb{P}(A\cap B)}{\mathbb{P}(B)}.
\end{equation}
In the case that \(A\) and \(B\) are independent, the numerator of the fraction factors so that \(\mathbb{P}(B)\) cancels with the result:
\begin{equation}
\mathbb{P}(A|B)=\mathbb{P}(A)\mbox{ when \(A\), \(B\) are independent.}
\end{equation}
The interpretation in the case of independence is that the information that the event \(B\) occurred does not influence the probability of the event \(A\) occurring. Similarly, \(\mathbb{P}(B|A)=\mathbb{P}(B)\), and so the occurrence of the event \(A\) likewise does not affect the probability of event \(B\). It may seem more natural to define \(A\) and \(B\) to be independent when \(\mathbb{P}(A|B)=\mathbb{P}(A)\); however, the conditional probability \(\mathbb{P}(A|B)\) is only defined when \(\mathbb{P}(B)&gt;0\). Our definition is not limited by this restriction. It can be shown that when \(\mathbb{P}(A),\ \mathbb{P}(B)&gt;0\) the two notions of independence are equivalent.
</p>

<div class="prop">
<p>If the events \(A\) and \(B\) are independent then
</p><ul>
<li>\(A\) and \(B^{c}\) are independent,
</li>
<li>\(A^{c}\) and \(B\) are independent,
</li>
<li>\(A^{c}\) and \(B^{c}\) are independent.
</li>
</ul>



</div>


<div class="proof">
<p>Suppose that \(A\) and \(B\) are independent. We will show the second one; the others are similar. We need to show that
\[
\mathbb{P}(A^{c}\cap B)=\mathbb{P}(A^{c})\mathbb{P}(B).
\]
To this end, note that the Multiplication Rule, Equation <a href="#eq-multiplication-rule-short">MR short</a> implies 
\begin{eqnarray*}
\mathbb{P}(A^{c}\cap B) & = & \mathbb{P}(B)\mathbb{P}(A^{c}|B),\\
 & = & \mathbb{P}(B)[1-\mathbb{P}(A|B)],\\
 & = & \mathbb{P}(B)\mathbb{P}(A^{c}).
\end{eqnarray*}
</p>
</div>


<div class="defn">
<p>The events \(A\), \(B\), and \(C\) are <i>mutually independent</i> if the following four conditions are met: 
\begin{eqnarray*}
\mathbb{P}(A\cap B) & = & \mathbb{P}(A)\mathbb{P}(B),\\
\mathbb{P}(A\cap C) & = & \mathbb{P}(A)\mathbb{P}(C),\\
\mathbb{P}(B\cap C) & = & \mathbb{P}(B)\mathbb{P}(C),
\end{eqnarray*}
and
\[
\mathbb{P}(A\cap B\cap C)=\mathbb{P}(A)\mathbb{P}(B)\mathbb{P}(C).
\]
If only the first three conditions hold then \(A\), \(B\), and \(C\) are said to be independent <i>pairwise</i>. Note that pairwise independence is not the same as mutual independence when the number of events is larger than two.
</p>
</div>

<p>
We can now deduce the pattern for \(n\) events, \(n&gt;3\). The events will be mutually independent only if they satisfy the product equality pairwise, then in groups of three, in groups of four, and so forth, up to all \(n\) events at once. For \(n\) events, there will be \(2^{n}-n-1\) equations that must be satisfied (see Exercise <a href="#xca-numb-cond-indep">Number conditions indep</a>). Although these requirements for a set of events to be mutually independent may seem stringent, the good news is that for most of the situations considered in this book the conditions will all be met (or at least we will suppose that they are).
</p>

<div class="exampletoo">
<p><a name="exa-toss-ten-coins" id="exa-toss-ten-coins"></a>
Toss ten coins. What is the probability of observing at least one Head? Answer: Let \(A_{i}= \{ \mbox{the }i^{\mathrm{th}}\mbox{ coin shows }H \} ,\ i=1,2,\ldots,10\). Supposing that we toss the coins in such a way that they do not interfere with each other, this is one of the situations where all of the \(A_{i}\) may be considered mutually independent due to the nature of the tossing. Of course, the only way that there will not be at least one Head showing is if all tosses are Tails. Therefore,
\begin{align*}
\mathbb{P}(\mbox{at least one }H) & =1-\mathbb{P}(\mbox{all }T),\\
 & =1-\mathbb{P}(A_{1}^{c}\cap A_{2}^{c}\cap\cdots\cap A_{10}^{c}),\\
 & =1-\mathbb{P}(A_{1}^{c})\mathbb{P}(A_{2}^{c})\cdots\mathbb{P}(A_{10}^{c}),\\
 & =1-\left(\frac{1}{2}\right)^{10},
\end{align*}
which is approximately \(0.9990234\).
</p>

</div>


</div>

<div id="outline-container-4-7-1" class="outline-4">
<h4 id="sec-4-7-1"><span class="section-number-4">4.7.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-4-7-1">



<div class="exampletoo">
<p>Toss ten coins. What is the probability of observing at least one Head?
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> tosscoin(10, makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> subset(S, isrep(S, vals = <span style="font-style: italic;">"T"</span>, nrep = 10))
1 - prob::prob(A)
</pre>


<p>
Compare this answer to what we got in Example <a href="#exa-toss-ten-coins">Toss 10 coins</a>.
</p>

</div>

</div>

</div>

<div id="outline-container-4-7-2" class="outline-4">
<h4 id="sec-4-7-2"><span class="section-number-4">4.7.2</span> Independent, Repeated Experiments</h4>
<div class="outline-text-4" id="text-4-7-2">


<p>
Generalizing from above it is common to repeat a certain experiment multiple times under identical conditions and in an independent manner. We have seen many examples of this already: tossing a coin repeatedly, rolling a die or dice, <i>etc</i>.
</p>
<p>
The <code>iidspace</code> function was designed specifically for this situation. It has three arguments: <code>x</code>, which is a vector of outcomes, <code>ntrials</code>, which is an integer telling how many times to repeat the experiment, and <code>probs</code> to specify the probabilities of the outcomes of <code>x</code> in a single trial. 
</p>

<div class="exampletoo">
<p><b>An unbalanced coin</b> (continued, see Example <a href="#exa-unbalanced-coin">Unbalanced Coin</a>). It was easy enough to set up the probability space for one unbalanced toss, however, the situation becomes more complicated when there are many tosses involved. Clearly, the outcome \(HHH\) should not have the same probability as \(TTT\), which should again not have the same probability as \(HTH\). At the same time, there is symmetry in the experiment in that the coin does not remember the face it shows from toss to toss, and it is easy enough to toss the coin in a similar way repeatedly.
</p>
<p>
We may represent tossing our unbalanced coin three times with the following: 
</p>



<pre class="src src-R">iidspace(c(<span style="font-style: italic;">"H"</span>,<span style="font-style: italic;">"T"</span>), ntrials = 3, probs = c(0.7, 0.3)) 
</pre>


<p>
As expected, the outcome \(HHH\) has the largest probability, while \(TTT\) has the smallest. (Since the trials are independent, \(\mathbb{P}(HHH)=0.7^{3}\) and \(\mathbb{P}(TTT)=0.3^{3}\), <i>etc</i>.) Note that the result of the function call is a probability space, not a sample space (which we could construct already with the <code>tosscoin</code> or <code>urnsamples</code> functions). The same procedure could be used to model an unbalanced die or any other experiment that may be represented with a vector of possible outcomes.
</p>

</div>

<p>
Note that <code>iidspace</code> will assume <code>x</code> has equally likely outcomes if no <code>probs</code> argument is specified. Also note that the argument <code>x</code> is a <i>vector</i>, not a data frame. Something like <code>iidspace(tosscoin(1),...)</code> would give an error.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Bayes--Rule" class="outline-3">
<h3 id="sec-Bayes--Rule"><a name="sec-4-8" id="sec-4-8"></a><span class="section-number-3">4.8</span> Bayes' Rule</h3>
<div class="outline-text-3" id="text-sec-Bayes--Rule">


<p>
We mentioned the subjective view of probability in Section <a href="#sec-4-3">Interpreting Probabilities</a>. In this section we introduce a rule that allows us to update our probabilities when new information becomes available. 
</p>

<div class="thm">
<p><b>Bayes' Rule</b>. Let \(B_{1}\), \(B_{2}\), &hellip;, \(B_{n}\) be mutually exclusive and exhaustive and let \(A\) be an event with \(\mathbb{P}(A)&gt;0\). Then 
\begin{equation}
\mathbb{P}(B_{k}|A)=\frac{\mathbb{P}(B_{k})\mathbb{P}(A|B_{k})}{\sum_{i=1}^{n}\mathbb{P}(B_{i})\mathbb{P}(A|B_{i})},\quad k=1,2,\ldots,n.
\end{equation}
<a name="eq-bayes-rule" class="target">eq-bayes-rule</a> 
</p>
</div>


<div class="proof">
<p>The proof follows from looking at \(\mathbb{P}(B_{k}\cap A)\) in two different ways. For simplicity, suppose that \(P(B_{k})&gt;0\) for all \(k\). Then
\[
\mathbb{P}(A)\mathbb{P}(B_{k}|A)=\mathbb{P}(B_{k}\cap A)=\mathbb{P}(B_{k})\mathbb{P}(A|B_{k}).
\]
Since \(\mathbb{P}(A)&gt;0\) we may divide through to obtain 
\[
\mathbb{P}(B_{k}|A)=\frac{\mathbb{P}(B_{k})\mathbb{P}(A|B_{k})}{\mathbb{P}(A)}.
\]
Now remembering that \(\{ B_{k} \}\) is a partition, the Theorem of Total Probability (Equation <a href="#eq-theorem-total-probability">TTP</a>) gives the denominator of the last expression to be
\[
\mathbb{P}(A)=\sum_{k=1}^{n}\mathbb{P}(B_{k}\cap A)=\sum_{k=1}^{n}\mathbb{P}(B_{k})\mathbb{P}(A|B_{k}).
\]
</p>
</div>

<p>
What does it mean? Usually in applications we are given (or know) <i>a priori</i> probabilities \(\mathbb{P}(B_{k})\). We go out and collect some data, which we represent by the event \(A\). We want to know: how do we <b>update</b> \(\mathbb{P}(B_{k})\) to \(\mathbb{P}(B_{k}|A)\)? The answer: Bayes' Rule.
</p>

<div class="exampletoo">
<p><a name="exa-misfiling-assistants" id="exa-misfiling-assistants"></a>
<b>Misfiling Assistants.</b> In this problem, there are three assistants working at a company: Moe, Larry, and Curly. Their primary job duty is to file paperwork in the filing cabinet when papers become available. The three assistants have different work schedules:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left"></th><th scope="col" class="left">Moe</th><th scope="col" class="left">Larry</th><th scope="col" class="left">Curly</th></tr>
</thead>
<tbody>
<tr><td class="left">Workload</td><td class="left">\(60\%\)</td><td class="left">\(30\%\)</td><td class="left">\(10\%\)</td></tr>
</tbody>
</table>


<p>
That is, Moe works 60% of the time, Larry works 30% of the time, and Curly does the remaining 10%, and they file documents at approximately the same speed. Suppose a person were to select one of the documents from the cabinet at random. Let \(M\) be the event
\[
M= \{ \mbox{Moe filed the document} \}
\]
and let \(L\) and \(C\) be the events that Larry and Curly, respectively, filed the document. What are these events' respective probabilities? In the absence of additional information, reasonable prior probabilities would just be
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left"></th><th scope="col" class="left">Moe</th><th scope="col" class="left">Larry</th><th scope="col" class="left">Curly</th></tr>
</thead>
<tbody>
<tr><td class="left">Prior Probability</td><td class="left">0.6</td><td class="left">0.3</td><td class="left">0.1</td></tr>
</tbody>
</table>


<p>
Now, the boss comes in one day, opens up the file cabinet, and selects a file at random. The boss discovers that the file has been misplaced. The boss is so angry at the mistake that (s)he threatens to fire the one who erred. The question is: who misplaced the file?
</p>
<p>
The boss decides to use probability to decide, and walks straight to the workload schedule. (S)he reasons that, since the three employees work at the same speed, the probability that a randomly selected file would have been filed by each one would be proportional to his workload. The boss notifies <b>Moe</b> that he has until the end of the day to empty his desk.
</p>
<p>
But Moe argues in his defense that the boss has ignored additional information. Moe's likelihood of having misfiled a document is smaller than Larry's and Curly's, since he is a diligent worker who pays close attention to his work. Moe admits that he works longer than the others, but he doesn't make as many mistakes as they do. Thus, Moe recommends that &ndash; before making a decision &ndash; the boss should update the probability (initially based on workload alone) to incorporate the likelihood of having observed a misfiled document.
</p>
<p>
And, as it turns out, the boss has information about Moe, Larry, and Curly's filing accuracy in the past (due to historical performance evaluations). The performance information may be represented by the following table:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left"></th><th scope="col" class="left">Moe</th><th scope="col" class="left">Larry</th><th scope="col" class="left">Curly</th></tr>
</thead>
<tbody>
<tr><td class="left">Misfile Rate</td><td class="left">0.003</td><td class="left">0.007</td><td class="left">0.010</td></tr>
</tbody>
</table>


<p>
In other words, on the average, Moe misfiles 0.3% of the documents he is supposed to file. Notice that Moe was correct: he is the most accurate filer, followed by Larry, and lastly Curly. If the boss were to make a decision based only on the worker's overall accuracy, then <b>Curly</b> should get the axe. But Curly hears this and interjects that he only works a short period during the day, and consequently makes mistakes only very rarely; there is only the tiniest chance that he misfiled this particular document.
</p>
<p>
The boss would like to use this updated information to update the probabilities for the three assistants, that is, (s)he wants to use the additional likelihood that the document was misfiled to update his/her beliefs about the likely culprit. Let \(A\) be the event that a document is misfiled. What the boss would like to know are the three probabilities
\[
\mathbb{P}(M|A),\mbox{ }\mathbb{P}(L|A),\mbox{ and }\mathbb{P}(C|A).
\]
We will show the calculation for \(\mathbb{P}(M|A)\), the other two cases being similar. We use Bayes' Rule in the form
\[
\mathbb{P}(M|A)=\frac{\mathbb{P}(M\cap A)}{\mathbb{P}(A)}.
\]
Let's try to find \(\mathbb{P}(M\cap A)\), which is just \(\mathbb{P}(M)\cdot\mathbb{P}(A|M)\) by the Multiplication Rule. We already know \(\mathbb{P}(M)=0.6\) and \(\mathbb{P}(A|M)\) is nothing more than Moe's misfile rate, given above to be \(\mathbb{P}(A|M)=0.003\). Thus, we compute
\[
\mathbb{P}(M\cap A)=(0.6)(0.003)=0.0018.
\]
Using the same procedure we may calculate
\[
\mathbb{P}(L \cap A)=0.0021\mbox{ and }\mathbb{P}(C \cap A)=0.0010.
\]

Now let's find the denominator, \(\mathbb{P}(A)\). The key here is the notion that if a file is misplaced, then either Moe or Larry or Curly must have filed it; there is no one else around to do the misfiling. Further, these possibilities are mutually exclusive. We may use the Theorem of Total Probability <a href="#eq-theorem-total-probability">TTP</a> to write
\[ 
\mathbb{P}(A)=\mathbb{P}(A\cap M)+\mathbb{P}(A\cap L)+\mathbb{P}(A\cap C).
\]
Luckily, we have computed these above. Thus
\[
\mathbb{P}(A)=0.0018+0.0021+0.0010=0.0049.
\]
Therefore, Bayes' Rule yields
\[
\mathbb{P}(M|A)=\frac{0.0018}{0.0049}\approx0.37.
\]
This last quantity is called the posterior probability that Moe misfiled the document, since it incorporates the observed data that a randomly selected file was misplaced (which is governed by the misfile rate). We can use the same argument to calculate
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left"></th><th scope="col" class="left">Moe</th><th scope="col" class="left">Larry</th><th scope="col" class="left">Curly</th></tr>
</thead>
<tbody>
<tr><td class="left">Posterior Probability</td><td class="left">\(\approx0.37\)</td><td class="left">\(\approx0.43\)</td><td class="left">\(\approx0.20\)</td></tr>
</tbody>
</table>

The conclusion: <b>Larry</b> gets the axe. What is happening is an intricate interplay between the time on the job and the misfile rate. It is not obvious who the winner (or in this case, loser) will be, and the statistician needs to consult Bayes' Rule to determine the best course of action.

</div>


<div class="exampletoo">
<p><a name="exa-misfiling-assistants-multiple" id="exa-misfiling-assistants-multiple"></a>
Suppose the boss gets a change of heart and does not fire anybody. But the next day (s)he randomly selects another file and again finds it to be misplaced. To decide whom to fire now, the boss would use the same procedure, with one small change. (S)he would not use the prior probabilities 60%, 30%, and 10%; those are old news. Instead, she would replace the prior probabilities with the posterior probabilities just calculated. After the math she will have new posterior probabilities, updated even more from the day before.
</p>
<p>
In this way, probabilities found by Bayes' rule are always on the cutting edge, always updated with respect to the best information available at the time.
</p>
</div>


</div>

<div id="outline-container-4-8-1" class="outline-4">
<h4 id="sec-4-8-1"><span class="section-number-4">4.8.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-4-8-1">


<p>
There are not any special functions for Bayes' Rule in the <code>prob</code> package, but problems like the ones above are easy enough to do by hand.
</p>

<div class="exampletoo">
<p><b>Misfiling assistants</b> (continued from Example <a href="#exa-misfiling-assistants">Misfiling Assistants</a>). We store the prior probabilities and the likelihoods in vectors and go to town.
</p>



<pre class="src src-R">prior <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(0.6, 0.3, 0.1)
like <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(0.003, 0.007, 0.010)
post <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> prior * like
post / sum(post)
</pre>



</div>


<p>
Compare these answers with what we got in Example <a href="#exa-misfiling-assistants">Misfiling Assistants</a>. We would replace <code>prior</code> with <code>post</code> in a future calculation. We could raise <code>like</code> to a power to see how the posterior is affected by future document mistakes. (Do you see why? Think back to Section <a href="#sec-4-7">Independent Events</a>.)
</p>


<div class="exampletoo">
<p>Let us incorporate the posterior probability (<code>post</code>) information from the last example and suppose that the assistants misfile seven more documents. Using Bayes' Rule, what would the new posterior probabilities be?
</p>



<pre class="src src-R">newprior <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> post
post <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> newprior * like^7
post / sum(post)
</pre>


<p>
We see that the individual with the highest probability of having misfiled all eight documents given the observed data is no longer Larry, but Curly. 
</p>
</div>

<p>
There are two important points. First, we did not divide <code>post</code> by the sum of its entries until the very last step; we do not need to calculate it, and it will save us computing time to postpone normalization until absolutely necessary, namely, until we finally want to interpret them as probabilities.
</p>
<p>
Second, the reader might be wondering what the boss would get if (s)he skipped the intermediate step of calculating the posterior after only one misfiled document. What if she started from the <i>original</i> prior, then observed eight misfiled documents, and calculated the posterior? What would she get? It must be the same answer, of course.
</p>



<pre class="src src-R">fastpost <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> prior * like^8
fastpost / sum(fastpost)
</pre>



<p>
Compare this to what we got in Example <a href="#exa-misfiling-assistants-multiple">Misfiling Assistants Multiple</a>.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Random-Variables" class="outline-3">
<h3 id="sec-Random-Variables"><a name="sec-4-9" id="sec-4-9"></a><span class="section-number-3">4.9</span> Random Variables</h3>
<div class="outline-text-3" id="text-sec-Random-Variables">


<p>
We already know about experiments, sample spaces, and events. In this section, we are interested in a <i>number</i> that is associated with the experiment. We conduct a random experiment \(E\) and after learning the outcome \(\omega\) in \(S\) we calculate a number \(X\). That is, to each outcome \(\omega\) in the sample space we associate a number \(X(\omega)=x\). 
</p>

<div class="defn">
<p>A <i>random variable</i> \(X\) is a function \(X:S\to\mathbb{R}\) that associates to each outcome \(\omega\in S\) exactly one number \(X(\omega)=x\). 
</p>
</div>

<p>
We usually denote random variables by uppercase letters such as \(X\), \(Y\), and \(Z\), and we denote their observed values by lowercase letters \(x\), \(y\), and \(z\). Just as \(S\) is the set of all possible outcomes of \(E\), we call the set of all possible values of \(X\) the <i>support</i> of \(X\) and denote it by \(S_{X}\).
</p>

<div class="exampletoo">
<p>Let \(E\) be the experiment of flipping a coin twice. We have seen that the sample space is \( S = \{ HH,\ HT,\ TH,\ TT \} \). Now define the random variable \(X = \mbox{the number of heads}\). That is, for example, \(X(HH)=2\), while \(X(HT)=1\). We may make a table of the possibilities:
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-flip-coin-twice">
<caption>Flipping a coin twice.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">\(\omega\in S\)</th><th scope="col" class="left">\(HH\)</th><th scope="col" class="left">\(HT\)</th><th scope="col" class="left">\(TH\)</th><th scope="col" class="left">\(TT\)</th></tr>
</thead>
<tbody>
<tr><td class="left">\(X(\omega)=x\)</td><td class="left">2</td><td class="left">1</td><td class="left">1</td><td class="left">0</td></tr>
</tbody>
</table>


<p>
Taking a look at the second row of the table, we see that the support of \(X\) &ndash; the set of all numbers that \(X\) assumes &ndash; would be \( S_{X}= \{ 0,1,2 \} \).
</p>
</div>


<div class="exampletoo">
<p>Let \(E\) be the experiment of flipping a coin repeatedly until observing a Head. The sample space would be \(S= \{ H,\ TH,\ TTH,\ TTTH,\ \ldots \} \). Now define the random variable \(Y=\mbox{the number of Tails before the first head}\). Then the support of \(Y\) would be \( S_{Y}= \{ 0,1,2,\ldots \} \).
</p>
</div>


<div class="exampletoo">
<p>Let \(E\) be the experiment of tossing a coin in the air, and define the random variable \( Z = \mbox{the time (in seconds) until the coin hits the ground} \). In this case, the sample space is inconvenient to describe. Yet the support of \(Z\) would be \((0,\infty)\). Of course, it is reasonable to suppose that the coin will return to Earth in a short amount of time; in practice, the set \((0,\infty)\) is admittedly too large. However, we will find that in many circumstances it is mathematically convenient to study the extended set rather than a restricted one. 
</p>
</div>

<p>
There are important differences between the supports of \(X\), \(Y\), and \(Z\). The support of \(X\) is a finite collection of elements that can be inspected all at once. And while the support of \(Y\) cannot be exhaustively written down, its elements can nevertheless be listed in a naturally ordered sequence. Random variables with supports similar to those of \(X\) and \(Y\) are called <i>discrete random variables</i>. We study these in Chapter <a href="#sec-5">Discrete Distributions</a>.
</p>
<p>
In contrast, the support of \(Z\) is a continuous interval, containing all rational and irrational positive real numbers. For this reason
random variables with supports like \(Z\) are called <i>continuous random variables</i>, to be studied in Chapter <a href="#sec-6">Continuous Distributions</a>.
</p>

</div>

<div id="outline-container-4-9-1" class="outline-4">
<h4 id="sec-4-9-1"><span class="section-number-4">4.9.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-4-9-1">


<p>
The primary vessel for this task is the <code>addrv</code> function. There are two ways to use it, and we will describe both.
</p>

</div>

<div id="outline-container-4-9-1-1" class="outline-5">
<h5 id="sec-4-9-1-1"><span class="section-number-5">4.9.1.1</span> Supply a Defining Formula</h5>
<div class="outline-text-5" id="text-4-9-1-1">


<p>
The first method is based on the <code>transform</code> function. See <code>?transform</code>. The idea is to write a formula defining the random variable inside the function, and it will be added as a column to the data frame. As an example, let us roll a 4-sided die three times, and let us define the random variable \(U=X1-X2+X3\). 
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rolldie(3, nsides = 4, makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) 
S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> addrv(S, U = X1-X2+X3) 
</pre>


<p>
Now let's take a look at the values of \(U\). In the interest of space, we will only reproduce the first few rows of \(S\) (there are \(4^{3}=64\) rows in total). 
</p>



<pre class="src src-R">head(S)
</pre>


<pre class="example">
  X1 X2 X3 U    probs
1  1  1  1 1 0.015625
2  2  1  1 2 0.015625
3  3  1  1 3 0.015625
4  4  1  1 4 0.015625
5  1  2  1 0 0.015625
6  2  2  1 1 0.015625
</pre>


<p>
We see from the \(U\) column it is operating just like it should. We can now answer questions like
</p>



<pre class="src src-R">prob::prob(S, U &gt; 6) 
</pre>


<pre class="example">
[1] 0.015625
</pre>


</div>

</div>

<div id="outline-container-4-9-1-2" class="outline-5">
<h5 id="sec-4-9-1-2"><span class="section-number-5">4.9.1.2</span> Supply a Function</h5>
<div class="outline-text-5" id="text-4-9-1-2">


<p>
Sometimes we have a function laying around that we would like to apply to some of the outcome variables, but it is unfortunately tedious to write out the formula defining what the new variable would be. The <code>addrv</code> function has an argument <code>FUN</code> specifically for this case. Its value should be a legitimate function from \(\mathsf{R}\), such as <code>sum</code>, <code>mean</code>, <code>median</code>, and so forth. Or, you can define your own function. Continuing the previous example, let's define \(V=\max(X1,X2,X3)\) and \(W=X1+X2+X3\). 
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> addrv(S, FUN = max, invars = c(<span style="font-style: italic;">"X1"</span>,<span style="font-style: italic;">"X2"</span>,<span style="font-style: italic;">"X3"</span>), name = <span style="font-style: italic;">"V"</span>) 
S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> addrv(S, FUN = sum, invars = c(<span style="font-style: italic;">"X1"</span>,<span style="font-style: italic;">"X2"</span>,<span style="font-style: italic;">"X3"</span>), name = <span style="font-style: italic;">"W"</span>) 
head(S) 
</pre>


<pre class="example">
  X1 X2 X3 U V W    probs
1  1  1  1 1 1 3 0.015625
2  2  1  1 2 2 4 0.015625
3  3  1  1 3 3 5 0.015625
4  4  1  1 4 4 6 0.015625
5  1  2  1 0 2 4 0.015625
6  2  2  1 1 2 5 0.015625
</pre>


<p>
Notice that <code>addrv</code> has an <code>invars</code> argument to specify exactly to which columns one would like to apply the function <code>FUN</code>. If no input variables are specified, then <code>addrv</code> will apply <code>FUN</code> to all non-=probs= columns. Further, <code>addrv</code> has an optional argument <code>name</code> to give the new variable; this can be useful when adding several random variables to a probability space (as above). If not specified, the default name is <code>X</code>.
</p>
</div>
</div>

</div>

<div id="outline-container-4-9-2" class="outline-4">
<h4 id="sec-4-9-2"><span class="section-number-4">4.9.2</span> Marginal Distributions</h4>
<div class="outline-text-4" id="text-4-9-2">


<p>
As we can see above, often after adding a random variable \(V\) to a probability space one will find that \(V\) has values that are repeated, so that it becomes difficult to understand what the ultimate behavior of \(V\) actually is. We can use the <code>marginal</code> function to aggregate the rows of the sample space by values of \(V\), all the while accumulating the probability associated with \(V\)'s distinct values. Continuing our example from above, suppose we would like to focus entirely on the values and probabilities of \(V=\max(X1,X2,X3)\). 
</p>



<pre class="src src-R">marginal(S, vars = <span style="font-style: italic;">"V"</span>) 
</pre>


<pre class="example">
  V    probs
1 1 0.015625
2 2 0.109375
3 3 0.296875
4 4 0.578125
</pre>


<p>
We could save the probability space of \(V\) in a data frame and study it further, if we wish. As a final remark, we can calculate the marginal distributions of multiple variables desired using the <code>vars</code> argument. For example, suppose we would like to examine the joint distribution of \(V\) and \(W\). 
</p>



<pre class="src src-R">marginal(S, vars = c(<span style="font-style: italic;">"V"</span>, <span style="font-style: italic;">"W"</span>)) 
</pre>



<pre class="example">   V  W    probs
1  1  3 0.015625
2  2  4 0.046875
3  2  5 0.046875
4  3  5 0.046875
5  2  6 0.015625
6  3  6 0.093750
7  4  6 0.046875
8  3  7 0.093750
9  4  7 0.093750
10 3  8 0.046875
11 4  8 0.140625
12 3  9 0.015625
13 4  9 0.140625
14 4 10 0.093750
15 4 11 0.046875
16 4 12 0.015625
</pre>


<p>
Note that the default value of <code>vars</code> is the names of all columns except <code>probs</code>. This can be useful if there are duplicated rows in the probability space.
</p>

</div>
</div>

</div>

<div id="outline-container-4-10" class="outline-3">
<h3 id="sec-4-10"><span class="section-number-3">4.10</span> Exercises</h3>
<div class="outline-text-3" id="text-4-10">




<div class="xca">
<p><a name="xca-numb-cond-indep" id="xca-numb-cond-indep"></a>
Prove the assertion given in the text: the number of conditions that the events \(A_{1}\), \(A_{2}\), &hellip;, \(A_{n}\) must satisfy in order to be mutually independent is \(2^{n}-n-1\). (<i>Hint</i>: think about Pascal's triangle.)
</p>
</div>

<p>
<b>Answer:</b>
The events must satisfy the product equalities two at a time, of which there are \({n \choose 2}\), then they must satisfy an additional \({n \choose 3}\) conditions three at a time, and so on, until they satisfy the \({n \choose n}=1\) condition including all \(n\) events. In total, there are 
\[
{n \choose 2}+{n \choose 3}+\cdots+{n \choose n}=\sum_{k=0}^{n}{n \choose k}-\left[{n \choose 0}+{n \choose 1}\right]
\]
conditions to be satisfied, but the binomial series in the expression on the right is the sum of the entries of the \(n^{\mathrm{th}}\) row of Pascal's triangle, which is \(2^{n}\).
</p>
</div>
</div>

</div>

<div id="outline-container-cha-Discrete-Distributions" class="outline-2">
<h2 id="cha-Discrete-Distributions"><a name="sec-5" id="sec-5"></a><span class="section-number-2">5</span> Discrete Distributions</h2>
<div class="outline-text-2" id="text-cha-Discrete-Distributions">




<p>
In this chapter we introduce discrete random variables, those who take values in a finite or countably infinite support set. We discuss probability mass functions and some special expectations, namely, the mean, variance and standard deviation. Some of the more important discrete distributions are explored in detail, and the more general concept of expectation is defined, which paves the way for moment generating functions. 
</p>
<p>
We give special attention to the empirical distribution since it plays such a fundamental role with respect to resampling and Chapter <a href="#sec-13">Resampling Methods</a>; it will also be needed in Section <a href="#sec-10-5-1">Kolmogorov-Smirnov</a> where we discuss the Kolmogorov-Smirnov test. Following this is a section in which we introduce a catalogue of discrete random variables that can be used to model experiments.
</p>
<p>
There are some comments on simulation, and we mention transformations of random variables in the discrete case. The interested reader who would like to learn more about any of the assorted discrete distributions mentioned here should take a look at <i>Univariate Discrete Distributions</i> by Johnson <i>et al</i>\cite{Johnson1993}.
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>how to choose a reasonable discrete model under a variety of physical circumstances
</li>
<li>item the notion of mathematical expectation, how to calculate it, and basic properties- moment generating functions (yes, I want them to hear about those)
</li>
<li>the general tools of the trade for manipulation of continuous random variables, integration, <i>etc</i>.
</li>
<li>some details on a couple of discrete models, and exposure to a bunch of other ones
</li>
<li>how to make new discrete random variables from old ones
</li>
</ul>



</div>

<div id="outline-container-sec-discrete-random-variables" class="outline-3">
<h3 id="sec-discrete-random-variables"><a name="sec-5-1" id="sec-5-1"></a><span class="section-number-3">5.1</span> Discrete Random Variables</h3>
<div class="outline-text-3" id="text-sec-discrete-random-variables">



</div>

<div id="outline-container-sub-probability-mass-functions" class="outline-4">
<h4 id="sub-probability-mass-functions"><a name="sec-5-1-1" id="sec-5-1-1"></a><span class="section-number-4">5.1.1</span> Probability Mass Functions</h4>
<div class="outline-text-4" id="text-sub-probability-mass-functions">


<p>
Discrete random variables are characterized by their supports which take the form
\begin{equation}
S_{X}=\{u_{1},u_{2},\ldots,u_{k}\}\mbox{ or }S_{X}=\{u_{1},u_{2},u_{3}\ldots\}.
\end{equation}
Every discrete random variable \(X\) has associated with it a probability mass function (PMF) \(f_{X}:S_{X}\to[0,1]\) defined by
\begin{equation}
f_{X}(x)=\mathbb{P}(X=x),\quad x\in S_{X}.
\end{equation}
Since values of the PMF represent probabilities, we know from Chapter <a href="#sec-4">Probability</a> that PMFs enjoy certain properties. In particular, all PMFs satisfy
</p><ol>
<li>\(f_{X}(x)&gt;0\) for \(x\in S\),
</li>
<li>\(\sum_{x\in S}f_{X}(x)=1\), and
</li>
<li>\(\mathbb{P}(X\in A)=\sum_{x\in A}f_{X}(x)\), for any event \(A\subset S\).
</li>
</ol>



<div class="exampletoo">
<p><a name="exa-Toss-a-coin" id="exa-Toss-a-coin"></a>
</p>
<p>
Toss a coin 3 times. The sample space would be
\[
S=\{ HHH,\ HTH,\ THH,\ TTH,\ HHT,\ HTT,\ THT,\ TTT\}.
\]
Now let \(X\) be the number of Heads observed. Then \(X\) has support \(S_{X}=\{ 0,1,2,3\} \). Assuming that the coin is fair and was tossed in exactly the same way each time, it is not unreasonable to suppose that the outcomes in the sample space are all equally likely. 
</p>
<p>
What is the PMF of \(X\)? Notice that \(X\) is zero exactly when the outcome \(TTT\) occurs, and this event has probability \(1/8\). Therefore, \(f_{X}(0)=1/8\), and the same reasoning shows that \(f_{X}(3)=1/8\). Exactly three outcomes result in \(X=1\), thus, \(f_{X}(1)=3/8\) and \(f_{X}(3)\) holds the remaining \(3/8\) probability (the total is 1). We can represent the PMF with a table:
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-pmf-flip-coin-three">
<caption>Flipping a coin three times: the PMF.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">\(x\in S_{X}\)</th><th scope="col" class="left">0</th><th scope="col" class="left">1</th><th scope="col" class="left">2</th><th scope="col" class="left">3</th><th scope="col" class="left">Total</th></tr>
</thead>
<tbody>
<tr><td class="left">\(f_{X}(x)=\mathbb{P}(X=x)\)</td><td class="left">1/8</td><td class="left">3/8</td><td class="left">3/8</td><td class="left">1/8</td><td class="left">1</td></tr>
</tbody>
</table>



</div>

</div>

</div>

<div id="outline-container-sub-mean-variance-sd" class="outline-4">
<h4 id="sub-mean-variance-sd"><a name="sec-5-1-2" id="sec-5-1-2"></a><span class="section-number-4">5.1.2</span> Mean, Variance, and Standard Deviation</h4>
<div class="outline-text-4" id="text-sub-mean-variance-sd">


<p>
There are numbers associated with PMFs. One important example is the mean \(\mu\), also known as \(\mathbb{E} X\) (which we will discuss later):
\begin{equation}
\mu=\mathbb{E} X=\sum_{x\in S}xf_{X}(x),
\end{equation}
provided the (potentially infinite) series \(\sum|x|f_{X}(x)\) is convergent. Another important number is the variance:
\begin{equation}
\sigma^{2}=\sum_{x\in S}(x-\mu)^{2}f_{X}(x),
\end{equation}
which can be computed (see Exercise <a href="#xca-variance-shortcut">Variance Shortcut</a>) with the alternate formula \(\sigma^{2}=\sum x{}^{2}f_{X}(x)-\mu^{2}\). Directly defined from the variance is the standard deviation \(\sigma=\sqrt{\sigma^{2}}\).
</p>

<div class="exampletoo">
<p><a name="exa-disc-pmf-mean" id="exa-disc-pmf-mean"></a>
We will calculate the mean of \(X\) in Example <a href="#exa-Toss-a-coin">Toss a coin</a>.
\[
\mu=\sum_{x=0}^{3}xf_{X}(x)=0\cdot\frac{1}{8}+1\cdot\frac{3}{8}+2\cdot\frac{3}{8}+3\cdot\frac{1}{8}=3.5.
\]
We interpret \(\mu = 3.5\) by reasoning that if we were to repeat the random experiment many times, independently each time, observe many corresponding outcomes of the random variable \(X\), and take the sample mean of the observations, then the calculated value would fall close to 3.5. The approximation would get better as we observe more and more values of \(X\) (another form of the Law of Large Numbers; see Section <a href="#sec-4-3">Interpreting Probabilities</a>). Another way it is commonly stated is that \(X\) is 3.5 ``on the average'' or ``in the long run''.
</p>
</div>


<div class="rem">
<p>Note that although we say \(X\) is 3.5 on the average, we must keep in mind that our \(X\) never actually equals 3.5 (in fact, it is impossible for \(X\) to equal 3.5).
</p>
</div>

<p>
Related to the probability mass function \(f_{X}(x)=\mathbb{P}(X=x)\) is another important function called the <i>cumulative distribution function</i> (CDF), \(F_{X}\). It is defined by the formula
\begin{equation}
F_{X}(t)=\mathbb{P}(X\leq t),\quad -\infty < t < \infty.
\end{equation}
We know that all PMFs satisfy certain properties, and a similar statement may be made for CDFs. In particular, any CDF \(F_{X}\) satisfies
</p><ul>
<li>\(F_{X}\) is nondecreasing (\(t_{1}\leq t_{2}\) implies \(F_{X}(t_{1})\leq F_{X}(t_{2})\)).
</li>
<li>\(F_{X}\) is right-continuous (\(\lim_{t\to a^{+}}F_{X}(t)=F_{X}(a)\) for all \(a\in\mathbb{R}\)).
</li>
<li>\(\lim_{t\to-\infty}F_{X}(t)=0\) and \(\lim_{t\to\infty}F_{X}(t)=1\).
</li>
</ul>

<p>We say that \(X\) has the distribution \(F_{X}\) and we write \(X\sim F_{X}\). In an abuse of notation we will also write \(X\sim f_{X}\) and for the named distributions the PMF or CDF will be identified by the family name instead of the defining formula.
</p>

</div>

<div id="outline-container-sub-disc-rv-how-r" class="outline-5">
<h5 id="sub-disc-rv-how-r"><a name="sec-5-1-2-1" id="sec-5-1-2-1"></a><span class="section-number-5">5.1.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-sub-disc-rv-how-r">


<p>
The mean and variance of a discrete random variable is easy to compute at the console. Let's return to Example <a href="#exa-disc-pmf-mean">Disc PMF mean</a>. We will start by defining a vector <code>x</code> containing the support of \(X\), and a vector <code>f</code> to contain the values of \(f_{X}\) at the respective outcomes in <code>x</code>:
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(0,1,2,3)
f <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(1/8, 3/8, 3/8, 1/8)
</pre>


<p>
To calculate the mean \(\mu\), we need to multiply the corresponding values of <code>x</code> and <code>f</code> and add them. This is easily accomplished in \(\mathsf{R}\) since operations on vectors are performed <i>element-wise</i> (see Section <a href="#sec-2-3-4">Functions and Expressions</a>): 
</p>



<pre class="src src-R">mu <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sum(x * f)
mu
</pre>


<pre class="example">
[1] 1.5
</pre>


<p>
To compute the variance \(\sigma^{2}\), we subtract the value of <code>mu</code> from each entry in <code>x</code>, square the answers, multiply by <code>f</code>,and <code>sum</code>. The standard deviation \(\sigma\) is simply the square root of \(\sigma^{2}\).
</p>



<pre class="src src-R">sigma2 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sum((x-mu)^2 * f)
sigma2
</pre>


<pre class="example">
[1] 0.75
</pre>





<pre class="src src-R">sigma <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sqrt(sigma2)
sigma
</pre>


<pre class="example">
[1] 0.8660254
</pre>


<p>
Finally, we may find the values of the CDF \(F_{X}\) on the support by accumulating the probabilities in \(f_{X}\) with the <code>cumsum</code> function. 
</p>



<pre class="src src-R">F <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cumsum(f)
F
</pre>


<pre class="example">
[1] 0.125 0.500 0.875 1.000
</pre>


<p>
As easy as this is, it is even easier to do with the <code>distrEx</code> package \cite{Ruckdescheldistr}. We define a random variable <code>X</code> as an object, then compute things from the object such as mean, variance, and standard deviation with the functions <code>E</code>, <code>var</code>, and <code>sd</code>:
</p>



<pre class="src src-R">X <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> DiscreteDistribution(supp = 0:3, prob = c(1,3,3,1)/8)
E(X); var(X); sd(X)
</pre>


<pre class="example">
[1] 1.5
[1] 0.75
[1] 0.8660254
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-sec-disc-uniform-dist" class="outline-3">
<h3 id="sec-disc-uniform-dist"><a name="sec-5-2" id="sec-5-2"></a><span class="section-number-3">5.2</span> The Discrete Uniform Distribution</h3>
<div class="outline-text-3" id="text-sec-disc-uniform-dist">


<p>
We have seen the basic building blocks of discrete distributions and we now study particular models that statisticians often encounter in the field. Perhaps the most fundamental of all is the <i>discrete uniform</i> distribution.
</p>
<p>
A random variable \(X\) with the discrete uniform distribution on the integers \(1,2,\ldots,m\) has PMF
\begin{equation}
f_{X}(x)=\frac{1}{m},\quad x=1,2,\ldots,m.
\end{equation}
We write \(X\sim\mathsf{disunif}(m)\). A random experiment where this distribution occurs is the choice of an integer at random between 1 and 100, inclusive. Let \(X\) be the number chosen. Then \(X\sim\mathsf{disunif}(m=100)\) and
\[
\mathbb{P}(X=x)=\frac{1}{100},\quad x=1,\ldots,100.
\]
We find a direct formula for the mean of \(X\sim\mathsf{disunif}(m)\):
\begin{equation}
\mu=\sum_{x=1}^{m}xf_{X}(x)=\sum_{x=1}^{m}x\cdot\frac{1}{m}=\frac{1}{m}(1+2+\cdots+m)=\frac{m+1}{2},
\end{equation}
where we have used the famous identity \(1+2+\cdots+m=m(m+1)/2\). That is, if we repeatedly choose integers at random from 1 to \(m\) then, on the average, we expect to get \((m+1)/2\). To get the variance we first calculate
\[
\sum_{x=1}^{m}x^{2}f_{X}(x)=\frac{1}{m}\sum_{x=1}^{m}x^{2}=\frac{1}{m}\frac{m(m+1)(2m+1)}{6}=\frac{(m+1)(2m+1)}{6},
\]
and finally,
\begin{equation}
\sigma^{2}=\sum_{x=1}^{m}x^{2}f_{X}(x)-\mu^{2}=\frac{(m+1)(2m+1)}{6}-\left(\frac{m+1}{2}\right)^{2}=\cdots=\frac{m^{2}-1}{12}.
\end{equation}

</p>
<div class="exampletoo">
<p>Roll a die and let \(X\) be the upward face showing. Then \(m=6\), \(\mu=7/2=3.5\), and \(\sigma^{2}=(6^{2}-1)/12=35/12\).
</p>
</div>


</div>

<div id="outline-container-5-2-1" class="outline-4">
<h4 id="sec-5-2-1"><span class="section-number-4">5.2.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-5-2-1">


</div>

</div>

<div id="outline-container-5-2-2" class="outline-4">
<h4 id="sec-5-2-2"><span class="section-number-4">5.2.2</span> From the console:</h4>
<div class="outline-text-4" id="text-5-2-2">

<p>One can choose an integer at random with the <code>sample</code> function. The general syntax to simulate a discrete uniform random variable is <code>sample(x, size, replace = TRUE)</code>.
</p>
<p>
The argument <code>x</code> identifies the numbers from which to randomly sample. If <code>x</code> is a number, then sampling is done from 1 to <code>x</code>. The argument <code>size</code> tells how big the sample size should be, and <code>replace</code> tells whether or not numbers should be replaced in the urn after having been sampled. The default option is <code>replace = FALSE</code> but for discrete uniforms the sampled values should be replaced. Some examples follow.
</p>
</div>

</div>

<div id="outline-container-5-2-3" class="outline-4">
<h4 id="sec-5-2-3"><span class="section-number-4">5.2.3</span> Examples</h4>
<div class="outline-text-4" id="text-5-2-3">

<ul>
<li>To roll a fair die 3000 times, do <code>sample(6, size = 3000, replace = TRUE)</code>.
</li>
<li>To choose 27 random numbers from 30 to 70, do <code>sample(30:70, size = 27, replace = TRUE)</code>.
</li>
<li>To flip a fair coin 1000 times, do <code>sample(c("H","T"), size = 1000, replace = TRUE)</code>.
</li>
</ul>


</div>

</div>

<div id="outline-container-5-2-4" class="outline-4">
<h4 id="sec-5-2-4"><span class="section-number-4">5.2.4</span> With the \(\mathsf{R}\) Commander:</h4>
<div class="outline-text-4" id="text-5-2-4">


<p>
Follow the sequence <code>Probability</code> \(\triangleright\) <code>Discrete Distributions</code> \(\triangleright\) <code>Discrete Uniform distribution</code> \(\triangleright\) <code>Simulate Discrete uniform variates...</code>.
</p>
<p>
Suppose we would like to roll a fair die 3000 times. In the <code>Number of samples</code> field we enter <code>1</code>. Next, we describe what interval of integers to be sampled. Since there are six faces numbered 1 through 6, we set <code>from = 1</code>, we set <code>to = 6</code>, and set <code>by = 1</code> (to indicate that we travel from 1 to 6 in increments of 1 unit). We will generate a list of 3000 numbers selected from among 1, 2, &hellip;, 6, and we store the results of the simulation. For the time being, we select <code>New Data set</code>. Click <code>OK</code>.
</p>
<p>
Since we are defining a new data set, the \(\mathsf{R}\) Commander requests a name for the data set. The default name is <code>Simset1</code>, although in principle you could name it whatever you like (according to \(\mathsf{R}\)'s rules for object names). We wish to have a list that is 3000 long, so we set <code>Sample Size = 3000</code> and click <code>OK</code>.
</p>
<p>
In the \(\mathsf{R}\) Console window, the \(\mathsf{R}\) Commander should tell you that <code>Simset1</code> has been initialized, and it should also alert you that <code>There was 1 discrete uniform variate sample stored in Simset 1.</code>. To take a look at the rolls of the die, we click <code>View data set</code> and a window opens.  
</p>
<p>
The default name for the variable is <code>disunif.sim1</code>.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-binom-dist" class="outline-3">
<h3 id="sec-binom-dist"><a name="sec-5-3" id="sec-5-3"></a><span class="section-number-3">5.3</span> The Binomial Distribution</h3>
<div class="outline-text-3" id="text-sec-binom-dist">


<p>
The binomial distribution is based on a <i>Bernoulli trial</i>, which is a random experiment in which there are only two possible outcomes: success (\(S\)) and failure (\(F\)). We conduct the Bernoulli trial and let 
\begin{equation}
X=
\begin{cases}
1 & \mbox{if the outcome is $S$},\\
0 & \mbox{if the outcome is $F$}.
\end{cases}
\end{equation}
If the probability of success is \(p\) then the probability of failure must be \(1-p=q\) and the PMF of \(X\) is
\begin{equation}
f_{X}(x)=p^{x}(1-p)^{1-x},\quad x=0,1.
\end{equation}
It is easy to calculate \(\mu=\mathbb{E} X=p\) and \(\mathbb{E} X^{2}=p\) so that \(\sigma^{2}=p-p^{2}=p(1-p)\).
</p>

</div>

<div id="outline-container-sub-The-Binomial-Model" class="outline-4">
<h4 id="sub-The-Binomial-Model"><a name="sec-5-3-1" id="sec-5-3-1"></a><span class="section-number-4">5.3.1</span> The Binomial Model</h4>
<div class="outline-text-4" id="text-sub-The-Binomial-Model">


<p>
The Binomial model has three defining properties:
</p><ul>
<li>Bernoulli trials are conducted \(n\) times,
</li>
<li>the trials are independent,
</li>
<li>the probability of success \(p\) does not change between trials.
</li>
</ul>

<p>If \(X\) counts the number of successes in the \(n\) independent trials, then the PMF of \(X\) is 
\begin{equation}
f_{X}(x)={n \choose x}p^{x}(1-p)^{n-x},\quad x=0,1,2,\ldots,n.
\end{equation}
We say that \(X\) has a <i>binomial distribution</i> and we write \(X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\). It is clear that \(f_{X}(x)\geq0\) for all \(x\) in the support because the value is the product of nonnegative numbers. We next check that \(\sum f(x)=1\):
\[
\sum_{x=0}^{n}{n \choose x}p^{x}(1-p)^{n-x}=[p+(1-p)]^{n}=1^{n}=1.
\]
We next find the mean:
\begin{alignat*}{1}
\mu= & \sum_{x=0}^{n}x\,{n \choose x}p^{x}(1-p)^{n-x},\\
= & \sum_{x=1}^{n}x\,\frac{n!}{x!(n-x)!}p^{x}q^{n-x},\\
= & n\cdot p\sum_{x=1}^{n}\frac{(n-1)!}{(x-1)!(n-x)!}p^{x-1}q^{n-x},\\
= & np\,\sum_{x-1=0}^{n-1}{n-1 \choose x-1}p^{(x-1)}(1-p)^{(n-1)-(x-1)},\\
= & np.
\end{alignat*}
A similar argument shows that \(\mathbb{E} X(X-1)=n(n-1)p^{2}\) (see Exercise <a href="#xca-binom-factorial-expectation">Binom factorial exp</a>). Therefore
\begin{alignat*}{1}
\sigma^{2}= & \mathbb{E} X(X-1)+\mathbb{E} X-[\mathbb{E} X]^{2},\\
= & n(n-1)p^{2}+np-(np)^{2},\\
= & n^{2}p^{2}-np^{2}+np-n^{2}p^{2},\\
= & np-np^{2}=np(1-p).
\end{alignat*}

</p>
<div class="exampletoo">
<p>A four-child family. Each child may be either a boy (\(B\)) or a girl (\(G\)). For simplicity we suppose that \(\mathbb{P}(B)=\mathbb{P}(G)=1/2\) and that the genders of the children are determined independently. If we let \(X\) count the number of \(B\)'s, then \(X\sim\mathsf{binom}(\mathtt{size}=4,\,\mathtt{prob}=1/2)\). Further, \(\mathbb{P}(X=2)\) is
\[
f_{X}(2)={4 \choose 2}(1/2)^{2}(1/2)^{2}=\frac{6}{2^{4}}.
\]
The mean number of boys is \(4(1/2)=2\) and the variance of \(X\) is \(4(1/2)(1/2)=1\).
</p>
</div>


</div>

<div id="outline-container-5-3-1-1" class="outline-5">
<h5 id="sec-5-3-1-1"><span class="section-number-5">5.3.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-5-3-1-1">


<p>
The corresponding \(\mathsf{R}\) function for the PMF and CDF are <code>dbinom</code> and <code>pbinom</code>, respectively. We demonstrate their use in the following examples.  
</p>

<div class="exampletoo">
<p>We can calculate it in \(\mathsf{R}\) Commander under the <code>Binomial Distribution</code> menu with the <code>Binomial probabilities</code> menu item.
</p>


<pre class="src src-R">  A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(Pr=dbinom(0:4, size = 4, prob = 0.5))
  rownames(A) <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 0:4 
  A
</pre>



</div>

<p>
We know that the \(\mathsf{binom}(\mathtt{size}=4,\,\mathtt{prob}=1/2)\) distribution is supported on the integers 0, 1, 2, 3, and 4; thus the table is complete. We can read off the answer to be \(\mathbb{P}(X=2)=0.3750\).
</p>

<div class="exampletoo">
<p>Roll 12 dice simultaneously, and let \(X\) denote the number of 6's that appear. We wish to find the probability of getting seven, eight, or nine 6's. If we let \(S=\{ \mbox{get a 6 on one roll} \} \), then \(\mathbb{P}(S)=1/6\) and the rolls constitute Bernoulli trials; thus \(X\sim\mathsf{binom}(\mathtt{size}=12,\ \mathtt{prob}=1/6)\) and our task is to find \(\mathbb{P}(7\leq X\leq9)\). This is just
\[ 
\mathbb{P}(7\leq X\leq9)=\sum_{x=7}^{9}{12 \choose x}(1/6)^{x}(5/6)^{12-x}.
\]
Again, one method to solve this problem would be to generate a probability mass table and add up the relevant rows. However, an alternative method is to notice that \(\mathbb{P}(7\leq X\leq9)=\mathbb{P}(X\leq9)-\mathbb{P}(X\leq6)=F_{X}(9)-F_{X}(6)\), so we could get the same answer by using the <code>Binomial tail probabilities...</code> menu in the \(\mathsf{R}\) Commander or the following from the command line: 
</p>



<pre class="src src-R">pbinom(9, size=12, prob=1/6) - pbinom(6, size=12, prob=1/6)
diff(pbinom(c(6,9), size = 12, prob = 1/6))  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">same thing</span>
</pre>



</div>


<div class="exampletoo">
<p><a name="exa-toss-coin-3-withR" id="exa-toss-coin-3-withR"></a>
Toss a coin three times and let \(X\) be the number of Heads observed. We know from before that \(X\sim\mathsf{binom}(\mathtt{size}=3,\,\mathtt{prob}=1/2)\) which implies the following PMF:
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-flip-coin-thrice">
<caption>Flipping a coin three times: the PMF.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">\(x=\mbox{num. of Heads}\)</th><th scope="col" class="left">0</th><th scope="col" class="left">1</th><th scope="col" class="left">2</th><th scope="col" class="left">3</th><th scope="col" class="left">Total</th></tr>
</thead>
<tbody>
<tr><td class="left">\(f(x) = \mathbb{P}(X = x)\)</td><td class="left">1/8</td><td class="left">3/8</td><td class="left">3/8</td><td class="left">1/8</td><td class="left">1</td></tr>
</tbody>
</table>


<p>
Our next goal is to write down the CDF of \(X\) explicitly. The first case is easy: it is impossible for \(X\) to be negative, so if \(x&lt;0\) then we should have \(\mathbb{P}(X\leq x)=0\). Now choose a value \(x\) satisfying \(0\leq x&lt;1\), say, \(x=0.3\). The only way that \(X\leq x\) could happen would be if \(X=0\), therefore, \(\mathbb{P}(X\leq x)\) should equal \(\mathbb{P}(X=0)\), and the same is true for any \(0\leq x&lt;1\). Similarly, for any \(1\leq x&lt;2\), say, \(x=1.73\), the event \(\{ X\leq x \}\) is exactly the event \(\{ X=0\mbox{ or }X=1 \}\). Consequently, \(\mathbb{P}(X\leq x)\) should equal \(\mathbb{P}(X=0\mbox{ or }X=1)=\mathbb{P}(X=0)+\mathbb{P}(X=1)\). Continuing in this fashion, we may figure out the values of \(F_{X}(x)\) for all possible inputs \(-\infty&lt;x&lt;\infty\), and we may summarize our observations with the following piecewise defined function:
\[
F_{X}(x)=\mathbb{P}(X\leq x)=
\begin{cases}
0, & x<0,\\
\frac{1}{8}, & 0\leq x<1,\\
\frac{1}{8}+\frac{3}{8}=\frac{4}{8}, & 1\leq x<2,\\
\frac{4}{8}+\frac{3}{8}=\frac{7}{8}, & 2\leq x<3,\\
1, & x\geq3.
\end{cases}
\]
In particular, the CDF of \(X\) is defined for the entire real line, \(\mathbb{R}\). The CDF is right continuous and nondecreasing. A graph of the \(\mathsf{binom}(\mathtt{size}=3,\,\mathtt{prob}=1/2)\) CDF is shown in Figure <a href="#fig-binom-cdf-base">binom-cdf-base</a>.
</p>
</div>










<div id="fig-binom-cdf-base" class="figure">
  <p><img src="svg/discdist/binom-cdf-base.svg" width=500 alt="svg/discdist/binom-cdf-base.svg" /></p>
  <p> A graph of the <code>binom(size = 3, prob = 1/2)</code> CDF.</p>
</div>


<div class="exampletoo">
<p>Another way to do Example <a href="#exa-toss-coin-3-withR">Toss coin 3 with R</a> is with the <code>distr</code> family of packages \cite{Ruckdescheldistr}. They use an object oriented approach to random variables, that is, a random variable is stored in an object <code>X</code>, and then questions about the random variable translate to functions on and involving <code>X</code>. Random variables with distributions from the <code>base</code> package are specified by capitalizing the name of the distribution.
</p>



<pre class="src src-R">X <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> Binom(size = 3, prob = 1/2)
X
</pre>


<p>
The analogue of the <code>dbinom</code> function for <code>X</code> is the <code>d(X)</code> function, and the analogue of the <code>pbinom</code> function is the <code>p(X)</code> function. Compare the following:
</p>



<pre class="src src-R">d(X)(1)   <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">pmf of X evaluated at x = 1</span>
p(X)(2)   <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">cdf of X evaluated at x = 2</span>
</pre>



</div>

<p>
Random variables defined via the <code>distr</code> package may be <i>plotted</i>, which will return graphs of the PMF, CDF, and quantile function (introduced in Section <a href="#sec-6-3-1">Normal Quantiles</a>). See Figure <a href="#fig-binom-plot-distr">binom-plot-distr</a> for an example.
</p>



<pre class="src src-R">plot(X, cex = 0.2)
</pre>







<div id="fig-binom-plot-distr" class="figure">
  <p><img src="svg/discdist/binom-plot-distr.svg" width=500 alt="svg/discdist/binom-plot-distr.svg" /></p>
  <p>The <code>binom(size = 3, prob = 0.5)</code> distribution from the <code>distr</code> package.</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption>Correspondence between <code>stats</code> and <code>distr</code>. We are given \(X&sim;\mathsf{dbinom}(\mathtt{size}=n,\,\mathtt{prob}=p)\).  For the <code>distr</code> package we must first set \(\mathtt{X\ &lt;-\ Binom(size=}n\mathtt{,\ prob=}p\mathtt{)}\).</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">How to do:</th><th scope="col" class="left">with <code>stats</code> (default)</th><th scope="col" class="left">with <code>distr</code></th></tr>
</thead>
<tbody>
<tr><td class="left">PMF: \(\mathbb{P}(X=x)\)</td><td class="left">\(\mathtt{dbinom(x,size=n,prob=p)}\)</td><td class="left">\(\mathtt{d(X)(x)}\)</td></tr>
<tr><td class="left">CDF:  \(\mathbb{P}(X\leq x)\)</td><td class="left">\(\mathtt{pbinom(x,size=n,prob=p)}\)</td><td class="left">\(\mathtt{p(X)(x)}\)</td></tr>
<tr><td class="left">Simulate \(k\) variates</td><td class="left">\(\mathtt{rbinom(k,size=n,prob=p)}\)</td><td class="left">\(\mathtt{r(X)(k)}\)</td></tr>
</tbody>
</table>


</div>
</div>
</div>

</div>

<div id="outline-container-sec-expectation-and-mgfs" class="outline-3">
<h3 id="sec-expectation-and-mgfs"><a name="sec-5-4" id="sec-5-4"></a><span class="section-number-3">5.4</span> Expectation and Moment Generating Functions</h3>
<div class="outline-text-3" id="text-sec-expectation-and-mgfs">



</div>

<div id="outline-container-sub-expectation-operator" class="outline-4">
<h4 id="sub-expectation-operator"><a name="sec-5-4-1" id="sec-5-4-1"></a><span class="section-number-4">5.4.1</span> The Expectation Operator</h4>
<div class="outline-text-4" id="text-sub-expectation-operator">


<p>
We next generalize some of the concepts from Section <a href="#sec-5-1-2">Mean-variance-sd</a>. There we saw that every
PMF has two important numbers associated with it:
\begin{equation}
\mu=\sum_{x\in S}xf_{X}(x),\quad \sigma^{2}=\sum_{x\in S}(x-\mu)^{2}f_{X}(x).
\end{equation}
Intuitively, for repeated observations of \(X\) we would expect the sample mean to closely approximate \(\mu\) as the sample size increases without bound. For this reason we call \(\mu\) the <i>expected value</i> of \(X\) and we write \(\mu=\mathbb{E} X\), where \(\mathbb{E}\) is an <i>expectation operator</i>.
</p>

<div class="defn">
<p>More generally, given a function \(g\) we define the <i>expected value of</i> \(g(X)\) by
\begin{equation}
\mathbb{E}\, g(X)=\sum_{x\in S}g(x)f_{X}(x),
\end{equation}
provided the (potentially infinite) series \(\sum_{x}|g(x)|f(x)\) is convergent. We say that \(\mathbb{E} g(X)\) <i>exists</i>.
</p>
</div>

<p>
In this notation the variance is \(\sigma^{2}=\mathbb{E}(X-\mu)^{2}\) and we prove the identity
\begin{equation}
\mathbb{E}(X-\mu)^{2}=\mathbb{E} X^{2}-(\mathbb{E} X)^{2}
\end{equation}
in Exercise <a href="#xca-variance-shortcut">Variance Shortcut</a>. Intuitively, for repeated observations of \(X\) we would expect the sample mean of the \(g(X)\) values to closely approximate \(\mathbb{E}\, g(X)\) as the sample size increases without bound.
</p>
<p>
Let us take the analogy further. If we expect \(g(X)\) to be close to \(\mathbb{E} g(X)\) on the average, where would we expect \(3g(X)\) to be on the average? It could only be \(3\mathbb{E} g(X)\). The following theorem makes this idea precise.
</p>

<div class="prop">
<p><a name="pro-expectation-properties" id="pro-expectation-properties"></a>
For any functions \(g\) and \(h\), any random variable \(X\), and any constant \(c\): 
</p><ol>
<li>\(\mathbb{E}\: c=c\),
</li>
<li>\(\mathbb{E}[c\cdot g(X)]=c\mathbb{E} g(X)\)
</li>
<li>\(\mathbb{E}[g(X)+h(X)]=\mathbb{E} g(X)+\mathbb{E} h(X)\),
</li>
</ol>

<p>provided \(\mathbb{E} g(X)\) and \(\mathbb{E} h(X)\) exist.
</p>
</div>


<div class="proof">
<p>Go directly from the definition. For example,
\[
\mathbb{E}[c\cdot g(X)]=\sum_{x\in S}c\cdot g(x)f_{X}(x)=c\cdot\sum_{x\in S}g(x)f_{X}(x)=c\mathbb{E} g(X).
\]
</p>
</div>

</div>

</div>

<div id="outline-container-sub-MGFs" class="outline-4">
<h4 id="sub-MGFs"><a name="sec-5-4-2" id="sec-5-4-2"></a><span class="section-number-4">5.4.2</span> Moment Generating Functions</h4>
<div class="outline-text-4" id="text-sub-MGFs">



<div class="defn">
<p>Given a random variable \(X\), its <i>moment generating function</i> (abbreviated MGF) is defined by the formula
\begin{equation}
M_{X}(t)=\mathbb{E}\mathrm{e}^{tX}=\sum_{x\in S}\mathrm{e}^{tx}f_{X}(x),
\end{equation}
provided the (potentially infinite) series is convergent for all \(t\) in a neighborhood of zero (that is, for all \(-\epsilon&lt;t&lt;\epsilon\), for some \(\epsilon&gt;0\)).
</p>
</div>

<p>
Note that for any MGF \(M_{X}\),
\begin{equation}
M_{X}(0)=\mathbb{E}\mathrm{e}^{0\cdot X}=\mathbb{E}1=1.
\end{equation}
We will calculate the MGF for the two distributions introduced above.
</p>

<div class="exampletoo">
<p>Find the MGF for \(X\sim\mathsf{disunif}(m)\). 
Since \(f(x)=1/m\), the MGF takes the form
\[
M(t)=\sum_{x=1}^{m}\mathrm{e}^{tx}\frac{1}{m}=\frac{1}{m}(\mathrm{e}^{t}+\mathrm{e}^{2t}+\cdots+\mathrm{e}^{mt}),\quad \mbox{for any \(t\).}
\]

</p>
</div>


<div class="exampletoo">
<p>Find the MGF for \(X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\).
</p>
</div>



\begin{alignat*}{1}
M_{X}(t)= & \sum_{x=0}^{n}\mathrm{e}^{tx}\,{n \choose x}\, p^{x}(1-p)^{n-x},\\
= & \sum_{x=0}^{n}{n \choose x}\,(p\mathrm{e}^{t})^{x}q^{n-x},\\
= & (p\mathrm{e}^{t}+q)^{n},\quad \mbox{for any $t$.}
\end{alignat*}


</div>

<div id="outline-container-5-4-2-1" class="outline-5">
<h5 id="sec-5-4-2-1"><span class="section-number-5">5.4.2.1</span> Applications</h5>
<div class="outline-text-5" id="text-5-4-2-1">


<p>
We will discuss three applications of moment generating functions in this book. The first is the fact that an MGF may be used to accurately identify the probability distribution that generated it, which rests on the following:
</p>

<div class="thm">
<p><a name="thm-mgf-unique" id="thm-mgf-unique"></a>
The moment generating function, if it exists in a neighborhood of zero, determines a probability distribution <i>uniquely</i>. 
</p>
</div>


<div class="proof">
<p>Unfortunately, the proof of such a theorem is beyond the scope of a text like this one. Interested readers could consult Billingsley \cite{Billingsley1995}.
</p>
</div>


<p>
We will see an example of Theorem <a href="#thm-mgf-unique">MGF Unique</a> in action.
</p>

<div class="exampletoo">
<p>Suppose we encounter a random variable which has MGF
\[
M_{X}(t)=(0.3+0.7\mathrm{e}^{t})^{13}.
\]
Then \(X\sim\mathsf{binom}(\mathtt{size}=13,\,\mathtt{prob}=0.7)\).
</p>
</div>

<p>
An MGF is also known as a ``Laplace Transform'' and is manipulated in that context in many branches of science and engineering.
</p>
</div>

</div>

<div id="outline-container-5-4-2-2" class="outline-5">
<h5 id="sec-5-4-2-2"><span class="section-number-5">5.4.2.2</span> Why is it called a Moment Generating Function?</h5>
<div class="outline-text-5" id="text-5-4-2-2">


<p>
This brings us to the second powerful application of MGFs. Many of the models we study have a simple MGF, indeed, which permits us to determine the mean, variance, and even higher moments very quickly. Let us see why. We already know that 
\begin{alignat*}{1}
M(t)= & \sum_{x\in S}\mathrm{e}^{tx}f(x).
\end{alignat*}
Take the derivative with respect to \(t\) to get
\begin{equation}
M'(t)=\frac{\mathrm{d}}{\mathrm{d} t}\left(\sum_{x\in S}\mathrm{e}^{tx}f(x)\right)=\sum_{x\in S}\ \frac{\mathrm{d}}{\mathrm{d} t}\left(\mathrm{e}^{tx}f(x)\right)=\sum_{x\in S}x\mathrm{e}^{tx}f(x),
\end{equation}
and so if we plug in zero for \(t\) we see
\begin{equation}
M'(0)=\sum_{x\in S}x\mathrm{e}^{0}f(x)=\sum_{x\in S}xf(x)=\mu=\mathbb{E} X.
\end{equation}
Similarly, \(M''(t)=\sum x^{2}\mathrm{e}^{tx}f(x)\) so that \(M''(0)=\mathbb{E} X^{2}\). And in general, we can see
that
\begin{equation}
M_{X}^{(r)}(0)=\mathbb{E} X^{r}=\mbox{\(r^{\mathrm{th}}\) moment of \(X\) about the origin.}
\end{equation}

These are also known as <i>raw moments</i> and are sometimes denoted \(\mu_{r}'\). In addition to these are the so called <i>central moments</i> \(\mu_{r}\) defined by
\begin{equation}
\mu_{r}=\mathbb{E}(X-\mu)^{r},\quad r=1,2,\ldots
\end{equation}

</p>
<div class="exampletoo">
<p>Let \(X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\mbox{ with $M(t)=(q+p\mathrm{e}^{t})^{n}$}\).
</p>
<p>
We calculated the mean and variance of a binomial random variable in Section <a href="#sec-5-3">Binomial Distribution</a> by means of the binomial series. But look how quickly we find the mean and variance with the moment generating function.
\begin{alignat*}{1}
M'(t)= & n(q+p\mathrm{e}^{t})^{n-1}p\mathrm{e}^{t}\left|_{t=0}\right.,\\
= & n\cdot1^{n-1}p,\\
= & np.
\end{alignat*}
And
\begin{alignat*}{1}
M''(0)= & n(n-1)[q+p\mathrm{e}^{t}]^{n-2}(p\mathrm{e}^{t})^{2}+n[q+p\mathrm{e}^{t}]^{n-1}p\mathrm{e}^{t}\left|_{t=0}\right.,\\
\mathbb{E} X^{2}= & n(n-1)p^{2}+np.
\end{alignat*}
Therefore
\begin{alignat*}{1}
\sigma^{2}= & \mathbb{E} X^{2}-(\mathbb{E} X)^{2},\\
= & n(n-1)p^{2}+np-n^{2}p^{2},\\
= & np-np^{2}=npq.
\end{alignat*}
See how much easier that was?
</p>
</div>


<div class="rem">
<p>We learned in this section that \(M^{(r)}(0)=\mathbb{E} X^{r}\). We remember from Calculus II that certain functions \(f\) can be represented by a Taylor series expansion about a point \(a\), which takes the form
\begin{equation}
f(x)=\sum_{r=0}^{\infty}\frac{f^{(r)}(a)}{r!}(x-a)^{r},\quad \mbox{for all \(|x-a| < R\),}
\end{equation}
where \(R\) is called the <i>radius of convergence</i> of the series (see Appendix <a href="#sec-21-3">Sequences and Series</a>). We combine the two to say that if an MGF exists for all \(t\) in the interval \((-\epsilon,\epsilon)\), then we can write
\begin{equation}
M_{X}(t)=\sum_{r=0}^{\infty}\frac{\mathbb{E} X^{r}}{r!}t^{r},\quad \mbox{for all $|t|<\epsilon$.}
\end{equation}
</p>
</div>

</div>

</div>

<div id="outline-container-5-4-2-3" class="outline-5">
<h5 id="sec-5-4-2-3"><span class="section-number-5">5.4.2.3</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-5-4-2-3">


<p>
The <code>distrEx</code> package provides an expectation operator <code>E</code> which can be used on random variables that have been defined in the ordinary <code>distr</code> sense:
</p>



<pre class="src src-R">X <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> Binom(size = 3, prob = 0.45)
E(X)
E(3*X + 4)
</pre>


<pre class="example">
[1] 1.35
[1] 8.05
</pre>


<p>
For discrete random variables with finite support, the expectation is simply computed with direct summation. In the case that the random variable has infinite support and the function is crazy, then the expectation is not computed directly, rather, it is estimated by first generating a random sample from the underlying model and next computing a sample mean of the function of interest. 
</p>
<p>
There are methods for other population parameters:
</p>



<pre class="src src-R">var(X)
sd(X)
</pre>


<pre class="example">
[1] 0.7425
[1] 0.8616844
</pre>


<p>
There are even methods for <code>IQR</code>, <code>mad</code>, <code>skewness</code>, and <code>kurtosis</code>.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-empirical-distribution" class="outline-3">
<h3 id="sec-empirical-distribution"><a name="sec-5-5" id="sec-5-5"></a><span class="section-number-3">5.5</span> The Empirical Distribution</h3>
<div class="outline-text-3" id="text-sec-empirical-distribution">


<p>
Do an experiment \(n\) times and observe \(n\) values \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\) of a random variable \(X\). For simplicity in most of the discussion that follows it will be convenient to imagine that the observed values are distinct, but the remarks are valid even when the observed values are repeated. 
</p>

<div class="defn">
<p>The <i>empirical cumulative distribution function</i> \(F_{n}\) (written ECDF)\index{Empirical distribution} is the probability distribution that places probability mass \(1/n\) on each of the values \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\). The empirical PMF takes the form
\begin{equation} 
f_{X}(x)=\frac{1}{n},\quad x\in \{ x_{1},x_{2},...,x_{n} \}.
\end{equation}
If the value \(x_{i}\) is repeated \(k\) times, the mass at \(x_{i}\) is accumulated to \(k/n\).
</p>
</div>

<p>
The mean of the empirical distribution is
\begin{equation}
\mu=\sum_{x\in S}xf_{X}(x)=\sum_{i=1}^{n}x_{i}\cdot\frac{1}{n}
\end{equation}
and we recognize this last quantity to be the sample mean, \(\overline{x}\). The variance of the empirical distribution is
\begin{equation}
\sigma^{2}=\sum_{x\in S}(x-\mu)^{2}f_{X}(x)=\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}\cdot\frac{1}{n}
\end{equation}
and this last quantity looks very close to what we already know to be the sample variance.
\begin{equation}
s^{2}=\frac{1}{n-1}\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}.
\end{equation}
The <i>empirical quantile function</i> is the inverse of the ECDF. See Section <a href="#sec-6-3-1">Normal Quantiles</a>.
</p>

</div>

<div id="outline-container-5-5-1" class="outline-4">
<h4 id="sec-5-5-1"><span class="section-number-4">5.5.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-5-5-1">


<p>
The empirical distribution is not directly available as a distribution in the same way that the other base probability distributions are, but there are plenty of resources available for the determined investigator.  Given a data vector of observed values <code>x</code>, we can see the empirical CDF with the <code>ecdf</code>\index{ecdf@\texttt{ecdf}} function:
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(4, 7, 9, 11, 12)
ecdf(x)
</pre>


<pre class="example">
Empirical CDF 
Call: ecdf(x)
 x[1:5] =      4,      7,      9,     11,     12
</pre>


<p>
The above shows that the returned value of <code>ecdf(x)</code> is not a <i>number</i> but rather a <i>function</i>. The ECDF is not usually used by itself in this form. More commonly it is used as an intermediate step in a more complicated calculation, for instance, in hypothesis testing (see Chapter <a href="#sec-10">Hypothesis Testing</a>) or resampling (see Chapter <a href="#sec-13">Resampling Methods</a>). It is nevertheless instructive to see what the <code>ecdf</code> looks like, and there is a special plot method for <code>ecdf</code> objects.
</p>



<pre class="src src-R">plot(ecdf(x))
</pre>







<div id="fig-empirical-CDF" class="figure">
  <p><img src="svg/discdist/empirical-CDF.svg" width=500 alt="svg/discdist/empirical-CDF.svg" /></p>
  <p>The empirical CDF.</p>
</div>

<p>
See Figure <a href="#fig-empirical-CDF">empirical-CDF</a>. The graph is of a right-continuous function with jumps exactly at the locations stored in <code>x</code>. There are no repeated values in <code>x</code> so all of the jumps are equal to \(1/5=0.2\).
</p>
<p>
The empirical PDF is not usually of particular interest in itself, but if we really wanted we could define a function to serve as the empirical PDF:
</p>



<pre class="src src-R"><span style="font-weight: bold;">epdf</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x) <span style="font-weight: bold;">function</span>(t){sum(x %<span style="font-weight: bold;">in</span>% t)/length(x)}
x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(0,0,1)
epdf(x)(0)       <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">should be 2/3</span>
</pre>


<pre class="example">
[1] 0.6666667
</pre>


<p>
To simulate from the empirical distribution supported on the vector <code>x</code>, we use the <code>sample</code>\index{sample@\texttt{sample}} function.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(0,0,1)
sample(x, size = 7, replace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<pre class="example">
[1] 1 0 0 0 0 1 0
</pre>


<p>
We can get the empirical quantile function in \(\mathsf{R}\) with <code>quantile(x, probs = p, type = 1)</code>; see Section <a href="#sec-6-3-1">Normal Quantiles</a>.
</p>
<p>
As we hinted above, the empirical distribution is significant more because of how and where it appears in more sophisticated applications. We will explore some of these in later chapters &ndash; see, for instance, Chapter <a href="#sec-13">Resampling Methods</a>.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-other-discrete-distributions" class="outline-3">
<h3 id="sec-other-discrete-distributions"><a name="sec-5-6" id="sec-5-6"></a><span class="section-number-3">5.6</span> Other Discrete Distributions</h3>
<div class="outline-text-3" id="text-sec-other-discrete-distributions">


<p>
The binomial and discrete uniform distributions are popular, and rightly so; they are simple and form the foundation for many other more complicated distributions. But the particular uniform and binomial models only apply to a limited range of problems. In this section we introduce situations for which we need more than what the uniform and binomial offer.
</p>

</div>

<div id="outline-container-sec-non-bernoulli-trials" class="outline-4">
<h4 id="sec-non-bernoulli-trials"><a name="sec-5-6-1" id="sec-5-6-1"></a><span class="section-number-4">5.6.1</span> Dependent Bernoulli Trials</h4>
<div class="outline-text-4" id="text-sec-non-bernoulli-trials">



</div>

<div id="outline-container-sub-hypergeometric-dist" class="outline-5">
<h5 id="sub-hypergeometric-dist"><a name="sec-5-6-1-1" id="sec-5-6-1-1"></a><span class="section-number-5">5.6.1.1</span> The Hypergeometric Distribution</h5>
<div class="outline-text-5" id="text-sub-hypergeometric-dist">


<p>
Consider an urn with 7 white balls and 5 black balls. Let our random experiment be to randomly select 4 balls, without replacement, from the urn. Then the probability of observing 3 white balls (and thus 1 black ball) would be
\begin{equation}
\mathbb{P}(3W,1B)=\frac{{7 \choose 3}{5 \choose 1}}{{12 \choose 4}}.
\end{equation}
More generally, we sample without replacement \(K\) times from an urn with \(M\) white balls and \(N\) black balls. Let \(X\) be the number of white balls in the sample. The PMF of \(X\) is
\begin{equation}
f_{X}(x)=\frac{{M \choose x}{N \choose K-x}}{{M+N \choose K}}.
\end{equation}
We say that \(X\) has a <i>hypergeometric distribution</i> and write \(X\sim\mathsf{hyper}(\mathtt{m}=M,\,\mathtt{n}=N,\,\mathtt{k}=K)\).
</p>
<p>
The support set for the hypergeometric distribution is a little bit tricky. It is tempting to say that \(x\) should go from 0 (no white balls in the sample) to \(K\) (no black balls in the sample), but that does not work if \(K&gt;M\), because it is impossible to have more white balls in the sample than there were white balls originally in the urn. We have the same trouble if \(K&gt;N\). The good news is that the majority of examples we study have \(K\leq M\) and \(K\leq N\) and we will happily take the support to be \(x=0,\ 1,\ \ldots,\ K\). 
</p>
<p>
It is shown in Exercise <a href="#xca-hyper-mean-variance">Hyper-MV</a> that
\begin{equation}
\mu=K\frac{M}{M+N},\quad \sigma^{2}=K\frac{MN}{(M+N)^{2}}\frac{M+N-K}{M+N-1}.
\end{equation}

The associated \(\mathsf{R}\) functions for the PMF and CDF are <code>dhyper(x, m, n, k)</code> and <code>phyper</code>, respectively. There are two more functions: <code>qhyper</code>, which we will discuss in Section <a href="#sec-6-3-1">Normal Quantiles</a>, and <code>rhyper</code>, discussed below.
</p>

<div class="exampletoo">
<p>Suppose in a certain shipment of 250 Pentium processors there are 17 defective processors. A quality control consultant randomly collects 5 processors for inspection to determine whether or not they are defective. Let \(X\) denote the number of defectives in the sample.
</p>
<p>
Find the probability of exactly 3 defectives in the sample, that is, find \(\mathbb{P}(X=3)\). 
   <i>Solution:</i> We know that \(X\sim\mathsf{hyper}(\mathtt{m}=17,\,\mathtt{n}=233,\,\mathtt{k}=5)\). So the required probability is just
   \[
   f_{X}(3)=\frac{{17 \choose 3}{233 \choose 2}}{{250 \choose 5}}.
   \]
   To calculate it in \(\mathsf{R}\) we just type 
</p>



<pre class="src src-R">   dhyper(3, m = 17, n = 233, k = 5)
</pre>


<p>
   To find it with the \(\mathsf{R}\) Commander we go <code>Probability</code> \(\triangleright\) <code>Discrete Distributions</code> \(\triangleright\) <code>Hypergeometric distribution</code> \(\triangleright\) <code>Hypergeometric probabilities...</code>. We fill in the parameters \(m=17\), \(n=233\), and \(k=5\). Click <code>OK</code>, and the following table is shown in the window.
</p>



<pre class="src src-R">   A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(Pr=dhyper(0:4, m = 17, n = 233, k = 5))
   rownames(A) <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 0:4 
   A
</pre>


<p>
   We wanted \(\mathbb{P}(X=3)\), and this is found from the table to be approximately 0.0024. The value is rounded to the fourth decimal place.
   We know from our above discussion that the sample space should be \(x=0,1,2,3,4,5\), yet, in the table the probabilities are only displayed for \(x = 1,2,3,\) and 4. What is happening? As it turns out, the \(\mathsf{R}\) Commander will only display probabilities that are 0.00005 or greater. Since \(x=5\) is not shown, it suggests that the outcome has a tiny probability. To find its exact value we use the <code>dhyper</code> function:
</p>


<pre class="src src-R">   dhyper(5, m = 17, n = 233, k = 5)
</pre>

<p>
   In other words, \(\mathbb{P}(X=5)\approx0.0000007916049\), a small number indeed.
Find the probability that there are at most 2 defectives in the sample, that is, compute \(\mathbb{P}(X\leq2)\).
   <i>Solution:</i> Since \(\mathbb{P}(X\leq2)=\mathbb{P}(X=0,1,2)\), one way to do this would be to add the 0, 1, and 2 entries in the above table. this gives \(0.7011+0.2602+0.0362=0.9975\). Our answer should be correct up to the accuracy of 4 decimal places. However, a more precise method is provided by the \(\mathsf{R}\) Commander. Under the <code>Hypergeometric distribution</code> menu we select <code>Hypergeometric tail probabilities...</code>. We fill in the parameters \(m\), \(n\), and \(k\) as before, but in the <code>Variable value(s)</code> dialog box we enter the value 2. We notice that the <code>Lower tail</code> option is checked, and we leave that alone. Click <code>OK</code>.
</p>



<pre class="src src-R">   phyper(2, m = 17, n = 233, k = 5)
</pre>


<p>
   And thus \(\mathbb{P}(X\leq2)\approx 0.9975771\). We have confirmed that the above answer was correct up to four decimal places.
Find \(\mathbb{P}(X&gt;1)\). 
   The table did not give us the explicit probability \(\mathbb{P}(X=5)\), so we can not use the table to give us this probability. We need to use another method. Since \(\mathbb{P}(X&gt;1)=1-\mathbb{P}(X\leq1)=1-F_{X}(1)\), we can find the probability with <code>Hypergeometric tail probabilities...</code>. We enter 1 for <code>Variable Value(s)</code>, we enter the parameters as before, and in this case we choose the <code>Upper tail</code> option. This results in the following output.
</p>



<pre class="src src-R">   phyper(1, m = 17, n = 233, k = 5, lower.tail = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>


<p>
   In general, the <code>Upper tail</code> option of a tail probabilities dialog computes \(\mathbb{P}(X &gt; x)\) for all given <code>Variable Value(s)</code> \(x\).
Generate \(100,000\) observations of the random variable \(X\).
   We can randomly simulate as many observations of \(X\) as we want in \(\mathsf{R}\) Commander. Simply choose <code>Simulate hypergeometric variates...</code> in the <code>Hypergeometric distribution</code> dialog. 
   In the <code>Number of samples</code> dialog, type 1. Enter the parameters as above. Under the <code>Store Values</code> section, make sure <code>New Data set</code> is selected. Click <code>OK</code>. 
   A new dialog should open, with the default name <code>Simset1</code>.  We could change this if we like, according to the rules for \(\mathsf{R}\) object names. In the sample size box, enter 100000. Click <code>OK</code>. 
   In the Console Window, \(\mathsf{R}\) Commander should issue an alert that <code>Simset1</code> has been initialized, and in a few seconds, it should also state that 100,000 hypergeometric variates were stored in <code>hyper.sim1</code>. We can view the sample by clicking the <code>View Data Set</code> button on the \(\mathsf{R}\) Commander interface.
   We know from our formulas that \(\mu=K\cdot M/(M+N)=5*17/250=0.34\). We can check our formulas using the fact that with repeated observations of \(X\) we would expect about 0.34 defectives on the average. To see how our sample reflects the true mean, we can compute the sample mean
</p><pre class="example">
 Rcmdr&gt; mean(Simset2$hyper.sim1, na.rm=TRUE)
 [1] 0.340344
</pre>


<pre class="example">
 Rcmdr&gt; sd(Simset2$hyper.sim1, na.rm=TRUE)
 [1] 0.5584982
 ...
</pre>

<p>   We see that when given many independent observations of \(X\), the sample mean is very close to the true mean \(\mu\). We can repeat the same idea and use the sample standard deviation to estimate the true standard deviation of \(X\). From the output above our estimate is 0.5584982, and from our formulas we get
   \[
   \sigma^{2}=K\frac{MN}{(M+N)^{2}}\frac{M+N-K}{M+N-1}\approx0.3117896,
   \]
   with \(\sigma=\sqrt{\sigma^{2}}\approx0.5583811944\). Our estimate was pretty close.
   From the console we can generate random hypergeometric variates with the <code>rhyper</code> function, as demonstrated below.
</p>



<pre class="src src-R">   rhyper(10, m = 17, n = 233, k = 5)
</pre>



</div>

</div>

</div>

<div id="outline-container-sub-Sampling-With-and" class="outline-5">
<h5 id="sub-Sampling-With-and"><a name="sec-5-6-1-2" id="sec-5-6-1-2"></a><span class="section-number-5">5.6.1.2</span> Sampling With and Without Replacement</h5>
<div class="outline-text-5" id="text-sub-Sampling-With-and">


<p>
Suppose that we have a large urn with, say, \(M\) white balls and \(N\) black balls. We take a sample of size \(n\) from the urn, and let \(X\) count the number of white balls in the sample. If we sample
</p><dl>
<dt>without replacement,</dt><dd>then \(X\sim\mathsf{hyper}(\mathtt{m=}M,\,\mathtt{n}=N,\,\mathtt{k}=n)\) and has mean and variance
     \begin{alignat*}{1}
     \mu= & n\frac{M}{M+N},\\
     \sigma^{2}= & n\frac{MN}{(M+N)^{2}}\frac{M+N-n}{M+N-1},\\
     = & n\frac{M}{M+N}\left(1-\frac{M}{M+N}\right)\frac{M+N-n}{M+N-1}.
     \end{alignat*}
</dd>
</dl>

<p>On the other hand, if we sample
</p><dl>
<dt>with replacement,</dt><dd>then \(X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=M/(M+N))\) with mean and variance
     \begin{alignat*}{1}
     \mu= & n\frac{M}{M+N},\\
     \sigma^{2}= & n\frac{M}{M+N}\left(1-\frac{M}{M+N}\right).
     \end{alignat*}
</dd>
</dl>

<p>We see that both sampling procedures have the same mean, and the method with the larger variance is the ``with replacement'' scheme. The factor by which the variances differ,
\begin{equation}
\frac{M+N-n}{M+N-1},
\end{equation}
is called a <i>finite population correction</i>. For a fixed sample size \(n\), as \(M,N\to\infty\) it is clear that the correction goes to 1, that is, for infinite populations the sampling schemes are essentially the same with respect to mean and variance.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Waiting-Time-Distributions" class="outline-4">
<h4 id="sec-Waiting-Time-Distributions"><a name="sec-5-6-2" id="sec-5-6-2"></a><span class="section-number-4">5.6.2</span> Waiting Time Distributions</h4>
<div class="outline-text-4" id="text-sec-Waiting-Time-Distributions">


<p>
Another important class of problems is associated with the amount of time it takes for a specified event of interest to occur. For example, we could flip a coin repeatedly until we observe Heads. We could toss a piece of paper repeatedly until we make it in the trash can.
</p>

</div>

<div id="outline-container-sub-The-Geometric-Distribution" class="outline-5">
<h5 id="sub-The-Geometric-Distribution"><a name="sec-5-6-2-1" id="sec-5-6-2-1"></a><span class="section-number-5">5.6.2.1</span> The Geometric Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Geometric-Distribution">


<p>
Suppose that we conduct Bernoulli trials repeatedly, noting the successes and failures. Let \(X\) be the number of failures before a success. If \(\mathbb{P}(S)=p\) then \(X\) has PMF
\begin{equation}
f_{X}(x)=p(1-p)^{x},\quad x=0,1,2,\ldots
\end{equation}
(Why?) We say that \(X\) has a <i>Geometric distribution</i> and we write \(X\sim\mathsf{geom}(\mathtt{prob}=p)\). The associated \(\mathsf{R}\) functions are <code>dgeom(x, prob)</code>, <code>pgeom</code>, <code>qgeom</code>, and <code>rhyper</code>, which give the PMF, CDF, quantile function, and simulate random variates, respectively.
</p>
<p>
Again it is clear that \(f(x)\geq0\) and we check that \(\sum f(x)=1\) (see Equation <a href="#eq-geom-series">Geometric Series</a> in Appendix <a href="#sec-21-3">Sequences and Series</a>):
\begin{alignat*}{1}
\sum_{x=0}^{\infty}p(1-p)^{x}= & p\sum_{x=0}^{\infty}q^{x}=p\,\frac{1}{1-q}=1.
\end{alignat*}
We will find in the next section that the mean and variance are
\begin{equation}
\mu=\frac{1-p}{p}=\frac{q}{p}\mbox{ and }\sigma^{2}=\frac{q}{p^{2}}.
\end{equation}


</p>
<div class="exampletoo">
<p>The Pittsburgh Steelers place kicker, Jeff Reed, made 81.2% of his attempted field goals in his career up to 2006. Assuming that his successive field goal attempts are approximately Bernoulli trials, find the probability that Jeff misses at least 5 field goals before his first successful goal.
</p>
<p>
<i>Solution</i>: If \(X=\) the number of missed goals until Jeff's first success, then \(X\sim\mathsf{geom}(\mathtt{prob}=0.812)\) and we want \(\mathbb{P}(X\geq5)=\mathbb{P}(X&gt;4)\). We can find this in \(\mathsf{R}\) with
</p>



<pre class="src src-R">pgeom(4, prob = 0.812, lower.tail = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>



</div>


<div class="note">
<p>Some books use a slightly different definition of the geometric distribution. They consider Bernoulli trials and let \(Y\) count instead the number of trials until a success, so that \(Y\) has PMF
\begin{equation}
f_{Y}(y)=p(1-p)^{y-1},\quad y=1,2,3,\ldots
\end{equation}
When they say ``geometric distribution'', this is what they mean. It is not hard to see that the two definitions are related. In fact, if \(X\) denotes our geometric and \(Y\) theirs, then \(Y=X+1\). Consequently, they have \(\mu_{Y}=\mu_{X}+1\) and \(\sigma_{Y}^{2}=\sigma_{X}^{2}\).
</p>
</div>

</div>

</div>

<div id="outline-container-sub-The-Negative-Binomial" class="outline-5">
<h5 id="sub-The-Negative-Binomial"><a name="sec-5-6-2-2" id="sec-5-6-2-2"></a><span class="section-number-5">5.6.2.2</span> The Negative Binomial Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Negative-Binomial">


<p>
We may generalize the problem and consider the case where we wait for <i>more</i> than one success. Suppose that we conduct Bernoulli trials repeatedly, noting the respective successes and failures. Let \(X\) count the number of failures before \(r\) successes. If \(\mathbb{P}(S)=p\) then \(X\) has PMF
\begin{equation}
f_{X}(x)={r+x-1 \choose r-1}\, p^{r}(1-p)^{x},\quad x=0,1,2,\ldots
\end{equation}

We say that \(X\) has a <i>Negative Binomial distribution</i> and write \(X\sim\mathsf{nbinom}(\mathtt{size}=r,\,\mathtt{prob}=p)\). The associated \(\mathsf{R}\) functions are <code>dnbinom(x, size, prob)</code>, <code>pnbinom</code>, <code>qnbinom</code>, and <code>rnbinom</code>, which give the PMF, CDF, quantile function, and simulate random variates, respectively.
</p>
<p>
As usual it should be clear that \(f_{X}(x)\geq 0\) and the fact that \(\sum f_{X}(x)=1\) follows from a generalization of the geometric series by means of a Maclaurin's series expansion:
\begin{alignat}{1}
\frac{1}{1-t}= & \sum_{k=0}^{\infty}t^{k},\quad \mbox{for \(-1 < t < 1\)},\mbox{ and}\\
\frac{1}{(1-t)^{r}}= & \sum_{k=0}^{\infty}{r+k-1 \choose r-1}\, t^{k},\quad \mbox{for \(-1 < t < 1\)}.
\end{alignat}
Therefore
\begin{equation}
\sum_{x=0}^{\infty}f_{X}(x)=p^{r}\sum_{x=0}^{\infty}{r+x-1 \choose r-1}\, q^{x}=p^{r}(1-q)^{-r}=1,
\end{equation}
since \(|q|=|1-p|&lt;1\). 
</p>

<div class="exampletoo">
<p>We flip a coin repeatedly and let \(X\) count the number of Tails until we get seven Heads. What is \(\mathbb{P}(X=5)?\)
<i>Solution</i>: We know that \(X\sim\mathsf{nbinom}(\mathtt{size}=7,\,\mathtt{prob}=1/2)\).
\[
\mathbb{P}(X=5)=f_{X}(5)={7+5-1 \choose 7-1}(1/2)^{7}(1/2)^{5}={11 \choose 6}2^{-12}
\]
and we can get this in \(\mathsf{R}\) with
</p>



<pre class="src src-R">dnbinom(5, size = 7, prob = 0.5)
</pre>


<p>
Let us next compute the MGF of \(X\sim\mathsf{nbinom}(\mathtt{size}=r,\,\mathtt{prob}=p)\).
\begin{alignat*}{1}
M_{X}(t)= & \sum_{x=0}^{\infty}\mathrm{e}^{tx}\ {r+x-1 \choose r-1}p^{r}q^{x}\\
= & p^{r}\sum_{x=0}^{\infty}{r+x-1 \choose r-1}[q\mathrm{e}^{t}]^{x}\\
= & p^{r}(1-qe^{t})^{-r},\quad \mbox{provided $|q\mathrm{e}^{t}|<1$,}
\end{alignat*}
and so
\begin{equation}
M_{X}(t)=\left(\frac{p}{1-q\mathrm{e}^{t}}\right)^{r},\quad \mbox{for $q\mathrm{e}^{t}<1$}.
\end{equation}
We see that \(q\mathrm{e}^{t}&lt;1\) when \(t&lt;-\ln(1-p)\).
</p>
<p>
Let \(X\sim\mathsf{nbinom}(\mathtt{size}=r,\mathtt{prob}=p)\mbox{ with $M(t)=p^{r}(1-q\mathrm{e}^{t})^{-r}$}\). We proclaimed above the values of the mean and variance. Now we are equipped with the tools to find these directly.
\begin{alignat*}{1}
M'(t)= & p^{r}(-r)(1-q\mathrm{e}^{t})^{-r-1}(-q\mathrm{e}^{t}),\\
= & rq\mathrm{e}^{t}p^{r}(1-q\mathrm{e}^{t})^{-r-1},\\
= & \frac{rq\mathrm{e}^{t}}{1-q\mathrm{e}^{t}}M(t),\mbox{ and so }\\
M'(0)= & \frac{rq}{1-q}\cdot1=\frac{rq}{p}.
\end{alignat*}
Thus \(\mu=rq/p\). We next find \(\mathbb{E} X^{2}\).
\begin{alignat*}{1}
M''(0)= & \left.\frac{rq\mathrm{e}^{t}(1-q\mathrm{e}^{t})-rq\mathrm{e}^{t}(-q\mathrm{e}^{t})}{(1-q\mathrm{e}^{t})^{2}}M(t)+\frac{rq\mathrm{e}^{t}}{1-q\mathrm{e}^{t}}M'(t)\right|_{t=0},\\
= & \frac{rqp+rq^{2}}{p^{2}}\cdot1+\frac{rq}{p}\left(\frac{rq}{p}\right),\\
= & \frac{rq}{p^{2}}+\left(\frac{rq}{p}\right)^{2}.
\end{alignat*}
Finally we may say \( \sigma^{2} = M''(0) - [M'(0)]^{2} = rq/p^{2}. \)
</p>
</div>


<div class="exampletoo">
<p>A random variable has MGF
\[
M_{X}(t)=\left(\frac{0.19}{1-0.81\mathrm{e}^{t}}\right)^{31}.
\]
Then \(X\sim\mathsf{nbinom}(\mathtt{size}=31,\,\mathtt{prob}=0.19)\).
</p>
</div>


<div class="note">
<p>As with the Geometric distribution, some books use a slightly different definition of the Negative Binomial distribution. They consider Bernoulli trials and let \(Y\) be the number of trials until \(r\) successes, so that \(Y\) has PMF
\begin{equation}
f_{Y}(y)={y-1 \choose r-1}p^{r}(1-p)^{y-r},\quad y=r,r+1,r+2,\ldots
\end{equation}
It is again not hard to see that if \(X\) denotes our Negative Binomial and \(Y\) theirs, then \(Y=X+r\). Consequently, they have \(\mu_{Y}=\mu_{X}+r\) and \(\sigma_{Y}^{2}=\sigma_{X}^{2}\).
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sec-Arrival-Processes" class="outline-4">
<h4 id="sec-Arrival-Processes"><a name="sec-5-6-3" id="sec-5-6-3"></a><span class="section-number-4">5.6.3</span> Arrival Processes</h4>
<div class="outline-text-4" id="text-sec-Arrival-Processes">



</div>

<div id="outline-container-sub-The-Poisson-Distribution" class="outline-5">
<h5 id="sub-The-Poisson-Distribution"><a name="sec-5-6-3-1" id="sec-5-6-3-1"></a><span class="section-number-5">5.6.3.1</span> The Poisson Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Poisson-Distribution">


<p>
This is a distribution associated with ``rare events'', for reasons which will become clear in a moment. The events might be:
</p><ul>
<li>traffic accidents,
</li>
<li>typing errors, or
</li>
<li>customers arriving in a bank.
</li>
</ul>



<p>
Let \(\lambda\) be the average number of events in the time interval \([0,1]\). Let the random variable \(X\) count the number of events occurring in the interval. Then under certain reasonable conditions it can be shown that
\begin{equation}
f_{X}(x)=\mathbb{P}(X=x)=\mathrm{e}^{-\lambda}\frac{\lambda^{x}}{x!},\quad x=0,1,2,\ldots
\end{equation}
We use the notation \(X\sim\mathsf{pois}(\mathtt{lambda}=\lambda)\). The associated \(\mathsf{R}\) functions are <code>dpois(x, lambda)</code>, <code>ppois</code>, <code>qpois</code>, and <code>rpois</code>, which give the PMF, CDF, quantile function, and simulate random variates, respectively.
</p>
</div>

</div>

<div id="outline-container-5-6-3-2" class="outline-5">
<h5 id="sec-5-6-3-2"><span class="section-number-5">5.6.3.2</span> What are the reasonable conditions?</h5>
<div class="outline-text-5" id="text-5-6-3-2">


<p>
Divide \([0,1]\) into subintervals of length \(1/n\). A <i>Poisson process</i>\index{Poisson process} satisfies the following conditions:
</p><ul>
<li>the probability of an event occurring in a particular subinterval is \(\approx\lambda/n\).
</li>
<li>the probability of two or more events occurring in any subinterval is \(\approx 0\).
</li>
<li>occurrences in disjoint subintervals are independent.
</li>
</ul>



<div class="rem">
<p><a name="rem-poisson-process" id="rem-poisson-process"></a>
</p>
<p>
If \(X\) counts the number of events in the interval \([0,t]\) and \(\lambda\) is the average number that occur in unit time, then \(X\sim\mathsf{pois}(\mathtt{lambda}=\lambda t)\), that is,
\begin{equation}
\mathbb{P}(X=x)=\mathrm{e}^{-\lambda t}\frac{(\lambda t)^{x}}{x!},\quad x=0,1,2,3\ldots
\end{equation}
</p>
</div>


<div class="exampletoo">
<p>On the average, five cars arrive at a particular car wash every hour. Let \(X\) count the number of cars that arrive from 10AM to 11AM. Then \(X\sim\mathsf{pois}(\mathtt{lambda}=5)\). Also, \(\mu=\sigma^{2}=5\). What is the probability that no car arrives during this period? 
<i>Solution</i>: The probability that no car arrives is
\[
\mathbb{P}(X=0)=\mathrm{e}^{-5}\frac{5^{0}}{0!}=\mathrm{e}^{-5}\approx0.0067.
\]
</p>
</div>


<div class="exampletoo">
<p>Suppose the car wash above is in operation from 8AM to 6PM, and we let \(Y\) be the number of customers that appear in this period. Since this period covers a total of 10 hours, from Remark <a href="#rem-poisson-process">Poisson Process</a> we get that \(Y\sim\mathsf{pois}(\mathtt{lambda}=5\ast10=50)\). What is the probability that there are between 48 and 50 customers, inclusive? 
<i>Solution</i>: We want \(\mathbb{P}(48\leq Y\leq50)=\mathbb{P}(X\leq50)-\mathbb{P}(X\leq47)\). 
</p>



<pre class="src src-R">diff(ppois(c(47, 50), lambda = 50))
</pre>



</div>

</div>
</div>
</div>

</div>

<div id="outline-container-sec-functions-discrete-rvs" class="outline-3">
<h3 id="sec-functions-discrete-rvs"><a name="sec-5-7" id="sec-5-7"></a><span class="section-number-3">5.7</span> Functions of Discrete Random Variables</h3>
<div class="outline-text-3" id="text-sec-functions-discrete-rvs">


<p>
We have built a large catalogue of discrete distributions, but the tools of this section will give us the ability to consider infinitely many more. Given a random variable \(X\) and a given function \(h\), we may consider \(Y=h(X)\). Since the values of \(X\) are determined by chance, so are the values of \(Y\). The question is, what is the PMF of the random variable \(Y\)? The answer, of course, depends on \(h\). In the case that \(h\) is one-to-one (see Appendix <a href="#sec-21-2">Differential-Integral Calculus</a>), the solution can be found by simple substitution.
</p>

<div class="exampletoo">
<p>Let \(X\sim\mathsf{nbinom}(\mathtt{size}=r,\,\mathtt{prob}=p)\). We saw in <a href="#sec-5-6">Other Discrete Distributions</a> that \(X\) represents the number of failures until \(r\) successes in a sequence of Bernoulli trials. Suppose now that instead we were interested in counting the number of trials (successes and failures) until the \(r^{\mathrm{th}}\) success occurs, which we will denote by \(Y\). In a given performance of the experiment, the number of failures (\(X\)) and the number of successes (\(r\)) together will comprise the total number of trials (\(Y\)), or in other words, \(X+r=Y\). We may let \(h\) be defined by \(h(x)=x+r\) so that \(Y=h(X)\), and we notice that \(h\) is linear and hence one-to-one. Finally, \(X\) takes values \(0,\ 1,\ 2,\ldots\) implying that the support of \(Y\) would be \(\{ r,\ r+1,\ r+2,\ldots \}\). Solving for \(X\) we get \(X=Y-r\). Examining the PMF of \(X\)
\begin{equation}
f_{X}(x)={r+x-1 \choose r-1}\, p^{r}(1-p)^{x},
\end{equation}
we can substitute \( x = y - r \) to get
\begin{eqnarray*}
f_{Y}(y) & = & f_{X}(y-r),\\
 & = & {r+(y-r)-1 \choose r-1}\, p^{r}(1-p)^{y-r},\\
 & = & {y-1 \choose r-1}\, p^{r}(1-p)^{y-r},\quad y=r,\, r+1,\ldots
\end{eqnarray*}
</p>
</div>


<p>
Even when the function \(h\) is not one-to-one, we may still find the PMF of \(Y\) simply by accumulating, for each \(y\), the probability of all the \(x\)'s that are mapped to that \(y\).
</p>
<div class="prop">
<p>Let \(X\) be a discrete random variable with PMF \(f_{X}\) supported on the set \(S_{X}\). Let \(Y=h(X)\) for some function \(h\). Then \(Y\) has PMF \(f_{Y}\) defined by
\begin{equation}
f_{Y}(y)=\sum_{\{x\in S_{X}|\, h(x)=y\}}f_{X}(x)
\end{equation}
</p>
</div>


<div class="exampletoo">
<p>Let \(X\sim\mathsf{binom}(\mathtt{size}=4,\,\mathtt{prob}=1/2)\), and let \(Y=(X-1)^{2}\). Consider the following table:
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-disc-transf">
<caption>Transforming a discrete random variable.</caption>
<colgroup><col class="left" /><col class="right" /><col class="right" /><col class="right" /><col class="right" /><col class="right" />
</colgroup>
<thead>
<tr><th scope="col" class="left">x</th><th scope="col" class="right">0</th><th scope="col" class="right">1</th><th scope="col" class="right">2</th><th scope="col" class="right">3</th><th scope="col" class="right">4</th></tr>
</thead>
<tbody>
<tr><td class="left">\(f_{X}(x)\)</td><td class="right">1/16</td><td class="right">1/4</td><td class="right">6/16</td><td class="right">1/4</td><td class="right">1/16</td></tr>
</tbody>
<tbody>
<tr><td class="left">\(y=(x-1)^{2}\)</td><td class="right">1</td><td class="right">0</td><td class="right">1</td><td class="right">4</td><td class="right">9</td></tr>
</tbody>
</table>


<p>
From this we see that \(Y\) has support \(S_{Y}=\{0,1,4,9\}\). We also see that \(h(x)=(x-1)^{2}\) is not one-to-one on the support of \(X\), because both \(x=0\) and \(x=2\) are mapped by \(h\) to \(y=1\). Nevertheless, we see that \(Y=0\) only when \(X=1\), which has probability \(1/4\); therefore, \(f_{Y}(0)\) should equal \(1/4\). A similar approach works for \(y=4\) and \(y=9\). And \(Y=1\) exactly when \(X=0\) or \(X=2\), which has total probability \(7/16\). In summary, the PMF of \(Y\) may be written:
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-disc-transf-pmf">
<caption>Transforming a discrete random variable, its PMF.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">y</th><th scope="col" class="left">0</th><th scope="col" class="left">1</th><th scope="col" class="left">4</th><th scope="col" class="left">9</th></tr>
</thead>
<tbody>
<tr><td class="left">\(f_{Y}(y)\)</td><td class="left">1/4</td><td class="left">7/16</td><td class="left">1/4</td><td class="left">1/16</td></tr>
</tbody>
</table>


<p>
There is not a special name for the distribution of \(Y\), it is just an example of what to do when the transformation of a random variable is not one-to-one. The method is the same for more complicated problems.
</p>
</div>


<div class="prop">
<p>If \(X\) is a random variable with \(\mathbb{E} X=\mu\) and \(\mbox{Var}(X)=\sigma^{2}\), then the mean and variance of \(Y=mX+b\) is
\begin{equation}
\mu_{Y}=m\mu+b,\quad \sigma_{Y}^{2}=m^{2}\sigma^{2},\quad \sigma_{Y}=|m|\sigma.
\end{equation}
</p>
</div>


</div>

</div>

<div id="outline-container-5-8" class="outline-3">
<h3 id="sec-5-8"><span class="section-number-3">5.8</span> Exercises</h3>
<div class="outline-text-3" id="text-5-8">



<div class="xca">
<p>A recent national study showed that approximately 44.7% of college students have used Wikipedia as a source in at least one of their term papers. Let \(X\) equal the number of students in a random sample of size \(n=31\) who have used Wikipedia as a source. 
</p><ul>
<li>How is \(X\) distributed? 
</li>
<li>Sketch the probability mass function (roughly).
</li>
<li>Sketch the cumulative distribution function (roughly).
</li>
<li>Find the probability that \(X\) is equal to 17.
</li>
<li>Find the probability that \(X\) is at most 13.
</li>
<li>Find the probability that \(X\) is bigger than 11.
</li>
<li>Find the probability that \(X\) is at least 15.
</li>
<li>Find the probability that \(X\) is between 16 and 19, inclusive.
</li>
<li>Give the mean of \(X\), denoted \(\mathbb{E} X\).
</li>
<li>Give the variance of \(X\).
</li>
<li>Give the standard deviation of \(X\).
</li>
<li>Find \(\mathbb{E}(4X+51.324)\).
</li>
</ul>



</div>


<div class="xca">
<p>For the following situations, decide what the distribution of \(X\) should be. In nearly every case, there are additional assumptions that should be made for the distribution to apply; identify those assumptions (which may or may not hold in practice.)
</p><ul>
<li>We shoot basketballs at a basketball hoop, and count the number of shots until we make a goal. Let \(X\) denote the number of missed shots. On a normal day we would typically make about 37% of the shots.
</li>
<li>In a local lottery in which a three digit number is selected randomly, let \(X\) be the number selected.
</li>
<li>We drop a Styrofoam cup to the floor twenty times, each time recording whether the cup comes to rest perfectly right side up, or not. Let \(X\) be the number of times the cup lands perfectly right side up.
</li>
<li>We toss a piece of trash at the garbage can from across the room. If we miss the trash can, we retrieve the trash and try again, continuing to toss until we make the shot. Let \(X\) denote the number of missed shots.
</li>
<li>Working for the border patrol, we inspect shipping cargo as when it enters the harbor looking for contraband. A certain ship comes to port with 557 cargo containers. Standard practice is to select 10 containers randomly and inspect each one very carefully, classifying it as either having contraband or not. Let \(X\) count the number of containers that illegally contain contraband.
</li>
<li>At the same time every year, some migratory birds land in a bush outside for a short rest. On a certain day, we look outside and let \(X\) denote the number of birds in the bush. 
</li>
<li>We count the number of rain drops that fall in a circular area on a sidewalk during a ten minute period of a thunder storm.
</li>
<li>We count the number of moth eggs on our window screen.
</li>
<li>We count the number of blades of grass in a one square foot patch of land.
</li>
<li>We count the number of pats on a baby's back until (s)he burps.
</li>
</ul>



</div>


<div class="xca">
<p><a name="xca-variance-shortcut" id="xca-variance-shortcut"></a>
Show that \(\mathbb{E}(X-\mu)^{2}=\mathbb{E} X^{2}-\mu^{2}\). <i>Hint</i>: expand the quantity \((X-\mu)^{2}\) and distribute the expectation over the resulting terms.
</p>
</div>


<div class="xca">
<p><a name="xca-binom-factorial-expectation" id="xca-binom-factorial-expectation"></a>
If \(X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\) show that \(\mathbb{E} X(X-1)=n(n-1)p^{2}\).
</p>
</div>


<div class="xca">
<p><a name="xca-hyper-mean-variance" id="xca-hyper-mean-variance"></a>
Calculate the mean and variance of the hypergeometric distribution. Show that 
\begin{equation}
\mu=K\frac{M}{M+N},\quad \sigma^{2}=K\frac{MN}{(M+N)^{2}}\frac{M+N-K}{M+N-1}.
\end{equation}
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-cha-Continuous-Distributions" class="outline-2">
<h2 id="cha-Continuous-Distributions"><a name="sec-6" id="sec-6"></a><span class="section-number-2">6</span> Continuous Distributions</h2>
<div class="outline-text-2" id="text-cha-Continuous-Distributions">




<p>
The focus of the last chapter was on random variables whose support can be written down in a list of values (finite or countably infinite), such as the number of successes in a sequence of Bernoulli trials. Now we move to random variables whose support is a whole range of values, say, an interval \((a,b)\). It is shown in later classes that it is impossible to write all of the numbers down in a list; there are simply too many of them.
</p>
<p>
This chapter begins with continuous random variables and the associated PDFs and CDFs The continuous uniform distribution is highlighted, along with the Gaussian, or normal, distribution. Some mathematical details pave the way for a catalogue of models.
</p>
<p>
The interested reader who would like to learn more about any of the assorted discrete distributions mentioned below should take a look at <i>Continuous Univariate Distributions, Volumes 1</i> and <i>2</i> by Johnson <i>et al</i> \cite{Johnson1994,Johnson1995}.
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>how to choose a reasonable continuous model under a variety of physical circumstances
</li>
<li>basic correspondence between continuous versus discrete random variables
</li>
<li>the general tools of the trade for manipulation of continuous random variables, integration, <i>etc</i>.
</li>
<li>some details on a couple of continuous models, and exposure to a bunch of other ones
</li>
<li>how to make new continuous random variables from old ones
</li>
</ul>



</div>

<div id="outline-container-sec-continuous-random-variables" class="outline-3">
<h3 id="sec-continuous-random-variables"><a name="sec-6-1" id="sec-6-1"></a><span class="section-number-3">6.1</span> Continuous Random Variables</h3>
<div class="outline-text-3" id="text-sec-continuous-random-variables">



</div>

<div id="outline-container-sub-probability-density-functions" class="outline-4">
<h4 id="sub-probability-density-functions"><a name="sec-6-1-1" id="sec-6-1-1"></a><span class="section-number-4">6.1.1</span> Probability Density Functions</h4>
<div class="outline-text-4" id="text-sub-probability-density-functions">


<p>
Continuous random variables have supports that look like
\begin{equation}
S_{X}=[a,b]\mbox{ or }(a,b),
\end{equation}
or unions of intervals of the above form. Examples of random variables that are often taken to be continuous are:
</p>
<ul>
<li>the height or weight of an individual,
</li>
<li>other physical measurements such as the length or size of an object, and
</li>
<li>durations of time (usually).
</li>
</ul>


<p>
Every continuous random variable \(X\) has a <i>probability density function</i> (PDF) denoted \(f_{X}\) associated with it
that satisfies three basic properties:
</p><ol>
<li>\(f_{X}(x)&gt;0\) for \(x\in S_{X}\),
</li>
<li>\(\int_{x\in S_{X}}f_{X}(x)\,\mathrm{d} x=1\), and
</li>
<li>\(\mathbb{P}(X\in A)=\int_{x\in A}f_{X}(x)\:\mathrm{d} x\), for an event \(A\subset S_{X}\).
</li>
</ol>

<p><a name="enu-contrvcond3" id="enu-contrvcond3"></a>
</p>

<div class="rem">
<p>We can say the following about continuous random variables:
</p><ul>
<li>Usually, the set \(A\) in <a href="#enu-contrvcond3">enu-contrvcond3</a> takes the form of an interval, for example, \(A=[c,d]\), in which case
  \begin{equation}
  \mathbb{P}(X\in A)=\int_{c}^{d}f_{X}(x)\:\mathrm{d} x.
  \end{equation}
</li>
<li>It follows that the probability that \(X\) falls in a given interval is simply the <i>area under the curve</i> of \(f_{X}\) over the interval.
</li>
<li>Since the area of a line \(x=c\) in the plane is zero, \(\mathbb{P}(X=c)=0\)  for any value \(c\). In other words, the chance that \(X\) equals a particular value \(c\) is zero, and this is true for any number \(c\). Moreover, when \(a&lt;b\) all of the following probabilities are the same:
  \begin{equation}
  \mathbb{P}(a\leq X\leq b)=\mathbb{P}(a<X\leq b)=\mathbb{P}(a\leq X<b)=\mathbb{P}(a<X<b).
  \end{equation}
</li>
<li>The PDF \(f_{X}\) can sometimes be greater than 1. This is in contrast to the discrete case; every nonzero value of a PMF is a probability which is restricted to lie in the interval \([0,1]\).
</li>
</ul>



</div>

<p>
We met the cumulative distribution function, \(F_{X}\), in Chapter <a href="#sec-5">Discrete Distributions</a>. Recall that it is defined by \(F_{X}(t)=\mathbb{P}(X\leq t)\), for \(-\infty&lt;t&lt;\infty\). While in the discrete case the CDF is unwieldy, in the continuous case the CDF has a relatively convenient form:
\begin{equation}
F_{X}(t)=\mathbb{P}(X\leq t)=\int_{-\infty}^{t}f_{X}(x)\:\mathrm{d} x,\quad -\infty < t < \infty.
\end{equation}

</p>
<div class="rem">
<p>For any continuous CDF \(F_{X}\) the following are true.
</p><ul>
<li>\(F_{X}\) is nondecreasing , that is, \(t_{1}\leq t_{2}\) implies \(F_{X}(t_{1})\leq F_{X}(t_{2})\).
</li>
<li>\(F_{X}\) is continuous (see Appendix <a href="#sec-21-2">Differential-Integral Calculus</a>). Note the distinction from the discrete case: CDFs of discrete random variables are not continuous, they are only right continuous.
</li>
<li>\(\lim_{t\to-\infty}F_{X}(t)=0\) and \(\lim_{t\to\infty}F_{X}(t)=1\).
</li>
</ul>



</div>

<p>
There is a handy relationship between the CDF and PDF in the continuous case. Consider the derivative of \(F_{X}\):
\begin{equation}
F'_{X}(t)=\frac{\mathrm{d}}{\mathrm{d} t}F_{X}(t)=\frac{\mathrm{d}}{\mathrm{d} t}\,\int_{-\infty}^{t}f_{X}(x)\,\mathrm{d} x=f_{X}(t),
\end{equation}
the last equality being true by the Fundamental Theorem of Calculus, part (2) (see Appendix <a href="#sec-21-2">Differential-Integral Calculus</a>). In short, \((F_{X})'=f_{X}\) in the continuous case
</p>
</div>

</div>

<div id="outline-container-sub-Expectation-of-Continuous" class="outline-4">
<h4 id="sub-Expectation-of-Continuous"><a name="sec-6-1-2" id="sec-6-1-2"></a><span class="section-number-4">6.1.2</span> Expectation of Continuous Random Variables</h4>
<div class="outline-text-4" id="text-sub-Expectation-of-Continuous">


<p>
For a continuous random variable \(X\) the expected value of \(g(X)\) is
\begin{equation}
\mathbb{E} g(X)=\int_{x\in S}g(x)f_{X}(x)\:\mathrm{d} x,
\end{equation}
provided the (potentially improper) integral \(\int_{S}|g(x)|\, f(x)\mathrm{d} x\) is convergent. One important example is the mean \(\mu\), also known as \(\mathbb{E} X\):
\begin{equation}
\mu=\mathbb{E} X=\int_{x\in S}xf_{X}(x)\:\mathrm{d} x,
\end{equation}
provided \(\int_{S}|x|f(x)\mathrm{d} x\) is finite. Also there is the variance
\begin{equation}
\sigma^{2}=\mathbb{E}(X-\mu)^{2}=\int_{x\in S}(x-\mu)^{2}f_{X}(x)\,\mathrm{d} x,
\end{equation}
which can be computed with the alternate formula \(\sigma^{2}=\mathbb{E} X^{2}-(\mathbb{E} X)^{2}\). In addition, there is the standard deviation \(\sigma=\sqrt{\sigma^{2}}\). The moment generating function is given by
\begin{equation}
M_{X}(t)=\mathbb{E}\:\mathrm{e}^{tX}=\int_{-\infty}^{\infty}\mathrm{e}^{tx}f_{X}(x)\:\mathrm{d} x,
\end{equation}
provided the integral exists (is finite) for all \(t\) in a neighborhood of \(t=0\).
</p>

<div class="exampletoo">
<p><a name="exa-cont-pdf3x2" id="exa-cont-pdf3x2"></a>
</p>
<p>
Let the continuous random variable \(X\) have PDF
\[
f_{X}(x)=3x^{2},\quad 0\leq x\leq 1.
\]
We will see later that \(f_{X}\) belongs to the <i>Beta</i> family of distributions. It is easy to see that \(\int_{-\infty}^{\infty}f(x)\mathrm{d} x=1\).
\begin{align*}
\int_{-\infty}^{\infty}f_{X}(x)\mathrm{d} x & =\int_{0}^{1}3x^{2}\:\mathrm{d} x\\
 & =\left.x^{3}\right|_{x=0}^{1}\\
 & =1^{3}-0^{3}\\
 & =1.
\end{align*}
This being said, we may find \(\mathbb{P}(0.14\leq X&lt;0.71)\).
\begin{align*}
\mathbb{P}(0.14\leq X<0.71) & =\int_{0.14}^{0.71}3x^{2}\mathrm{d} x,\\
 & =\left.x^{3}\right|_{x=0.14}^{0.71}\\
 & =0.71^{3}-0.14^{3}\\
 & \approx0.355167.
\end{align*}
We can find the mean and variance in an identical manner.
\begin{align*}
\mu=\int_{-\infty}^{\infty}xf_{X}(x)\mathrm{d} x & =\int_{0}^{1}x\cdot3x^{2}\:\mathrm{d} x,\\
 & =\frac{3}{4}x^{4}|_{x=0}^{1},\\
 & =\frac{3}{4}.
\end{align*}
It would perhaps be best to calculate the variance with the shortcut formula \(\sigma^{2}=\mathbb{E} X^{2}-\mu^{2}\):
\begin{align*}
\mathbb{E} X^{2}=\int_{-\infty}^{\infty}x^{2}f_{X}(x)\mathrm{d} x & =\int_{0}^{1}x^{2}\cdot3x^{2}\:\mathrm{d} x\\
 & =\left.\frac{3}{5}x^{5}\right|_{x=0}^{1}\\
 & =3/5.
\end{align*}
which gives \(\sigma^{2}=3/5-(3/4)^{2}=3/80\).
</p>
</div>


<div class="exampletoo">
<p><a name="exa-cont-pdf-3x4" id="exa-cont-pdf-3x4"></a>
</p>
<p>
We will try one with unbounded support to brush up on improper integration. Let the random variable \(X\) have PDF
\[
f_{X}(x)=\frac{3}{x^{4}},\quad x>1.
\]
We can show that \(\int_{-\infty}^{\infty}f(x)\mathrm{d} x=1\):
\begin{align*}
\int_{-\infty}^{\infty}f_{X}(x)\mathrm{d} x & =\int_{1}^{\infty}\frac{3}{x^{4}}\:\mathrm{d} x,\\
 & =\lim_{t\to\infty}\int_{1}^{t}\frac{3}{x^{4}}\:\mathrm{d} x,\\
 & =\lim_{t\to\infty}\ \left.3\,\frac{1}{-3}x^{-3}\right|_{x=1}^{t},\\
 & =-\left(\lim_{t\to\infty}\frac{1}{t^{3}}-1\right),\\
 & =1.
\end{align*}
We calculate \(\mathbb{P}(3.4\leq X&lt;7.1)\):
\begin{align*}
\mathbb{P}(3.4\leq X<7.1) & =\int_{3.4}^{7.1}3x^{-4}\mathrm{d} x,\\
 & =\left.3\,\frac{1}{-3}x^{-3}\right|_{x=3.4}^{7.1},\\
 & =-1(7.1^{-3}-3.4^{-3}),\\
 & \approx0.0226487123.
\end{align*}
We locate the mean and variance just like before.
\begin{align*}
\mu=\int_{-\infty}^{\infty}xf_{X}(x)\mathrm{d} x & =\int_{1}^{\infty}x\cdot\frac{3}{x^{4}}\:\mathrm{d} x,\\
 & =\left.3\,\frac{1}{-2}x^{-2}\right|_{x=1}^{\infty},\\
 & =-\frac{3}{2}\left(\lim_{t\to\infty}\frac{1}{t^{2}}-1\right),\\
 & =\frac{3}{2}.
\end{align*}
Again we use the shortcut \(\sigma^{2}=\mathbb{E} X^{2}-\mu^{2}\):
\begin{align*}
\mathbb{E} X^{2}=\int_{-\infty}^{\infty}x^{2}f_{X}(x)\mathrm{d} x & =\int_{1}^{\infty}x^{2}\cdot\frac{3}{x^{4}}\:\mathrm{d} x,\\
 & =\left.3\:\frac{1}{-1}x^{-1}\right|_{x=1}^{\infty},\\
 & =-3\left(\lim_{t\to\infty}\frac{1}{t^{2}}-1\right),\\
 & =3,
\end{align*}
which closes the example with \(\sigma^{2}=3-(3/2)^{2}=3/4\).
</p>
</div>


</div>

<div id="outline-container-6-1-2-1" class="outline-5">
<h5 id="sec-6-1-2-1"><span class="section-number-5">6.1.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-6-1-2-1">


<p>
There exist utilities to calculate probabilities and expectations for general continuous random variables, but it is better to find a built-in model, if possible. Sometimes it is not possible. We show how to do it the long way, and the <code>distr</code>\index{R packages@\textsf{R} packages!distr@\texttt{distr}} package way.
</p>

<div class="exampletoo">
<p>Let \(X\) have PDF \(f(x)=3x^{2}\), \(0&lt;x&lt;1\) and find \(\mathbb{P}(0.14\leq X\leq0.71)\). (We will ignore that \(X\) is a beta random variable for the sake of argument.)
</p>



<pre class="src src-R"><span style="font-weight: bold;">f</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x) 3*x^2
integrate(f, lower = 0.14, upper = 0.71)
</pre>


<p>
Compare this to the answer we found in Example <a href="#exa-cont-pdf3x2">Cont-pdf3x2</a>. We could integrate the function \(x \cdot f(x)=\) <code>3*x^3</code> from zero to one to get the mean, and use the shortcut \(\sigma^{2}=\mathbb{E} X^{2}-\left(\mathbb{E} X\right)^{2}\) for the variance. 
</p>

</div>


<div class="exampletoo">
<p>Let \(X\) have PDF \(f(x)=3/x^{4}\), \(x&gt;1\). We may integrate the function \(g(x) = x \cdot f(x)=\) <code>3/x^3</code> from zero to infinity to get the mean of \(X\).
</p>



<pre class="src src-R"><span style="font-weight: bold;">g</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x) 3/x^3
integrate(g, lower = 1, upper = <span style="font-weight: bold; text-decoration: underline;">Inf</span>)
</pre>


<p>
Compare this to the answer we got in Example <a href="#exa-cont-pdf-3x4">Cont-pdf3x4</a>. Use <code>-Inf</code> for \(-\infty\).
</p>

</div>


<div class="exampletoo">
<p>Let us redo Example <a href="#exa-cont-pdf3x2">Cont-pdf3x2</a> with the <code>distr</code> package. The method is similar to that encountered in Section <a href="#sec-5-1-2-1">Discrete RV How R</a> in Chapter <a href="#sec-5">Discrete Distributions</a>. We define an absolutely continuous random variable:
</p>



<pre class="src src-R"><span style="font-weight: bold;">f</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x) 3*x^2
X <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> AbscontDistribution(d = f, low1 = 0, up1 = 1)
p(X)(0.71) - p(X)(0.14)
</pre>


<p>
Compare this to the answer we found earlier. Now let us try expectation with the <code>distrEx</code> package \cite{Ruckdescheldistr}:
</p>


<pre class="src src-R">E(X); var(X); 3/80
</pre>


<p>
Compare these answers to the ones we found in Example <a href="#exa-cont-pdf3x2">Cont-pdf3x2</a>. Why are they different? Because the <code>distrEx</code> package resorts to numerical methods when it encounters a model it does not recognize. This means that the answers we get for calculations may not exactly match the theoretical values. Be careful.
</p>
</div>

</div>
</div>
</div>

</div>

<div id="outline-container-sec-The-Continuous-Uniform" class="outline-3">
<h3 id="sec-The-Continuous-Uniform"><a name="sec-6-2" id="sec-6-2"></a><span class="section-number-3">6.2</span> The Continuous Uniform Distribution</h3>
<div class="outline-text-3" id="text-sec-The-Continuous-Uniform">


<p>
A random variable \(X\) with the continuous uniform distribution on the interval \((a,b)\) has PDF
\begin{equation}
f_{X}(x)=\frac{1}{b-a}, \quad a < x < b.
\end{equation}
The associated \(\mathsf{R}\) function is \(\mathsf{dunif}(\mathtt{min}=a,\,\mathtt{max}=b)\). We write \(X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)\). Due to the particularly simple form of this PDF we can also write down explicitly a formula for the CDF \(F_{X}\):
\begin{equation}
F_{X}(t)=
\begin{cases}
0, & t < 0,\\
\frac{t-a}{b-a}, & a\leq t < b,\\
1, & t \geq b.
\end{cases}
\end{equation}
<a name="eq-unif-cdf" id="eq-unif-cdf"></a>
</p>
<p>
The continuous uniform distribution is the continuous analogue of the discrete uniform distribution; it is used to model experiments whose outcome is an interval of numbers that are ``equally likely'' in the sense that any two intervals of equal length in the support have the same probability associated with them.
</p>

<div class="exampletoo">
<p>Choose a number in \( [0,1] \) at random, and let \(X\) be the number chosen. Then \(X\sim\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\).
The mean of \(X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)\) is relatively simple to calculate:
\begin{align*}
\mu=\mathbb{E} X & =\int_{-\infty}^{\infty}x\, f_{X}(x)\,\mathrm{d} x,\\
 & =\int_{a}^{b}x\ \frac{1}{b-a}\ \mathrm{d} x,\\
 & =\left.\frac{1}{b-a}\ \frac{x^{2}}{2}\ \right|_{x=a}^{b},\\
 & =\frac{1}{b-a}\ \frac{b^{2}-a^{2}}{2},\\
 & =\frac{b+a}{2},
\end{align*}
using the popular formula for the difference of squares. The variance is left to Exercise <a href="#xca-variance-dunif">Variance Uniform</a>.
</p>
</div>

</div>

</div>

<div id="outline-container-sec-The-Normal-Distribution" class="outline-3">
<h3 id="sec-The-Normal-Distribution"><a name="sec-6-3" id="sec-6-3"></a><span class="section-number-3">6.3</span> The Normal Distribution</h3>
<div class="outline-text-3" id="text-sec-The-Normal-Distribution">


<p>
We say that \(X\) has a <i>normal distribution</i> if it has PDF
\begin{equation}
f_{X}(x)=\frac{1}{\sigma\sqrt{2\pi}}\exp \left\{ \frac{-(x-\mu)^{2}}{2\sigma^{2}} \right\},\quad -\infty < x < \infty.
\end{equation}
We write \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\), and the associated \(\mathsf{R}\) function is <code>dnorm(x, mean = 0, sd = 1)</code>.
</p>
<p>
The familiar bell-shaped curve, the normal distribution is also known as the <i>Gaussian distribution</i> because the German mathematician C. F. Gauss largely contributed to its mathematical development. This distribution is by far the most important distribution, continuous or discrete. The normal model appears in the theory of all sorts of natural phenomena, from to the way particles of smoke dissipate in a closed room, to the journey of a bottle in the ocean to the white noise of cosmic background radiation.
</p>
<p>
When \(\mu=0\) and \(\sigma=1\) we say that the random variable has a <i>standard normal</i> distribution and we typically write \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\). The lowercase Greek letter phi (\(\phi\)) is used to denote the standard normal PDF and the capital Greek letter phi \(\Phi\) is used to denote the standard normal CDF: for \(-\infty&lt;z&lt;\infty\),
\begin{equation}
\phi(z)=\frac{1}{\sqrt{2\pi}}\,\mathrm{e}^{-z^{2}/2}\mbox{ and }\Phi(t)=\int_{-\infty}^{t}\phi(z)\,\mathrm{d} z.
\end{equation}

</p>
<div class="prop">
<p>If \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) then
\begin{equation}
Z=\frac{X-\mu}{\sigma}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).
\end{equation}
</p>
</div>

<p>
The MGF of \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) is relatively easy to derive:
\begin{eqnarray*}
M_{Z}(t) & = & \int_{-\infty}^{\infty}\mathrm{e}^{tz}\frac{1}{\sqrt{2\pi}}\mathrm{e}^{-z^{2}/2}\mathrm{d} z,\\
 & = & \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\exp \{ -\frac{1}{2}\left(z^{2}+2tz+t^{2}\right)+\frac{t^{2}}{2} \} \mathrm{d} z,\\
 & = & \mathrm{e}^{t^{2}/2}\left(\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\mathrm{e}^{-[z-(-t)]^{2}/2}\mathrm{d} z\right),
\end{eqnarray*}
and the quantity in the parentheses is the total area under a \(\mathsf{norm}(\mathtt{mean}=-t,\,\mathtt{sd}=1)\) density, which is one. Therefore,
\begin{equation}
M_{Z}(t)=\mathrm{e}^{t^{2}/2},\quad -\infty < t < \infty.
\end{equation}

</p>
<div class="exampletoo">
<p>The MGF of \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) is then not difficult either because 
\[
Z=\frac{X-\mu}{\sigma},\mbox{ or rewriting, }X=\sigma Z+\mu.
\]
Therefore
\[
M_{X}(t)=\mathbb{E}\mathrm{e}^{tX}=\mathbb{E}\mathrm{e}^{t(\sigma Z+\mu)}=\mathbb{E}\mathrm{e}^{\sigma tX}\mathrm{e}^{t\mu}=\mathrm{e}^{t\mu}M_{Z}(\sigma t),
\]
and we know that \(M_{Z}(t)=\mathrm{e}^{t^{2}/2}\), thus substituting we get
\[
M_{X}(t)=\mathrm{e}^{t\mu}\mathrm{e}^{(\sigma t)^{2}/2}=\exp\left\{ \mu t+\sigma^{2}t^{2}/2\right\} ,
\]
for \(-\infty&lt;t&lt;\infty\).
</p>
</div>


<div class="fact">
<p>The same argument above shows that if \(X\) has MGF \(M_{X}(t)\) then the MGF of \(Y=a+bX\) is
\begin{equation}
M_{Y}(t)=\mathrm{e}^{ta}M_{X}(bt).
\end{equation}
</p>
</div>


<div class="exampletoo">
<p>The 68-95-99.7 Rule. We saw in Section <a href="#sec-3-3-4">Measures of Spread</a> that when an empirical distribution is approximately bell shaped there are specific proportions of the observations which fall at varying distances from the (sample) mean. We can see where these come from &ndash; and obtain more precise proportions &ndash; with the following:
</p>
</div>




<pre class="src src-R">pnorm(1:3) - pnorm(-(1:3))
</pre>


<pre class="example">
[1] 0.6826895 0.9544997 0.9973002
</pre>



<div class="exampletoo">
<p><a name="exa-iq-model" id="exa-iq-model"></a>
Let the random experiment consist of a person taking an IQ test, and let \(X\) be the score on the test. The scores on such a test are typically standardized to have a mean of 100 and a standard deviation of 15, and IQ tests have (approximately and notoriously) a bell-shaped distribution. What is \(\mathbb{P}(85\leq X\leq115)\)?
</p>
<p>
<i>Solution</i>: this one is easy because the limits 85 and 115 fall exactly one standard deviation (below and above, respectively) from the mean of 100. The answer is therefore approximately 68%.
</p>
</div>


</div>

<div id="outline-container-sub-Normal-Quantiles-QF" class="outline-4">
<h4 id="sub-Normal-Quantiles-QF"><a name="sec-6-3-1" id="sec-6-3-1"></a><span class="section-number-4">6.3.1</span> Normal Quantiles and the Quantile Function</h4>
<div class="outline-text-4" id="text-sub-Normal-Quantiles-QF">


<p>
Until now we have been given two values and our task has been to find the area under the PDF between those values. In this section, we go in reverse: we are given an area, and we would like to find the value(s) that correspond to that area. 
</p>

<div class="exampletoo">
<p><a name="exa-iq-quantile-state-problem" id="exa-iq-quantile-state-problem"></a>
Assuming the IQ model of Example <a href="#exa-iq-model">IQ Model</a>, what is the lowest possible IQ score that a person can have and still be in the top 1% of all IQ scores?
<i>Solution</i>: If a person is in the top 1%, then that means that 99% of the people have lower IQ scores. So, in other words, we are looking for a value \(x\) such that \(F(x)=\mathbb{P}(X\leq x)\) satisfies \(F(x)=0.99\), or yet another way to say it is that we would like to solve the equation \(F(x)-0.99=0\). For the sake of argument, let us see how to do this the long way. We define the function \(g(x)=F(x)-0.99\), and then look for the root of \(g\) with the <code>uniroot</code> function. It uses numerical procedures to find the root so we need to give it an interval of \(x\) values in which to search for the root. We can get an educated guess from the Empirical Rule <a href="#fac-Empirical-Rule">Empirical Rule</a>; the root should be somewhere between two and three standard deviations (15 each) above the mean (which is 100).
</p>


<pre class="src src-R"><span style="font-weight: bold;">g</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x) pnorm(x, mean = 100, sd = 15) - 0.99
uniroot(g, interval = c(130, 145))
</pre>



<pre class="src src-R">temp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> round(uniroot(g, interval = c(130, 145))$root, 4)
</pre>


<p>
The answer is shown in <code>$root</code> which is approximately \( SRC_R{temp} \), that is, a person with this IQ score or higher falls in the top 1% of all IQ scores.
</p>
</div>

<p>
The discussion in Example <a href="#exa-iq-quantile-state-problem">IQ Quantile</a> was centered on the search for a value \(x\) that solved an equation \(F(x)=p\), for some given probability \(p\), or in mathematical parlance, the search for \(F^{-1}\), the inverse of the CDF of \(X\), evaluated at \(p\). This is so important that it merits a definition all its own.
</p>

<div class="defn">
<p>The <i>quantile function</i>
of a random variable \(X\) is the inverse of its cumulative distribution function:
\begin{equation}
Q_{X}(p)=\min\left\{ x:\ F_{X}(x)\geq p\right\} ,\quad 0 < p <1.
\end{equation}
</p>
</div>


<div class="rem">
<p>Here are some properties of quantile functions:
</p><ol>
<li>The quantile function is defined and finite for all \(0&lt;p&lt;1\).
</li>
<li>\(Q_{X}\) is left-continuous (see Appendix <a href="#sec-21-2">Differential-Integral Calculus</a>). For discrete random variables it is a step function, and for continuous random variables it is a continuous function.
</li>
<li>In the continuous case the graph of \(Q_{X}\) may be obtained by reflecting the graph of \(F_{X}\) about the line \(y=x\). In the discrete case, before reflecting one should: 1) connect the dots to get rid of the jumps &ndash; this will make the graph look like a set of stairs, 2) erase the horizontal lines so that only vertical lines remain, and finally 3) swap the open circles with the solid dots. Please see Figure <a href="#fig-binom-plot-distr">binom-plot-distr</a> for a comparison. 
</li>
<li>The two limits
   \[
   \lim_{p\to0^{+}}Q_{X}(p)\quad \mbox{and}\quad \lim_{p\to1^{-}}Q_{X}(p)
   \]
   always exist, but may be infinite (that is, sometimes \(\lim_{p\to0}Q(p)=-\infty\) and/or \(\lim_{p\to1}Q(p)=\infty\)).
</li>
</ol>



</div>

<p>
As the reader might expect, the standard normal distribution is a very special case and has its own special notation.
</p>

<div class="defn">
<p>For \(0&lt;\alpha&lt;1\), the symbol \(z_{\alpha}\) denotes the unique solution of the equation \( \mathbb{P} ( Z &gt; z_{\alpha}) = \alpha\), where \(Z \sim \mathsf{norm}(\mathtt{mean} = 0,\,\mathtt{sd} = 1)\). It can be calculated in one of two equivalent ways: \(\mathtt{qnorm(} 1 - \alpha \mathtt{)} \) and \(\mathtt{qnorm(} \alpha \mathtt{, lower.tail = FALSE)} \). 
</p>
</div>

<p>
There are a few other very important special cases which we will encounter in later chapters. 
</p>

</div>

<div id="outline-container-6-3-1-1" class="outline-5">
<h5 id="sec-6-3-1-1"><span class="section-number-5">6.3.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-6-3-1-1">


<p>
Quantile functions are defined for all of the base distributions with the <code>q</code> prefix to the distribution name, except for the ECDF whose quantile function is exactly the \( Q_{x}(p) = \mathsf{quantile}(x, \mathtt{probs} = p, \mathtt{type} = 1) \) function. 
</p>

<div class="exampletoo">
<p>Back to Example <a href="#exa-iq-quantile-state-problem">IQ Quantile</a>, we are looking for \(Q_{X}(0.99)\), where \(X\sim\mathsf{norm}(\mathtt{mean}=100,\,\mathtt{sd}=15)\). It could not be easier to do with \(\mathsf{R}\). 
</p>



<pre class="src src-R">qnorm(0.99, mean = 100, sd = 15)
</pre>


<p>
Compare this answer to the one obtained earlier with <code>uniroot</code>.
</p>
</div>


<div class="exampletoo">
<p>Find the values \(z_{0.025}\), \(z_{0.01}\), and \(z_{0.005}\) (these will play an important role from Chapter <a href="#sec-9">Estimation</a> onward).
</p>
</div>




<pre class="src src-R">qnorm(c(0.025, 0.01, 0.005), lower.tail = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>


<pre class="example">
[1] 1.959964 2.326348 2.575829
</pre>


<p>
Note the <code>lower.tail</code> argument. We would get the same answer with
</p><pre class="example">
qnorm(c(0.975, 0.99, 0.995))
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-sec-Functions-of-Continuous" class="outline-3">
<h3 id="sec-Functions-of-Continuous"><a name="sec-6-4" id="sec-6-4"></a><span class="section-number-3">6.4</span> Functions of Continuous Random Variables</h3>
<div class="outline-text-3" id="text-sec-Functions-of-Continuous">


<p>
The goal of this section is to determine the distribution of \(U=g(X)\) based on the distribution of \(X\). In the discrete case all we needed to do was back substitute for \(x=g^{-1}(u)\) in the PMF of \(X\) (sometimes accumulating probability mass along the way). In the continuous case, however, we need more sophisticated tools. Now would be a good time to review Appendix <a href="#sec-21-2">Differential-Integral Calculus</a>.
</p>

</div>

<div id="outline-container-6-4-1" class="outline-4">
<h4 id="sec-6-4-1"><span class="section-number-4">6.4.1</span> The PDF Method</h4>
<div class="outline-text-4" id="text-6-4-1">



<div class="prop">
<p><a name="pro-func-cont-rvs-pdf-formula" id="pro-func-cont-rvs-pdf-formula"></a>
</p>
<p>
Let \(X\) have PDF \(f_{X}\) and let \(g\) be a function which is one-to-one with a differentiable inverse \(g^{-1}\). Then the PDF of \(U=g(X)\) is given by
\begin{equation}
f_{U}(u)=f_{X}\left[g^{-1}(u)\right]\ \left|\frac{\mathrm{d}}{\mathrm{d} u}g^{-1}(u)\right|.
\end{equation}
<a name="eq-univ-trans-pdf-long" id="eq-univ-trans-pdf-long"></a>
</p>
</div>


<div class="rem">
<p>The formula in Equation <a href="#eq-univ-trans-pdf-long">eq-univ-trans-pdf-long</a> is nice, but does not really make any sense. It is better to write in the intuitive form
\begin{equation}
f_{U}(u)=f_{X}(x)\left|\frac{\mathrm{d} x}{\mathrm{d} u}\right|.
\end{equation}
<a name="eq-univ-trans-pdf-short" id="eq-univ-trans-pdf-short"></a>
</p>
</div>


<div class="exampletoo">
<p><a name="exa-lnorm-transformation" id="exa-lnorm-transformation"></a>
Let \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\), and let \(Y=\mathrm{e}^{X}\). What is the PDF of \(Y\)? 
<b>Solution:</b> Notice first that \(\mathrm{e}^{x}&gt;0\) for any \(x\), so the support of \(Y\) is \((0,\infty)\). Since the transformation is monotone, we can solve \(y=\mathrm{e}^{x}\) for \(x\) to get \(x=\ln\, y\), giving \(\mathrm{d} x/\mathrm{d} y=1/y\). Therefore, for any \(y&gt;0\),
\[
f_{Y}(y)=f_{X}(\ln y)\cdot\left|\frac{1}{y}\right|=\frac{1}{\sigma\sqrt{2\pi}}\exp\left\{ \frac{(\ln y-\mu)^{2}}{2\sigma^{2}}\right\} \cdot\frac{1}{y},
\]
where we have dropped the absolute value bars since \(y&gt;0\). The random variable \(Y\) is said to have a <i>lognormal distribution</i>; see Section <a href="#sec-6-5">Other Continuous Distributions</a>.
</p>
</div>


<div class="exampletoo">
<p><a name="exa-lin-trans-norm" id="exa-lin-trans-norm"></a>
Suppose \(X\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) and let \(Y=4-3X\). What is the PDF of \(Y\)?
</p>
</div>

<p>
The support of \(X\) is \((-\infty,\infty)\), and as \(x\) goes from \(-\infty\) to \(\infty\), the quantity \(y=4-3x\) also traverses \((-\infty,\infty)\). Solving for \(x\) in the equation \(y=4-3x\) yields \(x=-(y-4)/3\) giving \(\mathrm{d} x/\mathrm{d} y=-1/3\). And since
\[
f_{X}(x)=\frac{1}{\sqrt{2\pi}}\mathrm{e}^{-x^{2}/2}, \quad -\infty < x < \infty ,
\]
we have
\begin{eqnarray*}
f_{Y}(y) & = & f_{X}\left(\frac{y-4}{3}\right)\cdot\left|-\frac{1}{3}\right|,\quad -\infty < y < \infty,\\
 & = & \frac{1}{3\sqrt{2\pi}}\mathrm{e}^{-(y-4)^{2}/2\cdot3^{2}},\quad -\infty < y < \infty.
\end{eqnarray*}
We recognize the PDF of \(Y\) to be that of a \(\mathsf{norm}(\mathtt{mean}=4,\,\mathtt{sd}=3)\) distribution. Indeed, we may use an identical argument as the above to prove the following fact:
</p>

<div class="fact">
<p><a name="fac-lin-trans-norm-is-norm" id="fac-lin-trans-norm-is-norm"></a>
If \(X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) and if \(Y=a+bX\) for constants \(a\) and \(b\), with \(b\neq0\), then \(Y\sim\mathsf{norm}(\mathtt{mean}=a+b\mu,\,\mathtt{sd}=|b|\sigma)\). 
</p>
</div>

<p>
Note that it is sometimes easier to <i>postpone</i> solving for the inverse transformation \(x=x(u)\). Instead, leave the transformation in the form \(u=u(x)\) and calculate the derivative of the <i>original</i> transformation
\begin{equation}
\mathrm{d} u/\mathrm{d} x=g'(x).
\end{equation}
Once this is known, we can get the PDF of \(U\) with
\begin{equation}
f_{U}(u)=f_{X}(x)\left|\frac{1}{\mathrm{d} u/\mathrm{d} x}\right|.
\end{equation}
In many cases there are cancellations and the work is shorter. Of course, it is not always true that
\begin{equation}
\frac{\mathrm{d} x}{\mathrm{d} u}=\frac{1}{\mathrm{d} u/\mathrm{d} x},
\end{equation}
<a name="eq-univ-jacob-recip" id="eq-univ-jacob-recip"></a>
but for the well-behaved examples in this book the trick works just fine.
</p>

<div class="rem">
<p>In the case that \(g\) is not monotone we cannot apply Proposition <a href="#pro-func-cont-rvs-pdf-formula">func-cont-rvs-pdf</a> directly. However, hope is not lost. Rather, we break the support of \(X\) into pieces such that \(g\) is monotone on each one. We apply Proposition <a href="#pro-func-cont-rvs-pdf-formula">func-cont-rvs-pdf</a> on each piece, and finish up by adding the results together.
</p>
</div>

</div>

</div>

<div id="outline-container-6-4-2" class="outline-4">
<h4 id="sec-6-4-2"><span class="section-number-4">6.4.2</span> The CDF method</h4>
<div class="outline-text-4" id="text-6-4-2">


<p>
We know from Section <a href="#sec-6-1">Continuous Random Variables</a> that \(f_{X}=F_{X}'\) in the continuous case. Starting from the equation \(F_{Y}(y)=\mathbb{P}(Y\leq y)\), we may substitute \(g(X)\) for \(Y\), then solve for \(X\) to obtain \(\mathbb{P}[X\leq g^{-1}(y)]\), which is just another way to write \(F_{X}[g^{-1}(y)]\). Differentiating this last quantity with respect to \(y\) will yield the PDF of \(Y\).
</p>

<div class="exampletoo">
<p>Suppose \(X\sim\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\) and
suppose that we let \(Y=-\ln\, X\). What is the PDF of \(Y\)?
</p>
<p>
The support set of \(X\) is \((0,1),\) and \(y\) traverses \((0,\infty)\) as \(x\) ranges from \(0\) to \(1\), so the support set of \(Y\) is \(S_{Y}=(0,\infty)\). For any \(y&gt;0\), we consider
\[
F_{Y}(y)=\mathbb{P}(Y\leq y)=\mathbb{P}(-\ln\, X\leq y)=\mathbb{P}(X\geq\mathrm{e}^{-y})=1-\mathbb{P}(X<\mathrm{e}^{-y}),
\]
where the next to last equality follows because the exponential function is <i>monotone</i> (this point will be revisited later). Now since \(X\) is continuous the two probabilities \(\mathbb{P}(X&lt;\mathrm{e}^{-y})\) and \(\mathbb{P}(X\leq\mathrm{e}^{-y})\) are equal; thus
\[
1-\mathbb{P}(X < \mathrm{e}^{-y})=1-\mathbb{P}(X\leq\mathrm{e}^{-y})=1-F_{X}(\mathrm{e}^{-y}).
\]
Now recalling that the CDF of a \(\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\) random variable satisfies \(F(u)=u\) (see Equation <a href="#eq-unif-cdf">Uniform CDF</a>), we can say
\[
F_{Y}(y)=1-F_{X}(\mathrm{e}^{-y})=1-\mathrm{e}^{-y},\quad \mbox{for }y>0.
\]
We have consequently found the formula for the CDF of \(Y\); to obtain the PDF \(f_{Y}\) we need only differentiate \(F_{Y}\):
\[
f_{Y}(y)=\frac{\mathrm{d}}{\mathrm{d} y}\left(1-\mathrm{e}^{-y}\right)=0-\mathrm{e}^{-y}(-1),
\]
or \(f_{Y}(y)=\mathrm{e}^{-y}\) for \(y&gt;0\). This turns out to be a member of the exponential family of distributions, see Section <a href="#sec-6-5">Other Continuous Distributions</a>. 
</p>
</div>


<div class="exampletoo">
<p><b>The Probability Integral Transform</b>. Given a continuous random variable \(X\) with strictly increasing CDF \(F_{X}\), let the random variable \(Y\) be defined by \(Y=F_{X}(X)\). Then the distribution of \(Y\) is \(\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\).
</p>
</div>


<div class="proof">
<p>We employ the CDF method. First note that the support of \(Y\) is \((0,1)\). Then for any \(0&lt;y&lt;1\),
\[
F_{Y}(y)=\mathbb{P}(Y\leq y)=\mathbb{P}(F_{X}(X)\leq y).
\]
Now since \(F_{X}\) is strictly increasing, it has a well defined inverse function \(F_{X}^{-1}\). Therefore,
\[
\mathbb{P}(F_{X}(X)\leq y)=\mathbb{P}(X\leq F_{X}^{-1}(y))=F_{X}[F_{X}^{-1}(y)]=y.
\]
Summarizing, we have seen that \(F_{Y}(y)=y\), \(0&lt;y&lt;1\). But this is exactly the CDF of a \(\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)\) random variable. 
</p>
</div>


<div class="fact">
<p>The Probability Integral Transform is true for all continuous random variables with continuous CDFs, not just for those with strictly increasing CDFs (but the proof is more complicated). The transform is <b>not</b> true for discrete random variables, or for continuous random variables having a discrete component (that is, with jumps in their CDF).
</p>
</div>


<div class="exampletoo">
<p><a name="exa-distn-of-z-squared" id="exa-distn-of-z-squared"></a>
Let \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) and let \(U=Z^{2}\). What is the PDF of \(U\)? 
Notice first that \(Z^{2}\geq0\), and thus the support of \(U\) is \([0,\infty)\). And for any \(u\geq0\), 
\[
F_{U}(u)=\mathbb{P}(U\leq u)=\mathbb{P}(Z^{2}\leq u).
\]
But \(Z^{2}\leq u\) occurs if and only if \(-\sqrt{u}\leq Z\leq\sqrt{u}\). The last probability above is simply the area under the standard normal PDF from \(-\sqrt{u}\) to \(\sqrt{u}\), and since \(\phi\) is symmetric about 0, we have
\[
\mathbb{P}(Z^{2}\leq u)=2\mathbb{P}(0\leq Z\leq\sqrt{u})=2\left[F_{Z}(\sqrt{u})-F_{Z}(0)\right]=2\Phi(\sqrt{u})-1,
\]
because \(\Phi(0)=1/2\). To find the PDF of \(U\) we differentiate the CDF recalling that \(\Phi'=\phi\).
\[
f_{U}(u)=\left(2\Phi(\sqrt{u})-1\right)'=2\phi(\sqrt{u})\cdot\frac{1}{2\sqrt{u}}=u^{-1/2}\phi(\sqrt{u}).
\]
Substituting,
\[
f_{U}(u)=u^{-1/2}\frac{1}{\sqrt{2\pi}}\,\mathrm{e}^{-(\sqrt{u})^{2}/2}=(2\pi u)^{-1/2}\mathrm{e}^{-u/2},\quad u > 0.
\]
This is what we will later call a <i>chi-square distribution with 1 degree of freedom</i>. See Section <a href="#sec-6-5">Other Continuous Distributions</a>.
</p>
</div>


</div>

<div id="outline-container-6-4-2-1" class="outline-5">
<h5 id="sec-6-4-2-1"><span class="section-number-5">6.4.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-6-4-2-1">


<p>
The <code>distr</code> package has functionality to investigate transformations of univariate distributions. There are exact results for ordinary transformations of the standard distributions, and <code>distr</code> takes advantage of these in many cases. For instance, the <code>distr</code> package can handle the transformation in Example <a href="#exa-lin-trans-norm">Linear Trans-Norm</a> quite nicely:
</p>



<pre class="src src-R">X <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> Norm(mean = 0, sd = 1)
Y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 4 - 3*X
Y
</pre>


<pre class="example">
 Distribution Object of Class: Norm
 mean: 4
 sd: 3
</pre>


<p>
So <code>distr</code> ``knows'' that a linear transformation of a normal random variable is again normal, and it even knows what the correct <code>mean</code> and <code>sd</code> should be. But it is impossible for <code>distr</code> to know everything, and it is not long before we venture outside of the transformations that <code>distr</code> recognizes. Let us try Example <a href="#exa-lnorm-transformation">Lnorm Trans</a>:
</p>



<pre class="src src-R">Y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> exp(X)
Y
</pre>


<pre class="example">
Distribution Object of Class: AbscontDistribution
</pre>


<p>
The result is an object of class <code>AbscontDistribution</code>, which is one of the classes that <code>distr</code> uses to denote general distributions that it does not recognize (it turns out that \(Z\) has a <i>lognormal</i> distribution; see Section <a href="#sec-6-5">Other Continuous Distributions</a>). A simplified description of the process that <code>distr</code> undergoes when it encounters a transformation \(Y=g(X)\) that it does not recognize is
</p><ol>
<li>Randomly generate many, many copies \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) from the distribution of \(X\),
</li>
<li>Compute \(Y_{1}=g(X_{1})\), \(Y_{2}=g(X_{2})\), &hellip;, \(Y_{n}=g(X_{n})\) and store them for use.
</li>
<li>Calculate the PDF, CDF, quantiles, and random variates using the simulated values of \(Y\).
</li>
</ol>

<p>As long as the transformation is sufficiently nice, such as a linear transformation, the exponential, absolute value, <i>etc.</i>, the <code>d-p-q</code> functions are calculated analytically based on the <code>d-p-q</code> functions associated with \(X\). But if we try a crazy transformation then we are greeted by a warning:
</p>



<pre class="src src-R">W <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sin(exp(X) + 27)
W
</pre>


<pre class="example">
Distribution Object of Class: AbscontDistribution
</pre>


<p>
The warning confirms that the <code>d-p-q</code> functions are not calculated analytically, but are instead based on the randomly simulated values of \(Y\). <i>We must be careful to remember this.</i> The nature of random simulation means that we can get different answers to the same question: watch what happens when we compute \(\mathbb{P}(W\leq0.5)\) using the \(W\) above, then define \(W\) again, and compute the (supposedly) same \(\mathbb{P}(W\leq0.5)\) a few moments later.
</p>



<pre class="src src-R">p(W)(0.5)
W <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sin(exp(X) + 27)
p(W)(0.5)
</pre>


<pre class="example">
[1] 0.5793242
[1] 0.5793242
</pre>


<p>
The answers are not the same! Furthermore, if we were to repeat the process we would get yet another answer for \(\mathbb{P}(W\leq0.5)\).  
</p>
<p>
The answers were close, though. And the underlying randomly generated \(X\)'s were not the same so it should hardly be a surprise that the calculated \(W\)'s were not the same, either. This serves as a warning (in concert with the one that <code>distr</code> provides) that we should be careful to remember that complicated transformations computed by \(\mathsf{R}\) are only approximate and may fluctuate slightly due to the nature of the way the estimates are calculated.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Other-Continuous-Distributions" class="outline-3">
<h3 id="sec-Other-Continuous-Distributions"><a name="sec-6-5" id="sec-6-5"></a><span class="section-number-3">6.5</span> Other Continuous Distributions</h3>
<div class="outline-text-3" id="text-sec-Other-Continuous-Distributions">



</div>

<div id="outline-container-sub-Waiting-Time-Distributions" class="outline-4">
<h4 id="sub-Waiting-Time-Distributions"><a name="sec-6-5-1" id="sec-6-5-1"></a><span class="section-number-4">6.5.1</span> Waiting Time Distributions</h4>
<div class="outline-text-4" id="text-sub-Waiting-Time-Distributions">


<p>
In some experiments, the random variable being measured is the time until a certain event occurs. For example, a quality control specialist may be testing a manufactured product to see how long it takes until it fails. An efficiency expert may be recording the customer traffic at a retail store to streamline scheduling of staff. 
</p>

</div>

<div id="outline-container-sub-The-Exponential-Distribution" class="outline-5">
<h5 id="sub-The-Exponential-Distribution"><a name="sec-6-5-1-1" id="sec-6-5-1-1"></a><span class="section-number-5">6.5.1.1</span> The Exponential Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Exponential-Distribution">


<p>
We say that \(X\) has an <i>exponential distribution</i> and write \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). 
\begin{equation}
f_{X}(x)=\lambda\mathrm{e}^{-\lambda x},\quad x>0
\end{equation}
The associated \(\mathsf{R}\) functions are <code>dexp(x, rate = 1)</code>, <code>pexp</code>, <code>qexp</code>, and <code>rexp</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively.
</p>
<p>
The parameter \(\lambda\) measures the rate of arrivals (to be described later) and must be positive. The CDF is given by the formula
\begin{equation}
F_{X}(t)=1-\mathrm{e}^{-\lambda t},\quad t>0.
\end{equation}
The mean is \(\mu=1/\lambda\) and the variance is \(\sigma^{2}=1/\lambda^{2}\). 
</p>
<p>
The exponential distribution is closely related to the Poisson distribution. If customers arrive at a store according to a Poisson process with rate \(\lambda\) and if \(Y\) counts the number of customers that arrive in the time interval \([0,t)\), then we saw in Section <a href="#sec-5-6">Other Discrete Distributions</a> that \( Y \sim \mathsf{pois}(\mathtt{lambda}=\lambda t). \) Now consider a different question: let us start our clock at time 0 and stop the clock when the first customer arrives. Let \(X\) be the length of this random time interval. Then \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). Observe the following string of equalities:
\begin{align*}
\mathbb{P}(X>t) & =\mathbb{P}(\mbox{first arrival after time \emph{t}}),\\
 & =\mathbb{P}(\mbox{no events in [0,\emph{t})}),\\
 & =\mathbb{P}(Y=0),\\
 & =\mathrm{e}^{-\lambda t},
\end{align*}
where the last line is the PMF of \(Y\) evaluated at \(y=0\). In other words, \(\mathbb{P}(X\leq t)=1-\mathrm{e}^{-\lambda t}\), which is exactly the CDF of an \(\mathsf{exp}(\mathtt{rate}=\lambda)\) distribution. 
</p>
<p>
The exponential distribution is said to be <i>memoryless</i> because exponential random variables "forget" how old they are at every instant. That is, the probability that we must wait an additional five hours for a customer to arrive, given that we have already waited seven hours, is exactly the probability that we needed to wait five hours for a customer in the first place. In mathematical symbols, for any \(s,\, t&gt;0\),
\begin{equation}
\mathbb{P}(X>s+t\,|\, X>t)=\mathbb{P}(X>s).
\end{equation}
See Exercise <a href="#xca-prove-the-memoryless">Prove Memoryless</a>.
</p>
</div>

</div>

<div id="outline-container-sub-The-Gamma-Distribution" class="outline-5">
<h5 id="sub-The-Gamma-Distribution"><a name="sec-6-5-1-2" id="sec-6-5-1-2"></a><span class="section-number-5">6.5.1.2</span> The Gamma Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Gamma-Distribution">


<p>
This is a generalization of the exponential distribution. We say that \(X\) has a gamma distribution and write \(X\sim\mathsf{gamma}(\mathtt{shape}=\alpha,\,\mathtt{rate}=\lambda)\). It has PDF
\begin{equation}
f_{X}(x)=\frac{\lambda^{\alpha}}{\Gamma(\alpha)}\: x^{\alpha-1}\mathrm{e}^{-\lambda x},\quad x>0.
\end{equation}

The associated \(\mathsf{R}\) functions are <code>dgamma(x, shape, rate = 1)</code>, <code>pgamma</code>, <code>qgamma</code>, and <code>rgamma</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. If \(\alpha=1\) then \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). The mean is \(\mu=\alpha/\lambda\) and the variance is \(\sigma^{2}=\alpha/\lambda^{2}\).
</p>
<p>
To motivate the gamma distribution recall that if \(X\) measures the length of time until the first event occurs in a Poisson process with rate \(\lambda\) then \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\). If we let \(Y\) measure the length of time until the \(\alpha^{\mathrm{th}}\) event occurs then \(Y\sim\mathsf{gamma}(\mathtt{shape}=\alpha,\,\mathtt{rate}=\lambda)\). When \(\alpha\) is an integer this distribution is also known as the <i>Erlang</i> distribution.
</p>

<div class="exampletoo">
<p>At a car wash, two customers arrive per hour on the average. We decide to measure how long it takes until the third customer arrives. If \(Y\) denotes this random time then \(Y\sim\mathsf{gamma}(\mathtt{shape}=3,\,\mathtt{rate}=1/2)\).
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sub-The-Chi-Square-t-F" class="outline-4">
<h4 id="sub-The-Chi-Square-t-F"><a name="sec-6-5-2" id="sec-6-5-2"></a><span class="section-number-4">6.5.2</span> The Chi square, Student's \(t\), and Snedecor's \(F\) Distributions</h4>
<div class="outline-text-4" id="text-sub-The-Chi-Square-t-F">



</div>

<div id="outline-container-sub-The-Chi-Square" class="outline-5">
<h5 id="sub-The-Chi-Square"><a name="sec-6-5-2-1" id="sec-6-5-2-1"></a><span class="section-number-5">6.5.2.1</span> The Chi square Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Chi-Square">


<p>
A random variable \(X\) with PDF
\begin{equation}
f_{X}(x)=\frac{1}{\Gamma(p/2)2^{p/2}}x^{p/2-1}\mathrm{e}^{-x/2},\quad x>0,
\end{equation}
is said to have a <i>chi-square distribution</i> with \(p\) <i>degrees of freedom</i>. We write \(X\sim\mathsf{chisq}(\mathtt{df}=p)\). The associated \(\mathsf{R}\) functions are <code>dchisq(x, df)</code>, <code>pchisq</code>, <code>qchisq</code>, and <code>rchisq</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. See Figure <a href="#fig-chisq-dist-vary-df">chisq-dist-vary-df</a>. In an obvious notation we may define \(\chi_{\alpha}^{2}(p)\) as the number on the \(x\)-axis such that there is exactly \(\alpha\) area under the \(\mathsf{chisq}(\mathtt{df}=p)\) curve to its right.
</p>
<p>
The code to produce Figure <a href="#fig-chisq-dist-vary-df">chisq-dist-vary-df</a> is
</p>



<pre class="src src-R">curve(dchisq(x, df = 3), from = 0, to = 20, ylab = <span style="font-style: italic;">"y"</span>)
ind <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(4, 5, 10, 15)
<span style="font-weight: bold;">for</span> (i <span style="font-weight: bold;">in</span> ind) curve(dchisq(x, df = i), 0, 20, add = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>







<div id="fig-chisq-dist-vary-df" class="figure">
  <p><img src="svg/contdist/chisq-dist-vary-df.svg" width=500 alt="svg/contdist/chisq-dist-vary-df.svg" /></p>
  <p>The chi square distribution for various degrees of freedom.</p>
</div>


<div class="rem">
<p>Here are some useful things to know about the chi-square distribution.
</p><ol>
<li>If \(Z\sim\mathtt{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\), then \(Z^{2}\sim\mathsf{chisq}(\mathtt{df}=1)\). We saw this in Example <a href="#exa-distn-of-z-squared">Distn Z2</a>, and the fact is important when it comes time to find the distribution of the sample variance, \(S^{2}\). See Theorem <a href="#thm-Xbar-and-S">Xbar and S</a> in Section <a href="#sec-8-2-2">Sample Variance Distribution</a>.
</li>
<li>The chi-square distribution is supported on the positive \(x\)-axis, with a right-skewed distribution.
</li>
<li>The \(\mathsf{chisq}(\mathtt{df}=p)\) distribution is the same as a \(\mathsf{gamma}(\mathtt{shape}=p/2,\,\mathtt{rate}=1/2)\) distribution. 
</li>
<li>The MGF of \(X\sim\mathsf{chisq}(\mathtt{df}=p)\) is
   \begin{equation}
   M_{X}(t)=\left(1-2t\right)^{-p},\quad t < 1/2.
   \end{equation}
   <a name="eq-mgf-chisq" class="target">eq-mgf-chisq</a> 
</li>
</ol>



</div>

</div>

</div>

<div id="outline-container-sub-Student-s-t-distribution" class="outline-5">
<h5 id="sub-Student-s-t-distribution"><a name="sec-6-5-2-2" id="sec-6-5-2-2"></a><span class="section-number-5">6.5.2.2</span> Student's \(t\) distribution</h5>
<div class="outline-text-5" id="text-sub-Student-s-t-distribution">


<p>
A random variable \(X\) with PDF
\begin{equation}
f_{X}(x) = \frac{\Gamma\left[ (r+1)/2\right] }{\sqrt{r\pi}\,\Gamma(r/2)}\left( 1 + \frac{x^{2}}{r} \right)^{-(r+1)/2},\quad -\infty < x < \infty
\end{equation}
is said to have <i>Student's</i> \(t\) distribution with \(r\) <i>degrees of freedom</i>, and we write \(X\sim\mathsf{t}(\mathtt{df}=r)\). The associated \(\mathsf{R}\) functions are <code>dt</code>,=pt=, <code>qt</code>, and <code>rt</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. See Section <a href="#sec-8-2">Sampling from Normal</a>.
</p>
</div>

</div>

<div id="outline-container-sub-snedecor-F-distribution" class="outline-5">
<h5 id="sub-snedecor-F-distribution"><a name="sec-6-5-2-3" id="sec-6-5-2-3"></a><span class="section-number-5">6.5.2.3</span> Snedecor's \(F\) distribution</h5>
<div class="outline-text-5" id="text-sub-snedecor-F-distribution">


<p>
A random variable \(X\) with PDF
\begin{equation}
f_{X}(x)=\frac{\Gamma[(m+n)/2]}{\Gamma(m/2)\Gamma(n/2)}\left(\frac{m}{n}\right)^{m/2}x^{m/2-1}\left(1+\frac{m}{n}x\right)^{-(m+n)/2},\quad x>0.
\end{equation}
is said to have an \(F\) distribution with \((m,n)\) degrees of freedom. We write \(X\sim\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)\). The associated \(\mathsf{R}\) functions are <code>df(x, df1, df2)</code>, <code>pf</code>, <code>qf</code>, and <code>rf</code>, which give the PDF, CDF, quantile function, and simulate random variates, respectively. We define \(F_{\alpha}(m,n)\) as the number on the \(x\)-axis such that there is exactly \(\alpha\) area under the \(\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)\) curve to its right. 
</p>

<div class="rem">
<p>Here are some notes about the \(F\) distribution.
</p><ol>
<li>If \(X\sim\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)\) and \(Y=1/X\), then \(Y\sim\mathsf{f}(\mathtt{df1}=n,\,\mathtt{df2}=m)\). Historically, this fact was especially convenient. In the old days, statisticians used printed tables for their statistical calculations. Since the \(F\) tables were symmetric in \(m\) and \(n\), it meant that publishers could cut the size of their printed tables in half. It plays less of a role today now that personal computers are widespread.
</li>
<li>If \(X\sim\mathsf{t}(\mathtt{df}=r)\), then \(X^{2}\sim\mathsf{f}(\mathtt{df1}=1,\,\mathtt{df2}=r)\). We will see this again in Section <a href="#sec-11-3-3">SLR Overall F</a>.
</li>
</ol>



</div>

</div>
</div>

</div>

<div id="outline-container-sub-Other-Popular-Distributions" class="outline-4">
<h4 id="sub-Other-Popular-Distributions"><a name="sec-6-5-3" id="sec-6-5-3"></a><span class="section-number-4">6.5.3</span> Other Popular Distributions</h4>
<div class="outline-text-4" id="text-sub-Other-Popular-Distributions">



</div>

<div id="outline-container-sub-The-Cauchy-Distribution" class="outline-5">
<h5 id="sub-The-Cauchy-Distribution"><a name="sec-6-5-3-1" id="sec-6-5-3-1"></a><span class="section-number-5">6.5.3.1</span> The Cauchy Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Cauchy-Distribution">


<p>
This is a special case of the Student's \(t\) distribution. It has PDF
\begin{equation}
f_{X}(x) = \frac{1}{\beta\pi} \left[ 1+\left( \frac{x-m}{\beta} \right)^{2} \right]^{-1},\quad -\infty < x < \infty.
\end{equation}
We write \(X\sim\mathsf{cauchy}(\mathtt{location}=m,\,\mathtt{scale}=\beta)\). The associated \(\mathsf{R}\) function is <code>dcauchy(x, location = 0, scale = 1)</code>.
</p>
<p>
It is easy to see that a \(\mathsf{cauchy}(\mathtt{location}=0,\,\mathtt{scale}=1)\) distribution is the same as a \(\mathsf{t}(\mathtt{df}=1)\) distribution. The \(\mathsf{cauchy}\) distribution looks like a \(\mathsf{norm}\) distribution but with very heavy tails. The mean (and variance) do not exist, that is, they are infinite. The median is represented by the \(\mathtt{location}\) parameter, and the \(\mathtt{scale}\) parameter influences the spread of the distribution about its median.
</p>
</div>

</div>

<div id="outline-container-sub-The-Beta-Distribution" class="outline-5">
<h5 id="sub-The-Beta-Distribution"><a name="sec-6-5-3-2" id="sec-6-5-3-2"></a><span class="section-number-5">6.5.3.2</span> The Beta Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Beta-Distribution">


<p>
This is a generalization of the continuous uniform distribution.
\begin{equation}
f_{X}(x)=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\, x^{\alpha-1}(1-x)^{\beta-1},\quad 0 < x < 1.
\end{equation}
We write \(X\sim\mathsf{beta}(\mathtt{shape1}=\alpha,\,\mathtt{shape2}=\beta)\). The associated \(\mathsf{R}\) function is <code>dbeta(x, shape1, shape2)</code>. The mean and variance are
\begin{equation} 
\mu=\frac{\alpha}{\alpha+\beta}\mbox{ and }\sigma^{2}=\frac{\alpha\beta}{\left(\alpha+\beta\right)^{2}\left(\alpha+\beta+1\right)}.
\end{equation}
See Example <a href="#exa-cont-pdf3x2">Cont-pdf3x2</a>. This distribution comes up a lot in Bayesian statistics because it is a good model for one's prior beliefs about a population proportion \(p\), \(0\leq p\leq1\).
</p>
</div>

</div>

<div id="outline-container-sub-The-Logistic-Distribution" class="outline-5">
<h5 id="sub-The-Logistic-Distribution"><a name="sec-6-5-3-3" id="sec-6-5-3-3"></a><span class="section-number-5">6.5.3.3</span> The Logistic Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Logistic-Distribution">




\begin{equation}
f_{X}(x)=\frac{1}{\sigma}\exp\left(-\frac{x-\mu}{\sigma}\right)\left[1+\exp\left(-\frac{x-\mu}{\sigma}\right)\right]^{-2},\quad -\infty < x < \infty.
\end{equation}
<p>
We write \(X\sim\mathsf{logis}(\mathtt{location}=\mu,\,\mathtt{scale}=\sigma)\). The associated \(\mathsf{R}\) function is <code>dlogis(x, location = 0, scale = 1)</code>. The logistic distribution comes up in differential equations as a model for population growth under certain assumptions. The mean is \(\mu\) and the variance is \(\pi^{2}\sigma^{2}/3\).
</p>
</div>

</div>

<div id="outline-container-sub-The-Lognormal-Distribution" class="outline-5">
<h5 id="sub-The-Lognormal-Distribution"><a name="sec-6-5-3-4" id="sec-6-5-3-4"></a><span class="section-number-5">6.5.3.4</span> The Lognormal Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Lognormal-Distribution">


<p>
This is a distribution derived from the normal distribution (hence the name). If \(U\sim\mathtt{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\), then \( X = \mathrm{e}^{U} \) has PDF
\begin{equation}
f_{X}(x)=\frac{1}{\sigma x\sqrt{2\pi}}\exp\left[\frac{-(\ln x-\mu)^{2}}{2\sigma^{2}}\right], \quad 0 < x < \infty.
\end{equation}
We write \(X\sim\mathsf{lnorm}(\mathtt{meanlog}=\mu,\,\mathtt{sdlog}=\sigma)\). The associated \(\mathsf{R}\) function is <code>dlnorm(x, meanlog = 0, sdlog = 1)</code>. Notice that the support is concentrated on the positive \(x\) axis; the distribution is right-skewed with a heavy tail. See Example <a href="#exa-lnorm-transformation">Lnorm-trans</a>.
</p>
</div>

</div>

<div id="outline-container-sub-The-Weibull-Distribution" class="outline-5">
<h5 id="sub-The-Weibull-Distribution"><a name="sec-6-5-3-5" id="sec-6-5-3-5"></a><span class="section-number-5">6.5.3.5</span> The Weibull Distribution</h5>
<div class="outline-text-5" id="text-sub-The-Weibull-Distribution">


<p>
This has PDF
\begin{equation}
f_{X}(x)=\frac{\alpha}{\beta}\left(\frac{x}{\beta}\right)^{\alpha-1}\exp\left(\frac{x}{\beta}\right)^{\alpha},\quad x>0.
\end{equation}
We write \(X\sim\mathsf{weibull}(\mathtt{shape}=\alpha,\,\mathtt{scale}=\beta)\). The associated \(\mathsf{R}\) function is <code>dweibull(x, shape, scale = 1)</code>. 
</p>
</div>

</div>

<div id="outline-container-6-5-3-6" class="outline-5">
<h5 id="sec-6-5-3-6"><span class="section-number-5">6.5.3.6</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-6-5-3-6">


<p>
There is some support of moments and moment generating functions for some continuous probability distributions included in the <code>actuar</code> package \cite{Dutangactuar}. The convention is <code>m</code> in front of the distribution name for raw moments, and <code>mgf</code> in front of the distribution name for the moment generating function. At the time of this writing, the following distributions are supported: gamma, inverse Gaussian, (non-central) chi-squared, exponential, and uniform.
</p>

<div class="exampletoo">
<p>Calculate the first four raw moments for \(X\sim\mathsf{gamma}(\mathtt{shape}=13,\,\mathtt{rate}=1)\) and plot the moment generating function.
</p>
<p>
We load the <code>actuar</code> package and use the functions <code>mgamma</code> and <code>mgfgamma</code>:
</p>


<pre class="src src-R">mgamma(1:4, shape = 13, rate = 1)
</pre>


<p>
For the plot we can use the function in the following form:
</p>



<pre class="src src-R">plot(<span style="font-weight: bold;">function</span>(x){mgfgamma(x, shape = 13, rate = 1)}, from=-0.1, to=0.1, ylab = <span style="font-style: italic;">"gamma mgf"</span>)
</pre>



<pre class="src src-R">  &lt;&lt;gamma-mgf&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;gamma-mgf&gt;&gt;
</pre>



<div id="fig-gamma-mgf" class="figure">
  <p><img src="svg/contdist/gamma-mgf.svg" width=500 alt="svg/contdist/gamma-mgf.svg" /></p>
  <p>A plot of the <code>gamma(shape = 13, rate = 1)</code> MGF.</p>
</div>


</div>


</div>
</div>
</div>

</div>

<div id="outline-container-6-6" class="outline-3">
<h3 id="sec-6-6"><span class="section-number-3">6.6</span> Exercises</h3>
<div class="outline-text-3" id="text-6-6">



<div class="xca">
<p>Find the constant \(C\) so that the given function is a valid PDF of a random variable \(X\).
</p><ol>
<li>\( f(x) = Cx^{n},\quad 0 &lt; x &lt;1 \).
</li>
<li>\( f(x) = Cx\mathrm{e}^{-x},\quad 0 &lt; x &lt; \infty\).
</li>
<li>\( f(x) = \mathrm{e}^{-(x - C)}, \quad 7 &lt; x &lt; \infty.\)
</li>
<li>\( f(x) = Cx^{3}(1 - x)^{2},\quad 0 &lt; x &lt; 1.\)
</li>
<li>\( f(x) = C(1 + x^{2}/4)^{-1}, \quad -\infty &lt; x &lt; \infty.\)
</li>
</ol>



</div>


<div class="xca">
<p>For the following random experiments, decide what the distribution of \(X\) should be. In nearly every case, there are additional assumptions that should be made for the distribution to apply; identify those assumptions (which may or may not strictly hold in practice).
</p><ol>
<li>We throw a dart at a dart board. Let \(X\) denote the squared linear distance from the bulls-eye to the where the dart landed.
</li>
<li>We randomly choose a textbook from the shelf at the bookstore and let \(P\) denote the proportion of the total pages of the book devoted to exercises. 
</li>
<li>We measure the time it takes for the water to completely drain out of the kitchen sink.
</li>
<li>We randomly sample strangers at the grocery store and ask them how long it will take them to drive home. 
</li>
</ol>



</div>


<div class="xca">
<p>If \(Z\) is \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\), find 
</p><ol>
<li>\(\mathbb{P}(Z&gt;2.64)\)
</li>
<li>\(\mathbb{P}(0\leq Z&lt;0.87)\)
</li>
<li>\(\mathbb{P}(|Z|&gt;1.39)\) (Hint: draw a picture!)
</li>
</ol>



</div>


<div class="xca">
<p><a name="xca-variance-dunif" id="xca-variance-dunif"></a>
Calculate the variance of \(X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)\). <i>Hint:</i> First calculate \(\mathbb{E} X^{2}\).
</p>
</div>


<div class="xca">
<p><a name="xca-prove-the-memoryless" id="xca-prove-the-memoryless"></a>
Prove the memoryless property for exponential random variables. That is, for \(X\sim\mathsf{exp}(\mathtt{rate}=\lambda)\) show that for any \(s,t&gt;0\),
\[
\mathbb{P}(X>s+t\,|\, X>t)=\mathbb{P}(X>s).
\]
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-cha-Multivariable-Distributions" class="outline-2">
<h2 id="cha-Multivariable-Distributions"><a name="sec-7" id="sec-7"></a><span class="section-number-2">7</span> Multivariate Distributions</h2>
<div class="outline-text-2" id="text-cha-Multivariable-Distributions">




<p>
We have built up quite a catalogue of distributions, discrete and continuous. They were all univariate, however, meaning that we only considered one random variable at a time. We can imagine nevertheless many random variables associated with a single person: their height, their weight, their wrist circumference (all continuous), or their eye/hair color, shoe size, whether they are right handed, left handed, or ambidextrous (all categorical), and we can even surmise reasonable probability distributions to associate with each of these variables.
</p>
<p>
But there is a difference: for a single person, these variables are related. For instance, a person's height betrays a lot of information about that person's weight.
</p>
<p>
The concept we are hinting at is the notion of <i>dependence</i> between random variables. It is the focus of this chapter to study this concept in some detail. Along the way, we will pick up additional models to add to our catalogue. Moreover, we will study certain classes of dependence, and clarify the special case when there is no dependence, namely, independence.
</p>
<p>
The interested reader who would like to learn more about any of the below mentioned multivariate distributions should take a look at <i>Discrete Multivariate Distributions</i> by Johnson <i>et al</i>\cite{Johnson1997} or <i>Continuous Multivariate Distributions</i> \cite{Kotz2000} by Kotz <i>et al</i>.
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>the basic notion of dependence and how it is manifested with multiple variables (two, in particular)
</li>
<li>joint versus marginal distributions/expectation (discrete and continuous)
</li>
<li>some numeric measures of dependence
</li>
<li>conditional distributions, in the context of independence and exchangeability
</li>
<li>some details of at least one multivariate model (discrete and continuous)
</li>
<li>what it looks like when there are more than two random variables present
</li>
</ul>



</div>

<div id="outline-container-sec-Joint-Probability-Distributions" class="outline-3">
<h3 id="sec-Joint-Probability-Distributions"><a name="sec-7-1" id="sec-7-1"></a><span class="section-number-3">7.1</span> Joint and Marginal Probability Distributions</h3>
<div class="outline-text-3" id="text-sec-Joint-Probability-Distributions">


<p>
Consider two discrete random variables \(X\) and \(Y\) with PMFs \(f_{X}\) and \(f_{Y}\) that are supported on the sample spaces \(S_{X}\) and \(S_{Y}\), respectively. Let \(S_{X,Y}\) denote the set of all possible observed <i>pairs</i> \((x,y)\), called the <i>joint support set</i> of \(X\) and \(Y\). Then the <i>joint probability mass function</i> of \(X\) and \(Y\) is the function \(f_{X,Y}\) defined by
\begin{equation}
f_{X,Y}(x,y)=\mathbb{P}(X=x,\, Y=y),\quad \mbox{for }(x,y)\in S_{X,Y}.
\end{equation}
<a name="eq-joint-pmf" id="eq-joint-pmf"></a>
Every joint PMF satisfies
\begin{equation}
f_{X,Y}(x,y)>0\mbox{ for all }(x,y)\in S_{X,Y},
\end{equation}
and
\begin{equation}
\sum_{(x,y)\in S_{X,Y}}f_{X,Y}(x,y)=1.
\end{equation}
It is customary to extend the function \(f_{X,Y}\) to be defined on all of \(\mathbb{R}^{2}\) by setting \(f_{X,Y}(x,y)=0\) for \((x,y)\not\in S_{X,Y}\). 
</p>
<p>
In the context of this chapter, the PMFs \(f_{X}\) and \(f_{Y}\) are called the <i>marginal PMFs</i> of \(X\) and \(Y\), respectively. If we are given only the joint PMF then we may recover each of the marginal PMFs by using the Theorem of Total Probability (see Equation <a href="#eq-theorem-total-probability">TTP</a>): observe
\begin{eqnarray}
f_{X}(x) & = & \mathbb{P}(X=x),\\
 & = & \sum_{y\in S_{Y}}\mathbb{P}(X=x,\, Y=y),\\
 & = & \sum_{y\in S_{Y}}f_{X,Y}(x,y).
\end{eqnarray}
By interchanging the roles of \(X\) and \(Y\) it is clear that 
\begin{equation}
f_{Y}(y)=\sum_{x\in S_{Y}}f_{X,Y}(x,y).
\end{equation}
<a name="eq-marginal-pmf" id="eq-marginal-pmf"></a>
Given the joint PMF we may recover the marginal PMFs, but the converse is not true. Even if we have <i>both</i> marginal distributions they are not sufficient to determine the joint PMF; more information is needed
</p>
<p>
Associated with the joint PMF is the <i>joint cumulative distribution function</i> \(F_{X,Y}\) defined by
\[
F_{X,Y}(x,y)=\mathbb{P}(X\leq x,\, Y\leq y),\quad \mbox{for }(x,y)\in\mathbb{R}^{2}.
\]
The bivariate joint CDF is not quite as tractable as the univariate CDFs, but in principle we could calculate it by adding up quantities of the form in Equation <a href="#eq-joint-pmf">JPMF</a>. The joint CDF is typically not used in practice due to its inconvenient form; one can usually get by with the joint PMF alone.
</p>
<p>
We now introduce some examples of bivariate discrete distributions. The first we have seen before, and the second is based on the first.
</p>

<div class="exampletoo">
<p><a name="exa-toss-two-dice-joint-pmf" id="exa-toss-two-dice-joint-pmf"></a>
</p>
<p>
Roll a fair die twice. Let \(X\) be the face shown on the first roll, and let \(Y\) be the face shown on the second roll. We have already seen this example in Chapter <a href="#sec-4">Probability</a>, Example <a href="#exa-Toss-a-six-sided-die-twice">Toss die twice</a>. For this example, it suffices to define
\[
f_{X,Y}(x,y)=\frac{1}{36},\quad x=1,\ldots,6,\ y=1,\ldots,6.
\]
The marginal PMFs are given by \(f_{X}(x)=1/6\), \(x=1,2,\ldots,6\), and \(f_{Y}(y)=1/6\), \(y=1,2,\ldots,6\), since
\[
f_{X}(x)=\sum_{y=1}^{6}\frac{1}{36}=\frac{1}{6},\quad x=1,\ldots,6,
\]
and the same computation with the letters switched works for \(Y\). 
</p>
</div>

<p>
In the previous example, and in many other ones, the joint support can be written as a product set of the support of \(X\) ``times'' the support of \(Y\), that is, it may be represented as a cartesian product set, or rectangle, \(S_{X,Y}=S_{X}\times S_{Y}\), where \(S_{X} \times S_{Y}= \{ (x,y):\ x\in S_{X},\, y\in S_{Y} \} \). As we shall see presently in Section <a href="#sec-7-4">Independent Random Variables</a>, this form is a necessary condition for \(X\) and \(Y\) to be <i>independent</i> (or alternatively <i>exchangeable</i> when \(S_{X}=S_{Y}\)). But please note that in general it is not required for \(S_{X,Y}\) to be of rectangle form. We next investigate just such an example.
</p>


<div class="exampletoo">
<p><a name="exa-max-sum-two-dice" id="exa-max-sum-two-dice"></a>
</p>
<p>
Let the random experiment again be to roll a fair die twice, except now let us define the random variables \(U\) and \(V\) by
\begin{eqnarray*}
U & = & \mbox{the maximum of the two rolls, and }\\
V & = & \mbox{the sum of the two rolls.}
\end{eqnarray*}
We see that the support of \(U\) is \(S_{U}= \{ 1,2,\ldots,6 \} \) and the support of \(V\) is \(S_{V}= \{ 2,3,\ldots,12 \} \). We may represent the sample space with a matrix, and for each entry in the matrix we may calculate the value that \(U\) assumes. The result is in the left half of Table <a href="#tab-max-and-sum-two-dice">Max-sum two dice</a>. 
</p>
<p>
We can use the table to calculate the marginal PMF of \(U\), because from Example <a href="#exa-Toss-a-six-sided-die-twice">Toss die twice</a> we know that each entry in the matrix has probability \(1/36\) associated with it. For instance, there is only one outcome in the matrix with \(U=1\), namely, the top left corner. This single entry has probability \(1/36\), therefore, it must be that \(f_{U}(1)=\mathbb{P}(U=1)=1/36\). Similarly we see that there are three entries in the matrix with \(U=2\), thus \(f_{U}(2)=3/36\). Continuing in this fashion we will find the marginal distribution of \(U\) may be written
\begin{equation}
f_{U}(u)=\frac{2u-1}{36},\quad u=1,\,2,\ldots,6.
\end{equation}
We may do a similar thing for \(V\); see the right half of Table <a href="#tab-max-and-sum-two-dice">Max-sum two dice</a>. Collecting all of the probability we will find that the marginal PMF of \(V\) is
\begin{equation}
f_{V}(v)=\frac{6-|v-7|}{36},\quad v=2,\,3,\ldots,12.
\end{equation}



<pre class="src src-R">A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rolldie(2, makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> addrv(A, max, name = <span style="font-style: italic;">"U"</span>)
A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> addrv(A, sum, name = <span style="font-style: italic;">"V"</span>, invars = c(<span style="font-style: italic;">"X1"</span>, <span style="font-style: italic;">"X2"</span>))
p1 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(A, aes(x=X1, y=X2, label=U))
p1 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> p1 + geom_text(size = 6) + xlab(<span style="font-style: italic;">"X1 = First roll"</span>) + 
      ylab(<span style="font-style: italic;">"X2 = Second roll"</span>) + opts(title = <span style="font-style: italic;">"U = max(X1,X2)"</span>)
p2 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(A, aes(x=X1, y=X2, label=V))
p2 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> p2 + geom_text(size = 6) + xlab(<span style="font-style: italic;">"X1 = First roll"</span>) + 
      ylab(<span style="font-style: italic;">""</span>) + opts(title = <span style="font-style: italic;">"V = X1 + X2"</span>)
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))
<span style="font-weight: bold;">vplayout</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x, y) viewport(layout.pos.row = x, layout.pos.col = y)
print(p1, vp = vplayout(1, 1))
print(p2, vp = vplayout(1, 2))
</pre>



<pre class="src src-R">  &lt;&lt;max-and-sum-two-dice&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;max-and-sum-two-dice&gt;&gt;
</pre>



<div id="fig-max-and-sum-two-dice" class="figure">
  <p><img src="svg/multdist/max-and-sum-two-dice.svg" width=500 alt="svg/multdist/max-and-sum-two-dice.svg" /></p>
  <p>Rolling two dice. The value of U is the maximum of the two rolls, while the value of V is the sum of the two rolls.</p>
</div>

We may collapse the two matrices from Figure <a href="#fig-max-and-sum-two-dice">max-and-sum-two-dice</a> into one, big matrix of pairs of values \((u,v)\). The result is shown in Table <a href="#fig-max-sum-two-dice-joint">max-sum-two-dice-joint</a>. 
</p>




<pre class="src src-R">labs <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> with(A, paste(<span style="font-style: italic;">"("</span>, U, <span style="font-style: italic;">","</span>, V, <span style="font-style: italic;">")"</span>, sep = <span style="font-style: italic;">""</span>))
p3 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(A, aes(x = X1, y = X2, label = labs))
p3 + geom_text(size = 6) + xlab(<span style="font-style: italic;">"First roll"</span>) + ylab(<span style="font-style: italic;">"Second roll"</span>) + 
  opts(title = <span style="font-style: italic;">"Joint distribution of (U,V) pairs"</span>)
</pre>



<pre class="src src-R">  &lt;&lt;max-sum-two-dice-joint&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;max-sum-two-dice-joint&gt;&gt;
</pre>



<div id="fig-max-sum-two-dice-joint" class="figure">
  <p><img src="svg/multdist/max-sum-two-dice-joint.svg" width=500 alt="svg/multdist/max-sum-two-dice-joint.svg" /></p>
  <p>Rolling two dice. Joint values of U and V are shown as pairs, for each outcome in the sample space.</p>
</div>

<p>
Again, each of these pairs has probability \(1/36\) associated with it and we are looking at the joint PDF of \((U,V)\) albeit in an unusual form. Many of the pairs are repeated, but some of them are not: \((1,2)\) appears twice, but \((2,3)\) appears only once. We can make more sense out of this by writing a new table with \(U\) on one side and \(V\) along the top. We will accumulate the probability just like we did in Example <a href="#exa-toss-two-dice-joint-pmf">Two dice joint</a>. See Table <a href="#tab-max-sum-joint-pmf">Max-sum joint</a>.
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-max-sum-joint-pmf">
<caption>The outcomes of \(U\) are along the left and the outcomes of \(V\) are along the top. Empty entries in the table have zero probability. The row totals (on the right) and column totals (on the bottom) correspond to the marginal distribution of \(U\) and \(V\), respectively.</caption>
<colgroup><col class="right" /></colgroup>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /><col class="left" /></colgroup>
<colgroup><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="right"></th><th scope="col" class="left">2</th><th scope="col" class="left">3</th><th scope="col" class="left">4</th><th scope="col" class="left">5</th><th scope="col" class="left">6</th><th scope="col" class="left">7</th><th scope="col" class="left">8</th><th scope="col" class="left">9</th><th scope="col" class="left">10</th><th scope="col" class="left">11</th><th scope="col" class="left">12</th><th scope="col" class="left">Total</th></tr>
</thead>
<tbody>
<tr><td class="right">1</td><td class="left">\(\frac{1}{36}\)</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left">\(\frac{1}{36}\)</td></tr>
<tr><td class="right">2</td><td class="left"></td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{1}{36}\)</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left">\(\frac{3}{36}\)</td></tr>
<tr><td class="right">3</td><td class="left"></td><td class="left"></td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{1}{36}\)</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left">\(\frac{5}{36}\)</td></tr>
<tr><td class="right">4</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{1}{36}\)</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left">\(\frac{7}{36}\)</td></tr>
<tr><td class="right">5</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{1}{36}\)</td><td class="left"></td><td class="left"></td><td class="left">\(\frac{9}{36}\)</td></tr>
<tr><td class="right">6</td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left"></td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{1}{36}\)</td><td class="left">\(\frac{11}{36}\)</td></tr>
</tbody>
<tbody>
<tr><td class="right">Total</td><td class="left">\(\frac{1}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{3}{36}\)</td><td class="left">\(\frac{4}{36}\)</td><td class="left">\(\frac{5}{36}\)</td><td class="left">\(\frac{6}{36}\)</td><td class="left">\(\frac{5}{36}\)</td><td class="left">\(\frac{4}{36}\)</td><td class="left">\(\frac{3}{36}\)</td><td class="left">\(\frac{2}{36}\)</td><td class="left">\(\frac{1}{36}\)</td><td class="left">1</td></tr>
</tbody>
</table>


<p>
The joint support of \((U,V)\) is concentrated along the main diagonal;  note that the nonzero entries do not form a rectangle. Also notice that if we form row and column totals we are doing exactly the same thing as Equation <a href="#eq-marginal-pmf">eq-marginal-pmf</a>, so that the marginal distribution of \(U\) is the list of totals in the right ``margin'' of the Table <a href="#tab-max-sum-joint-pmf">Max-sum joint</a>, and the marginal distribution of \(V\)  is the list of totals in the bottom ``margin''. 
</p>
</div>

<p>
Continuing the reasoning for the discrete case, given two continuous random variables \(X\) and \(Y\) there similarly exists
a function \(f_{X,Y}(x,y)\) associated with \(X\) and \(Y\) called the <i>joint probability density function</i> of \(X\) and \(Y\). Every joint PDF satisfies
\begin{equation}
f_{X,Y}(x,y)\geq0\mbox{ for all }(x,y)\in S_{X,Y},
\end{equation}
and
\begin{equation}
\iintop_{S_{X,Y}}f_{X,Y}(x,y)\,\mathrm{d} x\,\mathrm{d} y=1.
\end{equation}
In the continuous case there is not such a simple interpretation for the joint PDF; however, we do have one for the joint CDF, namely,
\[
F_{X,Y}(x,y)=\mathbb{P}(X\leq x,\, Y\leq y)=\int_{-\infty}^{x}\int_{-\infty}^{y}f_{X,Y}(u,v)\,\mathrm{d} v\,\mathrm{d} u,
\]
for \((x,y)\in\mathbb{R}^{2}\). If \(X\) and \(Y\) have the joint PDF \(f_{X,Y}\), then the marginal density of \(X\) may be recovered by
\begin{equation}
f_{X}(x)=\int_{S_{Y}}f_{X,Y}(x,y)\,\mathrm{d} y,\quad x \in S_{X}
\end{equation}
and the marginal PDF of \(Y\) may be found with
\begin{equation}
f_{Y}(y)=\int_{S_{X}}f_{X,Y}(x,y)\,\mathrm{d} x, \quad y \in S_{Y}.
\end{equation}


</p>
<div class="exampletoo">
<p><a name="exa-joint-pdf" id="exa-joint-pdf"></a>
Let the joint PDF of \((X,Y)\) be given by
\[
f_{X,Y}(x,y)=\frac{6}{5}\left(x+y^{2}\right),\quad 0 < x < 1,\ 0 < y < 1.
\]
The marginal PDF of \(X\) is
\begin{eqnarray*}
f_{X}(x) & = & \int_{0}^{1}\frac{6}{5}\left(x+y^{2}\right)\,\mathrm{d} y,\\
 & = & \left.\frac{6}{5}\left(xy+\frac{y^{3}}{3}\right)\right|_{y=0}^{1},\\
 & = & \frac{6}{5}\left(x+\frac{1}{3}\right),
\end{eqnarray*}
for \(0 &lt; x &lt; 1\), and the marginal PDF of \(Y\) is
\begin{eqnarray*}
f_{Y}(y) & = & \int_{0}^{1}\frac{6}{5}\left(x+y^{2}\right)\,\mathrm{d} x,\\
 & = & \left.\frac{6}{5}\left(\frac{x^{2}}{2}+xy^{2}\right)\right|_{x=0}^{1},\\
 & = & \frac{6}{5}\left(\frac{1}{2}+y^{2}\right),
\end{eqnarray*}
for \(0 &lt; y &lt; 1\). In this example the joint support set was a rectangle \([0,1]\times[0,1]\), but it turns out that \(X\) and \(Y\) are not independent. See Section <a href="#sec-7-4">Independent Random Variables</a>.
</p>
</div>


</div>

<div id="outline-container-7-1-1" class="outline-4">
<h4 id="sec-7-1-1"><span class="section-number-4">7.1.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-7-1-1">


<p>
We will show how to do Example <a href="#exa-max-sum-two-dice">Max-sum two dice</a> using \(\mathsf{R}\); it is much simpler to do it with \(\mathsf{R}\) than without. First we set up the sample space with the <code>rolldie</code> function. Next, we add random variables \(U\) and \(V\) with the <code>addrv</code> function. We take a look at the very top of the data frame (probability space) to make sure that everything is operating according to plan.
</p>



<pre class="src src-R">S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rolldie(2, makespace = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> addrv(S, FUN = max, invars = c(<span style="font-style: italic;">"X1"</span>,<span style="font-style: italic;">"X2"</span>), name = <span style="font-style: italic;">"U"</span>)
S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> addrv(S, FUN = sum, invars = c(<span style="font-style: italic;">"X1"</span>,<span style="font-style: italic;">"X2"</span>), name = <span style="font-style: italic;">"V"</span>)
head(S)
</pre>


<pre class="example">
  X1 X2 U V      probs
1  1  1 1 2 0.02777778
2  2  1 2 3 0.02777778
3  3  1 3 4 0.02777778
4  4  1 4 5 0.02777778
5  5  1 5 6 0.02777778
6  6  1 6 7 0.02777778
</pre>


<p>
Yes, the \(U\) and \(V\) columns have been added to the data frame and have been computed correctly. This result would be fine as it is, but the data frame has too many rows: there are repeated pairs \((u,v)\) which show up as repeated rows in the data frame. The goal is to aggregate the rows of \(S\) such that the result has exactly one row for each unique pair \((u,v)\) with positive probability. This sort of thing is exactly the task for which the <code>marginal</code> function was designed. We may take a look at the joint distribution of \(U\) and \(V\) (we only show the first few rows of the data frame, but the complete one has 11 rows).
</p>



<pre class="src src-R">UV <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> marginal(S, vars = c(<span style="font-style: italic;">"U"</span>, <span style="font-style: italic;">"V"</span>))
head(UV)
</pre>


<pre class="example">
  U V      probs
1 1 2 0.02777778
2 2 3 0.05555556
3 2 4 0.02777778
4 3 4 0.05555556
5 3 5 0.05555556
6 4 5 0.05555556
</pre>


<p>
The data frame is difficult to understand. It would be better to have a tabular display like Table <a href="#tab-max-sum-joint-pmf">max-sum-joint-pmf</a>. We can do that with the <code>xtabs</code> function. 
</p>



<pre class="src src-R">xtabs(round(probs,3) ~ U + V, data = UV)
</pre>



<pre class="example">   V
U       2     3     4     5     6     7     8     9    10
  1 0.028 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000
  2 0.000 0.056 0.028 0.000 0.000 0.000 0.000 0.000 0.000
  3 0.000 0.000 0.056 0.056 0.028 0.000 0.000 0.000 0.000
  4 0.000 0.000 0.000 0.056 0.056 0.056 0.028 0.000 0.000
  5 0.000 0.000 0.000 0.000 0.056 0.056 0.056 0.056 0.028
  6 0.000 0.000 0.000 0.000 0.000 0.056 0.056 0.056 0.056
   V
U      11    12
  1 0.000 0.000
  2 0.000 0.000
  3 0.000 0.000
  4 0.000 0.000
  5 0.000 0.000
  6 0.056 0.028
</pre>


<p>
Compare these values to the ones shown in Table <a href="#tab-max-sum-joint-pmf">max-sum-joint-pmf</a>. We can repeat the process with <code>marginal</code> to get the univariate marginal distributions of \(U\) and \(V\) separately.
</p>



<pre class="src src-R">marginal(UV, vars = <span style="font-style: italic;">"U"</span>)
head(marginal(UV, vars = <span style="font-style: italic;">"V"</span>))
</pre>



<pre class="example">  U      probs
1 1 0.02777778
2 2 0.08333333
3 3 0.13888889
4 4 0.19444444
5 5 0.25000000
6 6 0.30555556
  V      probs
1 2 0.02777778
2 3 0.05555556
3 4 0.08333333
4 5 0.11111111
5 6 0.13888889
6 7 0.16666667
</pre>


<p>
Another way to do the same thing is with the <code>rowSums</code> and <code>colSums</code> of the <code>xtabs</code> object. Compare
</p>



<pre class="src src-R">temp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> xtabs(probs ~ U + V, data = UV)
rowSums(temp)
colSums(temp)
</pre>



<pre class="example">         1          2          3          4          5 
0.02777778 0.08333333 0.13888889 0.19444444 0.25000000 
         6 
0.30555556
         2          3          4          5          6 
0.02777778 0.05555556 0.08333333 0.11111111 0.13888889 
         7          8          9         10         11 
0.16666667 0.13888889 0.11111111 0.08333333 0.05555556 
        12 
0.02777778
</pre>


<p>
You should check that the answers that we have obtained exactly match the same (somewhat laborious) calculations that we completed in Example <a href="#exa-max-sum-two-dice">Max-sum two dice</a>.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Joint-and-Marginal-Expectation" class="outline-3">
<h3 id="sec-Joint-and-Marginal-Expectation"><a name="sec-7-2" id="sec-7-2"></a><span class="section-number-3">7.2</span> Joint and Marginal Expectation</h3>
<div class="outline-text-3" id="text-sec-Joint-and-Marginal-Expectation">


<p>
Given a function \(g\) with arguments \((x,y)\) we would like to know the long-run average behavior of \(g(X,Y)\) and how to mathematically calculate it. Expectation in this context is computed in the pedestrian way. We simply integrate (sum) with respect to the joint probability density (mass) function.
\begin{equation}
\mathbb{E}\, g(X,Y)=\iintop_{S_{X,Y}}g(x,y)\, f_{X,Y}(x,y)\,\mathrm{d} x\,\mathrm{d} y,
\end{equation}
or in the discrete case,
\begin{equation}
\mathbb{E}\, g(X,Y)=\mathop{\sum\sum}\limits _{(x,y)\in S_{X,Y}}g(x,y)\, f_{X,Y}(x,y).
\end{equation}

</p>
</div>

<div id="outline-container-7-2-1" class="outline-4">
<h4 id="sec-7-2-1"><span class="section-number-4">7.2.1</span> Covariance and Correlation</h4>
<div class="outline-text-4" id="text-7-2-1">


<p>
There are two very special cases of joint expectation: the <i>covariance</i> and the <i>correlation</i>. These are measures which help us quantify the dependence between \(X\) and \(Y\). 
</p>

<div class="defn">
<p>The <i>covariance</i> of \(X\) and \(Y\) is
\begin{equation}
\mbox{Cov}(X,Y)=\mathbb{E}(X-\mathbb{E} X)(Y-\mathbb{E} Y).
\end{equation}
</p>
</div>

<p>
By the way, there is a shortcut formula for covariance which is almost as handy as the shortcut for the variance:
\begin{equation}
\mbox{Cov}(X,Y)=\mathbb{E}(XY)-(\mathbb{E} X)(\mathbb{E} Y).
\end{equation}
The proof is left to Exercise <a href="#xca-Prove-cov-shortcut">Prove Covariance Shortcut</a>.
</p>
<p>
The Pearson product moment correlation between \(X\) and \(Y\) is the covariance between \(X\) and \(Y\) rescaled to fall in the interval \([-1,1]\). It is formally defined by 
\begin{equation}
\mbox{Corr}(X,Y)=\frac{\mbox{Cov}(X,Y)}{\sigma_{X}\sigma_{Y}}.
\end{equation}

The correlation is usually denoted by \(\rho_{X,Y}\) or simply \(\rho\) if the random variables are clear from context. There are some important facts about the correlation coefficient: 
</p><ol>
<li>The range of correlation is \(-1\leq\rho_{X,Y}\leq1\).
</li>
<li>Equality holds above (\(\rho_{X,Y}=\pm1\)) if and only if \(Y\) is a linear function of \(X\) with probability one.
</li>
</ol>



<div class="exampletoo">
<p><a name="exa-max-sum-dice-covariance" id="exa-max-sum-dice-covariance"></a>
</p>
<p>
We will compute the covariance for the discrete distribution in Example <a href="#exa-max-sum-two-dice">Max-sum two dice</a>. The expected value of \(U\) is
\[
\mathbb{E} U=\sum_{u=1}^{6}u\, f_{U}(u)=\sum_{u=1}^{6}u\,\frac{2u-1}{36}=1\left(\frac{1}{36}\right)+2\left(\frac{3}{36}\right)+\cdots+6\left(\frac{11}{36}\right)=\frac{161}{36},
\]
and the expected value of \(V\) is
\[
\mathbb{E} V=\sum_{v=2}^{12}v\,\frac{6-|7-v|}{36}=2\left(\frac{1}{36}\right)+3\left(\frac{2}{36}\right)+\cdots+12\left(\frac{1}{36}\right)=7,
\]
and the expected value of \(UV\) is
\[
\mathbb{E} UV=\sum_{u=1}^{6}\sum_{v=2}^{12}uv\, f_{U,V}(u,v)=1\cdot2\left(\frac{1}{36}\right)+2\cdot3\left(\frac{2}{36}\right)+\cdots+6\cdot12\left(\frac{1}{36}\right)=\frac{308}{9}.
\]
Therefore the covariance of \((U,V)\) is
\[
\mbox{Cov}(U,V)=\mathbb{E} UV-\left(\mathbb{E} U\right)\left(\mathbb{E} V\right)=\frac{308}{9}-\frac{161}{36}\cdot7=\frac{35}{12}.
\]
All we need now are the standard deviations of \(U\) and \(V\) to calculate the correlation coefficient (omitted).
</p>
</div>

<p>
We will do a continuous example so that you can see how it works.
</p>

<div class="exampletoo">

<p>
Let us find the covariance of the variables \((X,Y)\) from Example <a href="#exa-joint-pdf">exa-joint-pdf</a>. The expected value of \(X\) is
\[
\mathbb{E} X=\int_{0}^{1}x\cdot\frac{6}{5}\left(x+\frac{1}{3}\right)\mathrm{d} x=\left.\frac{2}{5}x^{3}+\frac{1}{5}x^{2}\right|_{x=0}^{1}=\frac{3}{5},
\]
and the expected value of \(Y\) is
\[
\mathbb{E} Y=\int_{0}^{1}y\cdot\frac{6}{5}\left(\frac{1}{2}+y^{2}\right)\mathrm{d} x=\left.\frac{3}{10}y^{2}+\frac{3}{20}y^{4}\right|_{y=0}^{1}=\frac{9}{20}.
\]
Finally, the expected value of \(XY\) is
\begin{eqnarray*}
\mathbb{E} XY & = & \int_{0}^{1}\int_{0}^{1}xy\,\frac{6}{5}\left(x+y^{2}\right)\mathrm{d} x\,\mathrm{d} y,\\
 & = & \int_{0}^{1}\left.\left(\frac{2}{5}x^{3}y+\frac{3}{10}xy^{4}\right)\right|_{x=0}^{1}\mathrm{d} y,\\
 & = & \int_{0}^{1}\left(\frac{2}{5}y+\frac{3}{10}y^{4}\right)\mathrm{d} y,\\
 & = & \frac{1}{5}+\frac{3}{50},
\end{eqnarray*}
which is 13/50. Therefore the covariance of \((X,Y)\) is
\[
\mbox{Cov}(X,Y)=\frac{13}{50}-\left(\frac{3}{5}\right)\left(\frac{9}{20}\right)=-\frac{1}{100}.
\]
</p>
</div>


</div>

<div id="outline-container-7-2-1-1" class="outline-5">
<h5 id="sec-7-2-1-1"><span class="section-number-5">7.2.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-7-2-1-1">


<p>
There are not any specific functions in the <code>prob</code> package designed for multivariate expectation. This is not a problem, though, because it is easy enough to do expectation the long way &ndash; with column operations. We just need to keep the definition in mind. For instance, we may compute the covariance of \((U,V)\) from Example <a href="#exa-max-sum-dice-covariance">Max-sum covariance</a>.
</p>



<pre class="src src-R">Eu <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sum(S$U*S$probs)
Ev <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sum(S$V*S$probs)
Euv <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sum(S$U*S$V*S$probs)
Euv - Eu * Ev
</pre>


<pre class="example">
[1] 2.916667
</pre>


<p>
Compare this answer to what we got in Example <a href="#exa-max-sum-dice-covariance">Max-sum covariance</a>.
</p>
<p>
To do the continuous case we could use the computer algebra utilities of <code>Yacas</code> and the associated \(\mathsf{R}\) package <code>Ryacas</code> \cite{ryacas}. See Section <a href="#sec-7-7-1">Bivariate Trans with R</a> for another example where the <code>Ryacas</code> package appears.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Conditional-Distributions" class="outline-3">
<h3 id="sec-Conditional-Distributions"><a name="sec-7-3" id="sec-7-3"></a><span class="section-number-3">7.3</span> Conditional Distributions</h3>
<div class="outline-text-3" id="text-sec-Conditional-Distributions">


<p>
If \(x\in S_{X}\) is such that \(f_{X}(x)&gt;0\), then we define the <i>conditional density</i> of \(Y|\, X=x\), denoted \(f_{Y|x}\), by 
\begin{equation}
f_{Y|x}(y|x)=\frac{f_{X,Y}(x,y)}{f_{X}(x)},\quad y\in S_{Y}.
\end{equation}
We define \(f_{X|y}\) in a similar fashion.
</p>

<div class="exampletoo">
<p>Let the joint PMF of \(X\) and \(Y\) be given by
\[
f_{X,Y}(x,y) =
\]
</p>
</div>


</div>

<div id="outline-container-7-3-1" class="outline-4">
<h4 id="sec-7-3-1"><span class="section-number-4">7.3.1</span> Bayesian Connection</h4>
<div class="outline-text-4" id="text-7-3-1">


<p>
Conditional distributions play a fundamental role in Bayesian probability and statistics. There is a parameter \(\theta\) which is of primary interest, and about which we would like to learn. But rather than observing \(\theta\) directly, we instead observe a random variable \(X\) whose probability distribution depends on \(\theta\). Using the information we provided by \(X,\) we would like to update the information that we have about \(\theta\).
</p>
<p>
Our initial beliefs about \(\theta\) are represented by a probability distribution, called the <i>prior distribution</i>, denoted by \(\pi\). The PDF \(f_{X|\theta}\) is called the <i>likelihood function</i>, also called the <i>likelihood of</i> \(X\) <i>conditional on</i> \(\theta\). Given an observation \(X=x\), we would like to update our beliefs \(\pi\) to a new distribution, called the <i>posterior distribution of</i> \(\theta\) <i>given the observation</i> \(X=x\), denoted \(\pi_{\theta|x}\). It may seem a mystery how to obtain \(\pi_{\theta|x}\) based only on the information provided by \(\pi\) and \(f_{X|\theta}\), but it should not be. We have already studied this in Section <a href="#sec-Bayes--Rule">Bayes' Rule</a> where it was called Bayes' Rule:
\begin{equation} 
\pi(\theta|x)=\frac{\pi(\theta)\, f(x|\theta)}{\int\pi(u)\, f(x|u)\mathrm{d} u}.
\end{equation} 
Compare the above expression to Equation <a href="#eq-bayes-rule">BR</a>.
</p>

<div class="exampletoo">
<p>Suppose the parameter \(\theta\) is the \(\mathbb{P}(\mbox{Heads})\) for a biased coin. It could be any value from 0 to 1. Perhaps we have some prior information about this coin, for example, maybe we have seen this coin before and we have reason to believe that it shows Heads less than half of the time. Suppose that we represent our beliefs about \(\theta\) with a \(\mathsf{beta}(\mathtt{shape1}=1,\,\mathtt{shape2}=3)\) prior distribution, that is, we assume 
\[
\theta\sim\pi(\theta)=3(1-\theta)^{2},\quad 0 < \theta < 1.
\]
To learn more about \(\theta\), we will do what is natural: flip the coin. We will observe a random variable \(X\) which takes the value \(1\) if the coin shows Heads, and 0 if the coin shows Tails. Under these circumstances, \(X\) will have a Bernoulli distribution, and in particular, \(X|\theta\sim\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=\theta)\):
\[ 
f_{X|\theta}(x|\theta)=\theta^{x}(1-\theta)^{1-x},\quad x=0,1.
\]
Based on the observation \(X=x\), we will update the prior distribution to the posterior distribution, and we will do so with Bayes' Rule: it says
\begin{eqnarray*}
\pi(\theta|x) & \propto & \pi(\theta)\, f(x|\theta),\\
 & = & \theta^{x}(1-\theta)^{1-x}\cdot3(1-\theta)^{2},\\
 & = & 3\,\theta^{x}(1-\theta)^{3-x},\quad 0 < \theta < 1,
\end{eqnarray*}
where the constant of proportionality is given by
\[
\int3\, u^{x}(1-u)^{3-x}\mathrm{d} u=\int3\, u^{(1+x)-1}(1-u)^{(4-x)-1}\mathrm{d} u=3\,\frac{\Gamma(1+x)\Gamma(4-x)}{\Gamma[(1+x)+(4-x)]},
\]
the integral being calculated by inspection of the formula for a \(\mathsf{beta}(\mathtt{shape1}=1+x,\,\mathtt{shape2}=4-x)\) distribution. That is to say, our posterior distribution is precisely
\[
\theta|x\sim\mathsf{beta}(\mathtt{shape1}=1+x,\,\mathtt{shape2}=4-x).
\]
The Bayesian statistician uses the posterior distribution for all matters concerning inference about \(\theta\).
</p>

</div>


<div class="rem">
<p>We usually do not restrict ourselves to the observation of only one \(X\) conditional on \(\theta\). In fact, it is common to observe an entire sample \(X_{1}\), \(X_{2}\),&hellip;,\(X_{n}\) conditional on \(\theta\) (which itself is often multidimensional). Do not be frightened, however, because the intuition is the same. There is a prior distribution \(\pi(\theta)\), a likelihood \(f(x_{1},x_{2},\ldots,x_{n}|\theta)\), and a posterior distribution \(\pi(\theta|x_{1},x_{2},\ldots,x_{n})\). Bayes' Rule states that the relationship between the three is
\[
\pi(\theta|x_{1},x_{2},\ldots,x_{n})\propto\pi(\theta)\, f(x_{1},x_{2},\ldots,x_{n}|\theta),
\]
where the constant of proportionality is \(\int\pi(u)\, f(x_{1},x_{2},\ldots,x_{n}|u)\,\mathrm{d} u\). Any good textbook on Bayesian Statistics will explain these notions in detail; to the interested reader I recommend Gelman \cite{Gelman2004} or Lee \cite{Lee1997}.
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sec-Independent-Random-Variables" class="outline-3">
<h3 id="sec-Independent-Random-Variables"><a name="sec-7-4" id="sec-7-4"></a><span class="section-number-3">7.4</span> Independent Random Variables</h3>
<div class="outline-text-3" id="text-sec-Independent-Random-Variables">



</div>

<div id="outline-container-sub-Independent-Random-Variables" class="outline-4">
<h4 id="sub-Independent-Random-Variables"><a name="sec-7-4-1" id="sec-7-4-1"></a><span class="section-number-4">7.4.1</span> Independent Random Variables</h4>
<div class="outline-text-4" id="text-sub-Independent-Random-Variables">


<p>
We recall from Chapter <a href="#sec-4">Probability</a> that the events \(A\) and \(B\) are said to be independent when
\begin{equation}
\mathbb{P}(A\cap B)=\mathbb{P}(A)\mathbb{P}(B).
\end{equation}
If it happens that
\begin{equation}
\mathbb{P}(X=x,Y=y)=\mathbb{P}(X=x)\mathbb{P}(Y=y),\quad \mbox{for every }x\in S_{X},\ y\in S_{Y},
\end{equation}
then we say that \(X\) and \(Y\) are <i>independent random variables</i>. Otherwise, we say that \(X\) and \(Y\) are <i>dependent</i>. Using the PMF notation from above, we see that independent discrete random variables satisfy
\begin{equation}
f_{X,Y}(x,y)=f_{X}(x)f_{Y}(y)\quad \mbox{for every }x\in S_{X},\ y\in S_{Y}.
\end{equation}
Continuing the reasoning, given two continuous random variables \(X\) and \(Y\) with joint PDF \(f_{X,Y}\) and respective marginal PDFs \(f_{X}\) and \(f_{Y}\) that are supported on the sets \(S_{X}\) and \(S_{Y}\), if it happens that
\begin{equation}
f_{X,Y}(x,y)=f_{X}(x)f_{Y}(y)\quad \mbox{for every }x\in S_{X},\ y\in S_{Y},
\end{equation}
then we say that \(X\) and \(Y\) are independent.
</p>

<div class="exampletoo">
<p>In Example <a href="#exa-toss-two-dice-joint-pmf">Toss two dice joint</a> we considered the random experiment of rolling a fair die twice. There we found the joint PMF to be
\[
f_{X,Y}(x,y)=\frac{1}{36},\quad x=1,\ldots,6,\ y=1,\ldots,6,
\]
and we found the marginal PMFs \(f_{X}(x)=1/6\), \(x=1,2,\ldots,6\), and \(f_{Y}(y)=1/6\), \(y=1,2,\ldots,6\). Therefore in this experiment \(X\) and \(Y\) are independent since for every \(x\) and \(y\) in the joint support the joint PMF satisfies
\[
f_{X,Y}(x,y)=\frac{1}{36}=\left(\frac{1}{6}\right)\left(\frac{1}{6}\right)=f_{X}(x)\, f_{Y}(y).
\]
</p>
</div>


<div class="exampletoo">
<p>In Example <a href="#exa-max-sum-two-dice">Max-sum two dice</a> we considered the same experiment but different random variables \(U\) and \(V\). We can prove that \(U\) and \(V\) are not independent if we can find a single pair \((u,v)\) where the independence equality does not hold. There are many such pairs. One of them is \((6,12)\):
\[
f_{U,V}(6,12)=\frac{1}{36}\neq\left(\frac{11}{36}\right)\left(\frac{1}{36}\right)=f_{U}(6)\, f_{V}(12).
\]
</p>
</div>

<p>
Independent random variables are very useful to the mathematician. They have many, many, tractable properties. We mention some of the more important ones.
</p>

<div class="prop">
<p><a name="pro-indep-implies-prodexpect" id="pro-indep-implies-prodexpect"></a>
If \(X\) and \(Y\) are independent, then for any functions \(u\) and \(v\), 
\begin{equation}
\mathbb{E}\left(u(X)v(Y)\right)=\left(\mathbb{E} u(X)\right)\left(\mathbb{E} v(Y)\right).
\end{equation}
</p>
</div>


<div class="proof">
<p>This is straightforward from the definition.
\begin{eqnarray*}
\mathbb{E}\left(u(X)v(Y)\right) & = & \iint\, u(x)v(y)\, f_{X,Y}(x,y)\,\mathrm{d} x\mathrm{d} y\\
 & = & \iint\, u(x)v(y)\, f_{X}(x)\, f_{Y}(y)\,\mathrm{d} x\mathrm{d} y\\
 & = & \int u(x)\, f_{X}(x)\,\mathrm{d} x\ \int v(y)\, f_{Y}(y)\,\mathrm{d} y
\end{eqnarray*}
and this last quantity is exactly \(\left(\mathbb{E} u(X)\right)\left(\mathbb{E} v(Y)\right)\). 
</p>
</div>

<p>
Now that we have Proposition <a href="#pro-indep-implies-prodexpect">pro-indep-implies-prodexpect</a> we mention a corollary that will help us later to quickly identify those random variables which are <i>not</i> independent.
</p>

<div class="cor">
<p><a name="cor-indep-implies-uncorr" id="cor-indep-implies-uncorr"></a>
If \(X\) and \(Y\) are independent, then \(\mbox{Cov}(X,Y)=0\), and consequently,
\(\mbox{Corr}(X,Y)=0\).
</p>
</div>


<div class="proof">
<p>When \(X\) and \(Y\) are independent then \(\mathbb{E} XY=\mathbb{E} X\,\mathbb{E} Y\). And when the covariance is zero the numerator of the correlation is 0.
</p>
</div>


<div class="rem">
<p><a name="rem-cov0-not-imply-indep" id="rem-cov0-not-imply-indep"></a>
Unfortunately, the converse of Corollary <a href="#cor-indep-implies-uncorr">cor-indep-implies-uncorr</a> is not true. That is, there are many random variables which are dependent yet their covariance and correlation is zero. For more details, see Casella and Berger \cite{Casella2002}.
</p>
</div>

<p>
Proposition <a href="#pro-indep-implies-prodexpect">pro-indep-implies-prodexpect</a> is useful to us and we will receive mileage out of it, but there is another fact which will play an even more important role. Unfortunately, the proof is beyond the techniques presented here. The inquisitive reader should consult Casella and Berger \cite{Casella2002}, Resnick \cite{Resnick1999}, <i>etc</i>.
</p>

<div class="fact">
<p><a name="fac-indep-then-function-indep" id="fac-indep-then-function-indep"></a>
If \(X\) and \(Y\) are independent, then \(u(X)\) and \(v(Y)\) are independent for any functions \(u\) and \(v\).
</p>
</div>

</div>

</div>

<div id="outline-container-sub-Combining-Independent-Random" class="outline-4">
<h4 id="sub-Combining-Independent-Random"><a name="sec-7-4-2" id="sec-7-4-2"></a><span class="section-number-4">7.4.2</span> Combining Independent Random Variables</h4>
<div class="outline-text-4" id="text-sub-Combining-Independent-Random">


<p>
Another important corollary of Proposition <a href="#pro-indep-implies-prodexpect">pro-indep-implies-prodexpect</a> will allow us to find the distribution of sums of random variables. 
</p>

<div class="cor">
<p>If \(X\) and \(Y\) are independent, then the moment generating function of \(X+Y\) is 
\begin{equation}
M_{X+Y}(t)=M_{X}(t)\cdot M_{Y}(t).
\end{equation}
</p>
</div>


<div class="proof">
<p>Choose \(u(x)=\mathrm{e}^{x}\) and \(v(y)=\mathrm{e}^{y}\) in Proposition <a href="#pro-indep-implies-prodexpect">pro-indep-implies-prodexpect</a>, and remember the identity \(\mathrm{e}^{t(x+y)}=\mathrm{e}^{tx}\,\mathrm{e}^{ty}\).
</p>
</div>

<p>
Let us take a look at some examples of the corollary in action.
</p>

<div class="exampletoo">
<p>Let \(X\sim\mathsf{binom}(\mathtt{size}=n_{1},\,\mathtt{prob}=p)\) and \(Y\sim\mathsf{binom}(\mathtt{size}=n_{2},\,\mathtt{prob}=p)\) be independent. Then \(X+Y\) has MGF
\[
M_{X+Y}(t)=M_{X}(t)\, M_{Y}(t)=\left(q+p\mathrm{e}^{t}\right)^{n_{1}}\left(q+p\mathrm{e}^{t}\right)^{n_{2}}=\left(q+p\mathrm{e}^{t}\right)^{n_{1}+n_{2}},
\]
which is the MGF of a \(\mathsf{binom}(\mathtt{size}=n_{1}+n_{2},\,\mathtt{prob}=p)\) distribution. Therefore, \(X+Y\sim\mathsf{binom}(\mathtt{size}=n_{1}+n_{2},\,\mathtt{prob}=p)\).
</p>
</div>


<div class="exampletoo">
<p>Let \(X\sim\mathsf{norm}(\mathtt{mean}=\mu_{1},\,\mathtt{sd}=\sigma_{1})\) and \(Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{2},\,\mathtt{sd}=\sigma_{2})\) be independent. Then \(X+Y\) has MGF
\[
M_{X}(t)\, M_{Y}(t)=\exp\left\{ \mu_{1}t+t^{2}\sigma_{1}^{2}/2\right\} \exp\left\{ \mu_{2}t+t^{2}\sigma_{2}^{2}/2\right\} =\exp\left\{ \left(\mu_{1}+\mu_{2}\right)t+t^{2}\left(\sigma_{1}^{2}+\sigma_{2}^{2}\right)/2\right\} ,
\]
which is the MGF of a \(\mathsf{norm}\left(\mathtt{mean}=\mu_{1}+\mu_{2},\,\mathtt{sd}=\sqrt{\sigma_{1}^{2}+\sigma_{2}^{2}}\right)\) distribution. 
</p>
</div>

<p>
Even when we cannot use the MGF trick to identify the exact distribution of a linear combination of random variables, we can still say something about its mean and variance.
</p>

<div class="prop">
<p><a name="pro-mean-sd-lin-comb-two" id="pro-mean-sd-lin-comb-two"></a>
Let \(X_{1}\) and \(X_{2}\) be independent with respective population means \(\mu_{1}\) and \(\mu_{2}\) and population standard deviations \(\sigma_{1}\) and \(\sigma_{2}\). For given constants \(a_{1}\) and \(a_{2}\), define \(Y=a_{1}X_{1}+a_{2}X_{2}\). Then the mean and standard deviation of \(Y\) are given by the formulas
\begin{equation}
\mu_{Y}=a_{1}\mu_{1}+a_{2}\mu_{2},\quad \sigma_{Y}=\left(a_{1}^{2}\sigma_{1}^{2}+a_{2}^{2}\sigma_{2}^{2}\right)^{1/2}.
\end{equation}
</p>
</div>


<div class="proof">
<p>We use Proposition <a href="#pro-expectation-properties">Expectation Properties</a>:
\[
\mathbb{E} Y=\mathbb{E}\left(a_{1}X_{1}+a_{2}X_{2}\right)=a_{1}\mathbb{E} X_{1}+a_{2}\mathbb{E} X_{2}=a_{1}\mu_{1}+a_{2}\mu_{2}.
\]
For the standard deviation, we will find the variance and take the square root at the end. And to calculate the variance we will first compute \(\mathbb{E} Y^{2}\) with an eye toward using the identity \(\sigma_{Y}^{2}=\mathbb{E} Y^{2}-\left(\mathbb{E} Y\right)^{2}\) as a final step. 
\[
\mathbb{E} Y^{2}=\mathbb{E}\left(a_{1}X_{1}+a_{2}X_{2}\right)^{2}=\mathbb{E}\left(a_{1}^{2}X_{1}^{2}+a_{2}^{2}X_{2}^{2}+2a_{1}a_{2}X_{1}X_{2}\right).
\]
Using linearity of expectation the \(\mathbb{E}\) distributes through the sum. Now \(\mathbb{E} X_{i}^{2}=\sigma_{i}^{2}+\mu_{i}^{2}\), for \(i=1\) and 2 and \(\mathbb{E} X_{1}X_{2}=\mathbb{E} X_{1}\mathbb{E} X_{2}=\mu_{1}\mu_{2}\) because of independence. Thus
\begin{eqnarray*}
\mathbb{E} Y^{2} & = & a_{1}^{2}(\sigma_{1}^{2}+\mu_{1}^{2})+a_{2}^{2}(\sigma_{2}^{2}+\mu_{2}^{2})+2a_{1}a_{2}\mu_{1}\mu_{2},\\
 & = & a_{1}^{2}\sigma_{1}^{2}+a_{2}^{2}\sigma_{2}^{2}+\left(a_{1}^{2}\mu_{1}^{2}+a_{2}^{2}\mu_{2}^{2}+2a_{1}a_{2}\mu_{1}\mu_{2}\right).
\end{eqnarray*}
But notice that the expression in the parentheses is exactly \(\left(a_{1}\mu_{1}+a_{2}\mu_{2}\right)^{2}=\left(\mathbb{E} Y\right)^{2}\), so the proof is complete.
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sec-Exchangeable-Random-Variables" class="outline-3">
<h3 id="sec-Exchangeable-Random-Variables"><a name="sec-7-5" id="sec-7-5"></a><span class="section-number-3">7.5</span> Exchangeable Random Variables</h3>
<div class="outline-text-3" id="text-sec-Exchangeable-Random-Variables">


<p>
Two random variables \(X\) and \(Y\) are said to be <i>exchangeable</i> if their joint CDF is a symmetric function of its arguments:
\begin{equation}
F_{X,Y}(x,y)=F_{X,Y}(y,x),\quad \mbox{for all }(x,y)\in\mathbb{R}^{2}.
\end{equation} 
When the joint density \(f\) exists, we may equivalently say that \(X\) and \(Y\) are exchangeable if \(f(x,y)=f(y,x)\) for all \((x,y)\).
</p>
<p>
Exchangeable random variables exhibit symmetry in the sense that a person may exchange one variable for the other with no substantive changes to their joint random behavior. While independence speaks to a <i>lack of influence</i> between the two variables, exchangeability aims to capture the <i>symmetry</i> between them.
</p>

<div class="exampletoo">
<p>Let \(X\) and \(Y\) have joint PDF
\begin{multline}
f_{X,Y}(x,y)=(1+\alpha)\lambda^{2}\mathrm{e}^{-\lambda(x+y)}+\alpha(2\lambda)^{2}\mathrm{e}^{-2\lambda(x+y)}-2\alpha\lambda^{2}\left(\mathrm{e}^{-\lambda(2x+y)}+\mathrm{e}^{-\lambda(x+2y)}\right).
\end{multline}
It is straightforward and tedious to check that \(\iint f=1\). We may see immediately that \(f_{X,Y}(x,y)=f_{X,Y}(y,x)\) for all \((x,y)\), which confirms that \(X\) and \(Y\) are exchangeable. Here, \(\alpha\) is said to be an association parameter. This particular example is one from the Farlie-Gumbel-Morgenstern family of distributions; see \cite{Kotz2000}.
</p>
</div>


<div class="exampletoo">
<p><a name="exa-binom-exchangeable" id="exa-binom-exchangeable"></a>
Suppose \(X\) and \(Y\) are IID \(\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\). Then their joint PMF is
\begin{eqnarray*}
f_{X,Y}(x,y) & = & f_{X}(x)f_{Y}(y)\\
 & = & {n \choose x}\, p^{x}(1-p)^{n-x}\,{n \choose y}\, p^{y}(1-p)^{n-y},\\
 & = & {n \choose x}{n \choose y}\, p^{x+y}(1-p)^{2n-(x+y)},
\end{eqnarray*}
and the value is the same if we exchange \(x\) and \(y\). Therefore \((X,Y)\) are exchangeable.
</p>
</div>

<p>
Looking at Example <a href="#exa-binom-exchangeable">Binomial Exchangeable</a> more closely we see that the fact that \((X,Y)\) are exchangeable has nothing to do with the \(\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\) distribution; it only matters that they are independent (so that the joint PDF factors) and they are identically distributed (in which case we may swap letters to no effect). We could just have easily used any other marginal distribution. We will take this as a proof of the following proposition.
</p>

<div class="prop">
<p>If \(X\) and \(Y\) are IID (with common marginal distribution \(F\)) then \(X\) and \(Y\) are exchangeable. 
</p>
</div>

<p>
Exchangeability thus contains IID as a special case. 
</p>
</div>

</div>

<div id="outline-container-sec-The-Bivariate-Normal" class="outline-3">
<h3 id="sec-The-Bivariate-Normal"><a name="sec-7-6" id="sec-7-6"></a><span class="section-number-3">7.6</span> The Bivariate Normal Distribution</h3>
<div class="outline-text-3" id="text-sec-The-Bivariate-Normal">


<p>
The bivariate normal PDF is given by the unwieldy formula
\begin{multline}
f_{X,Y}(x,y)=\frac{1}{2\pi\,\sigma_{X}\sigma_{Y}\sqrt{1-\rho^{2}}}\exp\left\{ -\frac{1}{2(1-\rho^{2})}\left[\left(\frac{x-\mu_{X}}{\sigma_{X}}\right)^{2}+\cdots\right.\right.\\
\left.\left.\cdots+2\rho\left(\frac{x-\mu_{X}}{\sigma_{X}}\right)\left(\frac{y-\mu_{Y}}{\sigma_{Y}}\right)+\left(\frac{y-\mu_{Y}}{\sigma_{Y}}\right)^{2}\right]\right\} ,
\end{multline}
for \((x,y)\in\mathbb{R}^{2}\). We write \((X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)\), where
\begin{equation}
\upmu=(\mu_{X},\,\mu_{Y})^{T},\quad \sum=\left(
\begin{array}{cc}
\sigma_{X}^{2} & \rho\sigma_{X}\sigma_{Y}\\
\rho\sigma_{X}\sigma_{Y} & \sigma_{Y}^{2}
\end{array}
\right).
\end{equation}
See Appendix <a href="#sec-21">Mathematical Machinery</a>. The vector notation allows for a more compact rendering of the joint PDF:
\begin{equation}
f_{X,Y}(\mathbf{x})=\frac{1}{2\pi\left|\Sigma\right|^{1/2}}\exp\left\{ -\frac{1}{2}\left(\mathbf{x}-\upmu\right)^{\top}\Sigma^{-1}\left(\mathbf{x}-\upmu\right)\right\} ,
\end{equation}
where in an abuse of notation we have written \(\mathbf{x}\) for \((x,y)\). Note that the formula only holds when \(\rho\neq\pm1\).
</p>

<div class="rem">
<p>In Remark <a href="#rem-cov0-not-imply-indep">rem-cov0-not-imply-indep</a> we noted that just because random variables are uncorrelated it does not necessarily mean that they are independent. However, there is an important exception to this rule: the bivariate normal distribution. Indeed, \((X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)\) are independent if and only if \(\rho=0\). 
</p>
</div>


<div class="rem">
<p>Inspection of the joint PDF shows that if \(\mu_{X}=\mu_{Y}\) and \(\sigma_{X}=\sigma_{Y}\) then \(X\) and \(Y\) are exchangeable.
</p>
</div>

<p>
The bivariate normal MGF is
\begin{equation}
M_{X,Y}(\mathbf{t})=\exp\left(\upmu^{\top}\mathbf{t}+\frac{1}{2}\mathbf{t}^{\top}\Sigma\mathbf{t}\right),
\end{equation}
where \(\mathbf{t}=(t_{1},t_{2})\).
</p>
<p>
The bivariate normal distribution may be intimidating at first but it turns out to be very tractable compared to other multivariate distributions. An example of this is the following fact about the marginals. 
</p>

<div class="fact">
<p>If \((X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)\) then
\begin{equation}
X\sim\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})\mbox{ and }Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y}).
\end{equation}
</p>
</div>

<p>
From this we immediately get that \(\mathbb{E} X=\mu_{X}\) and \(\mbox{Var}(X)=\sigma_{X}^{2}\) (and the same is true for \(Y\) with the letters switched). And it should be no surprise that the correlation between \(X\) and \(Y\) is exactly \(\mbox{Corr}(X,Y)=\rho\).
</p>

<div class="prop">
<p><a name="pro-mvnorm-cond-dist" id="pro-mvnorm-cond-dist"></a>
The conditional distribution of \(Y|\, X=x\) is \(\mathsf{norm}(\mathtt{mean}=\mu_{Y|x},\,\mathtt{sd}=\sigma_{Y|x})\), where
\begin{equation}
\mu_{Y|x}=\mu_{Y}+\rho\frac{\sigma_{Y}}{\sigma_{X}}\left(x-\mu_{X}\right),\mbox{ and }\sigma_{Y|x}=\sigma_{Y}\sqrt{1-\rho^{2}}.
\end{equation}
</p>
</div>

<p>
There are a few things to note about Proposition <a href="#pro-mvnorm-cond-dist">pro-mvnorm-cond-dist</a> which will be important in Chapter <a href="#sec-11">Simple Linear Regression</a>. First, the conditional mean of \(Y|x\) is linear in \(x\), with slope
\begin{equation}
\rho\,\frac{\sigma_{Y}}{\sigma_{X}}.
\end{equation}
<a name="eq-population-slope-slr" id="eq-population-slope-slr"></a>
Second, the conditional variance of \(Y|x\) is independent of \(x\). 
</p>

</div>

<div id="outline-container-7-6-1" class="outline-4">
<h4 id="sec-7-6-1"><span class="section-number-4">7.6.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-7-6-1">


<p>
The multivariate normal distribution is implemented in both the <code>mvtnorm</code> package \cite{Genzmvtnorm} and the <code>mnormt</code> package \cite{mnormt}. We use the <code>mvtnorm</code> package in this book simply because it is a dependency of another package used in the book. 
</p>
<p>
The <code>mvtnorm</code> package has functions <code>dmvnorm</code> and <code>rmvnorm</code> for the PDF and to generate random vectors, respectively. Let us get started with a graph of the bivariate normal PDF. We can make the plot with the following code, where the workhorse is the <code>persp</code> function in base \(\mathsf{R}\).
</p>
<p>
Another way to do this is with the <code>curve3d</code> function in the <code>emdbook</code> package \cite{emdbook}. It looks like this:
</p><pre class="example">
library("emdbook"); library("mvtnorm") # note: the order matters
mu &lt;- c(0,0); sigma &lt;- diag(2)
f &lt;- function(x,y) dmvnorm(c(x,y), mean = mu, sigma = sigma)
curve3d(f(x,y), from = c(-3,-3), to = c(3,3), theta = -30, phi = 30)
</pre>

<p>The code above is slightly shorter than that using <code>persp</code> and is easier to understand. One must be careful, however. If the <code>library</code> calls are swapped then the code will not work because both packages <code>emdbook</code> and <code>mvtnorm</code> have a function called <code>dmvnorm</code>; one must load them to the search path in the correct order or \(\mathsf{R}\) will use the wrong one (the arguments are named differently and the underlying algorithms are different).
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> seq(from = -3, to = 3, length.out = 30)
<span style="font-weight: bold;">f</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x,y) dmvnorm(cbind(x,y), mean = c(0,0), sigma = diag(2))
z <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> outer(x, y, FUN = f)
persp(x, y, z, theta = -30, phi = 30, ticktype = <span style="font-style: italic;">"detailed"</span>)
</pre>


<p>
We chose the standard bivariate normal, \(\mathsf{mvnorm}(\mathtt{mean}=\mathbf{0},\,\mathtt{sigma}=\mathbf{I})\), to display.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> seq(from = -3, to = 3, length.out = 30)
<span style="font-weight: bold;">f</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x,y) dmvnorm(cbind(x,y), mean = c(0,0), sigma = diag(2))
z <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> outer(x, y, FUN = f)
persp(x, y, z, theta = -30, phi = 30, ticktype = <span style="font-style: italic;">"detailed"</span>)
</pre>







<div id="fig-mvnorm-pdf" class="figure">
  <p><img src="svg/multdist/mvnorm-pdf.svg" width=500 alt="svg/multdist/mvnorm-pdf.svg" /></p>
  <p>A graph of a bivariate normal PDF.</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sec-Transformations-Multivariate" class="outline-3">
<h3 id="sec-Transformations-Multivariate"><a name="sec-7-7" id="sec-7-7"></a><span class="section-number-3">7.7</span> Bivariate Transformations of Random Variables</h3>
<div class="outline-text-3" id="text-sec-Transformations-Multivariate">


<p>
We studied in Section <a href="#sec-6-4">Functions of Continuous RVs</a> how to find the PDF of \(Y=g(X)\) given the PDF of \(X\). But now we have two random variables \(X\) and Y, with joint PDF \(f_{X,Y}\), and we would like to consider the joint PDF of two new random variables
\begin{equation}
U=g(X,Y)\quad \mbox{and}\quad V=h(X,Y),
\end{equation}
where \(g\) and \(h\) are two given functions, typically ``nice'' in the sense of Appendix <a href="#sec-21-6">Multivariable Calculus</a>. 
</p>
<p>
Suppose that the transformation \((x,y)\longmapsto(u,v)\) is one-to-one. Then an inverse transformation \(x=x(u,v)\) and \(y=y(u,v)\) exists, so let \(\partial(x,y)/\partial(u,v)\) denote the Jacobian of the inverse transformation. Then the joint PDF of \((U,V)\) is given by 
\begin{equation}
f_{U,V}(u,v)=f_{X,Y}\left[x(u,v),\, y(u,v)\right]\left|\frac{\partial(x,y)}{\partial(u,v)}\right|,
\end{equation}
or we can rewrite more shortly as
\begin{equation}
f_{U,V}(u,v)=f_{X,Y}(x,y)\left|\frac{\partial(x,y)}{\partial(u,v)}\right|.
\end{equation}
<a name="eq-biv-trans-pdf-short" id="eq-biv-trans-pdf-short"></a>
Take a moment and compare Equation <a href="#eq-biv-trans-pdf-short">eq-biv-trans-pdf-short</a> to Equation <a href="#eq-univ-trans-pdf-short">eq-univ-trans-pdf-short</a>. Do you see the connection? 
</p>

<div class="rem">
<p>It is sometimes easier to <i>postpone</i> solving for the inverse transformation \(x=x(u,v)\) and \(y=y(u,v)\). Instead, leave the transformation in the form \(u=u(x,y)\) and \(v=v(x,y)\) and calculate the Jacobian of the <i>original</i> transformation
\begin{equation}
\frac{\partial(u,v)}{\partial(x,y)}=\left|\begin{array}{cc}
\frac{\partial u}{\partial x} & \frac{\partial u}{\partial y}\\
\frac{\partial v}{\partial x} & \frac{\partial v}{\partial y}\end{array}\right|=\frac{\partial u}{\partial x}\frac{\partial v}{\partial y}-\frac{\partial u}{\partial y}\frac{\partial v}{\partial x}.
\end{equation}
Once this is known, we can get the PDF of \((U,V)\) by
\begin{equation}
f_{U,V}(u,v)=f_{X,Y}(x,y)\left|\frac{1}{\frac{\partial(u,v)}{\partial(x,y)}}\right|.
\end{equation}
In some cases there will be a cancellation and the work will be lot shorter. Of course, it is not always true that
\begin{equation}
\frac{\partial(x,y)}{\partial(u,v)}=\frac{1}{\frac{\partial(u,v)}{\partial(x,y)}},
\end{equation}
<a name="eq-biv-jacob-recip" id="eq-biv-jacob-recip"></a>
but for the well-behaved examples that we will see in this book it works just fine&hellip; do you see the connection between Equations <a href="#eq-biv-jacob-recip">eq-biv-jacob-recip</a> and <a href="#eq-univ-jacob-recip">eq-univ-jacob-recip</a>?
</p>
</div>



<div class="exampletoo">
<p>Let \((X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\mathbf{0}_{2\times1},\,\mathtt{sigma}=\mathbf{I}_{2\times2})\) and consider the transformation
\begin{align*}
U= & \ 3X+4Y,\\
V= & \ 5X+6Y.
\end{align*}
We can solve the system of equations to find the inverse transformations; they are
\begin{align*}
X= & -3U+2V,\\
Y= & \ \frac{5}{2}U-\frac{3}{2}V,
\end{align*}
in which case the Jacobian of the inverse transformation is
\[
\begin{vmatrix}
-3 & 2\\
\frac{5}{2} & -\frac{3}{2}
\end{vmatrix}
= 3\left(-\frac{3}{2}\right)-2\left(\frac{5}{2}\right) = -\frac{1}{2}.
\]
As \((x,y)\) traverses \(\mathbb{R}^{2}\), so too does \((u,v)\). Since the joint PDF of \((X,Y)\) is
\[
f_{X,Y}(x,y)=\frac{1}{2\pi}\exp\left\{ -\frac{1}{2}\left(x^{2}+y^{2}\right)\right\} ,\quad (x,y)\in\mathbb{R}^{2},
\]
we get that the joint PDF of \((U,V)\) is
\begin{equation}
f_{U,V}(u,v)=\frac{1}{2\pi}\exp\left\{ -\frac{1}{2}\left[\left(-3u+2v\right)^{2}+\left(\frac{5u-3v}{2}\right)^{2}\right]\right\} \cdot\frac{1}{2},\quad (u,v)\in\mathbb{R}^{2}.
\end{equation}
<a name="eq-biv-norm-hidden" id="eq-biv-norm-hidden"></a>
</p>
</div>


<div class="rem">
<p>It may not be obvious, but Equation <a href="#eq-biv-norm-hidden">eq-biv-norm-hidden</a> is the PDF of a \(\mathsf{mvnorm}\) distribution. For a more general result see Theorem <a href="#thm-mvnorm-dist-matrix-prod">thm-mvnorm-dist-matrix-prod</a>.
</p>
</div>


</div>

<div id="outline-container-sub-bivariate-transf-R" class="outline-4">
<h4 id="sub-bivariate-transf-R"><a name="sec-7-7-1" id="sec-7-7-1"></a><span class="section-number-4">7.7.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-sub-bivariate-transf-R">


<p>
It is possible to do the computations above in \(\mathsf{R}\) with the <code>Ryacas</code> package. The package is an interface to the open-source computer algebra system, ``Yacas''. The user installs Yacas, then employs <code>Ryacas</code> to submit commands to Yacas, after which the output is displayed in the \(\mathsf{R}\) console.
</p>
<p>
There are not yet any examples of Yacas in this book, but there are online materials to help the interested reader: see <a href="http://code.google.com/p/ryacas/">here</a> to get started.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Remarks-for-the-Multivariate" class="outline-3">
<h3 id="sec-Remarks-for-the-Multivariate"><a name="sec-7-8" id="sec-7-8"></a><span class="section-number-3">7.8</span> Remarks for the Multivariate Case</h3>
<div class="outline-text-3" id="text-sec-Remarks-for-the-Multivariate">


<p>
There is nothing spooky about \(n\geq3\) random variables. We just have a whole bunch of them: \(X_{1}\), \(X_{2}\),&hellip;, \(X_{n}\), which we can shorten to \(\mathbf{X}=(X_{1},X_{2},\ldots,X_{n})^{\mathrm{T}}\) to make the formulas prettier (now may be a good time to check out Appendix <a href="#sec-21-5">Linear Algebra</a>). For \(\mathbf{X}\) supported on the set \(S_{\mathbf{X}}\), the joint PDF \(f_{\mathbf{X}}\) (if it exists) satisfies
\begin{equation}
f_{\mathbf{X}}(\mathbf{x})>0,\quad \mbox{for }\mathbf{x}\in S_{\mathbf{X}},
\end{equation}
and
\begin{equation}
\int\!\!\!\int\cdots\int f_{\mathbf{X}}(\mathbf{x})\,\mathrm{d} x_{1}\mathrm{d} x_{2}\cdots\mathrm{d} x_{n}=1,
\end{equation}
or even shorter: \(\int f_{\mathbf{X}}(\mathbf{x})\,\mathrm{d}\mathbf{x}=1\). The joint CDF \(F_{\mathbf{X}}\) is defined by 
\begin{equation}
F_{\mathbf{X}}(\mathbf{x})=\mathbb{P}(X_{1}\leq x_{1},\, X_{2}\leq x_{2},\ldots,\, X_{n}\leq x_{n}),
\end{equation}
for \(\mathbf{x}\in\mathbb{R}^{n}\). The expectation of a function \(g(\mathbf{X})\) is defined just as we would imagine:
\begin{equation}
\mathbb{E} g(\mathbf{X})=\int g(\mathbf{x})\, f_{\mathbf{X}}(\mathbf{x})\,\mathrm{d}\mathbf{x}.
\end{equation}
provided the integral exists and is finite. And the moment generating function in the multivariate case is defined by
\begin{eqnarray} 
M_{\mathbf{X}}(\mathbf{t}) & = & \mathbb{E}\exp\left\{ \mathbf{t}^{\mathrm{T}}\mathbf{X}\right\},
\end{eqnarray}
whenever the integral exists and is finite for all \(\mathbf{t}\) in a neighborhood of \(\mathbf{0}_{\mathrm{n}\times1}\) (note that \(\mathbf{t}^{\mathrm{T}}\mathbf{X}\) is shorthand for \(t_{1}X_{1}+t_{2}X_{2}+\cdots+t_{n}X_{n}\)). The only difference in any of the above for the discrete case is that integrals are replaced by sums. 
</p>
<p>
Marginal distributions are obtained by integrating out remaining variables from the joint distribution. And even if we are given all of the univariate marginals it is not enough to determine the joint distribution uniquely.
</p>
<p>
We say that \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are <i>mutually independent</i> if their joint PDF factors into the product of the marginals
\begin{equation}
f_{\mathbf{X}}(\mathbf{x})=f_{X_{1}}(x_{1})\, f_{X_{2}}(x_{2})\,\cdots\, f_{X_{n}}(x_{n}),
\end{equation}
for every \(\mathbf{x}\) in their joint support \(S_{\mathbf{X}}\), and we say that \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are <i>exchangeable</i> if their joint PDF (or CDF) is a symmetric function of its \(n\) arguments, that is, if 
\begin{equation}
f_{\mathbf{X}}(\mathbf{x^{\ast}})=f_{\mathbf{X}}(\mathbf{x}),
\end{equation}
for any reordering \(\mathbf{x^{\ast}}\) of the elements of \(\mathbf{x}=(x_{1},x_{2},\ldots,x_{n})\) in the joint support.
</p>

<div class="prop">
<p><a name="pro-mean-sd-lin-comb" id="pro-mean-sd-lin-comb"></a>
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be independent with respective population means \(\mu_{1}\), \(\mu_{2}\), &hellip;, \(\mu_{n}\) and standard deviations \(\sigma_{1}\), \(\sigma_{2}\), &hellip;, \(\sigma_{n}\). For given constants \(a_{1}\), \(a_{2}\), &hellip;,\(a_{n}\) define \(Y=\sum_{i=1}^{n}a_{i}X_{i}\). Then the mean and standard deviation of \(Y\) are given by the formulas
\begin{equation}
\mu_{Y}=\sum_{i=1}^{n}a_{i}\mu_{i},\quad \sigma_{Y}=\left(\sum_{i=1}^{n}a_{i}^{2}\sigma_{i}^{2}\right)^{1/2}.
\end{equation}
</p>
</div>


<div class="proof">
<p>The mean is easy:
\[
\mathbb{E} Y=\mathbb{E}\left(\sum_{i=1}^{n}a_{i}X_{i}\right)=\sum_{i=1}^{n}a_{i}\mathbb{E} X_{i}=\sum_{i=1}^{n}a_{i}\mu_{i}.
\]
The variance is not too difficult to compute either. As an intermediate step, we calculate \(\mathbb{E} Y^{2}\). 
\[
\mathbb{E} Y^{2}=\mathbb{E}\left(\sum_{i=1}^{n}a_{i}X_{i}\right)^{2}=\mathbb{E}\left(\sum_{i=1}^{n}a_{i}^{2}X_{i}^{2}+2\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}a_{i}a_{j}X_{i}X_{j}\right).
\]
Using linearity of expectation the \(\mathbb{E}\) distributes through the sums. Now \(\mathbb{E} X_{i}^{2}=\sigma_{i}^{2}+\mu_{i}^{2}\) and \(\mathbb{E} X_{i}X_{j}=\mathbb{E} X_{i}\mathbb{E} X_{j}=\mu_{i}\mu_{j}\) when \(i\neq j\) because of independence. Thus
\begin{eqnarray*}
\mathbb{E} Y^{2} & = & \sum_{i=1}^{n}a_{i}^{2}(\sigma_{i}^{2}+\mu_{i}^{2})+2\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}a_{i}a_{j}\mu_{i}\mu_{j}\\
 & = & \sum_{i=1}^{n}a_{i}^{2}\sigma_{i}^{2}+\left(\sum_{i=1}^{n}a_{i}^{2}\mu_{i}^{2}+2\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}a_{i}a_{j}\mu_{i}\mu_{j}\right)
\end{eqnarray*}
To complete the proof, note that the expression in the parentheses is exactly \(\left(\mathbb{E} Y\right)^{2}\), and recall the identity \(\sigma_{Y}^{2}=\mathbb{E} Y^{2}-\left(\mathbb{E} Y\right)^{2}\).  
</p>
</div>

<p>
There is a corresponding statement of Fact <a href="#fac-indep-then-function-indep">fac-indep-then-function-indep</a> for the multivariate case. The proof is also omitted here. 
</p>

<div class="fact">
<p>If \(\mathbf{X}\) and \(\mathbf{Y}\) are mutually independent random vectors, then \(u(\mathbf{X})\) and \(v(\mathbf{Y})\) are independent for any functions \(u\) and \(v\).
</p>
</div>

<p>
Bruno de Finetti was a strong proponent of the subjective approach to probability. He proved an important theorem in 1931 which illuminates the link between exchangeable random variables and independent random variables. Here it is in one of its simplest forms. 
</p>

<div class="thm">
<p><b>De Finetti's Theorem.</b> Let \(X_{1}\), \(X_{2}\), &hellip; be a sequence of \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\) random variables such that \((X_{1},\ldots,X_{k})\) are exchangeable for every \(k\). Then there exists a random variable \(\Theta\) with support \([0,1]\) and PDF \(f_{\Theta}(\theta)\) such that
\begin{equation}
\mathbb{P}(X_{1}=x_{1},\ldots,\, X_{k}=x_{k})=\int_{0}^{1}\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}\, f_{\Theta}(\theta)\,\mathrm{d}\theta,
\end{equation}
<a name="eq-definetti-binary" id="eq-definetti-binary"></a>
for all \(x_{i}=0,\,1\), \(i=1,\,2,\ldots,k\).
</p>
</div>

<p>
To get a handle on the intuitive content de Finetti's theorem, imagine that we have a <i>bunch</i> of coins in our pocket with each having its own unique value of \(\theta=\mathbb{P}(\mbox{Heads})\). We reach into our pocket and select a coin at random according to some probability &ndash; say, \(f_{\Theta}(\theta)\). We take the randomly selected coin and flip it \(k\) times. 
</p>
<p>
Think carefully: the conditional probability of observing a sequence  \(X_{1}=x_{1},\ldots,\, X_{k}=x_{k}\), given a specific coin \(\theta\) would just be \(\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}\), because the coin flips are an independent sequence of Bernoulli trials. But the coin is random, so the Theorem of Total Probability says we can get the <i>unconditional</i> probability \(\mathbb{P}(X_{1}=x_{1},\ldots,\, X_{k}=x_{k})\) by adding up terms that look like
\begin{equation}
\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}\, f_{\Theta}(\theta),
\end{equation}
where we sum over all possible coins. The right-hand side of Equation <a href="#eq-definetti-binary">eq-definetti-binary</a> is a sophisticated way to denote this process.
</p>
<p>
Of course, the integral's value does not change if we jumble the \(x_{i}\)'s, so \((X_{1},\ldots,X_{k})\) are clearly exchangeable. The power of de Finetti's Theorem is that <i>every</i> infinite binary exchangeable sequence can be written in the above form.
</p>
<p>
The connection to subjective probability: our prior information about \(\theta\) corresponds to \(f_{\Theta}(\theta)\) and the likelihood of the sequence \(X_{1}=x_{1},\ldots,\, X_{k}=x_{k}\) (conditional on \(\theta\)) corresponds to \(\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}\). Compare Equation <a href="#eq-definetti-binary">eq-definetti-binary</a> to Section <a href="#sec-Bayes--Rule">Bayes' Rule</a> and Section <a href="#sec-7-3">Conditional Distributions</a>.
</p>
<p>
The multivariate normal distribution immediately generalizes from the bivariate case. If the matrix \(\Sigma\) is nonsingular then the joint PDF of \(\mathbf{X}\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)\) is
\begin{equation}
f_{\mathbf{X}}(\mathbf{x})=\frac{1}{(2\pi)^{n/2}\left|\Sigma\right|^{1/2}}\exp\left\{ -\frac{1}{2}\left(\mathbf{x}-\upmu\right)^{\top}\Sigma^{-1}\left(\mathbf{x}-\upmu\right)\right\},
\end{equation}
and the MGF is
\begin{equation}
M_{\mathbf{X}}(\mathbf{t})=\exp\left\{ \upmu^{\top}\mathbf{t}+\frac{1}{2}\mathbf{t}^{\top}\Sigma\mathbf{t}\right\}.
\end{equation}
We will need the following in Chapter <a href="#sec-12">Multiple Linear Regression</a>.
</p>

<div class="thm">
<p><a name="thm-mvnorm-dist-matrix-prod" id="thm-mvnorm-dist-matrix-prod"></a>
If \(\mathbf{X}\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)\) and \(\mathbf{A}\) is any matrix, then the random vector \(\mathbf{Y}=\mathbf{AX}\)
is distributed
\begin{equation}
\mathbf{Y}\sim\mathsf{mvnorm}(\mathtt{mean}=\mathbf{A}\upmu,\,\mathtt{sigma}=\mathbf{A}\Sigma\mathbf{A}^{\mathrm{T}}).
\end{equation}
</p>
</div>


<div class="proof">
<p>Look at the MGF of \(\mathbf{Y}\):
\begin{eqnarray*}
M_{\mathbf{Y}}(\mathbf{t}) & = & \mathbb{E}\,\exp\left\{ \mathbf{t}^{\mathrm{T}}(\mathbf{AX})\right\} ,\\
 & = & \mathbb{E}\,\exp\left\{ (\mathbf{A}^{\mathrm{T}}\mathbf{t})^{\mathrm{T}}\mathbf{X}\right\} ,\\
 & = & \exp\left\{ \upmu^{\mathrm{T}}(\mathbf{A}^{\top}\mathbf{t})+\frac{1}{2}(\mathbf{A}^{\mathrm{T}}\mathbf{t})^{\mathrm{T}}\Sigma(\mathbf{A}^{\mathrm{T}}\mathbf{t})\right\} ,\\
 & = & \exp\left\{ \left(\mathbf{A}\upmu\right)^{\mathrm{T}}\mathbf{t}+\frac{1}{2}\mathbf{t}^{\mathrm{T}}\left(\mathbf{A}\Sigma\mathbf{A}^{\mathrm{T}}\right)\mathbf{t}\right\},
\end{eqnarray*}
and the last expression is the MGF of an \(\mathsf{mvnorm}(\mathtt{mean}=\mathbf{A}\upmu,\,\mathtt{sigma}=\mathbf{A}\Sigma\mathbf{A}^{\mathrm{T}})\) distribution.
</p>
</div>

</div>

</div>

<div id="outline-container-sec-Multinomial" class="outline-3">
<h3 id="sec-Multinomial"><a name="sec-7-9" id="sec-7-9"></a><span class="section-number-3">7.9</span> The Multinomial Distribution</h3>
<div class="outline-text-3" id="text-sec-Multinomial">


<p>
We sample \(n\) times, with replacement, from an urn that contains balls of \(k\) different types. Let \(X_{1}\) denote the number of balls in our sample of type 1, let \(X_{2}\) denote the number of balls of type 2, &hellip;, and let \(X_{k}\) denote the number of balls of type \(k\). Suppose the urn has proportion \(p_{1}\) of balls of type 1, proportion \(p_{2}\) of balls of type 2, &hellip;, and proportion \(p_{k}\) of balls of type \(k\). Then the joint PMF of \((X_{1},\ldots,X_{k})\) is
\begin{eqnarray}
f_{X_{1},\ldots,X_{k}}(x_{1},\ldots,x_{k}) & = & {n \choose x_{1}\, x_{2}\,\cdots\, x_{k}}\, p_{1}^{x_{1}}p_{2}^{x_{2}}\cdots p_{k}^{x_{k}},
\end{eqnarray}
for \((x_{1},\ldots,x_{k})\) in the joint support \(S_{X_{1},\ldots X_{K}}\). We write
\begin{equation}
(X_{1},\ldots,X_{k})\sim\mathsf{multinom}(\mathtt{size}=n,\,\mathtt{prob}=\mathbf{p}_{\mathrm{k}\times1}).
\end{equation}
Several comments are in order. First, the joint support set \(S_{X_{1},\ldots X_{K}}\) contains all nonnegative integer \(k\)-tuples \((x_{1},\ldots,x_{k})\) such that \(x_{1}+x_{2}+\cdots+x_{k}=n\). A support set like this is called a <i>simplex</i>. Second, the proportions \(p_{1}\), \(p_{2}\), &hellip;, \(p_{k}\) satisfy \(p_{i}\geq0\) for all \(i\) and \(p_{1}+p_{2}+\cdots+p_{k}=1\). Finally, the symbol
\begin{equation}
{n \choose x_{1}\, x_{2}\,\cdots\, x_{k}}=\frac{n!}{x_{1}!\, x_{2}!\,\cdots x_{k}!}
\end{equation}
is called a <i>multinomial coefficient</i> which generalizes the notion of a binomial coefficient we saw in Equation <a href="#eq-binomial-coefficient">eq-binomial-coefficient</a>. 
</p>
<p>
The form and notation we have just described matches the \(\mathsf{R}\) usage but is not standard among other texts. Most other books use the above for a \(k-1\) dimension multinomial distribution, because the linear constraint \(x_{1}+x_{2}+\cdots+x_{k}=n\) means that once the values of \(X_{1}\), \(X_{2}\), &hellip;, \(X_{k-1}\) are known the final value \(X_{k}\) is determined, not random. Another term used for this is a <i>singular</i> distribution. 
</p>
<p>
For the most part we will ignore these difficulties, but the careful reader should keep them in mind. There is not much of a difference in practice, except that below we will use a two-dimensional support set for a three-dimension multinomial distribution. See Figure <a href="#fig-multinom-pmf2">multinom-pmf2</a>.
</p>
<p>
When \(k=2\), we have \(x_{1}=x\) and \(x_{2}=n-x\), we have \(p_{1}=p\) and \(p_{2}=1-p\), and the multinomial coefficient is literally a binomial coefficient. In the previous notation we have thus shown that the \(\mathsf{multinom}(\mathtt{size}=n,\,\mathtt{prob}=\mathbf{p}_{2\times1})\) distribution is the same as a \(\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\) distribution.
</p>

<div class="exampletoo">
<p><b>Dinner with Barack Obama.</b> During the 2008 U.S. presidential primary, Barack Obama offered to have dinner with three randomly selected monetary contributors to his campaign. Imagine the thousands of people in the contributor database. For the sake of argument, Suppose that the database was approximately representative of the U.S. population as a whole, Suppose Barack Obama wants to have <a href="http://pewresearch.org/pubs/773/fewer-voters-identify-as-republicans">dinner</a> with 36 democrat, 27 republican, and 37 independent.
</p>
</div>


<div class="rem">
<p>Here are some facts about the multinomial distribution.
</p><ol>
<li>The expected value of \((X_{1},\, X_{2},\,\ldots,\, X_{k})\) is \(n\mathbf{p}_{k\times1}\).
</li>
<li>The variance-covariance matrix \(\Sigma\) is symmetric with diagonal entries \(\sigma_{i}^{2}=np_{i}(1-p_{i})\), \(i=1,\,2,\,\ldots,\, k\) and off-diagonal entries \(\mbox{Cov}(X_{i},\, X_{j})=-np_{i}p_{j}\), for \(i\neq j\). The correlation between \(X_{i}\) and \(X_{j}\) is therefore \(\mbox{Corr}(X_{i},\, X_{j})=-\sqrt{p_{i}p_{j}/(1-p_{i})(1-p_{j})}\). 
</li>
<li>The marginal distribution of \((X_{1},\, X_{2},\,\ldots,\, X_{k-1})\) is \(\mathsf{multinom}(\mathtt{size}=n,\,\mathtt{prob}=\mathbf{p}_{(k-1)\times1})\) with
   \begin{equation}
   \mathbf{p}_{(k-1)\times1}=\left(p_{1},\, p_{2},\,\ldots,\, p_{k-2},\, p_{k-1}+p_{k}\right),
   \end{equation}
   and in particular, \(X_{i}\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p_{i})\).
</li>
</ol>



</div>


</div>

<div id="outline-container-7-9-1" class="outline-4">
<h4 id="sec-7-9-1"><span class="section-number-4">7.9.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-7-9-1">


<p>
There is support for the multinomial distribution in base \(\mathsf{R}\), namely in the <code>stats</code> package. The <code>dmultinom</code> function represents the PMF and the <code>rmultinom</code> function generates random variates.
</p>



<pre class="src src-R">tmp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> t(xsimplex(3, 6))
p <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> apply(tmp, MARGIN = 1, FUN = dmultinom, prob = c(36,27,37))
S <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> probspace(tmp, probs = p)
ProbTable <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> xtabs(probs ~ X1 + X2, data = S)
round(ProbTable, 3)
</pre>


<pre class="example">
   X2
X1      0     1     2     3     4     5     6
  0 0.003 0.011 0.020 0.020 0.011 0.003 0.000
  1 0.015 0.055 0.080 0.058 0.021 0.003 0.000
  2 0.036 0.106 0.116 0.057 0.010 0.000 0.000
  3 0.047 0.103 0.076 0.018 0.000 0.000 0.000
  4 0.034 0.050 0.018 0.000 0.000 0.000 0.000
  5 0.013 0.010 0.000 0.000 0.000 0.000 0.000
  6 0.002 0.000 0.000 0.000 0.000 0.000 0.000
</pre>


<p>
Do some examples of <code>rmultinom</code>.
</p>
<p>
Another way to do the plot is with the <code>scatterplot3d</code> function in the <code>scatterplot3d</code> package \cite{Liggesscatterplot3d}. It looks like this: 
</p><pre class="example">
library("scatterplot3d")
X &lt;- t(as.matrix(expand.grid(0:6, 0:6)))
X &lt;- X[, colSums(X) &lt;= 6 ]; X &lt;- rbind(X, 6 - colSums(X))
Z &lt;- round(apply(X, 2, function(x) dmultinom(x, prob = 1:3)), 3)
A &lt;- data.frame(x = X[1, ], y = X[2, ], probability = Z)
scatterplot3d(A, type = "h", lwd = 3, box = FALSE)
</pre>

<p>The <code>scatterplot3d</code> graph looks better in this example, but the code is more difficult to understand. And with <code>cloud</code> one can easily do conditional plots of the form <code>cloud(z ~ x + y | f)</code>, where <code>f</code> is a factor.
</p>



<pre class="src src-R">print(cloud(probs ~ X1 + X2, data = S, type = c(<span style="font-style: italic;">"p"</span>,<span style="font-style: italic;">"h"</span>), lwd = 2, 
            pch = 16, cex = 1.5), screen = list(z = 15, x = -70))
</pre>







<div id="fig-multinom-pmf2" class="figure">
  <p><img src="svg/multdist/multinom-pmf2.svg" width=500 alt="svg/multdist/multinom-pmf2.svg" /></p>
  <p>A plot of a multinomial PMF.</p>
</div>


</div>
</div>

</div>

<div id="outline-container-7-10" class="outline-3">
<h3 id="sec-7-10"><span class="section-number-3">7.10</span> Exercises</h3>
<div class="outline-text-3" id="text-7-10">




<div class="xca">
<p><a name="xca-Prove-cov-shortcut" id="xca-Prove-cov-shortcut"></a>
Prove that \( \mbox{Cov}(X,Y)=\mathbb{E}(XY)-(\mathbb{E} X)(\mathbb{E} Y). \)
</p>
</div>


<div class="xca">
<p><a name="xca-sum-indep-chisq" id="xca-sum-indep-chisq"></a>
Suppose \(X\sim\mathsf{chisq}(\mathtt{df}=p_{1})\) and \(Y\sim\mathsf{chisq}(\mathtt{df}=p_{2})\) are independent. Find the distribution of \(X+Y\) (you may want to refer to Equation <a href="#eq-mgf-chisq">eq-mgf-chisq</a>).
</p>
</div>


<div class="xca">
<p><a name="xca-diff-indep-norm" id="xca-diff-indep-norm"></a>
Show that when \(X\) and \(Y\) are independent the MGF of \(X-Y\) is \(M_{X}(t)M_{Y}(-t)\). Use this to find the distribution of \(X-Y\) when \(X\sim\mathsf{norm}(\mathtt{mean}=\mu_{1},\,\mathtt{sd}=\sigma_{1})\) and \(Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{2},\,\mathtt{sd}=\sigma_{2})\)  are independent. 
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-cha-Sampling-Distributions" class="outline-2">
<h2 id="cha-Sampling-Distributions"><a name="sec-8" id="sec-8"></a><span class="section-number-2">8</span> Sampling Distributions</h2>
<div class="outline-text-2" id="text-cha-Sampling-Distributions">




<p>
This is an important chapter; it is the bridge from probability and descriptive statistics that we studied in Chapters <a href="#sec-3">Data Description</a> through <a href="#sec-7">Multivariate Distributions</a> to inferential statistics which forms the latter part of this book.
</p>
<p>
Here is the link: we are presented with a <i>population</i> about which we would like to learn. And while it would be desirable to examine every single member of the population, we find that it is either impossible or infeasible to for us to do so, thus, we resort to collecting a <i>sample</i> instead. We do not lose heart. Our method will suffice, provided the sample is <i>representative</i> of the population. A good way to achieve this is to sample <i>randomly</i> from the population.
</p>
<p>
Supposing for the sake of argument that we have collected a random sample, the next task is to make some <i>sense</i> out of the data because the complete list of sample information is usually cumbersome, unwieldy. We summarize the data set with a descriptive <i>statistic</i>, a quantity calculated from the data (we saw many examples of these in Chapter <a href="#sec-3">Data Description</a>). But our sample was random&hellip; therefore, it stands to reason that our statistic will be random, too. How is the statistic distributed?
</p>
<p>
The probability distribution associated with the population (from which we sample) is called the <i>population distribution</i>, and the probability distribution associated with our statistic is called its <i>sampling distribution</i>; clearly, the two are interrelated. To learn about the population distribution, it is imperative to know everything we can about the sampling distribution. Such is the goal of this chapter.
</p>
<p>
We begin by introducing the notion of simple random samples and cataloguing some of their more convenient mathematical properties. Next we focus on what happens in the special case of sampling from the normal distribution (which, again, has several convenient mathematical properties), and in particular, we meet the sampling distribution of \(\overline{X}\) and \(S^{2}\). Then we explore what happens to \(\overline{X}\)'s sampling distribution when the population is not normal and prove one of the most remarkable theorems in statistics, the Central Limit Theorem (CLT).
</p>
<p>
With the CLT in hand, we then investigate the sampling distributions of several other popular statistics, taking full advantage of those with a tractable form. We finish the chapter with an exploration of statistics whose sampling distributions are not quite so tractable, and to accomplish this goal we will use simulation methods that are grounded in all of our work in the previous four chapters.
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>the notion of population versus simple random sample, parameter versus statistic, and population distribution versus sampling distribution
</li>
<li>the classical sampling distributions of the standard one and two sample statistics
</li>
<li>how to generate a simulated sampling distribution when the statistic is crazy
</li>
<li>the Central Limit Theorem, period.
</li>
<li>some basic concepts related to sampling distribution utility, such as bias and variance
</li>
</ul>



</div>

<div id="outline-container-sec-simple-random-samples" class="outline-3">
<h3 id="sec-simple-random-samples"><a name="sec-8-1" id="sec-8-1"></a><span class="section-number-3">8.1</span> Simple Random Samples</h3>
<div class="outline-text-3" id="text-sec-simple-random-samples">



<div class="defn">
<p>If \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are independent with \(X_{i}\sim f\) for \(i=1,2,\ldots,n\), then we say that \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are <i>independent and identically distributed</i> (IID) from the population \(f\) or alternatively we say that \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are a <i>simple random sample of size</i> \(n\), denoted \(SRS(n)\), from the population \(f\). 
</p>
</div>


<div class="prop">
<p><a name="pro-mean-sd-xbar" id="pro-mean-sd-xbar"></a>
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a population distribution with mean \(\mu\) and finite standard deviation \(\sigma\). Then the mean and standard deviation of \(\overline{X}\) are given by the formulas \(\mu_{\overline{X}}=\mu\) and \(\sigma_{\overline{X}}=\sigma/\sqrt{n}\).
</p>
</div>


<div class="proof">
<p>Plug in \(a_{1}=a_{2}=\cdots=a_{n}=1/n\) in Proposition <a href="#pro-mean-sd-lin-comb">pro-mean-sd-lin-comb</a>.
</p>
</div>

<p>
The next fact will be useful to us when it comes time to prove the Central Limit Theorem in Section <a href="#sec-8-3">Central Limit Theorem</a>.
</p>

<div class="prop">
<p><a name="pro-mgf-xbar" id="pro-mgf-xbar"></a>
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a population distribution with MGF \(M(t)\). Then the MGF of \(\overline{X}\) is given by
\begin{equation}
M_{\overline{X}}(t)=\left[M\left(\frac{t}{n}\right)\right]^{n}.
\end{equation}
</p>
</div>


<div class="proof">
<p>Go from the definition:
\begin{eqnarray*}
M_{\overline{X}}(t) & = & \mathbb{E}\,\mathrm{e}^{t\overline{X}},\\
 & = & \mathbb{E}\,\mathrm{e}^{t(X_{1}+\cdots+X_{n})/n},\\
 & = & \mathbb{E}\,\mathrm{e}^{tX_{1}/n}\mathrm{e}^{tX_{2}/n}\cdots\mathrm{e}^{tX_{n}/n}.
\end{eqnarray*}
And because \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are independent, Proposition <a href="#pro-indep-implies-prodexpect">pro-indep-implies-prodexpect</a> allows us to distribute the expectation among each term in the product, which is
\[
\mathbb{E}\mathrm{e}^{tX_{1}/n}\,\mathbb{E}\mathrm{e}^{tX_{2}/n}\cdots\mathbb{E}\mathrm{e}^{tX_{n}/n}.
\]
The last step is to recognize that each term in last product above is exactly \(M(t/n)\).
</p>
</div>

</div>

</div>

<div id="outline-container-sec-sampling-from-normal-dist" class="outline-3">
<h3 id="sec-sampling-from-normal-dist"><a name="sec-8-2" id="sec-8-2"></a><span class="section-number-3">8.2</span> Sampling from a Normal Distribution</h3>
<div class="outline-text-3" id="text-sec-sampling-from-normal-dist">



</div>

<div id="outline-container-sub-samp-mean-dist-of" class="outline-4">
<h4 id="sub-samp-mean-dist-of"><a name="sec-8-2-1" id="sec-8-2-1"></a><span class="section-number-4">8.2.1</span> The Distribution of the Sample Mean</h4>
<div class="outline-text-4" id="text-sub-samp-mean-dist-of">



<div class="prop">
<p>Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. Then the sample mean \(\overline{X}\) has a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma/\sqrt{n})\) sampling distribution.
</p>
</div>


<div class="proof">
<p>The mean and standard deviation of \(\overline{X}\) follow directly from Proposition <a href="#pro-mean-sd-xbar">pro-mean-sd-xbar</a>. To address the shape, first remember from Section <a href="#sec-6-3">Normal Distribution</a> that the \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) MGF is of the form
\[
M(t)=\exp\left[ \mu t+\sigma^{2}t^{2}/2\right] .
\]
Now use Proposition <a href="#pro-mgf-xbar">pro-mgf-xbar</a> to find
\begin{eqnarray*}
M_{\overline{X}}(t) & = & \left[M\left(\frac{t}{n}\right)\right]^{n},\\
 & = & \left[\exp\left( \mu(t/n)+\sigma^{2}(t/n)^{2}/2\right) \right]^{n},\\
 & = & \exp\left( \, n\cdot\left[\mu(t/n)+\sigma^{2}(t/n)^{2}/2\right]\right) ,\\
 & = & \exp\left( \mu t+(\sigma/\sqrt{n})^{2}t^{2}/2\right),
\end{eqnarray*}
and we recognize this last quantity as the MGF of a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma/\sqrt{n})\) distribution.
</p>
</div>

</div>

</div>

<div id="outline-container-sub-Samp-Var-Dist" class="outline-4">
<h4 id="sub-Samp-Var-Dist"><a name="sec-8-2-2" id="sec-8-2-2"></a><span class="section-number-4">8.2.2</span> The Distribution of the Sample Variance</h4>
<div class="outline-text-4" id="text-sub-Samp-Var-Dist">



<div class="thm">
<p><a name="thm-Xbar-andS" id="thm-Xbar-andS"></a>
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution, and let
\begin{equation}
\overline{X}=\sum_{i=1}^{n}X_{i}\quad \mbox{and}\quad S^{2}=\frac{1}{n-1}\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}.
\end{equation}
Then
</p><ol>
<li>\(\overline{X}\) and \(S^{2}\) are independent, and
</li>
<li>The rescaled sample variance
    \begin{equation}
    \frac{(n-1)}{\sigma^{2}}S^{2}=\frac{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}{\sigma^{2}}
    \end{equation}
    has a \(\mathsf{chisq}(\mathtt{df}=n-1)\) sampling distribution.
</li>
</ol>



</div>


<div class="proof">
<p>The proof is beyond the scope of the present book, but the theorem is simply too important to be omitted. The interested reader could consult Casella and Berger \cite{Casella2002}, or Hogg <i>et al</i> \cite{Hogg2005}. 
</p>
</div>

</div>

</div>

<div id="outline-container-sub-Student-s-t-Distribution" class="outline-4">
<h4 id="sub-Student-s-t-Distribution"><a name="sec-8-2-3" id="sec-8-2-3"></a><span class="section-number-4">8.2.3</span> The Distribution of Student's \(T\) Statistic</h4>
<div class="outline-text-4" id="text-sub-Student-s-t-Distribution">



<div class="prop">
<p>Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. Then the quantity 
\begin{equation}
T=\frac{\overline{X}-\mu}{S/\sqrt{n}}
\end{equation}
has a \(\mathsf{t}(\mathtt{df}=n-1)\) sampling distribution.
</p>
</div>


<div class="proof">
<p>Divide the numerator and denominator by \(\sigma\) and rewrite
\[
T=\frac{\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}}{S/\sigma}=\frac{\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}}{\sqrt{\left.\frac{(n-1)S^{2}}{\sigma^{2}}\right/ (n-1)}}.
\]
Now let 
\[
Z=\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\quad \mbox{and}\quad V=\frac{(n-1)S^{2}}{\sigma^{2}},
\]
so that
\begin{equation}
T=\frac{Z}{\sqrt{V/r}},
\end{equation}
where \(r=n-1\).
</p>
<p>
We know from Section <a href="#sec-8-2-1">Distribution of Xbar</a> that \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) and we know from Section <a href="#sec-8-2-2">Sample Variance Distribution</a> that \(V\sim\mathsf{chisq}(\mathtt{df}=n-1)\). Further, since we are sampling from a normal distribution, Theorem <a href="#thm-Xbar-andS">Xbar and S</a> gives that \(\overline{X}\) and \(S^{2}\) are independent and by Fact <a href="#fac-indep-then-function-indep">fac-indep-then-function-indep</a> so are \(Z\) and \(V\). In summary, the distribution of \(T\) is the same as the distribution of the quantity \(Z/\sqrt{V/r}\), where \(Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) and \(V\sim\mathsf{chisq}(\mathtt{df}=r)\) are independent. This is in fact the definition of Student's \(t\) distribution.
</p>
</div>

<p>
This distribution was first published by W. S. Gosset (1900) under the pseudonym Student, and the distribution has consequently come to be known as Student's \(t\) distribution. The PDF of \(T\) can be derived explicitly using the techniques of Section <a href="#sec-6-4">Functions of Continuous Random Variables</a>; it takes the form 
\begin{equation}
f_{X}(x)=\frac{\Gamma[(r+1)/2]}{\sqrt{r\pi}\ \Gamma(r/2)}\left(1+\frac{x^{2}}{r}\right)^{-(r+1)/2},\quad -\infty < x < \infty.
\end{equation}
Any random variable \(X\) with the preceding PDF is said to have Student's \(t\) distribution with \(r\) <i>degrees of freedom</i>, and we write \(X\sim\mathsf{t}(\mathtt{df}=r)\). The shape of the PDF is similar to the normal, but the tails are considerably heavier. See Figure <a href="#fig-Student-s-t-dist-vary-df">Student's-t-dist-vary-df</a>. As with the normal distribution, there are four functions in \(\mathsf{R}\) associated with the \(t\) distribution, namely <code>dt</code>, <code>pt</code>,=qt=, and <code>rt</code>, which compute the PDF, CDF, quantile function, and generate random variates, respectively.
</p>
<p>
The code to produce Figure <a href="#fig-Student-s-t-dist-vary-df">Student's-t-dist-vary-df</a> is
</p>



<pre class="src src-R">curve(dt(x, df = 30), from = -3, to = 3, lwd = 3, ylab = <span style="font-style: italic;">"y"</span>)
ind <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(1, 2, 3, 5, 10)
<span style="font-weight: bold;">for</span> (i <span style="font-weight: bold;">in</span> ind) curve(dt(x, df = i), -3, 3, add = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>







<div id="fig-Student's-t-dist-vary-df" class="figure">
  <p><img src="svg/sampdist/Student's-t-dist-vary-df.svg" width=500 alt="svg/sampdist/Student's-t-dist-vary-df.svg" /></p>
  <p>A plot of Student's t distribution for various degrees of freedom.</p>
</div>

<p>
Similar to that done for the normal we may define \(\mathsf{t}_{\alpha}(\mathtt{df}=n-1)\) as the number on the \(x\)-axis such that there is exactly \(\alpha\) area under the \(\mathsf{t}(\mathtt{df}=n-1)\) curve to its right.
</p>

<div class="exampletoo">
<p>Find \(\mathsf{t}{}_{0.01}(\mathtt{df}=23)\) with the quantile function.
</p>
</div>




<pre class="src src-R">qt(0.01, df = 23, lower.tail = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>


<pre class="example">
[1] 2.499867
</pre>



<div class="rem">
<p>There are a few things to note about the \(\mathtt{t}(\mathtt{df}=r)\) distribution.
</p><ol>
<li>The \(\mathtt{t}(\mathtt{df}=1)\) distribution is the same as the \(\mathsf{cauchy}(\mathtt{location}=0,\,\mathtt{scale}=1)\) distribution. The Cauchy distribution is rather pathological and is a counterexample to many famous results. 
</li>
<li>The standard deviation of \(\mathsf{t}(\mathtt{df}=r)\) is undefined (that is, infinite) unless \(r&gt;2\). When \(r\) is more than 2, the standard deviation is always bigger than one, but decreases to 1 as \(r\to\infty\).
</li>
<li>As \(r\to\infty\), the \(\mathtt{t}(\mathtt{df}=r)\) distribution approaches the \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) distribution.
</li>
</ol>



</div>

</div>
</div>

</div>

<div id="outline-container-sec-Central-Limit-Theorem" class="outline-3">
<h3 id="sec-Central-Limit-Theorem"><a name="sec-8-3" id="sec-8-3"></a><span class="section-number-3">8.3</span> The Central Limit Theorem</h3>
<div class="outline-text-3" id="text-sec-Central-Limit-Theorem">


<p>
In this section we study the distribution of the sample mean when the underlying distribution is <i>not</i> normal. We saw in Section <a href="#sec-8-2">Sampling from Normal</a> that when \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n}\) is a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution then \(\overline{X}\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma/\sqrt{n})\). In other words, we may say (owing to Fact <a href="#fac-lin-trans-norm-is-norm">fac-lin-trans-norm-is-norm</a>) when the underlying population is normal that the sampling distribution of \(Z\) defined by
\begin{equation}
Z=\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}
\end{equation}
is \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\). 
</p>
<p>
However, there are many populations that are <i>not</i> normal &hellip; and the statistician often finds herself sampling from such populations. What can be said in this case? The surprising answer is contained in the following theorem.
</p>

<div class="thm">
<p><a name="thm-central-limit-thrm" id="thm-central-limit-thrm"></a>
<b>The Central Limit Theorem.</b> Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a population distribution with mean \(\mu\) and finite standard deviation \(\sigma\). Then the sampling distribution of 
\begin{equation}
Z=\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}
\end{equation}
approaches a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) distribution as \(n\to\infty\).
</p>
</div>


<div class="rem">
<p>We suppose that \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n}\) are IID, and we learned in Section <a href="#sec-8-1">Simple Random Samples</a> that \(\overline{X}\) has mean \(\mu\) and standard deviation \(\sigma/\sqrt{n}\), so we already knew that \(Z\) has mean zero and standard deviation one. The beauty of the CLT is that it addresses the <i>shape</i> of \(Z\)'s distribution when the sample size is large.
</p>
</div>


<div class="rem">
<p>Notice that the shape of the underlying population's distribution is not mentioned in Theorem <a href="#thm-central-limit-thrm">CLT</a>; indeed, the result is true for any population that is well-behaved enough to have a finite standard deviation. In particular, if the population is normally distributed then we know from Section <a href="#sec-8-2-1">Distribution of Xbar</a> that the distribution of \(\overline{X}\) (and \(Z\) by extension) is <i>exactly</i> normal, for <i>every</i> \(n\).
</p>
</div>


<div class="rem">
<p>How large is ``sufficiently large''? It is here that the shape of the underlying population distribution plays a role. For populations with distributions that are approximately symmetric and mound-shaped, the samples may need to be only of size four or five, while for highly skewed or heavy-tailed populations the samples may need to be much larger for the distribution of the sample means to begin to show a bell-shape. Regardless, for a given population distribution (with finite standard deviation) the approximation tends to be better for larger sample sizes.
</p>
</div>


</div>

<div id="outline-container-8-3-1" class="outline-4">
<h4 id="sec-8-3-1"><span class="section-number-4">8.3.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-8-3-1">


<p>
The <code>TeachingDemos</code> package \cite{Snowteachingdemos} has <code>clt.examp</code> and the <code>distrTeach</code> \cite{Ruckdescheldistr} package has <code>illustrateCLT</code>. Try the following at the command line (output omitted):
</p>


<pre class="src src-R">example(clt.examp)
</pre>

<p>
and
</p>


<pre class="src src-R">example(illustrateCLT)
</pre>


<p>
The <code>IPSUR</code>  package has the functions <code>clt1</code>, <code>clt2</code>, and <code>clt3</code> (see Exercise <a href="#xca-clt123">clt123</a> at the end of this chapter). Its purpose is to investigate what happens to the sampling distribution of \(\overline{X}\) when the population distribution is mound shaped, finite support, and skewed, namely \(\mathsf{t}(\mathtt{df}=3)\), \(\mathsf{unif}(\mathtt{a}=0,\,\mathtt{b}=10)\), and \(\mathsf{gamma}(\mathtt{shape}=1.21,\,\mathtt{scale}=1/2.37)\), respectively. 
</p>
<p>
For example, when the command <code>clt1()</code>  is issued a plot window opens to show a graph of the PDF of a \(\mathsf{t}(\mathtt{df}=3)\) distribution. On the display are shown numerical values of the population mean and variance. While the students examine the graph the computer is simulating random samples of size <code>sample.size = 2</code> from the population distribution <code>rt</code> a total of <code>N.iter = 100000</code> times, and sample means are calculated of each sample. Next follows a histogram of the simulated sample means, which closely approximates the sampling distribution of \(\overline{X}\), see Section <a href="#sec-8-5">Simulated Sampling Distributions</a>. Also shown are the sample mean and sample variance of all of the simulated  \( \overline{X} \) values. As a final step, when the student clicks the second plot, a normal curve with the same mean and variance as the simulated \( \overline{X} \) values is superimposed over the histogram. Students should compare the population theoretical mean and variance to the simulated mean and variance of the sampling distribution. They should also compare the shape of the simulated sampling distribution to the shape of the normal distribution.
</p>
<p>
The three separate <code>clt1</code>, <code>clt2</code>, and <code>clt3</code> functions were written so that students could compare what happens overall when the shape of the population distribution changes. It would be possible to combine all three into one big function, <code>clt</code> which covers all three cases (and more). 
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Samp-Dist-Two-Samp" class="outline-3">
<h3 id="sec-Samp-Dist-Two-Samp"><a name="sec-8-4" id="sec-8-4"></a><span class="section-number-3">8.4</span> Sampling Distributions of Two-Sample Statistics</h3>
<div class="outline-text-3" id="text-sec-Samp-Dist-Two-Samp">


<p>
There are often two populations under consideration, and it sometimes of interest to compare properties between groups. To do so we take independent samples from each population and calculate respective sample statistics for comparison. In some simple cases the sampling distribution of the comparison is known and easy to derive; such cases are the subject of the present section.
</p>

</div>

<div id="outline-container-8-4-1" class="outline-4">
<h4 id="sec-8-4-1"><span class="section-number-4">8.4.1</span> Difference of Independent Sample Means</h4>
<div class="outline-text-4" id="text-8-4-1">



<div class="prop">
<p>Let \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n_{1}}\) be an \(SRS(n_{1})\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})\) distribution and let \(Y_{1}\), \(Y_{2}\), &hellip; , \(Y_{n_{2}}\) be an \(SRS(n_{2})\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})\) distribution. Suppose that \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n_{1}}\) and \(Y_{1}\), \(Y_{2}\), &hellip; , \(Y_{n_{2}}\) are independent samples. Then the quantity
\begin{equation}
\frac{\overline{X}-\overline{Y}-(\mu_{X}-\mu_{Y})}{\sqrt{\left.\sigma_{X}^{2}\right/ n_{1}+\left.\sigma_{Y}^{2}\right/ n_{2}}}
\end{equation}
<a name="eq-diff-indep-sample-means" id="eq-diff-indep-sample-means"></a>
has a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) sampling distribution. Equivalently, \(\overline{X}-\overline{Y}\) has a \(\mathsf{norm}(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sqrt{\left.\sigma_{X}^{2}\right/ n_{1}+\left.\sigma_{Y}^{2}\right/ n_{2}})\) sampling distribution.
</p>
</div>


<div class="proof">
<p>We know that \(\overline{X}\) is \(\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X}/\sqrt{n_{1}})\) and we also know that \(\overline{Y}\) is \(\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y}/\sqrt{n_{2}})\). And since the samples \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n_{1}}\) and \(Y_{1}\), \(Y_{2}\), &hellip;, \(Y_{n_{2}}\) are independent, so too are \(\overline{X}\) and \(\overline{Y}\). The distribution of their difference is thus normal as well, and the mean and standard deviation are given by Proposition <a href="#pro-mean-sd-lin-comb-two">pro-mean-sd-lin-comb-two</a>.
</p>
</div>


<div class="rem">
<p>Even if the distribution of one or both of the samples is not normal, the quantity in Equation <a href="#eq-diff-indep-sample-means">eq-diff-indep-sample-means</a> will be approximately normal provided both sample sizes are large.
</p>
</div>


<div class="rem">
<p>For the special case of \(\mu_{X}=\mu_{Y}\) we have shown that 
\begin{equation} \frac{\overline{X}-\overline{Y}}{\sqrt{\sigma_{X}^{2}/n_{1}+\sigma_{Y}^{2}/n_{2}}}
\end{equation}
has a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) sampling distribution, or in other words, \(\overline{X}-\overline{Y}\) has a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sqrt{\sigma_{X}^{2}/n_{1}+\sigma_{Y}^{2}/n_{2}})\) sampling distribution. This will be important when it comes time to do hypothesis tests; see Section <a href="#sec-9-3">Confidence Intervals for Difference of Means</a>.
</p>
</div>

</div>

</div>

<div id="outline-container-8-4-2" class="outline-4">
<h4 id="sec-8-4-2"><span class="section-number-4">8.4.2</span> Difference of Independent Sample Proportions</h4>
<div class="outline-text-4" id="text-8-4-2">



<div class="prop">
<p>Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n_{1}}\) be an \(SRS(n_{1})\) from a \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p_{1})\) distribution and let \(Y_{1}\), \(Y_{2}\), &hellip;, \(Y_{n_{2}}\) be an \(SRS(n_{2})\) from a \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p_{2})\) distribution. Suppose that \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n_{1}}\) and \(Y_{1}\), \(Y_{2}\), &hellip; , \(Y_{n_{2}}\) are independent samples. Define 
\begin{equation}
\hat{p}_{1}=\frac{1}{n_{1}}\sum_{i=1}^{n_{1}}X_{i}\quad \mbox{and}\quad \hat{p}_{2}=\frac{1}{n_{2}}\sum_{j=1}^{n_{2}}Y_{j}.
\end{equation}
Then the sampling distribution of
\begin{equation}
\frac{\hat{p}_{1}-\hat{p}_{2}-(p_{1}-p_{2})}{\sqrt{\frac{p_{1}(1-p_{1})}{n_{1}}+\frac{p_{2}(1-p_{2})}{n_{2}}}}
\end{equation}
approaches a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) distribution as both \(n_{1},\, n_{2}\to\infty\). In other words, the sampling distribution of \(\hat{p}_{1}-\hat{p}_{2}\) is approximately
\begin{equation}
\mathsf{norm}\left(\mathtt{mean}=p_{1}-p_{2},\,\mathtt{sd}=\sqrt{\frac{p_{1}(1-p_{1})}{n_{1}}+\frac{p_{2}(1-p_{2})}{n_{2}}}\right),
\end{equation}
provided both \(n_{1}\) and \(n_{2}\) are sufficiently large.
</p>
</div>


<div class="proof">
<p>We know that \(\hat{p}_{1}\) is approximately normal for \(n_{1}\) sufficiently large by the CLT, and we know that \(\hat{p}_{2}\) is approximately normal for \(n_{2}\) sufficiently large, also by the CLT. Further, \(\hat{p}_{1}\) and \(\hat{p}_{2}\) are independent since they are derived from independent samples. And a difference of independent (approximately) normal distributions is (approximately) normal, by Exercise <a href="#xca-diff-indep-norm">xca-diff-indep-norm</a>.
The expressions for the mean and standard deviation follow immediately from Proposition <a href="#pro-mean-sd-lin-comb-two">pro-mean-sd-lin-comb-two</a> combined with the formulas for the \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\) distribution from Chapter <a href="#sec-5">Discrete Distributions</a>.
</p>
</div>

</div>

</div>

<div id="outline-container-8-4-3" class="outline-4">
<h4 id="sec-8-4-3"><span class="section-number-4">8.4.3</span> Ratio of Independent Sample Variances</h4>
<div class="outline-text-4" id="text-8-4-3">



<div class="prop">
<p>Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n_{1}}\) be an \(SRS(n_{1})\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})\) distribution and let \(Y_{1}\), \(Y_{2}\), &hellip; , \(Y_{n_{2}}\) be an \(SRS(n_{2})\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})\) distribution. Suppose that \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n_{1}}\) and \(Y_{1}\), \(Y_{2}\), &hellip; , \(Y_{n_{2}}\) are independent samples. Then the ratio
\begin{equation}
F=\frac{\sigma_{Y}^{2}S_{X}^{2}}{\sigma_{X}^{2}S_{Y}^{2}}
\end{equation}
has an \(\mathsf{f}(\mathtt{df1}=n_{1}-1,\,\mathtt{df2}=n_{2}-1)\) sampling distribution.
</p>
</div>


<div class="proof">
<p>We know from Theorem <a href="#thm-Xbar-andS">Xbar and S</a> that \((n_{1}-1)S_{X}^{2}/\sigma_{X}^{2}\) is distributed \(\mathsf{chisq}(\mathtt{df}=n_{1}-1)\) and \((n_{2}-1)S_{Y}^{2}/\sigma_{Y}^{2}\) is distributed \(\mathsf{chisq}(\mathtt{df}=n_{2}-1)\). Now write
\[
F=\frac{\sigma_{Y}^{2}S_{X}^{2}}{\sigma_{X}^{2}S_{Y}^{2}}=\frac{\left.(n_{1}-1)S_{Y}^{2}\right/ (n_{1}-1)}{\left.(n_{2}-1)S_{Y}^{2}\right/ (n_{2}-1)}\cdot\frac{\left.1\right/ \sigma_{X}^{2}}{\left.1\right/ \sigma_{Y}^{2}},
\]
by multiplying and dividing the numerator with \(n_{1}-1\) and doing likewise for the denominator with \(n_{2}-1\). Now we may regroup the terms into
\[
F=\frac{\left.\frac{(n_{1}-1)S_{X}^{2}}{\sigma_{X}^{2}}\right/ (n_{1}-1)}{\left.\frac{(n_{2}-1)S_{Y}^{2}}{\sigma_{Y}^{2}}\right/ (n_{2}-1)},
\]
and we recognize \(F\) to be the ratio of independent \(\mathsf{chisq}\) distributions, each divided by its respective numerator \(\mathtt{df}=n_{1}-1\) and denominator \(\mathtt{df}=n_{1}-1\) degrees of freedom. This is, indeed, the definition of Snedecor's \(F\) distribution. 
</p>
</div>


<div class="rem">
<p>For the special case of \(\sigma_{X}=\sigma_{Y}\) we have shown that
\begin{equation}
F=\frac{S_{X}^{2}}{S_{Y}^{2}}
\end{equation}
has an \(\mathsf{f}(\mathtt{df1}=n_{1}-1,\,\mathtt{df2}=n_{2}-1)\) sampling distribution. This will be important in Chapters <a href="#sec-9">Estimation</a> onward.
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sec-Simulated-Sampling-Distributions" class="outline-3">
<h3 id="sec-Simulated-Sampling-Distributions"><a name="sec-8-5" id="sec-8-5"></a><span class="section-number-3">8.5</span> Simulated Sampling Distributions</h3>
<div class="outline-text-3" id="text-sec-Simulated-Sampling-Distributions">


<p>
Some comparisons are meaningful, but their sampling distribution is not quite so tidy to describe analytically. What do we do then?
</p>
<p>
As it turns out, we do not need to know the exact analytical form of the sampling distribution; sometimes it is enough to approximate it with a simulated distribution. In this section we will show you how. Note that \(\mathsf{R}\) is particularly well suited to compute simulated sampling distributions, much more so than, say, SPSS or SAS.
</p>

</div>

<div id="outline-container-8-5-1" class="outline-4">
<h4 id="sec-8-5-1"><span class="section-number-4">8.5.1</span> The Interquartile Range</h4>
<div class="outline-text-4" id="text-8-5-1">





<pre class="src src-R">iqrs <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> replicate(100, IQR(rnorm(100)))
</pre>


<p>
We can look at the mean of the simulated values
</p>


<pre class="src src-R">mean(iqrs)    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">close to 1</span>
</pre>


<pre class="example">
[1] 1.343608
</pre>


<p>
and we can see the standard deviation
</p>


<pre class="src src-R">sd(iqrs)
</pre>


<pre class="example">
[1] 0.1624308
</pre>


<p>
Now let's take a look at a plot of the simulated values
</p>



<pre class="src src-R">hist(iqrs, breaks = 20)
</pre>







<div id="fig-simulated-IQR" class="figure">
  <p><img src="svg/sampdist/simulated-IQR.svg" width=500 alt="svg/sampdist/simulated-IQR.svg" /></p>
  <p>A plot of simulated IQRs.</p>
</div>

</div>

</div>

<div id="outline-container-8-5-2" class="outline-4">
<h4 id="sec-8-5-2"><span class="section-number-4">8.5.2</span> The Median Absolute Deviation</h4>
<div class="outline-text-4" id="text-8-5-2">





<pre class="src src-R">mads <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> replicate(100, mad(rnorm(100)))
</pre>


<p>
We can look at the mean of the simulated values
</p>



<pre class="src src-R">mean(mads)    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">close to 1.349</span>
</pre>


<pre class="example">
[1] 1.002832
</pre>


<p>
and we can see the standard deviation
</p>



<pre class="src src-R">sd(mads)
</pre>


<pre class="example">
[1] 0.1085052
</pre>


<p>
Now let's take a look at a plot of the simulated values
</p>



<pre class="src src-R">hist(mads, breaks = 20)
</pre>







<div id="fig-simulated-MAD" class="figure">
  <p><img src="svg/sampdist/simulated-MAD.svg" width=500 alt="svg/sampdist/simulated-MAD.svg" /></p>
  <p>A plot of simulated MADs.</p>
</div>


</div>
</div>

</div>

<div id="outline-container-8-6" class="outline-3">
<h3 id="sec-8-6"><span class="section-number-3">8.6</span> Exercises</h3>
<div class="outline-text-3" id="text-8-6">





<div class="xca">
<p>Suppose that we observe a random sample \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n}\) of size SRS( n =  \(SRC_R{n[1]}\) ) from a \( \mathsf{norm}(\mathtt{mean}= SRC_R{mu[1]} ) \) distribution. 
</p><ol>
<li>What is the mean of \(\overline{X}\)?
</li>
<li>What is the standard deviation of \(\overline{X}\)?
</li>
<li>What is the distribution of \(\overline{X}\)? (approximately)
</li>
<li>Find \(\mathbb{P}(a&lt; \overline{X} \leq b)\)
</li>
<li>Find \(\mathbb{P}(\overline{X} &gt; c)\).
</li>
</ol>



</div>


<div class="xca">
<p><a name="xca-clt123" id="xca-clt123"></a>
In this exercise we will investigate how the shape of the population distribution affects the time until the distribution of \(\overline{X}\) is acceptably normal.
</p>
</div>


<div class="xca">
<p>Let \(X_{1}\),&hellip;, \(X_{25}\) be a random sample from a \(\mathsf{norm}(\mathtt{mean}=37,\,\mathtt{sd}=45)\) distribution, and let \(\overline{X}\) be the sample mean of these \(n=25\) observations.
</p><ol>
<li>How is \(\overline{X}\) distributed? 
   \(\mathsf{norm}(\mathtt{mean}=37,\,\mathtt{sd}=45/\sqrt{25})\) 
</li>
<li>Find \(\mathbb{P}(\overline{X} &gt; 43.1)\).
</li>
</ol>

<p>And that's all she wrote.
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-cha-Estimation" class="outline-2">
<h2 id="cha-Estimation"><a name="sec-9" id="sec-9"></a><span class="section-number-2">9</span> Estimation</h2>
<div class="outline-text-2" id="text-cha-Estimation">




<p>
We will discuss two branches of estimation procedures: point estimation and interval estimation. We briefly discuss point estimation first and then spend the rest of the chapter on interval estimation.
</p>
<p>
We find an estimator with the methods of Section <a href="#sec-9-1">Point Estimation 1</a>. We make some assumptions about the underlying population distribution and use what we know from Chapter <a href="#sec-8">Sampling Distributions</a> about sampling distributions both to study how the estimator will perform, and to find intervals of confidence for underlying parameters associated with the population distribution. Once we have confidence intervals we can do inference in the form of hypothesis tests in the next chapter.
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>how to look at a problem, identify a reasonable model, and estimate a parameter associated with the model
</li>
<li>about maximum likelihood, and in particular, how to
<ul>
<li>eyeball a likelihood to get a maximum
</li>
<li>use calculus to find an MLE for one-parameter families
</li>
</ul>

</li>
<li>about properties of the estimators they find, such as bias, minimum variance, MSE
</li>
<li>point versus interval estimation, and how to find and interpret confidence intervals for basic experimental designs
</li>
<li>the concept of margin of error and its relationship to sample size
</li>
</ul>



</div>

<div id="outline-container-sec-Point-Estimation-1" class="outline-3">
<h3 id="sec-Point-Estimation-1"><a name="sec-9-1" id="sec-9-1"></a><span class="section-number-3">9.1</span> Point Estimation</h3>
<div class="outline-text-3" id="text-sec-Point-Estimation-1">


<p>
The following example is how I was introduced to maximum likelihood.
</p>

<div class="exampletoo">
<p><a name="exa-how-many-fish" id="exa-how-many-fish"></a>
Suppose we have a small pond in our backyard, and in the pond there live some fish. We would like to know how many fish live in the pond. How can we estimate this? One procedure developed by researchers is the capture-recapture method. Here is how it works.
</p>
<p>
We will fish from the pond and suppose that we capture \(M=7\) fish. On each caught fish we attach an unobtrusive tag to the fish's tail, and release it back into the water. 
</p>
<p>
Next, we wait a few days for the fish to remix and become accustomed to their new tag. Then we go fishing again. On the second trip some of the fish we catch may be tagged; some may not be. Let \(X\) denote the number of caught fish which are tagged
and suppose for the sake of argument that we catch \(K=4\) fish and we find that 3 of them are tagged.
</p>
<p>
Now let \(F\) denote the (unknown) total number of fish in the pond. We know that \(F\geq7\), because we tagged that many on the first trip. In fact, if we let \(N\) denote the number of untagged fish in the pond, then \(F=M+N\). We have sampled \(K=4\) times, without replacement, from an urn which has \(M=7\) white balls and \(N=F-M\) black balls, and we have observed \(x=3\) of them to be white. What is the probability of this?
</p>
<p>
Looking back to Section <a href="#sec-5-6">Other Discrete Distributions</a>, we see that the random variable \(X\) has a \(\mathsf{hyper}(\mathtt{m}=M,\,\mathtt{n}=F-M,\,\mathtt{k}=K)\) distribution. Therefore, for an observed value \(X=x\) the probability would be
\[
\mathbb{P}(X=x)=\frac{{M \choose x}{F-M \choose K-x}}{{F \choose K}}.
\]
First we notice that \(F\) must be at least 7. Could \(F\) be equal to seven? If \(F=7\) then all of the fish would have been tagged on the first run, and there would be no untagged fish in the pond, thus, \(\mathbb{P}(\mbox{3 successes in 4 trials})=0\). 
What about \(F=8\); what would be the probability of observing \(X=3\) tagged fish?
\[
\mathbb{P}(\mbox{3 successes in 4 trials})=\frac{{7 \choose 3}{1 \choose 1}}{{8 \choose 4}}=\frac{35}{70}=0.5.
\]
Similarly, if \(F=9\) then the probability of observing \(X=3\) tagged fish would be
\[
\mathbb{P}(\mbox{3 successes in 4 trials})=\frac{{7 \choose 3}{2 \choose 1}}{{9 \choose 4}}=\frac{70}{126}\approx0.556.
\]
We can see already that the observed data \(X=3\) is more likely when \(F=9\) than it is when \(F=8\). And here lies the genius of Sir Ronald Aylmer Fisher: he asks, ``What is the value of \(F\) which has the highest likelihood?'' In other words, for all of the different possible values of \(F\), which one makes the above probability the biggest? We can answer this question with a plot of \(\mathbb{P}(X=x)\) versus \(F\). See Figure <a href="#fig-capture-recapture">capture-recapture</a>.
</p>
</div>










<div id="fig-capture-recapture" class="figure">
  <p><img src="svg/estimate/capture-recapture.svg" width=500 alt="svg/estimate/capture-recapture.svg" /></p>
  <p>A plot of maximum likelihood for the capture-recapture experiment.</p>
</div>


<div class="exampletoo">
<p><a name="exa-bass-bluegill" id="exa-bass-bluegill"></a>
In the last example we were only concerned with how many fish were in the pond, but now, we will ask a different question. Suppose it is known that there are only two species of fish in the pond: smallmouth bass (<i>Micropterus dolomieu</i>) and bluegill (<i>Lepomis macrochirus</i>); perhaps we built the pond some years ago and stocked it with only these two species. We would like to estimate the proportion of fish in the pond which are bass.
</p>
<p>
Let \(p=\mbox{the proportion of bass}\). Without any other information, it is conceivable for \(p\) to be any value in the interval \([0,1]\), but for the sake of argument we will suppose that \(p\) falls strictly between zero and one. How can we learn about the true value of \(p\)? Go fishing! As before, we will use catch-and-release, but unlike before, we will not tag the fish. We will simply note the species of any caught fish before returning it to the pond. 
</p>
<p>
Suppose we catch \(n\) fish. Let
\[
X_{i}=
\begin{cases}
1, & \mbox{if the \(i\mathrm{th}\) fish is a bass,}\\
0, & \mbox{if the \(i\mathrm{th}\) fish is a bluegill.}
\end{cases}
\]
Since we are returning the fish to the pond once caught, we may think of this as a sampling scheme with replacement where the proportion of bass \(p\) does not change. Given that we allow the fish sufficient time to ``mix'' once returned, it is not completely unreasonable to model our fishing experiment as a sequence of Bernoulli trials, so that the \(X_{i}\)'s would be IID \(\mathsf{binom(\mathtt{size}}=1,\,\mathtt{prob}=p)\). Under those assumptions we would have
\begin{eqnarray*}
\mathbb{P}(X_{1}=x_{1},\, X_{2}=x_{2},\,\ldots,\, X_{n}=x_{n}) & = & \mathbb{P}(X_{1}=x_{1})\,\mathbb{P}(X_{2}=x_{2})\,\cdots\mathbb{P}(X_{n}=x_{n}),\\
 & = & p^{x_{1}}(1-p)^{x_{1}}\, p^{x_{2}}(1-p)^{x_{2}}\cdots\, p^{x_{n}}(1-p)^{x_{n}},\\
 & = & p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\end{eqnarray*}
That is, 
\[
\mathbb{P}(X_{1}=x_{1},\, X_{2}=x_{2},\,\ldots,\, X_{n}=x_{n})=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\]
This last quantity is a function of \(p\), called the <i>likelihood function</i> \(L(p)\):
\[
L(p)=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\]
A graph of \(L\) for values of \(\sum x_{i}=3,\ 4\), and 5 when \(n=7\) is shown in Figure <a href="#fig-fishing-part-two">fishing-part-two</a>. 
</p>



<pre class="src src-R">curve(x^5*(1-x)^2, 0, 1, xlab = <span style="font-style: italic;">"p"</span>, ylab = <span style="font-style: italic;">"L(p)"</span>)
curve(x^4*(1-x)^3, 0, 1, add = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
curve(x^3*(1-x)^4, 0, 1, add = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>



<pre class="src src-R">  &lt;&lt;fishing-part-two&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;fishing-part-two&gt;&gt;
</pre>



<div id="fig-fishing-part-two" class="figure">
  <p><img src="svg/estimate/fishing-part-two.svg" width=500 alt="svg/estimate/fishing-part-two.svg" /></p>
  <p>Assorted likelihood functions for fishing, part two.</p>
</div>

<p>
We want the value of \(p\) which has the highest likelihood, that is, we again wish to maximize the likelihood. We know from calculus (see Appendix <a href="#sec-21-2">Differential and Integral Calculus</a>) to differentiate \(L\) and set \(L'=0\) to find a maximum.
\[
L'(p)=\left(\sum x_{i}\right)p^{\sum x_{i}-1}(1-p)^{n-\sum x_{i}}+p^{\sum x_{i}}\left(n-\sum x_{i}\right)(1-p)^{n-\sum x_{i}-1}(-1).
\]
The derivative vanishes (\(L'=0\)) when
\begin{eqnarray*}
\left(\sum x_{i}\right)p^{\sum x_{i}-1}(1-p)^{n-\sum x_{i}} & = & p^{\sum x_{i}}\left(n-\sum x_{i}\right)(1-p)^{n-\sum x_{i}-1},\\
\sum x_{i}(1-p) & = & \left(n-\sum x_{i}\right)p,\\
\sum x_{i}-p\sum x_{i} & = & np-p\sum x_{i},\\
\frac{1}{n}\sum_{i=1}^{n}x_{i} & = & p.
\end{eqnarray*}
This ``best'' \(p\), the one which maximizes the likelihood, is called the maximum likelihood estimator (MLE) of \(p\) and is denoted \(\hat{p}\). That is, 
\begin{equation} 
\hat{p}=\frac{\sum_{i=1}^{n}x_{i}}{n}=\overline{x}.
\end{equation}

</p>
<div class="rem">
<p>Strictly speaking we have only shown that the derivative equals zero at \(\hat{p}\), so it is theoretically possible that the critical value \(\hat{p}=\overline{x}\) is located at a minimum
instead of a maximum! We should be thorough and check that \(L'&gt;0\) when \(p&lt;\overline{x}\) and \(L'&lt;0\) when \(p&gt;\overline{x}\). Then by the First Derivative Test (Theorem <a href="#thm-First-Derivative-Test">FDT</a>) we could be certain that \(\hat{p}=\overline{x}\) is indeed a maximum likelihood estimator, and not a minimum likelihood estimator.
</p>
</div>

<p>
The result is shown in Figure <a href="#fig-species-mle">species-mle</a>.
</p>
</div>










<div id="fig-species-mle" class="figure">
  <p><img src="svg/estimate/species-mle.svg" width=500 alt="svg/estimate/species-mle.svg" /></p>
  <p>Species maximum likelihood.</p>
</div>

<p>
In general, we have a family of PDFs \(f(x|\theta)\) indexed by a parameter \(\theta\) in some parameter space \(\Theta\). We want to learn about \(\theta\). We take a \(SRS(n)\):
\begin{equation}
X_{1},\, X_{2},\,\ldots,X_{n}\mbox{ which are IID \( f(x| \theta ) \).}
\end{equation}

</p>
<div class="defn">
<p>Given the observed data \(x_{1}\), \(x_{2}\), &hellip;, \(x_{n}\), the <i>likelihood function</i> \(L\) is defined by 
\[ 
L(\theta)=\prod_{i=1}^{n}f(x_{i}|\theta),\quad \theta\in\Theta.
\]
</p>
</div>

<p>
The next step is to maximize \(L\). The method we will use in this book is to find the derivative \(L'\) and solve the equation \(L'(\theta)=0\). Call a solution \(\hat{\theta}\). We will check that \(L\) is maximized at \(\hat{\theta}\) using the First Derivative Test or the Second Derivative Test \(\left(L''(\hat{\theta})&lt;0\right)\).
</p>

<div class="defn">
<p>A value \(\theta\) that maximizes \(L\) is called a <i>maximum likelihood estimator</i> (MLE) and is denoted \(\hat{\theta}\). It is a function of the sample, \(\hat{\theta}=\hat{\theta}\left(X_{1},\, X_{2},\,\ldots,X_{n}\right)\), and is called a <i>point estimator</i> of \(\theta\).
</p>
</div>


<div class="rem">
<p>Some comments about maximum likelihood estimators:
</p><ul>
<li>Often it is easier to maximize the <i>log-likelihood</i> \(l(\theta)=\ln L(\theta)\) instead of the likelihood \(L\). Since the logarithmic function \(y=\ln x\) is a monotone transformation, the solutions to both problems are the same.
</li>
<li>MLEs do not always exist (for instance, sometimes the likelihood has a vertical asymptote), and even when they do exist, they are not always unique (imagine a function with a bunch of humps of equal height). For any given problem, there could be zero, one, or any number of values of \(\theta\) for which \(L(\theta)\) is a maximum.
</li>
<li>The problems we encounter in this book are all very nice with likelihood functions that have closed form representations and which are optimized by some calculus acrobatics. In practice, however, likelihood functions are sometimes nasty in which case we are obliged to use numerical methods to find maxima (if there are any).
</li>
<li>MLEs are just one of <span style="text-decoration:underline;">many</span> possible estimators. One of the more popular alternatives are the <i>method of moments estimators</i>; see Casella and Berger \cite{Casella2002} for more.
</li>
</ul>



</div>

<p>
Notice, in Example <a href="#exa-bass-bluegill">exa-bass-bluegill</a> we had \(X_{i}\) IID \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\), and we saw that the MLE was \(\hat{p}=\overline{X}\). But further
\begin{eqnarray*}
\mathbb{E}\overline{X} & = & \mathbb{E}\frac{X_{1}+X_{2}+\cdots+X_{n}}{n},\\
 & = & \frac{1}{n}\left(\mathbb{E} X_{1}+\mathbb{E} X_{2}+\cdots+\mathbb{E} X_{n}\right),\\
 & = & \frac{1}{n}\left(np\right),\\
 & = & p,
\end{eqnarray*}
which is exactly the same as the parameter which we estimated. More concisely, \(\mathbb{E}\hat{p}=p\), that is, on the average, the estimator is exactly right.
</p>

<div class="defn">
<p>Let \(s(X_{1},X_{2},\ldots,X_{n})\) be a statistic which estimates \(\theta\). If 
\[
\mathbb{E} s(X_{1},X_{2},\ldots,X_{n})=\theta,
\]
then the statistic \(s(X_{1},X_{2},\ldots,X_{n})\) is said to be an <i>unbiased estimator</i> of \(\theta\). Otherwise, it is <i>biased</i>.
</p>
</div>


<div class="exampletoo">
<p><a name="exa-normal-MLE-both" id="exa-normal-MLE-both"></a>
</p>
<p>
Let \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n}\) be an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. It can be shown (in Exercise <a href="#xca-norm-mu-sig-MLE">xca-norm-mu-sig-MLE</a>) that if \(\mbox{$\theta$}=(\mu,\sigma^{2})\) then the MLE of \(\theta\) is
\begin{equation}
\hat{\theta}=(\hat{\mu},\hat{\sigma}^{2}),
\end{equation}
where \(\hat{\mu}=\overline{X}\) and
\begin{equation}
\hat{\sigma^{2}}=\frac{1}{n}\sum_{i=1}^{n}\left(X_{i}-\overline{X}\right)^{2}=\frac{n-1}{n}S^{2}.
\end{equation}
We of course know from <a href="#pro-mean-sd-xbar">pro-mean-sd-xbar</a> that \(\hat{\mu}\) is unbiased. What about \(\hat{\sigma^{2}}\)? Let us check: 
\begin{eqnarray*}
\mathbb{E}\,\hat{\sigma^{2}} & = & \mathbb{E}\,\frac{n-1}{n}S^{2}\\
 & = & \mathbb{E}\left(\frac{\sigma^{2}}{n}\frac{(n-1)S^{2}}{\sigma^{2}}\right)\\
 & = & \frac{\sigma^{2}}{n}\mathbb{E}\ \mathsf{chisq}(\mathtt{df}=n-1)\\
 & = & \frac{\sigma^{2}}{n}(n-1),
\end{eqnarray*}
from which we may conclude two things:
</p><ul>
<li>\(\hat{\sigma^{2}}\) is a biased estimator of \(\sigma^{2}\), and 
</li>
<li>\(S^{2}=n\hat{\sigma^{2}}/(n-1)\) is an unbiased estimator of \(\sigma^{2}\).
</li>
</ul>



</div>

<p>
One of the most common questions in an introductory statistics class is, ``Why do we divide by \(n-1\) when we compute the sample variance? Why do we not divide by \(n\)?'' We see now that division by \(n\) amounts to the use of a <i>biased</i> estimator for \(\sigma^{2}\), that is, if we divided by \(n\) then on the average we would <i>underestimate</i> the true value of \(\sigma^{2}\). We use \(n-1\) so that, on the average, our estimator of \(\sigma^{2}\) will be exactly right. 
</p>

</div>

<div id="outline-container-9-1-1" class="outline-4">
<h4 id="sec-9-1-1"><span class="section-number-4">9.1.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-9-1-1">


<p>
\(\mathsf{R}\) can be used to find maximum likelihood estimators in a lot of diverse settings. We will discuss only the most basic here and will leave the rest to more sophisticated texts.
</p>
<p>
For one parameter estimation problems we may use the <code>optimize</code> function to find MLEs. The arguments are the function to be maximized (the likelihood function), the range over which the optimization is to take place, and optionally any other arguments to be passed to the likelihood if needed.
</p>
<p>
Let us see how to do Example <a href="#exa-bass-bluegill">exa-bass-bluegill</a>. Recall that our likelihood function was given by
\begin{equation}
L(p)=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.
\end{equation}
Notice that the likelihood is just a product of \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\) PMFs. We first give some sample data (in the vector <code>datavals</code>), next we define the likelihood function <code>L</code>, and finally we <code>optimize</code> <code>L</code> over the range <code>c(0,1)</code>.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> mtcars$am
<span style="font-weight: bold;">L</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(p,x) prod(dbinom(x, size = 1, prob = p))
optimize(L, interval = c(0,1), x = x, maximum = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<pre class="example">
 $maximum
[1] 0.4062458

$objective
[1] 4.099989e-10
</pre>




<p>
Note that the <code>optimize</code> function by default minimizes the function <code>L</code>, so we have to set <code>maximum = TRUE</code> to get an MLE. The returned value of <code>$maximum</code> gives an approximate value of the MLE to be \(  0.406 \) and <code>objective</code> gives <code>L</code> evaluated at the MLE which is approximately \(  0 \).
</p>
<p>
We previously remarked that it is usually more numerically convenient to maximize the log-likelihood (or minimize the negative log-likelihood), and we can just as easily do this with \(\mathsf{R}\). We just need to calculate the log-likelihood beforehand which (for this example) is
\[
-l(p)=-\sum x_{i}\ln\, p-\left(n-\sum x_{i}\right)\ln(1-p).
\]

It is done in \(\mathsf{R}\) with
</p>



<pre class="src src-R"><span style="font-weight: bold;">minuslogL</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(p,x){
                -sum(dbinom(x, size = 1, prob = p, log = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>))
             }
optimize(minuslogL, interval = c(0,1), x = x)
</pre>


<pre class="example">
 $minimum
[1] 0.4062525

$objective
[1] 21.61487
</pre>


<p>
Note that we did not need <code>maximum = TRUE</code> because we minimized the negative log-likelihood. The answer for the MLE is essentially the same as before, but the <code>$objective</code> value was different, of course.
</p>
<p>
For multiparameter problems we may use a similar approach by way of the <code>mle</code> function in the <code>stats4</code> package. 
</p>

<div class="exampletoo">

<p>
<b>Plant Growth.</b> We will investigate the <code>weight</code> variable of the <code>PlantGrowth</code> data. We will suppose that the weights constitute a random observations \(X_{1}\), \(X_{2}\), &hellip; , \(X_{n}\) that are IID \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) which is not unreasonable based on a histogram and other exploratory measures. We will find the MLE of \(\theta=(\mu,\sigma^{2})\). We claimed in Example <a href="#exa-normal-MLE-both">exa-normal-MLE-both</a> that \(\hat{\theta}=(\hat{\mu},\hat{\sigma}^{2})\) had the form given above. Let us check whether this is plausible numerically. The negative log-likelihood function is
</p>



<pre class="src src-R"><span style="font-weight: bold;">minuslogL</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(mu, sigma2){
  -sum(dnorm(x, mean = mu, sd = sqrt(sigma2), log = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>))
}
</pre>


<p>
Note that we omitted the data as an argument to the log-likelihood function; the only arguments were the parameters over which the maximization is to take place. Now we will simulate some data and find the MLE. The optimization algorithm requires starting values (intelligent guesses) for the parameters. We choose values close to the sample mean and variance (which turn out to be approximately 5 and 0.5, respectively) to illustrate the procedure.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> PlantGrowth$weight
MaxLikeEst <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> mle(minuslogL, start = list(mu = 5, sigma2 = 0.5))
summary(MaxLikeEst)
</pre>


<p>
The outputted MLEs are shown above, and <code>mle</code> even gives us estimates for the standard errors of \(\hat{\mu}\) and \(\hat{\sigma}^{2}\) (which were obtained by inverting the numerical Hessian matrix at the optima; see Appendix <a href="#sec-21-6">Multivariable Calculus</a>). Let us check how close the numerical MLEs came to the theoretical MLEs:
</p>



<pre class="src src-R">mean(x); var(x)*29/30; sd(x)/sqrt(30)
</pre>


<p>
The numerical MLEs were very close to the theoretical MLEs. We already knew that the standard error of \(\hat{\mu}=\overline{X}\) is \(\sigma/\sqrt{n}\), and the numerical estimate of this was very close too.
</p>

</div>

<p>
There is functionality in the <code>distrTest</code> package \cite{Ruckdescheldistr} to calculate theoretical MLEs; we will skip examples of these for the time being.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Confidence-Intervals-for-Means" class="outline-3">
<h3 id="sec-Confidence-Intervals-for-Means"><a name="sec-9-2" id="sec-9-2"></a><span class="section-number-3">9.2</span> Confidence Intervals for Means</h3>
<div class="outline-text-3" id="text-sec-Confidence-Intervals-for-Means">


<p>
We are given \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) that are an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution, where \(\mu\) is unknown. We know that we may estimate \(\mu\) with \(\overline{X}\), and we have seen that this estimator is the MLE. But how good is our estimate? We know that 
\begin{equation} 
\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).
\end{equation}
For a big probability \(1-\alpha\), for instance, 95%, we can calculate the quantile \(z_{\alpha/2}\). Then
\begin{equation}
\mathbb{P}\left(-z_{\alpha/2}\leq\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\leq z_{\alpha/2}\right)=1-\alpha.
\end{equation}
But now consider the following string of equivalent inequalities:
\[
-z_{\alpha/2}\leq\frac{\overline{X}-\mu}{\sigma/\sqrt{n}}\leq z_{\alpha/2},
\]
\[
-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq\overline{X}-\mu\leq z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right),
\]
\[
-\overline{X}-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq-\mu\leq-\overline{X}+z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right),
\]
\[
\overline{X}-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq\mu\leq\overline{X}+z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right).
\]
That is, 
\begin{equation}
\mathbb{P}\left(\overline{X}-z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\leq\mu\leq\overline{X}+z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right)=1-\alpha.
\end{equation}

</p>
<div class="defn">
<p>The interval
\begin{equation}
\left[\overline{X}-z_{\alpha/2}\frac{\sigma}{\sqrt{n}},\ \overline{X}+z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right]
\end{equation}
is a \(100(1-\alpha)\%\) <i>confidence interval for</i> \(\mu\). The quantity \(1-\alpha\) is called the <i>confidence coefficient</i>.
</p>
</div>


<div class="rem">
<p>The interval is also sometimes written more compactly as
\begin{equation}
\overline{X}\pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}.
\end{equation}
<a name="eq-z-interval" id="eq-z-interval"></a>
</p>
</div>

<p>
The interpretation of confidence intervals is tricky and often mistaken by novices. When I am teaching the concept ``live'' during class, I usually ask the students to imagine that my piece of chalk represents the ``unknown'' parameter, and I lay it down on the desk in front of me. Once the chalk has been lain, it is <i>fixed</i>; it does not move. Our goal is to estimate the parameter. For the estimator I pick up a sheet of loose paper lying nearby. The estimation procedure is to randomly drop the piece of paper from above, and observe where it lands. If the piece of paper covers the piece of chalk, then we are successful &ndash; our estimator covers the parameter. If it falls off to one side or the other, then we are unsuccessful; our interval fails to cover the parameter.
</p>
<p>
Then I ask them: suppose we were to repeat this procedure hundreds, thousands, millions of times. Suppose we kept track of how many times we covered and how many times we did not. What percentage of the time would we be successful?
</p>
<p>
In the demonstration, the parameter corresponds to the chalk, the sheet of paper corresponds to the confidence interval, and the random experiment corresponds to dropping the sheet of paper. The percentage of the time that we are successful <i>exactly</i> corresponds to the <i>confidence coefficient</i>. That is, if we use a 95% confidence interval, then we can say that, in the long run, approximately 95% of our intervals will cover the true parameter (which is fixed, but unknown). 
</p>
<p>
See Figure <a href="#fig-ci-examp">ci-examp</a>, which is a graphical display of these ideas.
</p>



<pre class="src src-R">ci.examp()
</pre>







<div id="fig-ci-examp" class="figure">
  <p><img src="svg/estimate/ci-examp.svg" width=500 alt="svg/estimate/ci-examp.svg" /></p>
  <p>Simulated confidence intervals.</p>
</div>

<p>
Under the above framework, we can reason that an ``interval'' with a <i>larger</i> confidence coefficient corresponds to a <i>wider</i> sheet of paper. Furthermore, the width of the confidence interval (sheet of paper) should be <i>somehow</i> related to the amount of information contained in the random sample, \(X_{1}\), \(X_{2}\), &hellip;,
\(X_{n}\). The following remarks makes these notions precise. 
</p>

<div class="rem">
<p>For a fixed confidence coefficient \(1-\alpha\), if \(n\) increases, then the confidence interval gets <i>SHORTER</i>.
</p>
<p>
For a fixed sample size \(n\), if \(1-\alpha\) increases, then the confidence interval gets <i>WIDER</i>.
</p>
</div>


<div class="exampletoo">
<p><a name="exa-plant-one-samp-z-int" id="exa-plant-one-samp-z-int"></a>
<b>Results from an Experiment on Plant Growth.</b> The <code>PlantGrowth</code> data frame gives the results of an experiment to measure plant yield (as measured by the weight of the plant). We would like to a 95% confidence interval for the mean weight of the plants. Suppose that we know from prior research that the true population standard deviation of the plant weights is \(0.7\) g.
</p>
<p>
The parameter of interest is \(\mu\), which represents the true mean weight of the population of all plants of the particular species in the study. We will first take a look at a stemplot of the data:
</p>

</div>




<pre class="src src-R">with(PlantGrowth, stem.leaf(weight))
</pre>



<pre class="example">1 | 2: represents 1.2
 leaf unit: 0.1
            n: 30
   1     f | 5
         s | 
   2    3. | 8
   4    4* | 11
   5     t | 3
   8     f | 455
  10     s | 66
  13    4. | 889
  (4)   5* | 1111
  13     t | 2233
   9     f | 555
         s | 
   6    5. | 88
   4    6* | 011
   1     t | 3
</pre>


<p>
The data appear to be approximately normal with no extreme values. The data come from a designed experiment, so it is reasonable to suppose that the observations constitute a simple random sample of weights
We know the population standard deviation \(\sigma=0.70\) from prior research. We are going to use the one-sample \(z\)-interval.
</p>



<pre class="src src-R">dim(PlantGrowth)   <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">sample size is first entry</span>
</pre>


<pre class="example">
[1] 30  2
</pre>





<pre class="src src-R">with(PlantGrowth, mean(weight))
</pre>


<pre class="example">
[1] 5.073
</pre>





<pre class="src src-R">qnorm(0.975)
</pre>


<pre class="example">
[1] 1.959964
</pre>


<p>
We find the sample mean of the data to be \(\overline{x}=5.073\) and \(z_{\alpha/2}=z_{0.025}\approx1.96\). Our interval is therefore
\[
\overline{x}\pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}=5.073\pm1.96\cdot\frac{0.70}{\sqrt{30}},
\]
which comes out to approximately \([4.823,\,5.323]\). In conclusion, we are 95% confident that the true mean weight \(\mu\) of all plants of this species lies somewhere between 4.823 g and 5.323 g, that is, we are 95% confident that the interval \([4.823,\,5.323]\) covers \(\mu\).
</p>

<div class="exampletoo">
<p>Give some data with \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. Maybe small sample?
</p>
</div>

<ol>
<li>What is the parameter of interest? in the context of the problem.
</li>
<li>Give a point estimate for \(\mu\).
</li>
<li>What are the assumptions being made in the problem? Do they meet the conditions of the interval?
</li>
<li>Calculate the interval.
</li>
<li>Draw the conclusion.
</li>
</ol>



<div class="rem">
<p>What if \(\sigma\) is unknown? We instead use the interval
\begin{equation}
\overline{X}\pm z_{\alpha/2}\frac{S}{\sqrt{n}},
\end{equation}
where \(S\) is the sample standard deviation.
</p><ul>
<li>If \(n\) is large, then \(\overline{X}\) will have an approximately normal distribution regardless of the underlying population (by the CLT) and \(S\) will be very close to the parameter \(\sigma\) (by the SLLN); thus the above interval will have approximately \(100(1-\alpha)\%\) confidence of covering \(\mu\).
</li>
<li>If \(n\) is small, then
<ul>
<li>If the underlying population is normal then we may replace \(z_{\alpha/2}\) with \(t_{\alpha/2}(\mathtt{df}=n-1)\). The resulting \(100(1-\alpha)\%\) confidence interval is
     \begin{equation}
     \overline{X}\pm t_{\alpha/2}(\mathtt{df}=n-1)\frac{S}{\sqrt{n}}.
     \end{equation}
     <a name="eq-one-samp-t-int" class="target">eq-one-samp-t-int</a> 
</li>
<li>if the underlying population is not normal, but approximately normal, then we may use the \(t\) interval, Equation <a href="#eq-one-samp-t-int">eq-one-samp-t-int</a>. The interval will have approximately \(100(1-\alpha)\%\) confidence of covering \(\mu\). However, if the population is highly skewed or the data have outliers, then we should ask a professional statistician for advice.
</li>
</ul>

</li>
</ul>



</div>

<p>
The author learned of a handy acronym from AP Statistics Exam graders that summarizes the important parts of confidence interval estimation, which is PANIC: <i>P</i>-arameter, <i>A</i>-ssumptions, <i>N</i>-ame, <i>I</i>-nterval, and <i>C</i>-onclusion.
</p><dl>
<dt>Parameter:</dt><dd>identify the parameter of interest with the proper symbols. Write down what the parameter means in the context of the problem.
</dd>
<dt>Assumptions:</dt><dd>list any assumptions made in the experiment. If there are any other assumptions needed or that were not checked, state what they are and why they are important.
</dd>
<dt>Name:</dt><dd>choose a statistical procedure from your bag of tricks based on the answers to the previous two parts. The assumptions of the procedure you choose should match those of the problem; if they do not match then either pick a different procedure or openly admit that the results may not be reliable. Write down any underlying formulas used.
</dd>
<dt>Interval:</dt><dd>calculate the interval from the sample data. This can be done by hand but will more often be done with the aid of a computer. Regardless of the method, all calculations or code should be shown so that the entire process is repeatable by a subsequent reader.
</dd>
<dt>Conclusion:</dt><dd>state the final results, using language in the context of the problem. Include the appropriate interpretation of the interval, making reference to the confidence coefficient.
</dd>
</dl>



<div class="rem">
<p>All of the above intervals for \(\mu\) were two-sided, but there are also one-sided intervals for \(\mu\). They look like
\begin{equation}
\left[\overline{X}-z_{\alpha}\frac{\sigma}{\sqrt{n}},\ \infty\right)\quad \mbox{or}\quad \left(-\infty,\ \overline{X}+z_{\alpha}\frac{\sigma}{\sqrt{n}}\right]
\end{equation}
and satisfy
\begin{equation}
\mathbb{P}\left(\overline{X}-z_{\alpha}\frac{\sigma}{\sqrt{n}}\leq\mu\right)=1-\alpha\quad \mbox{and}\quad \mathbb{P}\left(\overline{X}+z_{\alpha}\frac{\sigma}{\sqrt{n}}\geq\mu\right)=1-\alpha.
\end{equation}
</p>
</div>



<div class="exampletoo">
<p>Small sample, some data with \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution.  PANIC
</p>
</div>


</div>

<div id="outline-container-9-2-1" class="outline-4">
<h4 id="sec-9-2-1"><span class="section-number-4">9.2.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-9-2-1">

<p>We can do Example <a href="#exa-plant-one-samp-z-int">exa-plant-one-samp-z-int</a> with the following code.
</p>



<pre class="src src-R">temp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> with(PlantGrowth, z.test(weight, stdev = 0.7))
temp
</pre>



<pre class="example">
	One Sample z-test

data:  weight 
z = 39.6942, n = 30.000, Std. Dev. = 0.700, Std. Dev.
of the sample mean = 0.128, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 4.822513 5.323487 
sample estimates:
mean of weight 
         5.073
</pre>


<p>
The confidence interval bounds are shown in the sixth line down of the output (please disregard all of the additional output information for now &ndash; we will use it in Chapter <a href="#sec-10">Hypothesis Testing</a>). We can make the plot for Figure <a href="#fig-plant-z-int-plot">plant-z-int-plot</a> with
</p>



<pre class="src src-R">plot(temp, <span style="font-style: italic;">"Conf"</span>)
</pre>


</div>
</div>

</div>

<div id="outline-container-sec-Conf-Interv-for-Diff-Means" class="outline-3">
<h3 id="sec-Conf-Interv-for-Diff-Means"><a name="sec-9-3" id="sec-9-3"></a><span class="section-number-3">9.3</span> Confidence Intervals for Differences of Means</h3>
<div class="outline-text-3" id="text-sec-Conf-Interv-for-Diff-Means">


<p>
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})\) distribution and let \(Y_{1}\), \(Y_{2}\), &hellip;, \(Y_{m}\) be a \(SRS(m)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})\) distribution. Further, assume that the \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) sample is independent of the \(Y_{1}\), \(Y_{2}\), &hellip;, \(Y_{m}\) sample.
</p>
<p>
Suppose that \(\sigma_{X}\) and \(\sigma_{Y}\) are known. We would like a confidence interval for \(\mu_{X}-\mu_{Y}\). We know that 
\begin{equation}
\overline{X}-\overline{Y}\sim\mathsf{norm}\left(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sqrt{\frac{\sigma_{X}^{2}}{n}+\frac{\sigma_{Y}^{2}}{m}}\right).
\end{equation}
Therefore, a \( 100(1-\alpha)\% \) confidence interval for \(\mu_{X}-\mu_{Y}\) is given by
\begin{equation}
\left(\overline{X}-\overline{Y}\right)\pm z_{\alpha/2}\sqrt{\frac{\sigma_{X}^{2}}{n}+\frac{\sigma_{Y}^{2}}{m}}.
\end{equation}
<a name="eq-two-samp-mean-CI" id="eq-two-samp-mean-CI"></a>
Unfortunately, most of the time the values of \(\sigma_{X}\) and \(\sigma_{Y}\) are unknown. This leads us to the following:
</p><ul>
<li>If both sample sizes are large, then we may appeal to the CLT/SLLN (see Section <a href="#sec-8-3">Central Limit Theorem</a>) and substitute \(S_{X}^{2}\) and \(S_{Y}^{2}\) for \(\sigma_{X}^{2}\) and \(\sigma_{Y}^{2}\) in the interval <a href="#eq-two-samp-mean-CI">eq-two-samp-mean-CI</a>. The resulting confidence interval will have approximately \(100(1-\alpha)\%\) confidence.
</li>
<li>If one or more of the sample sizes is small then we are in trouble, unless
    -the underlying populations are both normal and \(\sigma_{X}=\sigma_{Y}\). In this case (setting \(\sigma=\sigma_{X}=\sigma_{Y}\)), 
    \begin{equation}
    \overline{X}-\overline{Y}\sim\mathsf{norm}\left(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sigma\sqrt{\frac{1}{n}+\frac{1}{m}}\right).
    \end{equation}
</li>
</ul>

<p>Now let
\begin{equation}
U=\frac{n-1}{\sigma^{2}}S_{X}^{2}+\frac{m-1}{\sigma^{2}}S_{Y}^{2}.
\end{equation}
Then by Exercise <a href="#xca-sum-indep-chisq">xca-sum-indep-chisq</a> we know that \(U\sim\mathsf{chisq}(\mathtt{df}=n+m-2)\) and it is not a large leap to believe that \(U\) is independent of \(\overline{X}-\overline{Y}\); thus
\begin{equation}
T = \frac{Z}{\sqrt{\left.U\right/ (n+m-2)}}\sim\mathsf{t}(\mathtt{df}=n+m-2).
\end{equation}
But
\begin{align*}
T & =\frac{\frac{\overline{X}-\overline{Y}-(\mu_{X}-\mu_{Y})}{\sigma\sqrt{\frac{1}{n}+\frac{1}{m}}}}{\sqrt{\left.\frac{n-1}{\sigma^{2}}S_{X}^{2}+\frac{m-1}{\sigma^{2}}S_{Y}^{2}\right/ (n+m-2)}},\\
 & =\frac{\overline{X}-\overline{Y}-(\mu_{X}-\mu_{Y})}{\sqrt{\left(\frac{1}{n}+\frac{1}{m}\right)\left(\frac{(n-1)S_{X}^{2}+(m-1)S_{Y}^{2}}{n+m-2}\right)}},\\
 & \sim\mathsf{t}(\mathtt{df}=n+m-2).
\end{align*}
Therefore a \(100(1-\alpha)\%\) confidence interval for \(\mu_{X}-\mu_{Y}\) is given by
\begin{equation}
\left(\overline{X}-\overline{Y}\right)\pm t_{\alpha/2}(\mathtt{df}=n+m-2)\, S_{p}\sqrt{\frac{1}{n}+\frac{1}{m}},
\end{equation}
where
\begin{equation}
S_{p}=\sqrt{\frac{(n-1)S_{X}^{2}+(m-1)S_{Y}^{2}}{n+m-2}}
\end{equation}
is called the ``pooled'' estimator of \(\sigma\).
</p><ul>
<li>If one of the samples is small, and both underlying populations are normal, but \(\sigma_{X}\neq\sigma_{Y}\), then we may use a Welch (or Satterthwaite) approximation to the degrees of freedom. See Welch \cite{Welch1947}, Satterthwaite \cite{Satterthwaite1946}, or Neter <i>et al</i> \cite{Neter1996}. The idea is to use an interval of the form 
</li>
</ul>


\begin{equation}
\left(\overline{X}-\overline{Y}\right)\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=r)\,\sqrt{\frac{S_{X}^{2}}{n}+\frac{S_{Y}^{2}}{m}},
\end{equation}
<p>
where the degrees of freedom \(r\) is chosen so that the interval has nice statistical properties. It turns out that a good choice for \(r\) is given by
\begin{equation}
r=\frac{\left(S_{X}^{2}/n+S_{Y}^{2}/m\right)^{2}}{\frac{1}{n-1}\left(S_{X}^{2}/n\right)^{2}+\frac{1}{m-1}\left(S_{Y}^{2}/m\right)^{2}},
\end{equation}
where we understand that \(r\) is rounded down to the nearest integer. The resulting interval has approximately \(100(1-\alpha)\%\) confidence.
</p>

</div>

<div id="outline-container-9-3-1" class="outline-4">
<h4 id="sec-9-3-1"><span class="section-number-4">9.3.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-9-3-1">


<p>
The basic function is <code>t.test</code> which has a <code>var.equal</code> argument that may be set to <code>TRUE</code> or <code>FALSE</code>. The confidence interval is shown as part of the output, although there is a lot of additional information that is not needed until Chapter <a href="#sec-10">Hypothesis Testing</a>.
</p>
<p>
There is not any specific functionality to handle the \(z\)-interval for small samples, but if the samples are large then <code>t.test</code> with <code>var.equal = FALSE</code> will be essentially the same thing. The standard deviations are never (?) known in advance anyway so it does not really matter in practice. 
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Confidence-Intervals-Proportions" class="outline-3">
<h3 id="sec-Confidence-Intervals-Proportions"><a name="sec-9-4" id="sec-9-4"></a><span class="section-number-3">9.4</span> Confidence Intervals for Proportions</h3>
<div class="outline-text-3" id="text-sec-Confidence-Intervals-Proportions">


<p>
We would like to know \(p\) which is the ``proportion of successes''. For instance, \(p\) could be:
</p><ul>
<li>the proportion of U.S. citizens that support Obama,
</li>
<li>the proportion of smokers among adults age 18 or over,
</li>
<li>the proportion of people worldwide infected by the H1N1 virus.
</li>
</ul>


<p>
We are given an \(SRS(n)\) \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) distributed \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\). Recall from Section <a href="#sec-5-3">Binomial Distribution</a> that the common mean of these variables is \(\mathbb{E} X=p\) and the variance is \(\mathbb{E}(X-p)^{2}=p(1-p)\). If we let \(Y=\sum X_{i}\), then from Section <a href="#sec-5-3">Binomial Distribution</a> we know that \(Y\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\) and that 
\[
\overline{X}=\frac{Y}{n}\mbox{ has }\mathbb{E}\overline{X}=p\mbox{ and }\mathrm{Var}(\overline{X})=\frac{p(1-p)}{n}.
\]
Thus if \(n\) is large (here is the CLT) then an approximate \(100(1-\alpha)\%\) confidence interval for \(p\) would be given by
\begin{equation}
\overline{X}\pm z_{\alpha/2}\sqrt{\frac{p(1-p)}{n}}.
\end{equation}
<a name="eq-ci-p-no-good" id="eq-ci-p-no-good"></a>
OOPS&hellip;! Equation <a href="#eq-ci-p-no-good">eq-ci-p-no-good</a> is of no use to us because the \underbar{unknown} parameter \(p\) is in the formula! (If we knew what \(p\) was to plug in the formula then we would not need a confidence interval in the first place.) There are two solutions to this problem.
</p><ol>
<li>Replace \(p\) with \(\hat{p}=\overline{X}\). Then an approximate \(100(1-\alpha)\%\) confidence interval for \(p\) is given by 
   \begin{equation}
   \hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.
   \end{equation}
   This approach is called the <i>Wald interval</i> and is also known as the <i>asymptotic interval</i> because it appeals to the CLT for large sample sizes.
</li>
<li>Go back to first principles. Note that
   \[
   -z_{\alpha/2}\leq\frac{Y/n-p}{\sqrt{p(1-p)/n}}\leq z_{\alpha/2}
   \]
   exactly when the function \(f\) defined by
   \[
   f(p)=\left(Y/n-p\right)^{2}-z_{\alpha/2}^{2}\frac{p(1-p)}{n}
   \]
   satisfies \(f(p)\leq0\). But \(f\) is quadratic in \(p\) so its graph is a parabola; it has two roots, and these roots form the limits of the confidence interval. We can find them with the quadratic formula (see Exercise <a href="#xca-CI-quad-form">xca-CI-quad-form</a>):
   \begin{equation}
   \left.\left[\left(\hat{p}+\frac{z_{\alpha/2}^{2}}{2n}\right)\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}+\frac{z_{\alpha/2}^{2}}{(2n)^{2}}}\right]\right/ \left(1+\frac{z_{\alpha/2}^{2}}{n}\right)
   \end{equation}
   This approach is called the <i>score interval</i> because it is based on the inversion of the ``Score test''. See Chapter <a href="#sec-15">Categorical Data Analysis</a>. It is also known as the <i>Wilson interval</i>; see Agresti \cite{Agresti2002}.
</li>
</ol>



<p>
For two proportions \(p_{1}\) and \(p_{2}\), we may collect independent \(\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)\) samples of size \(n_{1}\) and \(n_{2}\), respectively. Let \(Y_{1}\) and \(Y_{2}\) denote the number of successes in the respective samples. 
We know that
\[
\frac{Y_{1}}{n_{1}}\approx\mathsf{norm}\left(\mathtt{mean}=p_{1},\,\mathtt{sd}=\sqrt{\frac{p_{1}(1-p_{1})}{n_{1}}}\right)
\]
and
\[
\frac{Y_{2}}{n_{2}}\approx\mathsf{norm}\left(\mathtt{mean}=p_{2},\,\mathtt{sd}=\sqrt{\frac{p_{2}(1-p_{2})}{n_{2}}}\right)
\]
so it stands to reason that an approximate \(100(1-\alpha)\%\) confidence interval for \(p_{1}-p_{2}\) is given by
\begin{equation}
\left(\hat{p}_{1}-\hat{p}_{2}\right)\pm z_{\alpha/2}\sqrt{\frac{\hat{p}_{1}(1-\hat{p}_{1})}{n_{1}}+\frac{\hat{p}_{2}(1-\hat{p}_{2})}{n_{2}}},
\end{equation}
where \(\hat{p}_{1}=Y_{1}/n_{1}\) and \(\hat{p}_{2}=Y_{2}/n_{2}\).
</p>

<div class="rem">
<p>When estimating a single proportion, one-sided intervals are sometimes needed. They take the form
\begin{equation}
\left[0,\ \hat{p}+z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\right]
\end{equation}
or
\begin{equation}
\left[\hat{p}-z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}},\ 1\right]
\end{equation}
or in other words, we know in advance that the true proportion is restricted to the interval \([0,1]\), so we can truncate our confidence interval to those values on either side.
</p>
</div>


</div>

<div id="outline-container-9-4-1" class="outline-4">
<h4 id="sec-9-4-1"><span class="section-number-4">9.4.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-9-4-1">





<pre class="src src-R">binconf(x = 7, n = 25, method = <span style="font-style: italic;">"asymptotic"</span>)
</pre>


<pre class="example">
 PointEst     Lower     Upper
     0.28 0.1039957 0.4560043
</pre>





<pre class="src src-R">binconf(x = 7, n = 25, method = <span style="font-style: italic;">"wilson"</span>)
</pre>


<pre class="example">
 PointEst     Lower     Upper
     0.28 0.1428385 0.4757661
</pre>


<p>
The default value of the <code>method</code> argument is <code>wilson</code>.  An alternate way is 
</p>




<pre class="src src-R">tab <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> xtabs(~gender, data = RcmdrTestDrive)
prop.test(rbind(tab), conf.level = 0.95, correct = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>



<pre class="example">
	1-sample proportions test without continuity
	correction

data:  rbind(tab), null probability 0.5 
X-squared = 4.6667, df = 1, p-value = 0.03075
alternative hypothesis: true p is not equal to 0.5 
95 percent confidence interval:
 0.3447942 0.4922649 
sample estimates:
        p 
0.4166667
</pre>



<pre class="src src-R">A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> as.data.frame(Titanic)
B <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> with(A, untable(A, Freq))
</pre>


</div>
</div>

</div>

<div id="outline-container-sec-Confidence-Intervals-for-Variances" class="outline-3">
<h3 id="sec-Confidence-Intervals-for-Variances"><a name="sec-9-5" id="sec-9-5"></a><span class="section-number-3">9.5</span> Confidence Intervals for Variances</h3>
<div class="outline-text-3" id="text-sec-Confidence-Intervals-for-Variances">


<p>
I am thinking one and two sample problems here.
</p>

</div>

<div id="outline-container-9-5-1" class="outline-4">
<h4 id="sec-9-5-1"><span class="section-number-4">9.5.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-9-5-1">


<p>
I am thinking about <code>sigma.test</code> in the <code>TeachingDemos</code> package and <code>var.test</code> in base \(\mathsf{R}\) here.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Fitting-Distributions" class="outline-3">
<h3 id="sec-Fitting-Distributions"><a name="sec-9-6" id="sec-9-6"></a><span class="section-number-3">9.6</span> Fitting Distributions</h3>
<div class="outline-text-3" id="text-sec-Fitting-Distributions">



</div>

<div id="outline-container-9-6-1" class="outline-4">
<h4 id="sec-9-6-1"><span class="section-number-4">9.6.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-9-6-1">


<p>
I am thinking about <code>fitdistr</code> from the <code>MASS</code> package \cite{Venables2002}.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Sample-Size-and-MOE" class="outline-3">
<h3 id="sec-Sample-Size-and-MOE"><a name="sec-9-7" id="sec-9-7"></a><span class="section-number-3">9.7</span> Sample Size and Margin of Error</h3>
<div class="outline-text-3" id="text-sec-Sample-Size-and-MOE">


<p>
Sections <a href="#sec-9-2">Confidence Intervals for Means</a> through <a href="#sec-9-5">Confidence Intervals for Variances</a> all began the same way: we were given the sample size \(n\) and the confidence coefficient \(1-\alpha\), and our task was to find a margin of error \(E\) so that 
\[
\hat{\theta}\pm E\mbox{ is a }100(1-\alpha)\%\mbox{ confidence interval for }\theta.
\]

Some examples we saw were:
</p><ul>
<li>\(E=z_{\alpha/2}\sigma/\sqrt{n}\), in the one-sample \(z\)-interval,
</li>
<li>\(E=t_{\alpha/2}(\mathtt{df}=n+m-2)S_{p}\sqrt{n^{-1}+m^{-1}}\), in the two-sample pooled \(t\)-interval. 
</li>
</ul>


<p>
We already know (we can see in the formulas above) that \(E\) decreases as \(n\) increases. Now we would like to use this information to our advantage: suppose that we have a fixed margin of error \(E,\) say \(E=3\), and we want a \(100(1-\alpha)\%\) confidence interval for \(\mu\). The question is: how big does \(n\) have to be?
</p>
<p>
For the case of a population mean the answer is easy: we set up an equation and solve for \(n\).
</p>

<div class="exampletoo">
<p>Given a situation, given \(\sigma\), given \(E\), we would like to know how big \(n\) has to be to ensure that \(\overline{X}\pm5\) is a 95% confidence interval for \(\mu\).
</p>
</div>


<div class="rem">
<p>Always round up any decimal values of \(n\), no matter how small the decimal is. Another name for \(E\) is the ``maximum error of the estimate''.
</p>
</div>

<p>
For proportions, recall that the asymptotic formula to estimate \(p\) was
\[
\hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.
\]
Reasoning as above we would want
\begin{align}
E & =z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}},\mbox{ or}\\
n & =z_{\alpha/2}^{2}\frac{\hat{p}(1-\hat{p})}{E^{2}}.
\end{align}
<a name="eq-samp-size-prop-ME" id="eq-samp-size-prop-ME"></a>
OOPS! Recall that \(\hat{p}=Y/n\), which would put the variable \(n\) on both sides of Equation <a href="#eq-samp-size-prop-ME">eq-samp-size-prop-ME</a>. Again, there are two solutions to the problem.
</p>
<ol>
<li>If we have a good idea of what \(p\) is, say \(p^{\ast}\) then we can plug it in to get
   \begin{equation}
   n=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}.
   \end{equation}
</li>
<li>Even if we have no idea what \(p\) is, we do know from calculus that \(p(1-p)\leq1/4\) because the function \(f(x)=x(1-x)\) is quadratic (so its graph is a parabola which opens downward) with maximum value attained at \(x=1/2\). Therefore, regardless of our choice for \(p^{\ast}\) the sample size must satisfy
   \begin{equation}
   n=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}\leq\frac{z_{\alpha/2}^{2}}{4E^{2}}.
   \end{equation}
   The quantity \(z_{\alpha/2}^{2}/4E^{2}\) is large enough to guarantee \(100(1-\alpha)\%\) confidence.
</li>
</ol>



<div class="exampletoo">
<p>Proportion example.
</p>
</div>


<div class="rem">
<p>For very small populations sometimes the value of \(n\) obtained from the formula is too big. In this case we should use the hypergeometric distribution for a sampling model rather than the binomial model. With this modification the formulas change to the following: if \(N\) denotes the population size then let
\begin{equation}
m=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}
\end{equation}
and the sample size needed to ensure \(100(1-\alpha)\%\) confidence is achieved is
\begin{equation}
n=\frac{m}{1+\frac{m-1}{N}}.
\end{equation}
If we do not have a good value for the estimate \(p^{\ast}\) then we may use \(p^{\ast}=1/2\).
</p>
</div>


</div>

<div id="outline-container-9-7-1" class="outline-4">
<h4 id="sec-9-7-1"><span class="section-number-4">9.7.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-9-7-1">

<p>I am thinking about <code>power.t.test</code>, <code>power.prop.test</code>, <code>power.anova.test</code>, and I am also thinking about <code>replicate</code>.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Other-Topics" class="outline-3">
<h3 id="sec-Other-Topics"><a name="sec-9-8" id="sec-9-8"></a><span class="section-number-3">9.8</span> Other Topics</h3>
<div class="outline-text-3" id="text-sec-Other-Topics">


<p>
Mention <code>mle</code> from the <code>stats4</code> package.
</p>

</div>

</div>

<div id="outline-container-9-9" class="outline-3">
<h3 id="sec-9-9"><span class="section-number-3">9.9</span> Exercises</h3>
<div class="outline-text-3" id="text-9-9">



<div class="xca">
<p><a name="xca-norm-mu-sig-MLE" id="xca-norm-mu-sig-MLE"></a>
Let \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) be an \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. Find a two-dimensional MLE for \(\theta=(\mu,\sigma)\).
</p>
</div>


<div class="xca">
<p><a name="xca-CI-quad-form" id="xca-CI-quad-form"></a>
Find the upper and lower limits for the confidence interval procedure by finding the roots of \(f\) defined by 
\[
f(p)=\left(Y/n-p\right)^{2}-z_{\alpha/2}^{2}\frac{p(1-p)}{n}.
\]
You are going to need the quadratic formula.
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-cha-Hypothesis-Testing" class="outline-2">
<h2 id="cha-Hypothesis-Testing"><a name="sec-10" id="sec-10"></a><span class="section-number-2">10</span> Hypothesis Testing</h2>
<div class="outline-text-2" id="text-cha-Hypothesis-Testing">




<p>
<b>What do I want them to know?</b>
</p><ul>
<li>basic terminology and philosophy of the Neyman-Pearson paradigm
</li>
<li>classical hypothesis tests for the standard one and two sample problems with means, variances, and proportions
</li>
<li>the notion of between versus within group variation and how it plays out with one-way ANOVA
</li>
<li>the concept of statistical power and its relation to sample size
</li>
</ul>



</div>

<div id="outline-container-sec-Introduction-Hypothesis" class="outline-3">
<h3 id="sec-Introduction-Hypothesis"><a name="sec-10-1" id="sec-10-1"></a><span class="section-number-3">10.1</span> Introduction</h3>
<div class="outline-text-3" id="text-sec-Introduction-Hypothesis">


<p>
I spent a week during the summer of 2005 at the University of Nebraska at Lincoln grading Advanced Placement Statistics exams, and while I was there I attended a presentation by Dr. Roxy Peck. At the end of her talk she described an activity she had used with students to introduce the basic concepts of hypothesis testing. I was impressed by the activity and have used it in my own classes several times since.
</p>
<blockquote>

<p>The instructor (with a box of cookies in hand) enters a class of fifteen or more students and produces a brand-new, sealed deck of ordinary playing cards. The instructor asks for a student volunteer to break the seal, and then the instructor prominently shuffles the deck
several times in front of the class, after which time the students are asked to line up in a row. They are going to play a game. Each student will draw a card from the top of the deck, in turn. If the card is black, then the lucky student will get a cookie. If the card is red, then the unlucky student will sit down empty-handed. Let the game begin.
</p>
<p>
The first student draws a card: red. There are jeers and outbursts, and the student slinks off to his/her chair. (S)he is disappointed, of course, but not really. After all, (s)he had a 50-50 chance of getting black, and it did not happen. Oh well.
</p>
<p>
The second student draws a card: red, again. There are more jeers, and the second student slips away. This student is also disappointed, but again, not so much, because it is probably his/her unlucky day. On to the next student.
</p>
<p>
The student draws: red again! There are a few wiseguys who yell (happy to make noise, more than anything else), but there are a few other students who are not yelling any more &ndash; they are thinking. This is the third red in a row, which is possible, of course, but what is going on, here? They are not quite sure. They are now concentrating on the next card&hellip; it is bound to be black, right?
</p>
<p>
The fourth student draws: red. Hmmm&hellip; now there are groans instead of outbursts. A few of the students at the end of the line shrug their shoulders and start to make their way back to their desk, complaining that the teacher does not want to give away any cookies. There are still some students in line though, salivating, waiting for the inevitable black to appear.
</p>
<p>
The fifth student draws red. Now it isn't funny any more. As the remaining students make their way back to their seats an uproar ensues, from an entire classroom demanding cookies.
</p>
</blockquote>


<p>
Keep the preceding experiment in the back of your mind as you read the following sections. When you have finished the entire chapter, come back and read this introduction again. All of the mathematical jargon that follows is connected to the above paragraphs. In the meantime, I will get you started:
</p>
<dl>
<dt>Null hypothesis:</dt><dd>it is an ordinary deck of playing cards, shuffled thoroughly.
</dd>
<dt>Alternative hypothesis:</dt><dd>either it is a trick deck of cards, or the instructor did some fancy shufflework.
</dd>
<dt>Observed data:</dt><dd>a sequence of draws from the deck, five reds in a row.
</dd>
</dl>


<p>
If it were truly an ordinary, well-shuffled deck of cards, the probability of observing zero blacks out of a sample of size five (without replacement) from a deck with 26 black cards and 26 red cards would be
</p>



<pre class="src src-R">dhyper(0, m = 26, n = 26, k = 5)
</pre>


<pre class="example">
[1] 0.02531012
</pre>


<p>
There are two very important final thoughts. First, everybody gets a cookie in the end. Second, the students invariably (and aggressively) attempt to get me to open up the deck and reveal the true nature of the cards. I never do.
</p>
</div>

</div>

<div id="outline-container-sec-Tests-for-Proportions" class="outline-3">
<h3 id="sec-Tests-for-Proportions"><a name="sec-10-2" id="sec-10-2"></a><span class="section-number-3">10.2</span> Tests for Proportions</h3>
<div class="outline-text-3" id="text-sec-Tests-for-Proportions">



<div class="exampletoo">
<p><a name="exa-widget-machine" id="exa-widget-machine"></a>
</p>
<p>
We have a machine that makes widgets. 
</p>
<ul>
<li>Under normal operation, about 0.10 of the widgets produced are defective.
</li>
<li>Go out and purchase a torque converter.
</li>
<li>Install the torque converter, and observe \(n=100\) widgets from the machine.
</li>
<li>Let \(Y=\mbox{number of defective widgets observed}\).
</li>
</ul>


<p>
If
</p>
<ul>
<li>\(Y=0\), then the torque converter is great!
</li>
<li>\(Y=4\), then the torque converter seems to be helping. 
</li>
<li>\(Y=9\), then there is not much evidence that the torque converter helps.
</li>
<li>\(Y=17\), then throw away the torque converter.
</li>
</ul>


<p>
Let \(p\) denote the proportion of defectives produced by the machine. Before the installation of the torque converter \(p\) was \(0.10\). Then we installed the torque converter. Did \(p\) change? Did it go up or down? We use statistics to decide. Our method is to observe data and construct a 95% confidence interval for \(p\),
\begin{equation}
\hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.
\end{equation}
If the confidence interval is 
</p><ul>
<li>\([0.01,\,0.05]\), then we are 95% confident that \(0.01\leq p\leq0.05\), so there is evidence that the torque converter is helping.
</li>
<li>\([0.15,\,0.19]\), then we are 95% confident that \(0.15\leq p\leq0.19\), so there is evidence that the torque converter is hurting.
</li>
<li>\([0.07,\,0.11]\), then there is not enough evidence to conclude that the torque converter is doing anything at all, positive or negative.
</li>
</ul>



</div>


</div>

<div id="outline-container-10-2-1" class="outline-4">
<h4 id="sec-10-2-1"><span class="section-number-4">10.2.1</span> Terminology</h4>
<div class="outline-text-4" id="text-10-2-1">


<p>
The <i>null hypothesis</i> \(H_{0}\) is a ``nothing'' hypothesis, whose interpretation could be that nothing has changed, there is no difference, there is nothing special taking place, <i>etc</i>. In Example <a href="#exa-widget-machine">exa-widget-machine</a> the null hypothesis would be \(H_{0}:\, p=0.10.\) The <i>alternative hypothesis</i> \(H_{1}\) is the hypothesis that something has changed, in this case, \(H_{1}:\, p\neq0.10\). Our goal is to statistically <i>test</i> the hypothesis \(H_{0}:\, p=0.10\) versus the alternative \(H_{1}:\, p\neq0.10\). Our procedure will be:
</p><ol>
<li>Go out and collect some data, in particular, a simple random sample of observations from the machine.
</li>
<li>Suppose that \(H_{0}\) is true and construct a \(100(1-\alpha)\%\) confidence interval for \(p\).
</li>
<li>If the confidence interval does not cover \(p=0.10\), then we <i>reject</i> \(H_{0}\). Otherwise, we <i>fail to reject</i> \(H_{0}\).
</li>
</ol>



<div class="rem">
<p>Every time we make a decision it is possible to be wrong, and there are two possible mistakes that we could make. We have committed a 
</p><dl>
<dt>Type I Error</dt><dd>if we reject \(H_{0}\) when in fact \(H_{0}\) is true. This would be akin to convicting an innocent person for a crime (s)he did not commit.
</dd>
<dt>Type II Error</dt><dd>if we fail to reject \(H_{0}\) when in fact \(H_{1}\) is true. This is analogous to a guilty person escaping conviction.
</dd>
</dl>



</div>

<p>
Type I Errors are usually considered worse
and we design our statistical procedures to control the probability of making such a mistake. We define the
\begin{equation}
\mbox{significance level of the test}=\mathbb{P}(\mbox{Type I Error})=\alpha.
\end{equation}
We want \(\alpha\) to be small which conventionally means, say, \(\alpha=0.05\), \(\alpha=0.01\), or \(\alpha=0.005\) (but could mean anything, in principle).
</p><ul>
<li>The <i>rejection region</i> (also known as the <i>critical region</i>) for the test is the set of sample values which would result in the rejection of \(H_{0}\). For Example <a href="#exa-widget-machine">exa-widget-machine</a>, the rejection region would be all possible samples that result in a 95% confidence interval that does not cover \(p=0.10\).
</li>
<li>The above example with \(H_{1}:p\neq0.10\) is called a <i>two-sided</i> test. Many times we are interested in a <i>one-sided</i> test, which would look like \(H_{1}:p&lt;0.10\) or \(H_{1}:p&gt;0.10\).
</li>
</ul>


<p>
We are ready for tests of hypotheses for one proportion.
Table here.
Don't forget the assumptions.
</p>

<div class="exampletoo">
<p>Find
</p><ol>
<li>The null and alternative hypotheses.
</li>
<li>Check your assumptions.
</li>
<li>Define a critical region with an \(\alpha=0.05\) significance level.
</li>
<li>Calculate the value of the test statistic and state your conclusion.
</li>
</ol>



</div>


<div class="exampletoo">
<p><a name="exa-prop-test-pvalue-A" id="exa-prop-test-pvalue-A"></a>
</p>
<p>
Suppose \(p=\mbox{the proportion of students}\) who are admitted to the graduate school of the University of California at Berkeley, and suppose that a public relations officer boasts that UCB has historically had a 40% acceptance rate for its graduate school. Consider the data stored in the table <code>UCBAdmissions</code> from 1973. Assuming these observations constituted a simple random sample, are they consistent with the officer's claim, or do they provide evidence that the acceptance rate was significantly less than 40%? Use an \(\alpha=0.01\) significance level.
</p>
<p>
Our null hypothesis in this problem is \(H_{0}:\, p=0.4\) and the alternative hypothesis is \(H_{1}:\, p&lt;0.4\). We reject the null hypothesis if \(\hat{p}\) is too small, that is, if
\begin{equation} 
\frac{\hat{p}-0.4}{\sqrt{0.4(1-0.4)/n}}<-z_{\alpha},
\end{equation}
where \(\alpha=0.01\) and \(-z_{0.01}\) is 
</p>


<pre class="src src-R">-qnorm(0.99)
</pre>


<p>
Our only remaining task is to find the value of the test statistic and see where it falls relative to the critical value. We can find the number of people admitted and not admitted to the UCB graduate school with the following. 
</p>



<pre class="src src-R">A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> as.data.frame(UCBAdmissions)
head(A)
xtabs(Freq ~ Admit, data = A)
</pre>


<p>
Now we calculate the value of the test statistic.
</p>



<pre class="src src-R">phat <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 1755/(1755 + 2771)
(phat - 0.4)/sqrt(0.4 * 0.6/(1755 + 2771)) 
</pre>


<p>
Our test statistic is not less than \(-2.32\), so it does not fall into the critical region. Therefore, we <i>fail</i> to reject the null hypothesis that the true proportion of students admitted to graduate school is less than 40% and say that the observed data are consistent with the officer's claim at the \(\alpha=0.01\) significance level. 
</p>

</div>


<div class="exampletoo">
<p><a name="exa-prop-test-pvalue-B" id="exa-prop-test-pvalue-B"></a>
We are going to do Example <a href="#exa-prop-test-pvalue-A">exa-prop-test-pvalue-A</a> all over again. Everything will be exactly the same except for one change. Suppose we choose significance level \(\alpha=0.05\) instead of \(\alpha=0.01\). Are the 1973 data consistent with the officer's claim?
</p>
<p>
Our null and alternative hypotheses are the same. Our observed test statistic is the same: it was approximately \(-1.68\). But notice that our critical value has changed: \(\alpha=0.05\) and \(-z_{0.05}\) is 
</p>
</div>



<pre class="src src-R">-qnorm(0.95)
</pre>


<pre class="example">
[1] -1.644854
</pre>


<p>
Our test statistic is less than \(-1.64\) so it now falls into the critical region! We now <i>reject</i> the null hypothesis and conclude that the 1973 data provide evidence that the true proportion of students admitted to the graduate school of UCB in 1973 was significantly less than 40%. The data are <i>not</i> consistent with the officer's claim at the \(\alpha=0.05\) significance level.
</p>
<p>
What is going on, here? If we choose \(\alpha=0.05\) then we reject the null hypothesis, but if we choose \(\alpha=0.01\) then we fail to reject the null hypothesis. Our final conclusion seems to depend on our selection of the significance level. This is bad; for a particular test, we never know whether our conclusion would have been different if we had chosen a different significance level. 
</p>
<p>
Or do we?
</p>
<p>
Clearly, for some significance levels we reject, and for some significance levels we do not. Where is the boundary? That is, what is the significance level for which we would <i>reject</i> at any significance level <i>bigger</i>, and we would <i>fail to reject</i> at any significance level <i>smaller</i>? This boundary value has a special name: it is called the <i>p-value</i> of the test.
</p>

<div class="defn">
<p>The <i>p-value</i>, or <i>observed significance level</i>, of a hypothesis test is the probability when the null hypothesis is true of obtaining the observed value of the test statistic (such as \(\hat{p}\)) or values more extreme &ndash; meaning, in the direction of the alternative hypothesis
</p>
</div>


<div class="exampletoo">
<p>Calculate the \(p\)-value for the test in Examples <a href="#exa-prop-test-pvalue-A">exa-prop-test-pvalue-A</a> and <a href="#exa-prop-test-pvalue-B">exa-prop-test-pvalue-B</a>.
</p>
<p>
The \(p\)-value for this test is the probability of obtaining a \(z\)-score equal to our observed test statistic (which had \(z\)-score \(\approx-1.680919\)) or more extreme, which in this example is less than the observed test statistic. In other words, we want to know the area under a standard normal curve on the interval \((-\infty,\,-1.680919]\). We can get this easily with
</p>
</div>




<pre class="src src-R">pnorm(-1.680919)
</pre>


<pre class="example">
[1] 0.04638932
</pre>


<p>
We see that the \(p\)-value is strictly between the significance levels \(\alpha=0.01\) and \(\alpha=0.05\). This makes sense: it has to be bigger than \(\alpha=0.01\) (otherwise we would have rejected \(H_{0}\) in Example <a href="#exa-prop-test-pvalue-A">exa-prop-test-pvalue-A</a>) and it must also be smaller than \(\alpha=0.05\) (otherwise we would not have rejected \(H_{0}\) in Example <a href="#exa-prop-test-pvalue-B">exa-prop-test-pvalue-B</a>). Indeed, \(p\)-values are a characteristic indicator of whether or not we would have rejected at assorted significance levels, and for this reason a statistician will often skip the calculation of critical regions and critical values entirely. If (s)he knows the \(p\)-value, then (s)he knows immediately whether or not (s)he would have rejected at <i>any</i> given significance level.
</p>
<p>
Thus, another way to phrase our significance test procedure is: we will reject \(H_{0}\) at the \(\alpha\)-level of significance if the \(p\)-value is less than \(\alpha\).
</p>

<div class="rem">
<p>If we have two populations with proportions \(p_{1}\) and \(p_{2}\) then we can test the null hypothesis \(H_{0}:p_{1}=p_{2}\).
</p>
</div>

<p>
Table Here.
</p>

<div class="exampletoo">
<p>Example.
</p>
</div>


</div>

<div id="outline-container-10-2-1-1" class="outline-5">
<h5 id="sec-10-2-1-1"><span class="section-number-5">10.2.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-10-2-1-1">


<p>
The following does the test.
</p>



<pre class="src src-R">prop.test(1755, 1755 + 2771, p = 0.4, alternative = <span style="font-style: italic;">"less"</span>, 
          conf.level = 0.99, correct = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>



<pre class="example">
	1-sample proportions test without continuity
	correction

data:  1755 out of 1755 + 2771, null probability 0.4 
X-squared = 2.8255, df = 1, p-value = 0.04639
alternative hypothesis: true p is less than 0.4 
99 percent confidence interval:
 0.0000000 0.4047326 
sample estimates:
        p 
0.3877596
</pre>


<p>
Do the following to make the plot.
</p>

<p>
Use Yates' continuity correction when the expected frequency of successes is less than 10. You can use it all of the time, but you will have a decrease in power. For large samples the correction does not matter. 
</p>
</div>

</div>

<div id="outline-container-10-2-1-2" class="outline-5">
<h5 id="sec-10-2-1-2"><span class="section-number-5">10.2.1.2</span> With the \(\mathsf{R}\) Commander</h5>
<div class="outline-text-5" id="text-10-2-1-2">


<p>
If you already know the number of successes and failures, then you can use the menu <code>Statistics</code> \(\triangleright\) <code>Proportions</code> \(\triangleright\) <code>IPSUR Enter table for single sample...</code>
</p>
<p>
Otherwise, your data &ndash; the raw successes and failures &ndash; should be in a column of the Active Data Set. Furthermore, the data must be stored as a ``factor'' internally. If the data are not a factor but are numeric then you can use the menu <code>Data</code> \(\triangleright\) <code>Manage variables in active data set</code> \(\triangleright\) <code>Convert numeric variables to factors...</code> to convert the variable to a factor. Or, you can always use the <code>factor</code> function.
</p>
<p>
Once your unsummarized data is a column, then you can use the menu <code>Statistics</code> \(\triangleright\) <code>Proportions</code> \(\triangleright\) <code>Single-sample proportion test...</code>
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-One-Sample-Tests" class="outline-3">
<h3 id="sec-One-Sample-Tests"><a name="sec-10-3" id="sec-10-3"></a><span class="section-number-3">10.3</span> One Sample Tests for Means and Variances</h3>
<div class="outline-text-3" id="text-sec-One-Sample-Tests">



</div>

<div id="outline-container-10-3-1" class="outline-4">
<h4 id="sec-10-3-1"><span class="section-number-4">10.3.1</span> For Means</h4>
<div class="outline-text-4" id="text-10-3-1">


<p>
Here, \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. We would like to test \(H_{0}:\mu=\mu_{0}\).
</p>
<dl>
<dt>Case A:</dt><dd>Suppose \(\sigma\) is known. Then under \(H_{0}\),
   \[
   Z=\frac{\overline{X}-\mu_{0}}{\sigma/\sqrt{n}}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).
   \]
   Table here.
</dd>
<dt>Case B:</dt><dd>When \(\sigma\) is unknown, under \(H_{0}\)
   \[
   T = \frac{\overline{X}-\mu_{0}}{S/\sqrt{n}}\sim\mathsf{t}(\mathtt{df}=n-1).
   \]
   Table here.
</dd>
</dl>




<div class="rem">
<p>If \(\sigma\) is unknown but \(n\) is large then we can use the \(z\)-test.
</p>
</div>


<div class="exampletoo">
<p>In this example we
</p><ol>
<li>Find the null and alternative hypotheses.
</li>
<li>Choose a test and find the critical region.
</li>
<li>Calculate the value of the test statistic and state the conclusion.
</li>
<li>Find the \(p\)-value.
</li>
</ol>



</div>


<div class="rem">
<p>Another name for a \(p\)-value is <i>tail end probability</i>. We reject \(H_{0}\) when the \(p\)-value is small.
The quantity \(\sigma/\sqrt{n}\), when \(\sigma\) is known, is called the <i>standard error of the sample mean</i>. In general, if we have an estimator \(\hat{\theta}\) then \(\sigma_{\hat{\theta}}\) is called the <i>standard error</i> of \(\hat{\theta}\). We usually need to estimate \(\sigma_{\hat{\theta}}\) with \(\hat{\sigma_{\hat{\theta}}}\).
</p>
</div>


</div>

<div id="outline-container-10-3-1-1" class="outline-5">
<h5 id="sec-10-3-1-1"><span class="section-number-5">10.3.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-10-3-1-1">


<p>
I am thinking <code>z.test</code>\index{z.test@\texttt{z.test}} in <code>TeachingDemos</code>, <code>t.test</code>\index{t.test@\texttt{t.test}} in base \(\mathsf{R}\).
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rnorm(37, mean = 2, sd = 3)
z.test(x, mu = 1, sd = 3, conf.level = 0.90)
</pre>



<pre class="example">
	One Sample z-test

data:  x 
z = 0.9614, n = 37.000, Std. Dev. = 3.000, Std. Dev.
of the sample mean = 0.493, p-value = 0.3364
alternative hypothesis: true mean is not equal to 1 
90 percent confidence interval:
 0.6629226 2.2853962 
sample estimates:
mean of x 
 1.474159
</pre>


<p>
The <code>RcmdrPlugin.IPSUR</code> package does not have a menu for <code>z.test</code> yet. 
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rnorm(13, mean = 2, sd = 3)
t.test(x, mu = 0, conf.level = 0.90, alternative = <span style="font-style: italic;">"greater"</span>)
</pre>



<pre class="example">
	One Sample t-test

data:  x 
t = 1.9272, df = 12, p-value = 0.03898
alternative hypothesis: true mean is greater than 0 
90 percent confidence interval:
 0.6135461       Inf 
sample estimates:
mean of x 
 2.070973
</pre>


</div>

</div>

<div id="outline-container-10-3-1-2" class="outline-5">
<h5 id="sec-10-3-1-2"><span class="section-number-5">10.3.1.2</span> With the \(\mathsf{R}\) Commander</h5>
<div class="outline-text-5" id="text-10-3-1-2">


<p>
Your data should be in a single numeric column (a variable) of the Active Data Set. Use the menu <code>Statistics</code> \(\triangleright\) <code>Means</code> \(\triangleright\) <code>Single-sample t-test...</code> 
</p>
</div>
</div>

</div>

<div id="outline-container-10-3-2" class="outline-4">
<h4 id="sec-10-3-2"><span class="section-number-4">10.3.2</span> Tests for a Variance</h4>
<div class="outline-text-4" id="text-10-3-2">


<p>
Here, \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) are a \(SRS(n)\) from a \(\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)\) distribution. We would like to test \(H_{0}:\sigma^{2}=\sigma_{0}\). We know that under \(H_{0}\),
\[
X^{2}=\frac{(n-1)S^{2}}{\sigma^{2}}\sim\mathsf{chisq}(\mathtt{df}=n-1).
\]
Table here.
</p>

<div class="exampletoo">
<p>Give some data and a hypothesis.
</p><ul>
<li>Give an \(\alpha\)-level and test the critical region way.
</li>
<li>Find the \(p\)-value for the test.
</li>
</ul>



</div>


</div>

<div id="outline-container-10-3-2-1" class="outline-5">
<h5 id="sec-10-3-2-1"><span class="section-number-5">10.3.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-10-3-2-1">

<p>I am thinking about <code>sigma.test</code>\index{sigma.test@\texttt{sigma.test}} in the <code>TeachingDemos</code> package.
</p>



<pre class="src src-R">sigma.test(women$height, sigma = 8)
</pre>



<pre class="example">
	One sample Chi-squared test for variance

data:  women$height 
X-squared = 4.375, df = 14, p-value = 0.01449
alternative hypothesis: true variance is not equal to 64 
95 percent confidence interval:
 10.72019 49.74483 
sample estimates:
var of women$height 
                 20
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-sec-Two-Sample-Tests-for-Means" class="outline-3">
<h3 id="sec-Two-Sample-Tests-for-Means"><a name="sec-10-4" id="sec-10-4"></a><span class="section-number-3">10.4</span> Two-Sample Tests for Means and Variances</h3>
<div class="outline-text-3" id="text-sec-Two-Sample-Tests-for-Means">


<p>
The basic idea for this section is the following. We have \(X\sim\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})\) and \(Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})\). distributed independently. We would like to know whether \(X\) and \(Y\) come from the same population distribution, that is, we would like to know:
\begin{equation}
\mbox{Does }X\overset{\mathrm{d}}{=}Y?
\end{equation}
where the symbol \(\overset{\mathrm{d}}{=}\) means equality of probability distributions.
Since both \(X\) and \(Y\) are normal, we may rephrase the question:
\begin{equation}
\mbox{Does }\mu_{X}=\mu_{Y}\mbox{ and }\sigma_{X}=\sigma_{Y}?
\end{equation}
Suppose first that we do not know the values of \(\sigma_{X}\) and \(\sigma_{Y}\), but we know that they are equal, \(\sigma_{X}=\sigma_{Y}\). Our test would then simplify to \(H_{0}:\mu_{X}=\mu_{Y}\). We collect data \(X_{1}\), \(X_{2}\), &hellip;, \(X_{n}\) and \(Y_{1}\), \(Y_{2}\), &hellip;, \(Y_{m}\), both simple random samples of size \(n\) and \(m\) from their respective normal distributions. Then under \(H_{0}\) (that is, assuming \(H_{0}\) is true) we have \(\mu_{X}=\mu_{Y}\) or rewriting, \(\mu_{X}-\mu_{Y}=0\), so 
\begin{equation}
T=\frac{\overline{X}-\overline{Y}}{S_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}}=\frac{\overline{X}-\overline{Y}-(\mu_{X}-\mu_{Y})}{S_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}}\sim\mathsf{t}(\mathtt{df}=n+m-2).
\end{equation}

</p>
</div>

<div id="outline-container-10-4-1" class="outline-4">
<h4 id="sec-10-4-1"><span class="section-number-4">10.4.1</span> Independent Samples</h4>
<div class="outline-text-4" id="text-10-4-1">



<div class="rem">
<p>If the values of \(\sigma_{X}\) and \(\sigma_{Y}\) are known, then we can plug them in to our statistic:
\begin{equation} 
Z=\frac{\overline{X}-\overline{Y}}{\sqrt{\sigma_{X}^{2}/n+\sigma_{Y}^{2}/m}};
\end{equation}
the result will have a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) distribution when \(H_{0}:\mu_{X}=\mu_{Y}\) is true. 
</p>
</div>


<div class="rem">
<p>Even if the values of \(\sigma_{X}\) and \(\sigma_{Y}\) are not known, if both \(n\) and \(m\) are large then we can plug in the sample estimates and the result will have approximately a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) distribution when \(H_{0}:\mu_{X}=\mu_{Y}\) is true.
\begin{equation} 
Z=\frac{\overline{X}-\overline{Y}}{\sqrt{S_{X}^{2}/n+S_{Y}^{2}/m}}.
\end{equation}
</p>
</div>


<div class="rem">
<p>It is usually important to construct side-by-side boxplots and other visual displays in concert with the hypothesis test. This gives a visual comparison of the samples and helps to identify departures from the test's assumptions &ndash; such as outliers.
</p>
</div>


<div class="rem">
<p>WATCH YOUR ASSUMPTIONS.
</p><ul>
<li>The normality assumption can be relaxed as long as the population distributions are not highly skewed.
</li>
<li>The equal variance assumption can be relaxed as long as both sample sizes \(n\) and \(m\) are large. However, if one (or both) samples is small, then the test does not perform well; we should instead use the methods of Chapter <a href="#sec-13">Resampling Methods</a>.
</li>
</ul>



</div>

<p>
For a nonparametric alternative to the two-sample \(F\) test see Chapter <a href="#sec-14">Nonparametric Statistics</a>.
</p>
</div>

</div>

<div id="outline-container-10-4-2" class="outline-4">
<h4 id="sec-10-4-2"><span class="section-number-4">10.4.2</span> Paired Samples</h4>
<div class="outline-text-4" id="text-10-4-2">



</div>

<div id="outline-container-10-4-2-1" class="outline-5">
<h5 id="sec-10-4-2-1"><span class="section-number-5">10.4.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-10-4-2-1">





<pre class="src src-R">t.test(extra ~ group, data = sleep, paired = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>



<pre class="example">
	Paired t-test

data:  extra by group 
t = -4.0621, df = 9, p-value = 0.002833
alternative hypothesis: true difference in means is not equal to 0 
95 percent confidence interval:
 -2.4598858 -0.7001142 
sample estimates:
mean of the differences 
                  -1.58
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-sec-Other-Hypothesis-Tests" class="outline-3">
<h3 id="sec-Other-Hypothesis-Tests"><a name="sec-10-5" id="sec-10-5"></a><span class="section-number-3">10.5</span> Other Hypothesis Tests</h3>
<div class="outline-text-3" id="text-sec-Other-Hypothesis-Tests">



</div>

<div id="outline-container-sub-Kolmogorov-Smirnov-Goodness-of-Fit-Test" class="outline-4">
<h4 id="sub-Kolmogorov-Smirnov-Goodness-of-Fit-Test"><a name="sec-10-5-1" id="sec-10-5-1"></a><span class="section-number-4">10.5.1</span> Kolmogorov-Smirnov Goodness-of-Fit Test</h4>
<div class="outline-text-4" id="text-sub-Kolmogorov-Smirnov-Goodness-of-Fit-Test">



</div>

<div id="outline-container-10-5-1-1" class="outline-5">
<h5 id="sec-10-5-1-1"><span class="section-number-5">10.5.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-10-5-1-1">





<pre class="src src-R">ks.test(randu$x, <span style="font-style: italic;">"punif"</span>)
</pre>


<pre class="example">

	One-sample Kolmogorov-Smirnov test

data:  randu$x 
D = 0.0555, p-value = 0.1697
alternative hypothesis: two-sided
</pre>


</div>
</div>

</div>

<div id="outline-container-sub-Shapiro-Wilk-Normality-Test" class="outline-4">
<h4 id="sub-Shapiro-Wilk-Normality-Test"><a name="sec-10-5-2" id="sec-10-5-2"></a><span class="section-number-4">10.5.2</span> Shapiro-Wilk Normality Test</h4>
<div class="outline-text-4" id="text-sub-Shapiro-Wilk-Normality-Test">



</div>

<div id="outline-container-10-5-2-1" class="outline-5">
<h5 id="sec-10-5-2-1"><span class="section-number-5">10.5.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-10-5-2-1">





<pre class="src src-R">shapiro.test(women$height)
</pre>


<pre class="example">

	Shapiro-Wilk normality test

data:  women$height 
W = 0.9636, p-value = 0.7545
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-sec-Analysis-of-Variance" class="outline-3">
<h3 id="sec-Analysis-of-Variance"><a name="sec-10-6" id="sec-10-6"></a><span class="section-number-3">10.6</span> Analysis of Variance</h3>
<div class="outline-text-3" id="text-sec-Analysis-of-Variance">



</div>

<div id="outline-container-10-6-1" class="outline-4">
<h4 id="sec-10-6-1"><span class="section-number-4">10.6.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-10-6-1">


<p>
I am thinking 
</p>


<pre class="src src-R">with(chickwts, by(weight, feed, shapiro.test))
</pre>



<pre class="example">feed: casein

	Shapiro-Wilk normality test

data:  dd[x, ] 
W = 0.9166, p-value = 0.2592

--------------------------------------------- 
feed: horsebean

	Shapiro-Wilk normality test

data:  dd[x, ] 
W = 0.9376, p-value = 0.5265

--------------------------------------------- 
feed: linseed

	Shapiro-Wilk normality test

data:  dd[x, ] 
W = 0.9693, p-value = 0.9035

--------------------------------------------- 
feed: meatmeal

	Shapiro-Wilk normality test

data:  dd[x, ] 
W = 0.9791, p-value = 0.9612

--------------------------------------------- 
feed: soybean

	Shapiro-Wilk normality test

data:  dd[x, ] 
W = 0.9464, p-value = 0.5064

--------------------------------------------- 
feed: sunflower

	Shapiro-Wilk normality test

data:  dd[x, ] 
W = 0.9281, p-value = 0.3603
</pre>


<p>
and
</p>


<pre class="src src-R">temp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(weight ~ feed, data = chickwts)
</pre>

<p>
and 
</p>


<pre class="src src-R">anova(temp)
</pre>


<pre class="example">
Analysis of Variance Table

Response: weight
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
feed       5 231129   46226  15.365 5.936e-10 ***
Residuals 65 195556    3009                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</pre>


<p>
Plot for the intuition of between versus within group variation.
</p>









<div id="fig-Between-versus-within" class="figure">
  <p><img src="svg/hypoth/Between-versus-within.svg" width=500 alt="svg/hypoth/Between-versus-within.svg" /></p>
  <p>A plot of between group versus within group variation.</p>
</div>


<pre class="src src-R">old.omd <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> par(omd = c(.05,.88, .05,1))
F.setup(df1 = 5, df2 = 30)
F.curve(df1 = 5, df2 = 30, col=<span style="font-style: italic;">'blue'</span>)
F.observed(3, df1 = 5, df2 = 30)
par(old.omd)
</pre>







<div id="fig-Some-F-plots-HH" class="figure">
  <p><img src="svg/hypoth/Some-F-plots-HH.svg" width=500 alt="svg/hypoth/Some-F-plots-HH.svg" /></p>
  <p>Some \(F\) plots from the <code>HH</code> package.</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sec-Sample-Size-and-Power" class="outline-3">
<h3 id="sec-Sample-Size-and-Power"><a name="sec-10-7" id="sec-10-7"></a><span class="section-number-3">10.7</span> Sample Size and Power</h3>
<div class="outline-text-3" id="text-sec-Sample-Size-and-Power">


<p>
The power function of a test for a parameter \(\theta\) is
\[
\beta(\theta)=\mathbb{P}_{\theta}(\mbox{Reject }H_{0}),\quad -\infty < \theta < \infty.
\]
Here are some properties of power functions:
</p><ol>
<li>\(\beta(\theta)\leq\alpha\) for any \(\theta\in\Theta_{0}\), and \(\beta(\theta_{0})=\alpha\). We interpret this by saying that no matter what value \(\theta\) takes inside the null parameter space, there is never more than a chance of \(\alpha\) of rejecting the null hypothesis. We have controlled the Type I error rate to be no greater than \(\alpha\).
</li>
<li>\(\lim_{n\to\infty}\beta(\theta)=1\) for any fixed \(\theta\in\Theta_{1}\). In other words, as the sample size grows without bound we are able to detect a nonnull value of \(\theta\) with increasing accuracy, no matter how close it lies to the null parameter space. This may appear to be a good thing at first glance, but it often turns out to be a curse, because this means that our Type II error rate grows as the sample size increases. 
</li>
</ol>



</div>

<div id="outline-container-10-7-1" class="outline-4">
<h4 id="sec-10-7-1"><span class="section-number-4">10.7.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-10-7-1">


<p>
I am thinking about <code>replicate</code>\index{replicate@\texttt{replicate}} here, and also <code>power.examp</code>\index{power.examp@\texttt{power.examp}} from the <code>TeachingDemos</code> package. There is an even better plot in upcoming work from the <code>HH</code> package.
</p>



<pre class="src src-R">power.examp()
</pre>







<div id="fig-power-examp" class="figure">
  <p><img src="svg/hypoth/power-examp.svg" width=500 alt="svg/hypoth/power-examp.svg" /></p>
  <p>A plot of significance level and power.</p>
</div>


</div>
</div>

</div>

<div id="outline-container-10-8" class="outline-3">
<h3 id="sec-10-8"><span class="section-number-3">10.8</span> Exercises</h3>
<div class="outline-text-3" id="text-10-8">



</div>
</div>

</div>

<div id="outline-container-cha-simple-linear-regression" class="outline-2">
<h2 id="cha-simple-linear-regression"><a name="sec-11" id="sec-11"></a><span class="section-number-2">11</span> Simple Linear Regression</h2>
<div class="outline-text-2" id="text-cha-simple-linear-regression">




<p>
<b>What do I want them to know?</b>
</p>
<ul>
<li>basic philosophy of SLR and the regression assumptions
</li>
<li>point and interval estimation of the model parameters, and how to use it to make predictions
</li>
<li>point and interval estimation of future observations from the model
</li>
<li>regression diagnostics, including \( R^{2} \) and basic residual analysis
</li>
<li>the concept of influential versus outlying observations, and how to tell the difference
</li>
</ul>



</div>

<div id="outline-container-sec-Basic-Philosophy" class="outline-3">
<h3 id="sec-Basic-Philosophy"><a name="sec-11-1" id="sec-11-1"></a><span class="section-number-3">11.1</span> Basic Philosophy</h3>
<div class="outline-text-3" id="text-sec-Basic-Philosophy">


<p>
Here we have two variables \(X\) and \(Y\). For our purposes, \(X\) is not random (so we will write \(x\)), but \(Y\) is random. We believe that \(Y\) depends in <i>some</i> way on \(x\). Some typical examples of \( (x,Y) \) pairs are
</p>
<ul>
<li>\( x = \) study time and \( Y = \) score on a test.
</li>
<li>\( x = \) height and \( Y = \) weight.
</li>
<li>\( x = \) smoking frequency and \( Y = \) age of first heart attack.
</li>
</ul>


<p>
Given information about the relationship between \(x\) and \(Y\), we would like to <i>predict</i> future values of \(Y\) for particular values of \(x\). This turns out to be a difficult problem \!\!
, so instead we first tackle an easier problem: we estimate \( \mathbb{E} Y \). How can we accomplish this? Well, we know that \(Y\) depends somehow on \(x\), so it stands to reason that
\begin{equation}
\mathbb{E} Y = \mu(x),\ \mbox{a function of }x.
\end{equation}

But we should be able to say more than that. To focus our efforts we impose some structure on the functional form of \(\mu\). For instance, 
</p><ul>
<li>if \(\mu(x)=\beta_{0}+\beta_{1}x\), we try to estimate \( \beta_{0} \) and \( \beta_{1} \).
</li>
<li>if \( \mu(x) = \beta_{0} + \beta_{1}x + \beta_{2}x^{2} \), we try to estimate \(\beta_{0}\), \(\beta_{1}\), and \(\beta_{2}\).
</li>
<li>if \( \mu(x) = \beta_{0} \mathrm{e}^{\beta_{1}x} \), we try to estimate \(\beta_{0}\) and \(\beta_{1}\).
</li>
</ul>


<p>
This helps us in the sense that we concentrate on the estimation of just a few parameters, \(\beta_{0}\) and \(\beta_{1}\), say, rather than some nebulous function. Our <i>modus operandi</i> is simply to perform the random experiment \(n\) times and observe the \(n\) ordered pairs of data \( (x_{1},Y_{1}),\ (x_{2},Y_{2}),\ \ldots,(x_{n},Y_{n}) \). We use these \(n\) data points to estimate the parameters.
</p>
<p>
More to the point, there are <i>three simple linear regression</i> (SLR) assumptions\index{regression assumptions} that will form the basis for the rest of this chapter:
</p>

<div class="assumption">
<p>We assume that \(\mu\) is a linear function of \(x\), that is, 
\begin{equation}
\mu(x)=\beta_{0}+\beta_{1}x,
\end{equation}
where \(\beta_{0}\) and \(\beta_{1}\) are unknown constants to be estimated.
</p>
</div>


<div class="assumption">
<p>We further assume that \( Y_{i} \) is \( \mu(x_{i}) \), a ``signal'', plus some ``error'' (represented by the symbol \( \epsilon_{i} \)):
\begin{equation}
Y_{i} = \beta_{0} + \beta_{1}x_{i} + \epsilon_{i}, \quad i = 1,2,\ldots,n.
\end{equation}
</p>
</div>


<div class="assumption">
<p>We lastly assume that the errors are IID normal with mean 0 and variance \( \sigma^{2} \):
\begin{equation}
\epsilon_{1},\epsilon_{2},\ldots,\epsilon_{n}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma).
\end{equation}
</p>
</div>


<div class="rem">
<p>We assume both the normality of the errors \(\epsilon\) and the linearity of the mean function \( \mu \). Recall from Proposition <a href="#pro-mvnorm-cond-dist">pro-mvnorm-cond-dist</a> of Chapter <a href="#sec-7">Multivariate Distributions</a> that if \( (X,Y)\sim\mathsf{mvnorm} \) then the mean of \(Y|x\) is a linear function of \(x\). This is not a coincidence. In more advanced classes we study the case that both \(X\) and \(Y\) are random, and in particular, when they are jointly normally distributed.
</p>
</div>


</div>

<div id="outline-container-11-1-1" class="outline-4">
<h4 id="sec-11-1-1"><span class="section-number-4">11.1.1</span> What does it all mean?</h4>
<div class="outline-text-4" id="text-11-1-1">

<p>See Figure <a href="#fig-philosophy">philosophy</a>. Shown in the figure is a solid line, the regression line\index{regression line} \(\mu\), which in this display has slope 0.5 and <i>y</i>-intercept 2.5, that is, \( \mu(x) = 2.5 + 0.5x \). The intuition is that for each given value of \(x\), we observe a random value of \(Y\) which is normally distributed with a mean equal to the height of the regression line at that \(x\) value. Normal densities are superimposed on the plot to drive this point home; in principle, the densities stand outside of the page, perpendicular to the plane of the paper. The figure shows three such values of \(x\), namely, \( x = 1 \), \( x = 2.5 \), and \( x = 4 \). Not only do we assume that the observations at the three locations are independent, but we also assume that their distributions have the same spread. In mathematical terms this means that the normal densities all along the line have identical standard deviations &ndash; there is no ``fanning out'' or ``scrunching in'' of the normal densities as \(x\) increases
</p>



<div id="fig-philosophy" class="figure">
  <p><img src="svg/slr/philosophy.svg" width=500 alt="svg/slr/philosophy.svg" /></p>
  <p>Philosophical foundations of SLR.</p>
</div>








<div class="exampletoo">
<p><a name="exa-Speed-and-Stopping" id="exa-Speed-and-Stopping"></a>
<b>Speed and stopping distance of cars.</b> We will use the data frame \texttt{cars}\index{Data sets!cars@\texttt{cars}} from the <code>datasets</code> package. It has two variables: <code>speed</code> and <code>dist</code>. We can take a look at some of the values in the data frame: 
</p>


<pre class="src src-R">head(cars)
</pre>


<p>
The <code>speed</code> represents how fast the car was going (\(x\)) in miles per hour and <code>dist</code> (\(Y\)) measures how far it took the car to stop, in feet. We can make a simple scatterplot of the data with the <code>qplot</code> command in the <code>ggplot2</code> package. 
</p>



<div id="fig-Scatter-cars" class="figure">
  <p><img src="svg/slr/carscatter.svg" width=500 alt="svg/slr/carscatter.svg" /></p>
  <p>Scatterplot of <code>dist</code> versus <code>speed</code> for the <code>cars</code> data.</p>
</div>


<pre class="src src-R">qplot(speed, dist, data = cars)
</pre>



<pre class="src src-R">  &lt;&lt;carscatter&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;carscatter&gt;&gt;
</pre>


<p>
You can see the output in Figure <a href="#fig-Scatter-cars">carscatter</a>, which was produced by the following code.
</p>



<pre class="src src-R">qplot(speed, dist, data = cars)
plot(dist ~ speed, data = cars)
</pre>


<p>
There is a pronounced upward trend to the data points, and the pattern looks approximately linear. There does not appear to be substantial fanning out of the points or extreme values. 
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-sec-SLR-Estimation" class="outline-3">
<h3 id="sec-SLR-Estimation"><a name="sec-11-2" id="sec-11-2"></a><span class="section-number-3">11.2</span> Estimation</h3>
<div class="outline-text-3" id="text-sec-SLR-Estimation">



</div>

<div id="outline-container-sub-point-estimate-mle-slr" class="outline-4">
<h4 id="sub-point-estimate-mle-slr"><a name="sec-11-2-1" id="sec-11-2-1"></a><span class="section-number-4">11.2.1</span> Point Estimates of the Parameters</h4>
<div class="outline-text-4" id="text-sub-point-estimate-mle-slr">


<p>
Where is \( \mu(x) \)? In essence, we would like to ``fit'' a line to the points. But how do we determine a ``good'' line? Is there a <i>best</i> line? We will use maximum likelihood\index{maximum likelihood} to find it. We know:
\begin{equation}
Y_{i} = \beta_{0} + \beta_{1}x_{i} + \epsilon_{i},\quad i=1,\ldots,n,
\end{equation}
where the \( \epsilon_{i} \) are IID \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma) \). Thus \( Y_{i}\sim\mathsf{norm}(\mathtt{mean}=\beta_{0}+\beta_{1}x_{i},\,\mathtt{sd}=\sigma),\ i=1,\ldots,n \). Furthermore, \( Y_{1},\ldots,Y_{n} \) are independent &ndash; but not identically distributed. The likelihood function\index{likelihood function} is:
\begin{alignat}{1}
L(\beta_{0},\beta_{1},\sigma)= & \prod_{i=1}^{n}f_{Y_{i}}(y_{i}),\\
= & \prod_{i=1}^{n}(2\pi\sigma^{2})^{-1/2}\exp\left\{ \frac{-(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2}}{2\sigma^{2}}\right\} ,\\
= & (2\pi\sigma^{2})^{-n/2}\exp\left\{ \frac{-\sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2}}{2\sigma^{2}}\right\} .
\end{alignat}
We take the natural logarithm to get
\begin{equation}
\ln L(\beta_{0},\beta_{1},\sigma)=-\frac{n}{2}\ln(2\pi\sigma^{2})-\frac{\sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2}}{2\sigma^{2}}.
\end{equation}
<a name="eq-regML-lnL" id="eq-regML-lnL"></a>
 We would like to maximize this function of \( \beta_{0} \) and \( \beta_{1} \). See Appendix <a href="#sec-21-6">Multivariable Calculus</a> which tells us that we should find critical points by means of the partial derivatives. Let us start by differentiating with respect to \( \beta_{0} \):
\begin{equation}
\frac{\partial}{\partial\beta_{0}}\ln L=0-\frac{1}{2\sigma^{2}}\sum_{i=1}^{n}2(y_{i}-\beta_{0}-\beta_{1}x_{i})(-1),
\end{equation}
and the partial derivative equals zero when \( \sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i}) = 0 \), that is, when
\begin{equation}
n \beta_{0} + \beta_{1} \sum_{i=1}^{n} x_{i} = \sum_{i = 1}^{n}y_{i}.
\end{equation}
<a name="eq-regML-a" id="eq-regML-a"></a>
Moving on, we next take the partial derivative of \( \ln L \) (Equation <a href="#eq-regML-lnL">eq-regML-lnL</a>) with respect to \( \beta_{1} \) to get
\begin{alignat}{1}
\frac{\partial}{\partial\beta_{1}}\ln L=\  & 0-\frac{1}{2\sigma^{2}}\sum_{i=1}^{n}2(y_{i}-\beta_{0}-\beta_{1}x_{i})(-x_{i}),\\
= & \frac{1}{\sigma^{2}}\sum_{i=1}^{n}\left(x_{i}y_{i}-\beta_{0}x_{i}-\beta_{1}x_{i}^{2}\right),
\end{alignat}
and this equals zero when the last sum equals zero, that is, when
\begin{equation}
\beta_{0} \sum_{i = 1}^{n}x_{i} + \beta_{1} \sum_{i = 1}^{n}x_{i}^{2} = \sum_{i = 1}^{n}x_{i}y_{i}.
\end{equation}
<a name="eq-regML-b" id="eq-regML-b"></a>
Solving the system of equations <a href="#eq-regML-a">eq-regML-a</a> and <a href="#eq-regML-b">eq-regML-b</a>
\begin{eqnarray}
n\beta_{0} + \beta_{1}\sum_{i = 1}^{n}x_{i} & = & \sum_{i = 1}^{n}y_{i}\\
\beta_{0}\sum_{i = 1}^{n}x_{i}+\beta_{1}\sum_{i = 1}^{n}x_{i}^{2} & = & \sum_{i = 1}^{n}x_{i}y_{i}
\end{eqnarray}
for \( \beta_{0} \) and \( \beta_{1} \) (in Exercise <a href="#xca-find-mles-SLR">xca-find-mles-SLR</a>) gives
\begin{equation}
\hat{\beta}_{1} = \frac{\sum_{i = 1}^{n}x_{i}y_{i} - \left.\left(\sum_{i = 1}^{n}x_{i}\right)\left(\sum_{i = 1}^{n}y_{i}\right)\right] n}{\sum_{i = 1}^{n}x_{i}^{2} - \left.\left(\sum_{i = 1}^{n}x_{i}\right)^{2}\right/ n}
\end{equation}
<a name="eq-regline-slope-formula" id="eq-regline-slope-formula"></a>
and
\begin{equation}
\hat{\beta}_{0} = \overline{y} - \hat{\beta}_{1}\overline{x}.
\end{equation}

The conclusion? To estimate the mean line 
\begin{equation}
\mu(x) = \beta_{0} + \beta_{1}x,
\end{equation}
we use the ``line of best fit''
\begin{equation}
\hat{\mu}(x) = \hat{\beta}_{0} + \hat{\beta}_{1}x,
\end{equation}
where \(\hat{\beta}_{0}\) and \(\hat{\beta}_{1}\) are given as above. For notation we will usually write \( b_{0} = \hat{\beta_{0}} \) and \( b_{1}=\hat{\beta_{1}} \) so that \( \hat{\mu}(x) = b_{0} + b_{1}x \).
</p>

<div class="rem">
<p>The formula for \( b_{1} \) in Equation <a href="#eq-regline-slope-formula">eq-regline-slope-formula</a> gets the job done but does not really make any sense. There are many equivalent formulas for \( b_{1} \) that are more intuitive, or at the least are easier to remember. One of the author's favorites is
\begin{equation}
b_{1} = r\frac{s_{y}}{s_{x}},
\end{equation}
<a name="eq-sample-correlation-formula" id="eq-sample-correlation-formula"></a>
where \(r\), \( s_{y} \), and \( s_{x} \) are the sample correlation coefficient and the sample standard deviations of the \(Y\) and \(x\) data, respectively. See Exercise <a href="#xca-show-alternate-slope-formula">xca-show-alternate-slope-formula</a>. Also, notice the similarity between Equation <a href="#eq-sample-correlation-formula">eq-sample-correlation-formula</a> and Equation <a href="#eq-population-slope-slr">eq-population-slope-slr</a>.
</p>
</div>


</div>

<div id="outline-container-11-2-1-1" class="outline-5">
<h5 id="sec-11-2-1-1"><span class="section-number-5">11.2.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-2-1-1">




<p>
Here we go. \(\mathsf{R}\) will calculate the linear regression line with the <code>lm</code> function. We will store the result in an object which we will call <code>cars.lm</code>. Here is how it works:
</p>



<pre class="src src-R">cars.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(dist ~ speed, data = cars)
</pre>


<p>
The first part of the input to the <code>lm</code> function, <code>dist ~ speed</code>, is a <i>model formula</i>, read like this: <code>dist</code> is described (or modeled) by <code>speed</code>. The <code>data = cars</code> argument tells \(\mathsf{R}\) where to look for the variables quoted in the model formula. The output object <code>cars.lm</code> contains a multitude of information. Let's first take a look at the coefficients of the fitted regression line, which are extracted by the <code>coef</code> function (alternatively, we could just type <code>cars.lm</code> to see the same thing):
</p>



<pre class="src src-R">coef(cars.lm)
</pre>


<pre class="example">
(Intercept)       speed 
 -17.579095    3.932409
</pre>


<p>
The parameter estimates \( b_{0} \) and \( b_{1} \) for the intercept and slope, respectively, are shown above. The regression line is thus given by \( \hat{\mu}(\mathtt{speed}) =  -17.58 +  3.93 \cdot \mathtt{speed} \).
</p>
<p>
It is good practice to visually inspect the data with the regression line added to the plot. To do this we first scatterplot the original data and hen follow with a call to the <code>abline</code> function. The inputs to <code>abline</code> are the coefficients of <code>cars.lm</code>; see Figure <a href="#fig-Scatter-cars-regline">Scatter-cars-regline</a>.
</p>



<div id="fig-Scatter-cars-regline" class="figure">
  <p><img src="svg/slr/carline.svg" width=500 alt="svg/slr/carline.svg" /></p>
  <p>A scatterplot with an added regression line for the <code>cars</code> data.</p>
</div>


<pre class="src src-R">ggplot(cars, aes(x = speed, y = dist)) + geom_point(shape = 19) + 
       geom_smooth(method = lm, se = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
</pre>






<p>
To calculate points on the regression line we may simply plug the desired \(x\) value(s) into \( \hat{\mu} \), either by hand, or with the <code>predict</code> function. The inputs to <code>predict</code> are the fitted linear model object, <code>cars.lm</code>, and the desired \(x\) value(s) represented by a data frame. See the example below.
</p>

<div class="exampletoo">
<p><a name="exa-regline-cars-interpret" id="exa-regline-cars-interpret"></a>
</p>
<p>
Using the regression line for the <code>cars</code> data:
</p>
<ol>
<li>What is the meaning of \( \mu(60) = \beta_{0} + \beta_{1}(8) \)? 
   This represents the average stopping distance (in feet) for a car going 8 mph. 
</li>
<li>Interpret the slope \(\beta_{1}\). 
   The true slope \(\beta_{1}\) represents the increase in average stopping distance for each mile per hour faster that the car drives. In this case, we estimate the car to take approximately \( SRC_R{tmpcoef[2]} \) additional feet to stop for each additional mph increase in speed.
</li>
<li>Interpret the intercept \( \beta_{0} \).
   This would represent the mean stopping distance for a car traveling 0 mph (which our regression line estimates to be \( SRC_R{tmpcoef[1]} \) ). Of course, this interpretation does not make any sense for this example, because a car travelling 0 mph takes 0 ft to stop (it was not moving in the first place)! What went wrong? Looking at the data, we notice that the smallest speed for which we have measured data is 4 mph. Therefore, if we predict what would happen for slower speeds then we would be <i>extrapolating</i>, a dangerous practice which often gives nonsensical results.
</li>
</ol>



</div>

</div>
</div>

</div>

<div id="outline-container-sub-slr-point-est-regline" class="outline-4">
<h4 id="sub-slr-point-est-regline"><a name="sec-11-2-2" id="sec-11-2-2"></a><span class="section-number-4">11.2.2</span> Point Estimates of the Regression Line</h4>
<div class="outline-text-4" id="text-sub-slr-point-est-regline">


<p>
We said at the beginning of the chapter that our goal was to estimate \( \mu = \mathbb{E} Y \), and the arguments in Section <a href="#sec-11-2-1">Point Estimation</a> showed how to obtain an estimate \( \hat{\mu} \) of \( \mu \) when the regression assumptions hold. Now we will reap the benefits of our work in more ways than we previously disclosed. Given a particular value \(x_{0}\), there are two values we would like to estimate:
</p><ol>
<li>the mean value of \(Y\) at \(x_{0}\), and
</li>
<li>a future value of \(Y\) at \(x_{0}\).
</li>
</ol>

<p>The first is a number, \(\mu(x_{0})\), and the second is a random variable, \(Y(x_{0})\), but our point estimate is the same for both: \(\hat{\mu}(x_{0})\).
</p>

<div class="exampletoo">
<p><a name="exa-regline-cars-pe-8mph" id="exa-regline-cars-pe-8mph"></a>
We may use the regression line to obtain a point estimate of the mean stopping distance for a car traveling 8 mph: \( \hat{\mu}(15) = b_{0} + (8) (b_{1}) \approx SRC_R{tmpcoef[1]} + (8) ( SRC_R{tmpcoef[2]} ) \approx 13.88 \). We would also use 13.88 as a point estimate for the stopping distance of a future car traveling 8 mph. 
</p>
</div>

<p>
Note that we actually have observed data for a car traveling 8 mph; its stopping distance was 16 ft as listed in the fifth row of the <code>cars</code> data (which we saw in Example <a href="#exa-Speed-and-Stopping">exa-Speed-and-Stopping</a>).
</p>



<pre class="src src-R">cars[5, ]
</pre>


<pre class="example">
  speed dist
5     8   16
</pre>


<p>
There is a special name for estimates \( \hat{\mu}(x_{0}) \) when \( x_{0} \) matches an observed value \(x_{i}\) from the data set. They are called <i>fitted values</i>, they are denoted by \(\hat{Y}_{1}\), \(\hat{Y}_{2}\), &hellip;, \(\hat{Y}_{n}\) (ignoring repetition), and they play an important role in the sections that follow. 
</p>
<p>
In an abuse of notation we will sometimes write \(\hat{Y}\) or \(\hat{Y}(x_{0})\) to denote a point on the regression line even when \(x_{0}\) does not belong to the original data if the context of the statement obviates any danger of confusion.
</p>
<p>
We saw in Example <a href="#exa-regline-cars-interpret">exa-regline-cars-interpret</a> that spooky things can happen when we are cavalier about point estimation. While it is usually acceptable to predict/estimate at values of \(x_{0}\) that fall within the range of the original \(x\) data, it is reckless to use \(\hat{\mu}\) for point estimates at locations outside that range. Such estimates are usually worthless. <i>Do not extrapolate</i> unless there are compelling external reasons, and even then, temper it with a good deal of caution.
</p>

</div>

<div id="outline-container-11-2-2-1" class="outline-5">
<h5 id="sec-11-2-2-1"><span class="section-number-5">11.2.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-2-2-1">


<p>
The fitted values are automatically computed as a byproduct of the model fitting procedure and are already stored as a component of the <code>cars.lm</code> object. We may access them with the <code>fitted</code> function (we only show the first five entries):
</p>



<pre class="src src-R">fitted(cars.lm)[1:5]
</pre>


<pre class="example">
        1         2         3         4         5 
-1.849460 -1.849460  9.947766  9.947766 13.880175
</pre>


<p>
Predictions at \(x\) values that are not necessarily part of the original data are done with the <code>predict</code> function. The first argument is the original <code>cars.lm</code> object and the second argument <code>newdata</code> accepts a dataframe (in the same form that was used to fit <code>cars.lm</code>) that contains the locations at which we are seeking predictions. Let us predict the average stopping distances of cars traveling 6 mph, 8 mph, and 21 mph:
</p>



<pre class="src src-R">predict(cars.lm, newdata = data.frame(speed = c(6, 8, 21)))
</pre>


<pre class="example">
        1         2         3 
 6.015358 13.880175 65.001489
</pre>


<p>
Note that there were no observed cars that traveled 6 mph or 21 mph. Also note that our estimate for a car traveling 8 mph matches the value we computed by hand in Example <a href="#exa-regline-cars-pe-8mph">exa-regline-cars-pe-8mph</a>.
</p>
</div>
</div>

</div>

<div id="outline-container-11-2-3" class="outline-4">
<h4 id="sec-11-2-3"><span class="section-number-4">11.2.3</span> Mean Square Error and Standard Error</h4>
<div class="outline-text-4" id="text-11-2-3">


<p>
To find the MLE of \(\sigma^{2}\) we consider the partial derivative
\begin{equation}
\frac{\partial}{\partial\sigma^{2}}\ln L=\frac{n}{2\sigma^{2}}-\frac{1}{2(\sigma^{2})^{2}}\sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2},
\end{equation}
and after plugging in \(\hat{\beta}_{0}\) and \(\hat{\beta}_{1}\) and setting equal to zero we get
\begin{equation}
\hat{\sigma^{2}}=\frac{1}{n}\sum_{i=1}^{n}(y_{i}-\hat{\beta}_{0}-\hat{\beta}_{1}x_{i})^{2}=\frac{1}{n}\sum_{i=1}^{n}[y_{i}-\hat{\mu}(x_{i})]^{2}.
\end{equation}
We write \(\hat{Yi}=\hat{\mu}(x_{i})\), and we let \(E_{i}=Y_{i}-\hat{Y_{i}}\) be the \(i^{\mathrm{th}}\) <i>residual</i>. We see 
\begin{equation}
n\hat{\sigma^{2}}=\sum_{i=1}^{n}E_{i}^{2}=SSE=\mbox{ the sum of squared errors.}
\end{equation}
For a point estimate of \(\sigma^{2}\) we use the <i>mean square error</i> \(S^{2}\) defined by 
\begin{equation}
S^{2}=\frac{SSE}{n-2},
\end{equation}
and we estimate \(\sigma\) with the <i>standard error</i>
\(S=\sqrt{S^{2}}\).
</p>

</div>

<div id="outline-container-11-2-3-1" class="outline-5">
<h5 id="sec-11-2-3-1"><span class="section-number-5">11.2.3.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-2-3-1">


<p>
The residuals for the model may be obtained with the <code>residuals</code> function; we only show the first few entries in the interest of space:
</p>



<pre class="src src-R">residuals(cars.lm)[1:5]
</pre>


<pre class="example">
        1         2         3         4         5 
 3.849460 11.849460 -5.947766 12.052234  2.119825
</pre>




<p>
In the last section, we calculated the fitted value for \(x=8\) and found it to be approximately \( \hat{\mu}(8)\approx  13.88 \). Now, it turns out that there was only one recorded observation at \(x = 8\), and we have seen this value in the output of <code>head(cars)</code> in Example <a href="#exa-Speed-and-Stopping">exa-Speed-and-Stopping</a>; it was \(\mathtt{dist} = 16\) ft for a car with \( \mathtt{speed} = 8 \) mph. Therefore, the residual should be \(E = Y - \hat{Y}\) which is \(E \approx 16 -  13.88 \). Now take a look at the last entry of <code>residuals(cars.lm)</code>, above. It is not a coincidence.
</p>
<p>
The estimate \(S\) for \(\sigma\) is called the <code>Residual standard error</code> and for the <code>cars</code> data is shown a few lines up on the <code>summary(cars.lm)</code> output (see How to do it with \(\mathsf{R}\) in Section <a href="#sec-11-2-4">Interval Estimation</a>). We may read it from there to be \( S\approx  15.38 \), or we can access it directly from the <code>summary</code> object.
</p>



<pre class="src src-R">carsumry <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> summary(cars.lm)
carsumry$sigma
</pre>


<pre class="example">
[1] 15.37959
</pre>


</div>
</div>

</div>

<div id="outline-container-sub-slr-interval-est-params" class="outline-4">
<h4 id="sub-slr-interval-est-params"><a name="sec-11-2-4" id="sec-11-2-4"></a><span class="section-number-4">11.2.4</span> Interval Estimates of the Parameters</h4>
<div class="outline-text-4" id="text-sub-slr-interval-est-params">


<p>
We discussed general interval estimation in Chapter <a href="#sec-9">Estimation</a>. There we found that we could use what we know about the sampling distribution of certain statistics to construct confidence intervals for the parameter being estimated. We will continue in that vein, and to get started we will determine the sampling distributions of the parameter estimates, \(b_{1}\) and \(b_{0}\).
</p>
<p>
To that end, we can see from Equation <a href="#eq-regline-slope-formula">eq-regline-slope-formula</a> (and it is made clear in Chapter <a href="#sec-12">Multiple Linear Regression</a>) that \(b_{1}\) is just a linear combination of normally distributed random variables, so \(b_{1}\) is normally distributed too. Further, it can be shown that
\begin{equation}
b_{1}\sim\mathsf{norm}\left(\mathtt{mean}=\beta_{1},\,\mathtt{sd}=\sigma_{b_{1}}\right)
\end{equation}
where
\begin{equation}
\sigma_{b_{1}}=\frac{\sigma}{\sqrt{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}
\end{equation}
is called <i>the standard error of</i> \(b_{1}\) which unfortunately depends on the unknown value of \(\sigma\). We do not lose heart, though, because we can estimate \(\sigma\) with the standard error \(S\) from the last section. This gives us an estimate \(S_{b_{1}}\) for \(\sigma_{b_{1}}\) defined by
\begin{equation}
S_{b_{1}}=\frac{S}{\sqrt{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}.
\end{equation}

Now, it turns out that \(b_{0}\), \(b_{1}\), and \(S\) are mutually independent (see the footnote in Section <a href="#sec-12-2-4">MLR Interval Estimation</a>). Therefore, the quantity
\begin{equation}
T=\frac{b_{1}-\beta_{1}}{S_{b_{1}}}
\end{equation}
has a \(\mathsf{t}(\mathtt{df}=n-2)\) distribution and a \(100(1 - \alpha)\% \) confidence interval for \(\beta_{1}\) is given by 
\begin{equation}
b_{1}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\, S_{b_{1}.}
\end{equation}

It is also sometimes of interest to construct a confidence interval for \(\beta_{0}\) in which case we will need the sampling distribution of \(b_{0}\). It is shown in Chapter <a href="#sec-12">Multiple Linear Regression</a> that
\begin{equation}
b_{0}\sim\mathsf{norm}\left(\mathtt{mean}=\beta_{0},\,\mathtt{sd}=\sigma_{b_{0}}\right),
\end{equation}
where \(\sigma_{b_{0}}\) is given by
\begin{equation}
\sigma_{b_{0}}=\sigma\sqrt{\frac{1}{n}+\frac{\overline{x}^{2}}{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}},
\end{equation}
and which we estimate with the \(S_{b_{0}}\) defined by
\begin{equation}
S_{b_{0}}=S\sqrt{\frac{1}{n}+\frac{\overline{x}^{2}}{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}.
\end{equation}
Thus the quantity
\begin{equation}
T=\frac{b_{0}-\beta_{0}}{S_{b_{0}}}
\end{equation}
has a \(\mathsf{t}(\mathtt{df}=n-2)\) distribution and a \(100(1-\alpha)\%\) confidence interval for \(\beta_{0}\) is given by
\begin{equation}
b_{0}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\, S_{b_{0}}.
\end{equation}

</p>
</div>

<div id="outline-container-11-2-4-1" class="outline-5">
<h5 id="sec-11-2-4-1"><span class="section-number-5">11.2.4.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-2-4-1">




<p>
Let us take a look at the output from <code>summary(cars.lm)</code>:
</p>



<pre class="src src-R">summary(cars.lm)
</pre>



<pre class="example">
Call:
lm(formula = dist ~ speed, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.069  -9.525  -2.272   9.215  43.201 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -17.5791     6.7584  -2.601   0.0123 *  
speed         3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared: 0.6511,	Adjusted R-squared: 0.6438 
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12
</pre>


<p>
In the <code>Coefficients</code> section we find the parameter estimates and their respective standard errors in the second and third columns; the other columns are discussed in Section <a href="#sec-11-3">SLR Model Utility</a>. If we wanted, say, a 95% confidence interval for \(\beta_{1}\) we could use \( b_{1} =  3.932 \) and \( S_{b_{1}} =  0.416 \) together with a \( \mathsf{t}_{0.025}(\mathtt{df}=23) \) critical value to calculate \( b_{1} \pm \mathsf{t}_{0.025}(\mathtt{df} = 23) \cdot S_{b_{1}} \).  Or, we could use the <code>confint</code> function.
</p>



<pre class="src src-R">confint(cars.lm)
</pre>


<pre class="example">
                 2.5 %    97.5 %
(Intercept) -31.167850 -3.990340
speed         3.096964  4.767853
</pre>


<p>
With 95% confidence, the random interval \( [  3.097,  4.768 ] \) covers the parameter \(\beta_{1}\).
</p>
</div>
</div>

</div>

<div id="outline-container-sub-slr-interval-est-regline" class="outline-4">
<h4 id="sub-slr-interval-est-regline"><a name="sec-11-2-5" id="sec-11-2-5"></a><span class="section-number-4">11.2.5</span> Interval Estimates of the Regression Line</h4>
<div class="outline-text-4" id="text-sub-slr-interval-est-regline">


<p>
We have seen how to estimate the coefficients of regression line with both point estimates and confidence intervals. We even saw how to estimate a value \(\hat{\mu}(x)\) on the regression line for a given value of \(x\), such as \(x=15\). 
</p>
<p>
But how good is our estimate \(\hat{\mu}(15)\)? How much confidence do we have in <i>this</i> estimate? Furthermore, suppose we were going to observe another value of \(Y\) at \(x=15\). What could we say?
</p>
<p>
Intuitively, it should be easier to get bounds on the mean (average) value of \(Y\) at \(x_{0}\) &ndash; called a <i>confidence interval for the mean value of</i> \(Y\) <i>at</i> \(x_{0}\) &ndash; than it is to get bounds on a future observation of \(Y\) (called a <i>prediction interval for</i> \(Y\) <i>at</i> \(x_{0}\)). As we shall see, the intuition serves us well and confidence intervals are shorter for the mean value, longer for the individual value.
</p>
<p>
Our point estimate of \(\mu(x_{0})\) is of course \(\hat{Y}=\hat{Y}(x_{0})\), so for a confidence interval we will need to know \(\hat{Y}\)'s sampling distribution. It turns out (see Section ) that \(\hat{Y}=\hat{\mu}(x_{0})\) is distributed
\begin{equation}
\hat{Y}\sim\mathsf{norm}\left(\mathtt{mean}=\mu(x_{0}),\:\mathtt{sd}=\sigma\sqrt{\frac{1}{n}+\frac{(x_{0}-\overline{x})^{2}}{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}\right).
\end{equation}

Since \(\sigma\) is unknown we estimate it with \(S\) (we should expect the appearance of a \(\mathsf{t}(\mathtt{df}=n-2)\) distribution in the near future). 
</p>
<p>
A \( 100(1-\alpha)\% \) <i>confidence interval (CI) for</i> \(\mu(x_{0})\) is given by
\begin{equation}
\hat{Y}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-2)\, S\sqrt{\frac{1}{n}+\frac{(x_{0}-\overline{x}^{2})}{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}.
\end{equation}
<a name="eq-SLR-conf-int-formula" id="eq-SLR-conf-int-formula"></a>
Prediction intervals are a little bit different. In order to find confidence bounds for a new observation of \(Y\) (we will denote it \(Y_{\mbox{new}}\)) we use the fact that
\begin{equation}
Y_{\mbox{new}}\sim\mathtt{norm}\left(\mathtt{mean}=\mu(x_{0}),\,\mathtt{sd}=\sigma\sqrt{1+\frac{1}{n}+\frac{(x_{0}-\overline{x})^{2}}{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}\right).
\end{equation}
Of course, \(\sigma\) is unknown so we estimate it with \(S\) and a \( 100(1-\alpha)\% \) prediction interval (PI) for a future value of \(Y\) at \(x_{0}\) is given by 
\begin{equation}
\hat{Y}(x_{0})\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\: S\,\sqrt{1+\frac{1}{n}+\frac{(x_{0}-\overline{x})^{2}}{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}.
\end{equation}
<a name="eq-SLR-pred-int-formula" id="eq-SLR-pred-int-formula"></a>
We notice that the prediction interval in Equation <a href="#eq-SLR-pred-int-formula">eq-SLR-pred-int-formula</a> is wider than the confidence interval in Equation <a href="#eq-SLR-conf-int-formula">eq-SLR-conf-int-formula</a>, as we expected at the beginning of the section.
</p>

</div>

<div id="outline-container-11-2-5-1" class="outline-5">
<h5 id="sec-11-2-5-1"><span class="section-number-5">11.2.5.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-2-5-1">


<p>
Confidence and prediction intervals are calculated in \(\mathsf{R}\) with the <code>predict</code>\index{predict@\texttt{predict}} function, which we encountered in Section <a href="#sec-11-2-2">SLR Point Estimation</a>. There we neglected to take advantage of its additional <code>interval</code> argument. The general syntax follows. 
</p>

<div class="exampletoo">
<p>We will find confidence and prediction intervals for the stopping distance of a car travelling 5, 6, and 21 mph (note from the graph that there are no collected data for these speeds). We have computed <code>cars.lm</code> earlier, and we will use this for input to the <code>predict</code> function. Also, we need to tell \(\mathsf{R}\) the values of \(x_{0}\) at which we want the predictions made, and store the \(x_{0}\) values in a data frame whose variable is labeled with the correct name. <i>This is important</i>. 
</p>



<pre class="src src-R">new <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(speed = c(5, 6, 21))
</pre>


<p>
Next we instruct \(\mathsf{R}\) to calculate the intervals. Confidence intervals are given by 
</p>



<pre class="src src-R">predict(cars.lm, newdata = new, interval = <span style="font-style: italic;">"confidence"</span>)
</pre>



<pre class="src src-R">carsCI <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> round(predict(cars.lm, newdata = new, interval = <span style="font-style: italic;">"confidence"</span>), 2)
</pre>


<p>
Prediction intervals are given by
</p>



<pre class="src src-R">predict(cars.lm, newdata = new, interval = <span style="font-style: italic;">"prediction"</span>)
</pre>



<pre class="src src-R">carsPI <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> round(predict(cars.lm, newdata = new, interval = <span style="font-style: italic;">"prediction"</span>), 2)
</pre>



</div>

<p>
The type of interval is dictated by the <code>interval</code> argument (which is <code>none</code> by default), and the default confidence level is 95\% (which can be changed with the <code>level</code> argument). 
</p>

<div class="exampletoo">
<p>Using the <code>cars</code> data,
</p><ol>
<li>Report a point estimate of and a 95% confidence interval for the mean stopping distance for a car travelling 5 mph.
   The fitted value for \(x=5\) is \( SRC_R{carsCI[1, 1]} \), so a point estimate would be \( SRC_R{carsCI[1, 1]} \) ft. The 95% CI is given by \( [ SRC_R{carsCI[1, 2]}, SRC_R{carsCI[1, 3]} ] \), so with 95% confidence the mean stopping distance lies somewhere between \( SRC_R{carsCI[1, 2]} \) ft and \( SRC_R{carsCI[1, 3]} \) ft.
</li>
<li>Report a point prediction for and a 95% prediction interval for the stopping distance of a hypothetical car travelling 21 mph.
   The fitted value for \(x = 21\) is \( SRC_R{carsPI[3, 1]} \), so a point prediction for the stopping distance is \( SRC_R{carsPI[3, 1]} \) ft. The 95% PI is \( [ SRC_R{carsPI[3, 2]}, SRC_R{carsPI[3, 3]} ] \), so with 95% confidence we may assert that the hypothetical stopping distance for a car travelling 21 mph would lie somewhere between \( SRC_R{carsPI[3, 2]} \) ft and \( SRC_R{carsPI[3, 3]} \) ft.
</li>
</ol>



</div>

</div>
</div>

</div>

<div id="outline-container-11-2-6" class="outline-4">
<h4 id="sec-11-2-6"><span class="section-number-4">11.2.6</span> Graphing the Confidence and Prediction Bands</h4>
<div class="outline-text-4" id="text-11-2-6">


<p>
We earlier guessed that a bound on the value of a single new observation would be inherently less certain than a bound for an average (mean) value; therefore, we expect the CIs for the mean to be tighter than the PIs for a new observation. A close look at the standard deviations in Equations <a href="#eq-SLR-conf-int-formula">eq-SLR-conf-int-formula</a> and <a href="#eq-SLR-pred-int-formula">eq-SLR-pred-int-formula</a> confirms our guess, but we would like to see a picture to drive the point home.
</p>
<p>
We may plot the confidence and prediction intervals with one fell swoop using the <code>ci.plot</code> function from the <code>HH</code> package \cite{Heibergerhh}. The graph is displayed in Figure <a href="#fig-Scatter-cars-CIPI">Scatter-cars-CIPI</a>.
</p>



<div id="fig-Scatter-cars-CIPI" class="figure">
  <p><img src="svg/slr/carscipi.svg" width=500 alt="svg/slr/carscipi.svg" /></p>
  <p>A scatterplot with confidence/prediction bands for the <code>cars</code> data.</p>
</div>


<pre class="src src-R"><span style="font-weight: bold; text-decoration: underline;">library</span>(HH)
ci.plot(cars.lm)
</pre>


<p>
Notice that the bands curve outward from the regression line as the \(x\) values move away from the center. This is expected once we notice the \((x_{0}-\overline{x})^{2}\) term in the standard deviation formulas in Equations <a href="#eq-SLR-conf-int-formula">eq-SLR-conf-int-formula</a> and <a href="#eq-SLR-pred-int-formula">eq-SLR-pred-int-formula</a>.
</p>






</div>
</div>

</div>

<div id="outline-container-sec-Model-Utility-SLR" class="outline-3">
<h3 id="sec-Model-Utility-SLR"><a name="sec-11-3" id="sec-11-3"></a><span class="section-number-3">11.3</span> Model Utility and Inference</h3>
<div class="outline-text-3" id="text-sec-Model-Utility-SLR">



</div>

<div id="outline-container-sub-slr-hypoth-test-params" class="outline-4">
<h4 id="sub-slr-hypoth-test-params"><a name="sec-11-3-1" id="sec-11-3-1"></a><span class="section-number-4">11.3.1</span> Hypothesis Tests for the Parameters</h4>
<div class="outline-text-4" id="text-sub-slr-hypoth-test-params">


<p>
Much of the attention of SLR is directed toward \(\beta_{1}\) because when \( \beta_{1}\neq 0 \) the mean value of \(Y\) increases (or decreases) as \(x\) increases. It is really boring when \(\beta_{1}=0\), because in that case the mean value of \(Y\) remains the same, regardless of the value of \(x\) (when the regression assumptions hold, of course). It is thus very important to decide whether or not \( \beta_{1} = 0 \). We address the question with a statistical test of the null hypothesis \(H_{0}:\beta_{1}=0\) versus the alternative hypothesis \(H_{1}:\beta_{1}\neq0\), and to do that we need to know the sampling distribution of \(b_{1}\) when the null hypothesis is true.
</p>
<p>
To this end we already know from Section <a href="#sec-11-2-4">SLR Interval Estimation</a> that the quantity
</p>


\begin{equation} 
T=\frac{b_{1}-\beta_{1}}{S_{b_{1}}}
\end{equation}
<p>
has a \(\mathsf{t}(\mathtt{df}=n-2)\) distribution; therefore, when \(\beta_{1}=0\) the quantity \(b_{1}/S_{b_{1}}\) has a \(\mathsf{t}(\mathtt{df}=n-2)\) distribution and we can compute a \(p\)-value by comparing the observed value of \(b_{1}/S{}_{b_{1}}\) with values under a \(\mathsf{t}(\mathtt{df}=n-2)\) curve. 
</p>
<p>
Similarly, we may test the hypothesis \(H_{0}:\beta_{0}=0\) versus the alternative \(H_{1}:\beta_{0}\neq0\) with the statistic \(T=b_{0}/S_{b_{0}}\), where \(S_{b_{0}}\) is given in Section <a href="#sec-11-2-4">SLR Interval Estimation</a>. The test is conducted the same way as for \(\beta_{1}\). 
</p>

</div>

<div id="outline-container-11-3-1-1" class="outline-5">
<h5 id="sec-11-3-1-1"><span class="section-number-5">11.3.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-3-1-1">


<p>
Let us take another look at the output from <code>summary(cars.lm)</code>:
</p>



<pre class="src src-R">summary(cars.lm)
</pre>



<pre class="example">
Call:
lm(formula = dist ~ speed, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.069  -9.525  -2.272   9.215  43.201 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -17.5791     6.7584  -2.601   0.0123 *  
speed         3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared: 0.6511,	Adjusted R-squared: 0.6438 
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12
</pre>


<p>
In the <code>Coefficients</code> section we find the \(t\) statistics and the \(p\)-values associated with the tests that the respective parameters are zero in the fourth and fifth columns. Since the \(p\)-values are (much) less than 0.05, we conclude that there is strong evidence that the parameters \(\beta_{1}\neq0\) and \(\beta_{0}\neq0\), and as such, we say that there is a statistically significant linear relationship between <code>dist</code> and <code>speed</code>. 
</p>
</div>
</div>

</div>

<div id="outline-container-11-3-2" class="outline-4">
<h4 id="sec-11-3-2"><span class="section-number-4">11.3.2</span> Simple Coefficient of Determination</h4>
<div class="outline-text-4" id="text-11-3-2">


<p>
It would be nice to have a single number that indicates how well our linear regression model is doing, and the <i>simple coefficient of determination</i> is designed for that purpose. In what follows, we observe the values \(Y_{1}\), \(Y_{2}\), &hellip;,\(Y_{n}\), and the goal is to estimate \(\mu(x_{0})\), the mean value of \(Y\) at the location \(x_{0}\). 
</p>
<p>
If we disregard the dependence of \(Y\) and \(x\) and base our estimate only on the \(Y\) values then a reasonable choice for an estimator is just the MLE of \(\mu\), which is \(\overline{Y}\). Then the errors incurred by the estimate are just \(Y_{i}-\overline{Y}\) and the variation about the estimate as measured by the sample variance is proportional to
\begin{equation}
SSTO=\sum_{i=1}^{n}(Y_{i}-\overline{Y})^{2}.
\end{equation}
The acronym \(SSTO\) stands for <i>total sum of squares</i>.  And we have additional information, namely, we have values \(x_{i}\) associated with each value of \(Y_{i}\). We have seen that this information leads us to the estimate \(\hat{Y_{i}}\) and the errors incurred are just the residuals, \(E_{i}=Y_{i}-\hat{Y_{i}}\). The variation associated with these errors can be measured with 
\begin{equation}
SSE=\sum_{i=1}^{n}(Y_{i}-\hat{Y_{i}})^{2}.
\end{equation}
We have seen the \(SSE\) before, which stands for the <i>sum of squared errors</i> or <i>error sum of squares</i>. Of course, we would expect the error to be less in the latter case, since we have used more information. The improvement in our estimation as a result of the linear regression model can be measured with the difference
\[
(Y_{i}-\overline{Y})-(Y_{i}-\hat{Y_{i}})=\hat{Y_{i}}-\overline{Y},
\]
and we measure the variation in these errors with
\begin{equation}
SSR=\sum_{i=1}^{n}(\hat{Y_{i}}-\overline{Y})^{2},
\end{equation}
also known as the <i>regression sum of squares</i>. It is not obvious, but some algebra proved a famous result known as the <b>ANOVA Equality</b>:
\begin{equation}
\sum_{i=1}^{n}(Y_{i}-\overline{Y})^{2}=\sum_{i=1}^{n}(\hat{Y_{i}}-\overline{Y})^{2}+\sum_{i=1}^{n}(Y_{i}-\hat{Y_{i}})^{2}
\end{equation}
<a name="eq-anovaeq" id="eq-anovaeq"></a>
or in other words,
\begin{equation}
SSTO=SSR+SSE.
\end{equation}
This equality has a nice interpretation. Consider \(SSTO\) to be the <i>total variation</i> of the errors. Think of a decomposition of the total variation into pieces: one piece measuring the reduction of error from using the linear regression model, or <i>explained variation</i> (\(SSR\)), while the other represents what is left over, that is, the errors that the linear regression model doesn't explain, or <i>unexplained variation</i> (\(SSE\)). In this way we see that the ANOVA equality merely partitions the variation into 
\[
\mbox{total variation}=\mbox{explained variation}+\mbox{unexplained variation}.
\]
For a single number to summarize how well our model is doing we use the <i>simple coefficient of determination</i> \(r^{2}\), defined by
\begin{equation}
r^{2}=1-\frac{SSE}{SSTO}.
\end{equation}
We interpret \(r^{2}\) as the proportion of total variation that is explained by the simple linear regression model. When \(r^{2}\) is large, the model is doing a good job; when \(r^{2}\) is small, the model is not doing a good job.
</p>
<p>
Related to the simple coefficient of determination is the sample correlation coefficient, \(r\). As you can guess, the way we get \(r\) is by the formula \(|r|=\sqrt{r^{2}}\). The sign of \(r\) is equal the sign of the slope estimate \(b_{1}\). That is, if the regression line \(\hat{\mu}(x)\) has positive slope, then \(r=\sqrt{r^{2}}\). Likewise, if the slope of \(\hat{\mu}(x)\) is negative, then \(r=-\sqrt{r^{2}}\).
</p>

</div>

<div id="outline-container-11-3-2-1" class="outline-5">
<h5 id="sec-11-3-2-1"><span class="section-number-5">11.3.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-3-2-1">


<p>
The primary method to display partitioned sums of squared errors is with an <i>ANOVA table</i>. The command in \(\mathsf{R}\) to produce such a table is <code>anova</code>. The input to <code>anova</code> is the result of an <code>lm</code> call which for the <code>cars</code> data is <code>cars.lm</code>.
</p>



<pre class="src src-R">anova(cars.lm)
</pre>


<pre class="example">
Analysis of Variance Table

Response: dist
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
speed      1  21186 21185.5  89.567 1.49e-12 ***
Residuals 48  11354   236.5                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</pre>


<p>
The output gives
\[
r^{2}=1-\frac{SSE}{SSR+SSE}=1-\frac{11353.5}{21185.5+11353.5}\approx0.65.
\]

The interpretation should be: ``The linear regression line accounts for approximately 65% of the variation of <code>dist</code> as explained by <code>speed</code>''.
</p>
<p>
The value of \(r^{2}\) is stored in the <code>r.squared</code> component of <code>summary(cars.lm)</code>, which we called <code>carsumry</code>.
</p>



<pre class="src src-R">carsumry$r.squared
</pre>


<pre class="example">
[1] 0.6510794
</pre>


<p>
We already knew this. We saw it in the next to the last line of the <code>summary(cars.lm)</code> output where it was called <code>Multiple R-squared</code>. Listed right beside it is the <code>Adjusted R-squared</code> which we will discuss in Chapter <a href="#sec-12">Multiple Linear Regression</a>.  For the <code>cars</code> data, we find \(r\) to be
</p>



<pre class="src src-R">sqrt(carsumry$r.squared)
</pre>


<pre class="example">
[1] 0.8068949
</pre>


<p>
We choose the principal square root because the slope of the regression line is positive.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-slr-overall-F-statistic" class="outline-4">
<h4 id="sub-slr-overall-F-statistic"><a name="sec-11-3-3" id="sec-11-3-3"></a><span class="section-number-4">11.3.3</span> Overall <i>F</i> statistic</h4>
<div class="outline-text-4" id="text-sub-slr-overall-F-statistic">


<p>
There is another way to test the significance of the linear regression model. In SLR, the new way also tests the hypothesis \(H_{0}:\beta_{1}=0\) versus \(H_{1}:\beta_{1}\neq0\), but it is done with a new test statistic called the <i>overall F statistic</i>. It is defined by
</p>


\begin{equation}
F=\frac{SSR}{SSE/(n-2)}.
\end{equation}
<p>
<a name="eq-slr-overall-F-statistic" id="eq-slr-overall-F-statistic"></a>
</p>
<p>
Under the regression assumptions and when \(H_{0}\) is true, the \(F\) statistic has an \(\mathtt{f}(\mathtt{df1}=1,\,\mathtt{df2}=n-2)\) distribution. We reject \(H_{0}\) when \(F\) is large &ndash; that is, when the explained variation is large relative to the unexplained variation.
</p>
<p>
All this being said, we have not yet gained much from the overall \(F\) statistic because we already knew from Section <a href="#sec-11-3-1">SLR Hypothesis Testing</a> how to test \(H_{0}:\beta_{1}=0\)&hellip; we use the Student's \(t\) statistic. What is worse is that (in the simple linear regression model) it can be proved that the \(F\) in Equation <a href="#eq-slr-overall-F-statistic">SLR Overall F</a> is exactly the Student's \(t\) statistic for \(\beta_{1}\) squared,
</p>


\begin{equation}
F=\left(\frac{b_{1}}{S_{b_{1}}}\right)^{2}.
\end{equation}

<p>
So why bother to define the \(F\) statistic? Why not just square the \(t\) statistic and be done with it? The answer is that the \(F\) statistic has a more complicated interpretation and plays a more important role in the multiple linear regression model which we will study in Chapter <a href="#sec-12">Multiple Linear Regression</a>. See Section <a href="#sec-12-3-2">MLR Overall F</a> for details.
</p>

</div>

<div id="outline-container-11-3-3-1" class="outline-5">
<h5 id="sec-11-3-3-1"><span class="section-number-5">11.3.3.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-3-3-1">


<p>
The overall \(F\) statistic and \(p\)-value are displayed in the bottom line of the <code>summary(cars.lm)</code> output. It is also shown in the final columns of <code>anova(cars.lm)</code>:
</p>



<pre class="src src-R">anova(cars.lm)
</pre>


<pre class="example">
Analysis of Variance Table

Response: dist
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
speed      1  21186 21185.5  89.567 1.49e-12 ***
Residuals 48  11354   236.5                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</pre>




<p>
Here we see that the \(F\) statistic is \(  89.57 \) with a \(p\)-value very close to zero. The conclusion: there is very strong evidence that \(H_{0}:\beta_{1} = 0 \) is false, that is, there is strong evidence that \( \beta_{1} \neq 0 \). Moreover, we conclude that the regression relationship between <code>dist</code> and <code>speed</code> is significant.
</p>
<p>
Note that the value of the \(F\) statistic is the same as the Student's \(t\) statistic for <code>speed</code> squared.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Residual-Analysis-SLR" class="outline-3">
<h3 id="sec-Residual-Analysis-SLR"><a name="sec-11-4" id="sec-11-4"></a><span class="section-number-3">11.4</span> Residual Analysis</h3>
<div class="outline-text-3" id="text-sec-Residual-Analysis-SLR">


<p>
We know from our model that \(Y=\mu(x)+\epsilon\), or in other words, \(\epsilon=Y-\mu(x)\). Further, we know that \(\epsilon\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma)\). We may estimate \(\epsilon_{i}\) with the <i>residual</i> \(E_{i}=Y_{i}-\hat{Y_{i}}\), where \(\hat{Y_{i}}=\hat{\mu}(x_{i})\). If the regression assumptions hold, then the residuals should be normally distributed. We check this in Section <a href="#sec-11-4-1">Normality Assumption</a>. Further, the residuals should have mean zero with constant variance \(\sigma^{2}\), and we check this in Section <a href="#sec-11-4-2">Constant Variance Assumption</a>. Last, the residuals should be independent, and we check this in Section <a href="#sec-11-4-3">Independence Assumption</a>.
</p>
<p>
In every case, we will begin by looking at residual plots &ndash; that is, scatterplots of the residuals \(E_{i}\) versus index or predicted values \(\hat{Y_{i}}\) &ndash; and follow up with hypothesis tests.
</p>

</div>

<div id="outline-container-sub-Normality-Assumption" class="outline-4">
<h4 id="sub-Normality-Assumption"><a name="sec-11-4-1" id="sec-11-4-1"></a><span class="section-number-4">11.4.1</span> Normality Assumption</h4>
<div class="outline-text-4" id="text-sub-Normality-Assumption">


<p>
We can assess the normality of the residuals with graphical methods and hypothesis tests. To check graphically whether the residuals are normally distributed we may look at histograms or <i>q-q</i> plots. We first examine a histogram in Figure <a href="#fig-Normal-q-q-plot-cars">Normal-q-q-plot-cars</a>. There we see that the distribution of the residuals appears to be mound shaped, for the most part. We can plot the order statistics of the sample versus quantiles from a \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)\) distribution with the command <code>plot(cars.lm, which = 2)</code>, and the results are in Figure <a href="#fig-Normal-q-q-plot-cars">Normal-q-q-plot-cars</a>. If the assumption of normality were true, then we would expect points randomly scattered about the dotted straight line displayed in the figure. In this case, we see a slight departure from normality in that the dots show systematic clustering on one side or the other of the line. The points on the upper end of the plot also appear begin to stray from the line. We would say there is some evidence that the residuals are not perfectly normal. 
</p>



<div id="fig-Normal-q-q-plot-cars" class="figure">
  <p><img src="svg/slr/Normal-q-q-plot-cars.svg" width=500 alt="svg/slr/Normal-q-q-plot-cars.svg" /></p>
  <p>Normal q-q plot of the residuals for the <code>cars</code> data.</p>
</div>


<pre class="src src-R">plot(cars.lm, which = 2)
</pre>







</div>

<div id="outline-container-11-4-1-1" class="outline-5">
<h5 id="sec-11-4-1-1"><span class="section-number-5">11.4.1.1</span> Testing the Normality Assumption</h5>
<div class="outline-text-5" id="text-11-4-1-1">


<p>
Even though we may be concerned about the plots, we can use tests to determine if the evidence present is statistically significant, or if it could have happened merely by chance. There are many statistical tests of normality. We will use the Shapiro-Wilk test, since it is known to be a good test and to be quite powerful. However, there are many other fine tests of normality including the Anderson-Darling test and the Lillefors test, just to mention two of them.  
</p>
<p>
The Shapiro-Wilk test is based on the statistic
\begin{equation}
W=\frac{\left(\sum_{i=1}^{n}a_{i}E_{(i)}\right)^{2}}{\sum_{j=1}^{n}E_{j}^{2}},
\end{equation}
where the \(E_{(i)}\) are the ordered residuals and the \(a_{i}\) are constants derived from the order statistics of a sample of size \(n\) from a normal distribution. See Section <a href="#sec-10-5-2">Shapiro Wilk Normality Test</a>.
We perform the Shapiro-Wilk test below, using the <code>shapiro.test</code> function from the <code>stats</code> package. The hypotheses are
\[
H_{0}:\mbox{ the residuals are normally distributed }
\]
versus
\[
H_{1}:\mbox{ the residuals are not normally distributed.}
\]
The results from \(\mathsf{R}\) are
</p>



<pre class="src src-R">shapiro.test(residuals(cars.lm))
</pre>


<pre class="example">

	Shapiro-Wilk normality test

data:  residuals(cars.lm) 
W = 0.9451, p-value = 0.02153
</pre>


<p>
For these data we would reject the assumption of normality of the residuals at the \(\alpha=0.05\) significance level, but do not lose heart, because the regression model is reasonably robust to departures from the normality assumption. As long as the residual distribution is not highly skewed, then the regression estimators will perform reasonably well. Moreover, departures from constant variance and independence will sometimes affect the quantile plots and histograms, therefore it is wise to delay final decisions regarding normality until all diagnostic measures have been investigated.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-Constant-Variance-Assumption" class="outline-4">
<h4 id="sub-Constant-Variance-Assumption"><a name="sec-11-4-2" id="sec-11-4-2"></a><span class="section-number-4">11.4.2</span> Constant Variance Assumption</h4>
<div class="outline-text-4" id="text-sub-Constant-Variance-Assumption">


<p>
We will again go to residual plots to try and determine if the spread of the residuals is changing over time (or index). However, it is unfortunately not that easy because the residuals do not have constant variance! In fact, it can be shown that the variance of the residual \(E_{i}\) is 
\begin{equation}
\mbox{Var$(E_{i})$}=\sigma^{2}(1-h_{ii}),\quad i=1,2,\ldots,n,
\end{equation}
where \(h_{ii}\) is a quantity called the <i>leverage</i> which is defined below. Consequently, in order to check the constant variance assumption we must standardize the residuals before plotting. We estimate the standard error of \(E_{i}\) with \(s_{E_{i}}=s\sqrt{(1-h_{ii})}\) and define the <i>standardized residuals</i> \(R_{i}\), \(i=1,2,\ldots,n\), by 
\begin{equation} 
R_{i}=\frac{E_{i}}{s\,\sqrt{1-h_{ii}}},\quad i=1,2,\ldots,n.
\end{equation}
For the constant variance assumption we do not need the sign of the residual so we will plot \(\sqrt{|R_{i}|}\) versus the fitted values. As we look at a scatterplot of \(\sqrt{|R_{i}|}\) versus \(\hat{Y}_{i}\) we would expect under the regression assumptions to see a constant band of observations, indicating no change in the magnitude of the observed distance from the line. We want to watch out for a fanning-out of the residuals, or a less common funneling-in of the residuals. Both patterns indicate a change in the residual variance and a consequent departure from the regression assumptions, the first an increase, the second a decrease.
</p>
<p>
In this case, we plot the standardized residuals versus the fitted values. The graph may be seen in Figure <a href="#fig-std-resids-fitted-cars">std-resids-fitted-cars</a>. For these data there does appear to be somewhat of a slight fanning-out of the residuals.
</p>



<div id="fig-std-resids-fitted-cars" class="figure">
  <p><img src="svg/slr/std-resids-fitted-cars.svg" width=500 alt="svg/slr/std-resids-fitted-cars.svg" /></p>
  <p>Plot of standardized residuals against the fitted values for the <code>cars</code> data.</p>
</div>


<pre class="src src-R">plot(cars.lm, which = 3)
</pre>







</div>

<div id="outline-container-11-4-2-1" class="outline-5">
<h5 id="sec-11-4-2-1"><span class="section-number-5">11.4.2.1</span> Testing the Constant Variance Assumption</h5>
<div class="outline-text-5" id="text-11-4-2-1">


<p>
We will use the Breusch-Pagan test to decide whether the variance of the residuals is nonconstant. The null hypothesis is that the variance is the same for all observations, and the alternative hypothesis is that the variance is not the same for all observations. The test statistic is found by fitting a linear model to the centered squared residuals,
\begin{equation}
W_{i} = E_{i}^{2} - \frac{SSE}{n}, \quad i=1,2,\ldots,n.
\end{equation}

By default the same explanatory variables are used in the new model which produces fitted values \(\hat{W}_{i}\), \(i=1,2,\ldots,n\). The Breusch-Pagan test statistic in \(\mathsf{R}\) is then calculated with 
\begin{equation}
BP=n\sum_{i=1}^{n}\hat{W}_{i}^{2}\div\sum_{i=1}^{n}W_{i}^{2}.
\end{equation}
We reject the null hypothesis if \(BP\) is too large, which happens when the explained variation i the new model is large relative to the unexplained variation in the original model.
We do it in \(\mathsf{R}\) with the <code>bptest</code> function from the <code>lmtest</code> package \cite{Zeileislmtest}. 
</p>


<pre class="src src-R">bptest(cars.lm)
</pre>


<pre class="example">

	studentized Breusch-Pagan test

data:  cars.lm 
BP = 3.2149, df = 1, p-value = 0.07297
</pre>


<p>
For these data we would not reject the null hypothesis at the \(\alpha=0.05\) level. There is relatively weak evidence against the assumption of constant variance. 
</p>
</div>
</div>

</div>

<div id="outline-container-sub-Independence-Assumption" class="outline-4">
<h4 id="sub-Independence-Assumption"><a name="sec-11-4-3" id="sec-11-4-3"></a><span class="section-number-4">11.4.3</span> Independence Assumption</h4>
<div class="outline-text-4" id="text-sub-Independence-Assumption">


<p>
One of the strongest of the regression assumptions is the one regarding independence. Departures from the independence assumption are often exhibited by correlation (or autocorrelation, literally, self-correlation) present in the residuals. There can be positive or negative correlation.
</p>
<p>
Positive correlation is displayed by positive residuals followed by positive residuals, and negative residuals followed by negative residuals. Looking from left to right, this is exhibited by a cyclical feature in the residual plots, with long sequences of positive residuals being followed by long sequences of negative ones.
</p>
<p>
On the other hand, negative correlation implies positive residuals followed by negative residuals, which are then followed by positive residuals, <i>etc</i>. Consequently, negatively correlated residuals are often associated with an alternating pattern in the residual plots. We examine the residual plot in Figure <a href="#fig-resids-fitted-cars">resids-fitted-cars</a>. There is no obvious cyclical wave pattern or structure to the residual plot. 
</p>



<div id="fig-resids-fitted-cars" class="figure">
  <p><img src="svg/slr/resids-fitted-cars.svg" width=500 alt="svg/slr/resids-fitted-cars.svg" /></p>
  <p>A plot of the residuals versus the fitted values for the <code>cars</code>
 data.</p>
</div>


<pre class="src src-R">plot(cars.lm, which = 1)
</pre>







</div>

<div id="outline-container-11-4-3-1" class="outline-5">
<h5 id="sec-11-4-3-1"><span class="section-number-5">11.4.3.1</span> Testing the Independence Assumption</h5>
<div class="outline-text-5" id="text-11-4-3-1">


<p>
We may statistically test whether there is evidence of autocorrelation in the residuals with the Durbin-Watson test. The test is based on the statistic
\begin{equation}
D=\frac{\sum_{i=2}^{n}(E_{i}-E_{i-1})^{2}}{\sum_{j=1}^{n}E_{j}^{2}}.
\end{equation}
Exact critical values are difficult to obtain, but \(\mathsf{R}\) will calculate the <i>p-value</i> to great accuracy. It is performed with the <code>dwtest</code> function from the <code>lmtest</code> package. We will conduct a two sided test that the correlation is not zero, which is not the default (the default is to test that the autocorrelation is positive).
</p>



<pre class="src src-R">dwtest(cars.lm, alternative = <span style="font-style: italic;">"two.sided"</span>)
</pre>


<pre class="example">

	Durbin-Watson test

data:  cars.lm 
DW = 1.6762, p-value = 0.1904
alternative hypothesis: true autocorrelation is not 0
</pre>


<p>
In this case we do not reject the null hypothesis at the \(\alpha=0.05\) significance level; there is very little evidence of nonzero autocorrelation in the residuals.
</p>
</div>
</div>

</div>

<div id="outline-container-11-4-4" class="outline-4">
<h4 id="sec-11-4-4"><span class="section-number-4">11.4.4</span> Remedial Measures</h4>
<div class="outline-text-4" id="text-11-4-4">


<p>
We often find problems with our model that suggest that at least one of the three regression assumptions is violated. What do we do then? There are many measures at the statistician's disposal, and we mention specific steps one can take to improve the model under certain types of violation.
</p>
<dl>
<dt>Mean response is not linear</dt><dd>We can directly modify the model to better approximate the mean response. In particular, perhaps a polynomial regression function of the form 
  \[
  \mu(x) = \beta_{0} + \beta_{1}x_{1} + \beta_{2}x_{1}^{2}
  \]
  would be appropriate. Alternatively, we could have a function of the form
  \[
  \mu(x)=\beta_{0}\mathrm{e}^{\beta_{1}x}.
  \]
  Models like these are studied in nonlinear regression courses.
</dd>
<dt>Error variance is not constant</dt><dd>Sometimes a transformation of the dependent variable will take care of the problem. There is a large class of them called <i>Box-Cox transformations</i>. They take the form 
  \begin{equation}
  Y^{\ast}=Y^{\lambda},
  \end{equation}
  where \(\lambda\) is a constant. (The method proposed by Box and Cox will determine a suitable value of \(\lambda\) automatically by maximum likelihood). The class contains the transformations 
  \begin{alignat*}{1}
  \lambda=2,\quad & Y^{\ast}=Y^{2}\\
  \lambda=0.5,\quad & Y^{\ast}=\sqrt{Y}\\
  \lambda=0,\quad & Y^{\ast}=\ln\: Y\\
  \lambda=-1,\quad & Y^{\ast}=1/Y
  \end{alignat*}
  Alternatively, we can use the method of <i>weighted least squares</i>. This is studied in more detail in later classes. 
</dd>
<dt>Error distribution is not normal</dt><dd>The same transformations for stabilizing the variance are equally appropriate for smoothing the residuals to a more Gaussian form. In fact, often we will kill two birds with one stone.
</dd>
<dt>Errors are not independent</dt><dd>There is a large class of autoregressive models to be used in this situation which occupy the latter part of Chapter <a href="#sec-16">Time Series</a>.
</dd>
</dl>


</div>
</div>

</div>

<div id="outline-container-sec-Other-Diagnostic-Tools-SLR" class="outline-3">
<h3 id="sec-Other-Diagnostic-Tools-SLR"><a name="sec-11-5" id="sec-11-5"></a><span class="section-number-3">11.5</span> Other Diagnostic Tools</h3>
<div class="outline-text-3" id="text-sec-Other-Diagnostic-Tools-SLR">


<p>
There are two types of observations with which we must be especially careful:
</p><dl>
<dt>Influential observations</dt><dd>are those that have a substantial effect on our estimates, predictions, or inferences. A small change in an influential observation is followed by a large change in the parameter estimates or inferences. 
</dd>
<dt>Outlying observations</dt><dd>are those that fall fall far from the rest of the data. They may be indicating a lack of fit for our regression model, or they may just be a mistake or typographical error that should be corrected. Regardless, special attention should be given to these observations. An outlying observation may or may not be influential.
</dd>
</dl>


<p>
We will discuss outliers first because the notation builds sequentially in that order.
</p>
</div>

<div id="outline-container-11-5-1" class="outline-4">
<h4 id="sec-11-5-1"><span class="section-number-4">11.5.1</span> Outliers</h4>
<div class="outline-text-4" id="text-11-5-1">

<p>There are three ways that an observation \((x_{i},y_{i})\) might be identified as an  outlier: it can have an \(x_{i}\) value which falls far from the other  \(x\) values, it can have a \(y_{i}\) value which falls far from the other \(y\) values, or it can have both its \(x_{i}\) and \(y_{i}\) values falling far from the other \(x\) and \(y\) values.
</p></div>

</div>

<div id="outline-container-11-5-2" class="outline-4">
<h4 id="sec-11-5-2"><span class="section-number-4">11.5.2</span> Leverage</h4>
<div class="outline-text-4" id="text-11-5-2">

<p>Leverage statistics are designed to identify observations which have \(x\) values that are far away from the rest of the data. In the simple linear regression model the leverage of \(x_{i}\) is denoted by \(h_{ii}\) and defined by 
\begin{equation}
h_{ii}=\frac{1}{n}+\frac{(x_{i}-\overline{x})^{2}}{\sum_{k=1}^{n}(x_{k}-\overline{x})^{2}},\quad i=1,2,\ldots,n.
\end{equation}
The formula has a nice interpretation in the SLR model: if the distance from \(x_{i}\) to \(\overline{x}\) is large relative to the other \(x\)'s then \(h_{ii}\) will be close to 1. 
</p>
<p>
Leverages have nice mathematical properties; for example, they satisfy
\begin{equation}
0\leq h_{ii}\leq1,
\end{equation}
<a name="eq-slr-leverage-between" id="eq-slr-leverage-between"></a>
and their sum is
\begin{eqnarray}
\sum_{i=1}^{n}h_{ii} & = & \sum_{i=1}^{n}\left[\frac{1}{n}+\frac{(x_{i}-\overline{x})^{2}}{\sum_{k=1}^{n}(x_{k}-\overline{x})^{2}}\right],\\
 & = & \frac{n}{n}+\frac{\sum_{i}(x_{i}-\overline{x})^{2}}{\sum_{k}(x_{k}-\overline{x})^{2}},\\
 & = & 2.
<<eq-slr-average-leverage>>(INVISIBLE)
\end{eqnarray}

A rule of thumb is to consider leverage values to be large if they are more than double their average size (which is \(2/n\) according to Equation <a href="#eq-slr-average-leverage">eq-slr-average-leverage</a>). So leverages larger than \(4/n\) are suspect. Another rule of thumb is to say that values bigger than 0.5 indicate high leverage, while values between 0.3 and 0.5 indicate moderate leverage.
</p>
</div>

</div>

<div id="outline-container-11-5-3" class="outline-4">
<h4 id="sec-11-5-3"><span class="section-number-4">11.5.3</span> Standardized and Studentized Deleted Residuals</h4>
<div class="outline-text-4" id="text-11-5-3">


<p>
We have already encountered the <i>standardized residuals</i> \(r_{i}\) in Section <a href="#sec-11-4-2">Constant Variance Assumption</a>; they are merely residuals that have been divided by their respective standard deviations: 
\begin{equation}
R_{i}=\frac{E_{i}}{S\sqrt{1-h_{ii}}},\quad i=1,2,\ldots,n.
\end{equation}
Values of \(|R_{i}| &gt; 2\) are extreme and suggest that the observation has an outlying \(y\)-value. 
</p>
<p>
Now delete the \(i^{\mathrm{th}}\) case and fit the regression function to the remaining \(n - 1\) cases, producing a fitted value \(\hat{Y}_{(i)}\) with <i>deleted residual</i> \(D_{i}=Y_{i}-\hat{Y}_{(i)}\). It is shown in later classes that 
\begin{equation}
\mbox{Var $(D_{i})$}=\frac{S_{(i)}^{2}}{1-h_{ii}},\quad i=1,2,\ldots,n,
\end{equation}
so that the <i>studentized deleted residuals</i> \(t_{i}\) defined by
\begin{equation}
t_{i}=\frac{D_{i}}{S_{(i)}/(1-h_{ii})},\quad i=1,2,\ldots,n,
\end{equation}
<a name="eq-slr-studentized-deleted-resids" id="eq-slr-studentized-deleted-resids"></a>
have a \(\mathsf{t}(\mathtt{df}=n-3)\) distribution and we compare observed values of \(t_{i}\) to this distribution to decide whether or not an observation is extreme. 
</p>
<p>
The folklore in regression classes is that a test based on the statistic in Equation <a href="#eq-slr-studentized-deleted-resids">eq-slr-studentized-deleted-resids</a> can be too liberal. A rule of thumb is if we suspect an observation to be an outlier <i>before</i> seeing the data then we say it is significantly outlying if its two-tailed \(p\)-value is less than \(\alpha\), but if we suspect an observation to be an outlier <i>after</i> seeing the data then we should only say it is significantly outlying if its two-tailed \(p\)-value is less than \(\alpha/n\). The latter rule of thumb is called the <i>Bonferroni approach</i> and can be overly conservative for large data sets. The responsible statistician should look at the data and use his/her best judgement, in every case.
</p>

</div>

<div id="outline-container-11-5-3-1" class="outline-5">
<h5 id="sec-11-5-3-1"><span class="section-number-5">11.5.3.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-5-3-1">


<p>
We can calculate the standardized residuals with the <code>rstandard</code> function. The input is the <code>lm</code> object, which is <code>cars.lm</code>.
</p>



<pre class="src src-R">sres <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rstandard(cars.lm)
sres[1:5]
</pre>


<pre class="example">
         1          2          3          4          5 
 0.2660415  0.8189327 -0.4013462  0.8132663  0.1421624
</pre>


<p>
We can find out which observations have studentized residuals larger than two with the command
</p>



<pre class="src src-R">sres[which(abs(sres) &gt; 2)]
</pre>


<pre class="example">
      23       35       49 
2.795166 2.027818 2.919060
</pre>


<p>
In this case, we see that observations 23, 35, and 49 are potential outliers with respect to their \(y\)-value.  We can compute the studentized deleted residuals with <code>rstudent</code>:
</p>



<pre class="src src-R">sdelres <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rstudent(cars.lm)
sdelres[1:5]
</pre>


<pre class="example">
         1          2          3          4          5 
 0.2634500  0.8160784 -0.3978115  0.8103526  0.1407033
</pre>


<p>
We should compare these values with critical values from a \(\mathsf{t}(\mathtt{df}=n-3)\) distribution, which in this case is \(\mathsf{t}(\mathtt{df}=50-3=47)\). We can calculate a 0.005 quantile and check with 
</p>



<pre class="src src-R">t0.005 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> qt(0.005, df = 47, lower.tail = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
sdelres[which(abs(sdelres) &gt; t0.005)]
</pre>


<pre class="example">
      23       49 
3.022829 3.184993
</pre>


<p>
This means that observations 23 and 49 have a large studentized deleted residual. The leverages can be found with the <code>hatvalues</code> function:
</p>



<pre class="src src-R">leverage <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> hatvalues(cars.lm)
leverage[which(leverage &gt; 4/50)]
</pre>


<pre class="example">
         1          2         50 
0.11486131 0.11486131 0.08727007
</pre>


<p>
Here we see that observations 1, 2, and 50 have leverages bigger than double their mean value. These observations would be considered outlying with respect to their \(x\) value (although they may or may not be influential).
</p>
</div>
</div>

</div>

<div id="outline-container-11-5-4" class="outline-4">
<h4 id="sec-11-5-4"><span class="section-number-4">11.5.4</span> Influential Observations</h4>
<div class="outline-text-4" id="text-11-5-4">



</div>

<div id="outline-container-11-5-4-1" class="outline-5">
<h5 id="sec-11-5-4-1"><span class="section-number-5">11.5.4.1</span> \(DFBETAS\) and \(DFFITS\)</h5>
<div class="outline-text-5" id="text-11-5-4-1">


<p>
Any time we do a statistical analysis, we are confronted with the variability of data. It is always a concern when an observation plays too large a role in our regression model, and we would not like or procedures to be overly influenced by the value of a single observation. Hence, it becomes desirable to check to see how much our estimates and predictions would change if one of the observations were not included in the analysis. If an observation changes the estimates/predictions a large amount, then the observation is influential and should be subjected to a higher level of scrutiny.
</p>
<p>
We measure the change in the parameter estimates as a result of deleting an observation with \(DFBETAS\). The \(DFBETAS\) for the intercept \(b_{0}\) are given by
\begin{equation}
(DFBETAS)_{0(i)}=\frac{b_{0}-b_{0(i)}}{S_{(i)}\sqrt{\frac{1}{n}+\frac{\overline{x}^{2}}{\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}}}},\quad i=1,2,\ldots,n.
\end{equation}
and the \(DFBETAS\) for the slope \(b_{1}\) are given by
\begin{equation}
(DFBETAS)_{1(i)}=\frac{b_{1}-b_{1(i)}}{S_{(i)}\left[\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}\right]^{-1/2}},\quad i=1,2,\ldots,n.
\end{equation}
See Section <a href="#sec-12-8">MLR Residual Analysis</a> for a better way to write these. The signs of the \(DFBETAS\) indicate whether the coefficients would increase or decrease as a result of including the observation. If the \(DFBETAS\) are large, then the observation has a large impact on those regression coefficients. We label observations as suspicious if their \(DFBETAS\) have magnitude greater 1 for small data or \(2/\sqrt{n}\) for large data sets.
We can calculate the \(DFBETAS\) with the <code>dfbetas</code> function (some output has been omitted):
</p>



<pre class="src src-R">dfb <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> dfbetas(cars.lm)
head(dfb)
</pre>


<pre class="example">
  (Intercept)       speed
1  0.09440188 -0.08624563
2  0.29242487 -0.26715961
3 -0.10749794  0.09369281
4  0.21897614 -0.19085472
5  0.03407516 -0.02901384
6 -0.11100703  0.09174024
</pre>


<p>
We see that the inclusion of the first observation slightly increases the <code>Intercept</code> and slightly decreases the coefficient on <code>speed</code>.
</p>
<p>
We can measure the influence that an observation has on its fitted value with \(DFFITS\). These are calculated by deleting an observation, refitting the model, recalculating the fit, then standardizing. The formula is 
\begin{equation}
(DFFITS)_{i}=\frac{\hat{Y_{i}}-\hat{Y}_{(i)}}{S_{(i)}\sqrt{h_{ii}}},\quad i=1,2,\ldots,n.
\end{equation}
The value represents the number of standard deviations of \(\hat{Y_{i}}\) that the fitted value \(\hat{Y_{i}}\) increases or decreases with the inclusion of the \(i^{\textrm{th}}\) observation. We can compute them with the <code>dffits</code> function.
</p>



<pre class="src src-R">dff <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> dffits(cars.lm)
dff[1:5]
</pre>


<pre class="example">
          1           2           3           4           5 
 0.09490289  0.29397684 -0.11039550  0.22487854  0.03553887
</pre>


<p>
A rule of thumb is to flag observations whose \(DFFIT\) exceeds one in absolute value, but there are none of those in this data set.
</p>
</div>

</div>

<div id="outline-container-11-5-4-2" class="outline-5">
<h5 id="sec-11-5-4-2"><span class="section-number-5">11.5.4.2</span> Cook's Distance</h5>
<div class="outline-text-5" id="text-11-5-4-2">


<p>
The \(DFFITS\) are good for measuring the influence on a single fitted value, but we may want to measure the influence an observation has on all of the fitted values simultaneously. The statistics used for measuring this are Cook's distances which may be calculated
by the formula
\begin{equation}
D_{i}=\frac{E_{i}^{2}}{(p+1)S^{2}}\cdot\frac{h_{ii}}{(1-h_{ii})^{2}},\quad i=1,2,\ldots,n.
\end{equation}
<a name="eq-slr-cooks-distance" id="eq-slr-cooks-distance"></a>
It shows that Cook's distance depends both on the residual \(E_{i}\) and the leverage \(h_{ii}\) and in this way \(D_{i}\) contains information about outlying \(x\) and \(y\) values.
</p>
<p>
To assess the significance of \(D\), we compare to quantiles of an \(\mathsf{f}(\mathtt{df1}=2,\,\mathtt{df2}=n-2)\) distribution. A rule of thumb is to classify observations falling higher than the \(50^{\mathrm{th}}\) percentile as being extreme. 
</p>
</div>

</div>

<div id="outline-container-11-5-4-3" class="outline-5">
<h5 id="sec-11-5-4-3"><span class="section-number-5">11.5.4.3</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-11-5-4-3">


<p>
We can calculate the Cook's Distances with the <code>cooks.distance</code> function.
</p>



<pre class="src src-R">cooksD <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cooks.distance(cars.lm)
cooksD[1:4]
</pre>


<pre class="example">
          1           2           3           4 
0.004592312 0.043513991 0.006202350 0.025467338
</pre>


<p>
We can look at a plot of the Cook's distances with the command <code>plot(cars.lm, which = 4)</code>.
</p>



<div id="fig-Cooks-distance-cars" class="figure">
  <p><img src="svg/slr/Cooks-distance-cars.svg" width=500 alt="svg/slr/Cooks-distance-cars.svg" /></p>
  <p>Cook's distances for the <code>cars</code> data.</p>
</div>


<pre class="src src-R">plot(cars.lm, which = 4)
</pre>






<p>
Observations with the largest Cook's D values are labeled, hence we see that observations 23, 39, and 49 are suspicious. However, we need to compare to the quantiles of an \( \mathsf{f}(\mathtt{df1} = 2, \, \mathtt{df2} = 48) \) distribution:
</p>



<pre class="src src-R">F0.50 <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> qf(0.5, df1 = 2, df2 = 48)
any(cooksD &gt; F0.50)
</pre>


<pre class="example">
[1] FALSE
</pre>


<p>
We see that with this data set there are no observations with extreme Cook's distance, after all.
</p>
</div>
</div>

</div>

<div id="outline-container-11-5-5" class="outline-4">
<h4 id="sec-11-5-5"><span class="section-number-4">11.5.5</span> All Influence Measures Simultaneously</h4>
<div class="outline-text-4" id="text-11-5-5">


<p>
We can display the result of diagnostic checking all at once in one table, with potentially influential points displayed. We do it with the command <code>influence.measures(cars.lm)</code>:
</p>



<pre class="src src-R">influence.measures(cars.lm)
</pre>


<p>
The output is a huge matrix display, which we have omitted in the interest of brevity. A point is identified if it is classified to be influential with respect to any of the diagnostic measures. Here we see that observations 2, 11, 15, and 18 merit further investigation.  
</p>
<p>
We can also look at all diagnostic plots at once with the commands
</p>



<pre class="src src-R">par(mfrow = c(2,2))
plot(cars.lm)
par(mfrow = c(1,1))
</pre>


<p>
The <code>par</code> command is used so that \(2\times 2 = 4\) plots will be shown on the same display. The diagnostic plots for the <code>cars</code> data are shown in Figure <a href="#fig-Diagnostic-plots-cars">Diagnostic-plots-cars</a>:
</p>



<div id="fig-Diagnostic-plots-cars" class="figure">
  <p><img src="svg/slr/Diagnostic-plots-cars.svg" width=500 alt="svg/slr/Diagnostic-plots-cars.svg" /></p>
  <p>Diagnostic plots for the <code>cars</code> data.</p>
</div>







<p>
We have discussed all of the plots except the last, which is possibly the most interesting. It shows Residuals vs. Leverage, which will identify outlying \(y\) values versus outlying \(x\) values. Here we see that observation 23 has a high residual, but low leverage, and it turns out that observations 1 and 2 have relatively high leverage but low/moderate leverage (they are on the right side of the plot, just above the horizontal line). Observation 49 has a large residual with a comparatively large leverage. 
</p>
<p>
We can identify the observations with the <code>identify</code> command; it allows us to display the observation number of dots on the plot. First, we plot the graph, then we call <code>identify</code>:
</p>



<pre class="src src-R">plot(cars.lm, which = 5)          <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">std'd resids vs lev plot</span>
identify(leverage, sres, n = 4)   <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">identify 4 points</span>
</pre>


<p>
The graph with the identified points is omitted (but the plain plot is shown in the bottom right corner of Figure <a href="#fig-Diagnostic-plots-cars">Diagnostic-plots-cars</a>). Observations 1 and 2 fall on the far right side of the plot, near the horizontal axis.
</p>

</div>
</div>

</div>

<div id="outline-container-11-6" class="outline-3">
<h3 id="sec-11-6"><span class="section-number-3">11.6</span> Exercises</h3>
<div class="outline-text-3" id="text-11-6">



<div class="xca">
<p>Prove the ANOVA equality, Equation <a href="#eq-anovaeq">eq-anovaeq</a>. <i>Hint</i>:
show that
\[
\sum_{i=1}^{n}(Y_{i}-\hat{Y_{i}})(\hat{Y_{i}}-\overline{Y})=0.
\]
</p>
</div>


<div class="xca">
<p><a name="xca-find-mles-SLR" id="xca-find-mles-SLR"></a>
Solve the following system of equations for \(\beta_{1}\) and \(\beta_{0}\) to find the MLEs for slope and intercept in the simple linear regression model.
\begin{eqnarray*}
n\beta_{0}+\beta_{1}\sum_{i=1}^{n}x_{i} & = & \sum_{i=1}^{n}y_{i}\\
\beta_{0}\sum_{i=1}^{n}x_{i}+\beta_{1}\sum_{i=1}^{n}x_{i}^{2} & = & \sum_{i=1}^{n}x_{i}y_{i}
\end{eqnarray*}
</p>
</div>


<div class="xca">
<p><a name="xca-show-alternate-slope-formula" id="xca-show-alternate-slope-formula"></a>
Show that the formula given in Equation <a href="#eq-sample-correlation-formula">eq-sample-correlation-formula</a> is equivalent to
\[
\hat{\beta}_{1} = \frac{\sum_{i=1}^{n}x_{i}y_{i}-\left.\left(\sum_{i=1}^{n}x_{i}\right)\left(\sum_{i=1}^{n}y_{i}\right)\right/ n}{\sum_{i=1}^{n}x_{i}^{2}-\left.\left(\sum_{i=1}^{n}x_{i}\right)^{2}\right/ n}.
\]
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-cha-multiple-linear-regression" class="outline-2">
<h2 id="cha-multiple-linear-regression"><a name="sec-12" id="sec-12"></a><span class="section-number-2">12</span> Multiple Linear Regression</h2>
<div class="outline-text-2" id="text-cha-multiple-linear-regression">




<p>
We know a lot about simple linear regression models, and a next step is to study multiple regression models that have more than one independent (explanatory) variable. In the discussion that follows we will assume that we have \(p\) explanatory variables, where \(p&gt;1\).
</p>
<p>
The language is phrased in matrix terms &ndash; for two reasons. First, it is quicker to write and (arguably) more pleasant to read. Second, the matrix approach will be required for later study of the subject; the reader might as well be introduced to it now.
</p>
<p>
Most of the results are stated without proof or with only a cursory justification. Those yearning for more should consult an advanced text in linear regression for details, such as <i>Applied Linear Regression Models</i> \cite{Neter1996} or <i>Linear Models: Least Squares and Alternatives</i> \cite{Rao1999}.
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>the basic MLR model, and how it relates to the SLR
</li>
<li>how to estimate the parameters and use those estimates to make predictions
</li>
<li>basic strategies to determine whether or not the model is doing a good job
</li>
<li>a few thoughts about selected applications of the MLR, such as polynomial, interaction, and dummy variable models
</li>
<li>some of the uses of residuals to diagnose problems
</li>
<li>hints about what will be coming later
</li>
</ul>



</div>

<div id="outline-container-sec-The-MLR-Model" class="outline-3">
<h3 id="sec-The-MLR-Model"><a name="sec-12-1" id="sec-12-1"></a><span class="section-number-3">12.1</span> The Multiple Linear Regression Model</h3>
<div class="outline-text-3" id="text-sec-The-MLR-Model">


<p>
The first thing to do is get some better notation. We will write 
\begin{equation}
\mathbf{Y}_{\mathrm{n}\times1}=
\begin{bmatrix}y_{1}\\
y_{2}\\
\vdots\\
y_{n}
\end{bmatrix},
\quad \mbox{and}\quad \mathbf{X}_{\mathrm{n}\times(\mathrm{p}+1)}=
\begin{bmatrix}1 & x_{11} & x_{21} & \cdots & x_{p1}\\
1 & x_{12} & x_{22} & \cdots & x_{p2}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & x_{1n} & x_{2n} & \cdots & x_{pn}
\end{bmatrix}.
\end{equation}
The vector \(\mathbf{Y}\) is called the <i>response vector</i> \index{response vector} and the matrix \(\mathbf{X}\) is called the <i>model matrix</i> \index{model matrix}. As in Chapter <a href="#sec-11">Simple Linear Regression</a>, the most general assumption that relates \(\mathbf{Y}\) to \(\mathbf{X}\) is
\begin{equation}
\mathbf{Y}=\mu(\mathbf{X})+\upepsilon,
\end{equation}
where \(\mu\) is some function (the <i>signal</i>) and \(\upepsilon\) is the <i>noise</i> (everything else). We usually impose some structure on \(\mu\) and \(\upepsilon\). In particular, the standard multiple linear regression model\index{model!multiple linear regression} assumes
\begin{equation}
\mathbf{Y}=\mathbf{X}\upbeta+\upepsilon,
\end{equation}
where the parameter vector \(\upbeta\) looks like 
\begin{equation}
\upbeta_{(\mathrm{p}+1)\times1}=\begin{bmatrix}\beta_{0} & \beta_{1} & \cdots & \beta_{p}\end{bmatrix}^{\mathrm{T}},
\end{equation}
and the random vector \(\upepsilon_{\mathrm{n}\times1}=\begin{bmatrix}\epsilon_{1} &amp; \epsilon_{2} &amp; \cdots &amp; \epsilon_{n}\end{bmatrix}^{\mathrm{T}}\) is assumed to be distributed
\begin{equation}
\upepsilon\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{0}_{\mathrm{n}\times1},\,\mathtt{sigma}=\sigma^{2}\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\right).
\end{equation}

The assumption on \(\upepsilon\) is equivalent to the assumption that \(\epsilon_{1}\), \(\epsilon_{2}\), &hellip;, \(\epsilon_{n}\) are IID \(\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma)\). It is a linear model because the quantity \(\mu(\mathbf{X})=\mathbf{X}\upbeta\) is linear in the parameters \(\beta_{0}\), \(\beta_{1}\), &hellip;, \(\beta_{p}\). It may be helpful to see the model in expanded form; the above matrix formulation is equivalent to the more lengthy
\begin{equation} 
Y_{i}=\beta_{0}+\beta_{1}x_{1i}+\beta_{2}x_{2i}+\cdots+\beta_{p}x_{pi}+\epsilon_{i},\quad i=1,2,\ldots,n.
\end{equation}

</p>
<div class="exampletoo">
<p><b>Girth, Height, and Volume for Black Cherry trees.</b> \index{Data sets!trees@\texttt{trees}}
Measurements were made of the girth, height, and volume of timber in 31 felled black cherry trees. Note that girth is the diameter of the tree (in inches) measured at 4 ft 6 in above the ground. The variables are
</p>
<ol>
<li><code>Girth</code>: tree diameter in inches (denoted \(x_{1}\))
</li>
<li><code>Height</code>: tree height in feet (\(x_{2}\)).
</li>
<li><code>Volume</code>: volume of the tree in cubic feet. (\(y\))
</li>
</ol>


<p>
The data are in the <code>datasets</code> package and are already on the search path; they can be viewed with
</p>



<pre class="src src-R">head(trees)
</pre>


<p>
Let us take a look at a visual display of the data. For multiple variables, instead of a simple scatterplot we use a scatterplot matrix which is made with the <code>splom</code> function in the <code>lattice</code> package \cite{Sarkarlattice} as shown below. The plot is shown in Figure <a href="#fig-splom-trees">splom-trees</a>.
</p>



<pre class="src src-R">splom(trees)
</pre>



<pre class="src src-R">  &lt;&lt;splom-trees&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;splom-trees&gt;&gt;
</pre>



<div id="fig-splom-trees" class="figure">
  <p><img src="svg/mlr/splom-trees.svg" width=500 alt="svg/mlr/splom-trees.svg" /></p>
  <p>A scatterplot matrix of the <code>trees</code> data.</p>
</div>

<p>
The dependent (response) variable <code>Volume</code> is listed in the first row of the scatterplot matrix. Moving from left to right, we see an approximately linear relationship between <code>Volume</code> and the independent (explanatory) variables <code>Height</code> and <code>Girth</code>. A first guess at a model for these data might be
\begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\epsilon,
\end{equation}
in which case the quantity \(\mu(x_{1},x_{2})=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}\) would represent the mean value of \(Y\) at the point \((x_{1},x_{2})\).
</p>
</div>


</div>

<div id="outline-container-12-1-1" class="outline-4">
<h4 id="sec-12-1-1"><span class="section-number-4">12.1.1</span> What does it mean?</h4>
<div class="outline-text-4" id="text-12-1-1">


<p>
The interpretation is simple. The intercept \(\beta_{0}\) represents the mean <code>Volume</code> when all other independent variables are zero. The parameter \(\beta_{i}\) represents the change in mean <code>Volume</code> when there is a unit increase in \(x_{i}\), while the other independent variable is held constant. For the <code>trees</code> data, \(\beta_{1}\) represents the change in average <code>Volume</code> as <code>Girth</code> increases by one unit when the <code>Height</code> is held constant, and \(\beta_{2}\) represents the change in average <code>Volume</code> as <code>Height</code> increases by one unit when the <code>Girth</code> is held constant. 
</p>

<p>
In simple linear regression, we had one independent variable and our linear regression surface was 1D, simply a line. In multiple regression there are many independent variables and so our linear regression surface will be many-D&hellip; in general, a hyperplane. But when there are only two explanatory variables the hyperplane is just an ordinary plane and we can look at it with a 3D scatterplot. 
</p>
<p>
One way to do this is with the \(\mathsf{R}\) Commander in the <code>Rcmdr</code> package \cite{Foxrcmdr}. It has a 3D scatterplot option under the <code>Graphs</code> menu. It is especially great because the resulting graph is dynamic; it can be moved around with the mouse, zoomed, <i>etc</i>. But that particular display does not translate well to a printed book.
</p>
<p>
Another way to do it is with the <code>scatterplot3d</code> function in the <code>scatterplot3d</code> package. The code follows, and the result is shown in Figure <a href="#fig-3D-scatterplot-trees">3D-scatterplot-trees</a>.
</p>



<pre class="src src-R">s3d <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> with(trees, scatterplot3d(Girth, Height, Volume, 
                                 pch = 16, highlight.3d = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>, 
                                 angle = 60))
fit <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ Girth + Height, data = trees)
</pre>







<div id="fig-3D-scatterplot-trees" class="figure">
  <p><img src="svg/mlr/3D-scatterplot-trees.svg" width=500 alt="svg/mlr/3D-scatterplot-trees.svg" /></p>
  <p> A 3D scatterplot with regression plane for the <code>trees</code> data.</p>
</div>

<p>
Looking at the graph we see that the data points fall close to a plane in three dimensional space. (The plot looks remarkably good. In the author's experience it is rare to see points fit so well to the plane without some additional work.)
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Estimation-and-Prediction-MLR" class="outline-3">
<h3 id="sec-Estimation-and-Prediction-MLR"><a name="sec-12-2" id="sec-12-2"></a><span class="section-number-3">12.2</span> Estimation and Prediction</h3>
<div class="outline-text-3" id="text-sec-Estimation-and-Prediction-MLR">



</div>

<div id="outline-container-sub-mlr-parameter-estimates" class="outline-4">
<h4 id="sub-mlr-parameter-estimates"><a name="sec-12-2-1" id="sec-12-2-1"></a><span class="section-number-4">12.2.1</span> Parameter estimates</h4>
<div class="outline-text-4" id="text-sub-mlr-parameter-estimates">


<p>
We will proceed exactly like we did in Section <a href="#sec-11-2">SLR Estimation</a>. We know
\begin{equation}
\upepsilon\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{0}_{\mathrm{n}\times1},\,\mathtt{sigma}=\sigma^{2}\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\right),
\end{equation}
which means that \(\mathbf{Y}=\mathbf{X}\upbeta+\upepsilon\) has an \(\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{X}\upbeta,\,\mathtt{sigma}=\sigma^{2}\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\right)\) distribution. Therefore, the likelihood function\index{likelihood function} is
\begin{equation}
L(\upbeta,\sigma)=\frac{1}{2\pi^{n/2}\sigma}\exp\left\{ -\frac{1}{2\sigma^{2}}\left(\mathbf{Y}-\mathbf{X}\upbeta\right)^{\mathrm{T}}\left(\mathbf{Y}-\mathbf{X}\upbeta\right)\right\}.
\end{equation}

To <i>maximize</i> the likelihood\index{maximum likelihood} in \(\upbeta\), we need to <i>minimize</i> the quantity \(g(\upbeta)=\left(\mathbf{Y}-\mathbf{X}\upbeta\right)^{\mathrm{T}}\left(\mathbf{Y}-\mathbf{X}\upbeta\right)\). We do this by differentiating \(g\) with respect to \(\upbeta\). (It may be a good idea to brush up on the material in Appendices <a href="#sec-21-5">Linear Algebra</a> and <a href="#sec-21-6">Multivariable Calculus</a>.) First we will rewrite \(g\):
\begin{equation}
g(\upbeta)=\mathbf{Y}^{\mathrm{T}}\mathbf{Y}-\mathbf{Y}^{\mathrm{T}}\mathbf{X}\upbeta-\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Y}+\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta,
\end{equation}
which can be further simplified to \(g(\upbeta)=\mathbf{Y}^{\mathrm{T}}\mathbf{Y}-2\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Y}+\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta\) since \(\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Y}\) is \(1\times1\) and thus equal to its transpose. Now we differentiate to get
\begin{equation}
\frac{\partial g}{\partial\upbeta}=\mathbf{0}-2\mathbf{X}^{\mathrm{T}}\mathbf{Y}+2\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta,
\end{equation}
since \(\mathbf{X}^{\mathrm{T}}\mathbf{X}\) is symmetric. Setting the derivative equal to the zero vector yields the so called ``normal equations''\index{normal equations}
\begin{equation}
\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta=\mathbf{X}^{\mathrm{T}}\mathbf{Y}.
\end{equation}

In the case that \(\mathbf{X}^{\mathrm{T}}\mathbf{X}\) is invertible
we may solve the equation for \(\upbeta\) to get the maximum likelihood estimator of \(\upbeta\) which we denote by \(\mathbf{b}\):
\begin{equation}
\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}.
\end{equation}
<a name="eq-b-formula-matrix" id="eq-b-formula-matrix"></a>
</p>

<div class="rem">
<p>The formula in Equation <a href="#eq-b-formula-matrix">eq-b-formula-matrix</a> is convenient for mathematical study but is inconvenient for numerical computation. Researchers have devised much more efficient algorithms for the actual calculation of the parameter estimates, and we do not explore them here.
</p>
</div>


<div class="rem">
<p>We have only found a critical value, and have not actually shown that the critical value is a minimum. We omit the details and refer the interested reader to \cite{Rao1999}.
</p>
</div>


</div>

<div id="outline-container-12-2-1-1" class="outline-5">
<h5 id="sec-12-2-1-1"><span class="section-number-5">12.2.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-2-1-1">


<p>
We do all of the above just as we would in simple linear regression. The powerhouse is the <code>lm</code>\index{lm@\texttt{lm}} function. Everything else is based on it. We separate explanatory variables in the model formula by a plus sign.
</p>



<pre class="src src-R">trees.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ Girth + Height, data = trees)
trees.lm
</pre>


<pre class="example">

Call:
lm(formula = Volume ~ Girth + Height, data = trees)

Coefficients:
(Intercept)        Girth       Height  
   -57.9877       4.7082       0.3393
</pre>


<p>
We see from the output that for the <code>trees</code> data our parameter estimates are 
\[
\mathbf{b}=\begin{bmatrix}-58.0 & 4.7 & 0.3\end{bmatrix},
\] 
and consequently our estimate of the mean response is \(\hat{\mu}\) given by 
\begin{alignat}{1}
\hat{\mu}(x_{1},x_{2})= & \ b_{0}+b_{1}x_{1}+b_{2}x_{2},\\
\approx & -58.0+4.7x_{1}+0.3x_{2}.
\end{alignat}
We could see the entire model matrix \(\mathbf{X}\) with the <code>model.matrix</code>\index{model.matrix@\texttt{model.matrix}} function, but in the interest of brevity we only show the first few rows. 
</p>



<pre class="src src-R">head(model.matrix(trees.lm))
</pre>


<pre class="example">
  (Intercept) Girth Height
1           1   8.3     70
2           1   8.6     65
3           1   8.8     63
4           1  10.5     72
5           1  10.7     81
6           1  10.8     83
</pre>


</div>
</div>

</div>

<div id="outline-container-sub-mlr-point-est-regsurface" class="outline-4">
<h4 id="sub-mlr-point-est-regsurface"><a name="sec-12-2-2" id="sec-12-2-2"></a><span class="section-number-4">12.2.2</span> Point Estimates of the Regression Surface</h4>
<div class="outline-text-4" id="text-sub-mlr-point-est-regsurface">


<p>
The parameter estimates \(\mathbf{b}\) make it easy to find the fitted values\index{fitted values}, \(\hat{\mathbf{Y}}\). We write them individually as \(\hat{Y}_{i}\), \(i=1,2,\ldots,n\), and recall that they are defined by
\begin{eqnarray}
\hat{Y}_{i} & = & \hat{\mu}(x_{1i},x_{2i}),\\
 & = & b_{0}+b_{1}x_{1i}+b_{2}x_{2i},\quad i=1,2,\ldots,n.
\end{eqnarray}
They are expressed more compactly by the matrix equation
\begin{equation}
\hat{\mathbf{Y}}=\mathbf{X}\mathbf{b}.
\end{equation}
From Equation <a href="#eq-b-formula-matrix">eq-b-formula-matrix</a> we know that \(\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}\), so we can rewrite
\begin{eqnarray}
\hat{\mathbf{Y}} & = & \mathbf{X}\left[\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}\right],\\
 & = & \mathbf{H}\mathbf{Y},
\end{eqnarray}
where \(\mathbf{H}=\mathbf{X}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\) is appropriately named <i>the hat matrix</i>\index{hat matrix} because it ``puts the hat on \(\mathbf{Y}\)''. The hat matrix is very important in later courses. Some facts about \(\mathbf{H}\) are
</p><ul>
<li>\(\mathbf{H}\) is a symmetric square matrix, of dimension \(\mathrm{n}\times\mathrm{n}\).
</li>
<li>The diagonal entries \(h_{ii}\) satisfy \(0\leq h_{ii}\leq1\) (compare to Equation <a href="#eq-slr-leverage-between">eq-slr-leverage-between</a>).
</li>
<li>The trace is \(\mathrm{tr}(\mathbf{H})=p\).
</li>
<li>\(\mathbf{H}\) is <i>idempotent</i> (also known as a <i>projection matrix</i>) which means that \(\mathbf{H}^{2}=\mathbf{H}\). The same is true of \(\mathbf{I}-\mathbf{H}\).
</li>
</ul>


<p>
Now let us write a column vector \(\mathbf{x}_{0}=(x_{10},x_{20})^{\mathrm{T}}\) to denote given values of the explanatory variables <code>Girth =</code> \(x_{10}\) and <code>Height =</code> \(x_{20}\). These values may match those of the collected data, or they may be completely new values not observed in the original data set. We may use the parameter estimates to find \(\hat{Y}(\mathbf{x}_{0})\), which will give us
</p>
<ol>
<li>an estimate of \(\mu(\mathbf{x}_{0})\), the mean value of a future observation at \(\mathbf{x}_{0}\), and

</li>
<li>a prediction for \(Y(\mathbf{x}_{0})\), the actual value of a future observation at \(\mathbf{x}_{0}\).
</li>
</ol>


<p>
We can represent \(\hat{Y}(\mathbf{x}_{0})\) by the matrix equation
\begin{equation}
\hat{Y}(\mathbf{x}_{0})=\mathbf{x}_{0}^{\mathrm{T}}\mathbf{b},
\end{equation}
<a name="eq-mlr-single-yhat-matrix" id="eq-mlr-single-yhat-matrix"></a>
which is just a fancy way to write
\begin{equation}
\hat{Y}(x_{10},x_{20})=b_{0}+b_{1}x_{10}+b_{2}x_{20}.
\end{equation}
</p>

<div class="exampletoo">
<p>If we wanted to predict the average volume of black cherry trees that have <code>Girth = 15</code> in and are <code>Height = 77</code> ft tall then we would use the estimate 
\begin{alignat*}{1}
\hat{\mu}(15,\,77)= & -58+4.7(15)+0.3(77),\\
\approx & 35.6\mbox{\,\ ft}^{3}.
\end{alignat*}

We would use the same estimate \(\hat{Y}=35.6\) to predict the measured <code>Volume</code> of another black cherry tree &ndash; yet to be observed &ndash; that has <code>Girth = 15</code> in and is <code>Height = 77</code> ft tall.
</p>
</div>


</div>

<div id="outline-container-12-2-2-1" class="outline-5">
<h5 id="sec-12-2-2-1"><span class="section-number-5">12.2.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-2-2-1">


<p>
The fitted values are stored inside <code>trees.lm</code> and may be accessed with the <code>fitted</code> function. We only show the first five fitted values.
</p>



<pre class="src src-R">fitted(trees.lm)[1:5]
</pre>


<pre class="example">
        1         2         3         4         5 
 4.837660  4.553852  4.816981 15.874115 19.869008
</pre>


<p>
The syntax for general prediction does not change much from simple linear regression. The computations are done with the <code>predict</code> function as described below. 
</p>
<p>
The only difference from SLR is in the way we tell \(\mathsf{R}\) the values of the explanatory variables for which we want predictions. In SLR we had only one independent variable but in MLR we have many (for the <code>trees</code> data we have two). We will store values for the independent variables in the data frame <code>new</code>, which has two columns (one for each independent variable) and three rows (we shall make predictions at three different locations).
</p>



<pre class="src src-R">new <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
</pre>


<p>
We can view the locations at which we will predict:
</p>



<pre class="src src-R">new
</pre>


<pre class="example">
  Girth Height
1   9.1     69
2  11.6     74
3  12.5     87
</pre>


<p>
We continue just like we would have done in SLR.
</p>



<pre class="src src-R">predict(trees.lm, newdata = new)
</pre>


<pre class="example">
        1         2         3 
 8.264937 21.731594 30.379205
</pre>





<div class="exampletoo">
<p>Using the <code>trees</code> data,
</p><ol>
<li>Report a point estimate of the mean <code>Volume</code> of a tree of <code>Girth</code> 9.1 in and <code>Height</code> 69 ft.

<p>
   The fitted value for \(x_{1}=9.1\) and \(x_{2}=69\) is \( SRC_R{treesFIT[ 1 ]} \), so a point estimate would be \( SRC_R{treesFIT[ 1 ]} \) cubic feet. 
</p>
</li>
<li>Report a point prediction for and a 95% prediction interval for the <code>Volume</code> of a hypothetical tree of <code>Girth</code> 12.5 in and <code>Height</code> 87 ft.

<p>
   The fitted value for \(x_{1} = 12.5\) and \(x_{2} = 87\) is \( SRC_R{treesFIT[ 3 ]} \), so a point prediction for the <code>Volume</code> is \( SRC_R{treesFIT[ 3 ]} \) cubic feet. 
</p></li>
</ol>



</div>

</div>
</div>

</div>

<div id="outline-container-sub-mlr-mse-se" class="outline-4">
<h4 id="sub-mlr-mse-se"><a name="sec-12-2-3" id="sec-12-2-3"></a><span class="section-number-4">12.2.3</span> Mean Square Error and Standard Error</h4>
<div class="outline-text-4" id="text-sub-mlr-mse-se">


<p>
The residuals are given by
\begin{equation}
\mathbf{E}=\mathbf{Y}-\hat{\mathbf{Y}}=\mathbf{Y}-\mathbf{H}\mathbf{Y}=(\mathbf{I}-\mathbf{H})\mathbf{Y}.
\end{equation}
Now we can use Theorem <a href="#thm-mvnorm-dist-matrix-prod">thm-mvnorm-dist-matrix-prod</a> to see that the residuals are distributed
\begin{equation}
\mathbf{E}\sim\mathsf{mvnorm}(\mathtt{mean}=\mathbf{0},\,\mathtt{sigma}=\sigma^{2}(\mathbf{I}-\mathbf{H})),
\end{equation}
since \((\mathbf{I}-\mathbf{H})\mathbf{X}\upbeta=\mathbf{X}\upbeta-\mathbf{X}\upbeta=\mathbf{0}\) and \((\mathbf{I}-\mathbf{H})\,(\sigma^{2}\mathbf{I})\,(\mathbf{I}-\mathbf{H})^{\mathrm{T}}=\sigma^{2}(\mathbf{I}-\mathbf{H})^{2}=\sigma^{2}(\mathbf{I}-\mathbf{H})\). The sum of squared errors \(SSE\) is just
\begin{equation}
SSE=\mathbf{E}^{\mathrm{T}}\mathbf{E}=\mathbf{Y}^{\mathrm{T}}(\mathbf{I}-\mathbf{H})(\mathbf{I}-\mathbf{H})\mathbf{Y}=\mathbf{Y}^{\mathrm{T}}(\mathbf{I}-\mathbf{H})\mathbf{Y}.
\end{equation}
Recall that in SLR we had two parameters (\(\beta_{0}\) and \(\beta_{1}\)) in our regression model and we estimated \(\sigma^{2}\) with \(s^{2}=SSE/(n-2)\). In MLR, we have \(p+1\) parameters in our regression model and we might guess that to estimate \(\sigma^{2}\) we would use the <i>mean square error</i> \(S^{2}\) defined by 
\begin{equation}
S^{2}=\frac{SSE}{n-(p+1)}.
\end{equation}
That would be a good guess. The <i>residual standard error</i> is \(S=\sqrt{S^{2}}\).
</p>

</div>

<div id="outline-container-12-2-3-1" class="outline-5">
<h5 id="sec-12-2-3-1"><span class="section-number-5">12.2.3.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-2-3-1">


<p>
The residuals are also stored with <code>trees.lm</code> and may be accessed with the <code>residuals</code> function. We only show the first five residuals.
</p>



<pre class="src src-R">residuals(trees.lm)[1:5]
</pre>


<pre class="example">
         1          2          3          4          5 
 5.4623403  5.7461484  5.3830187  0.5258848 -1.0690084
</pre>


<p>
The <code>summary</code> function output (shown later) lists the <code>Residual Standard Error</code> which is just \(S=\sqrt{S^{2}}\). It is stored in the <code>sigma</code> component of the <code>summary</code> object.
</p>



<pre class="src src-R">treesumry <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> summary(trees.lm)
treesumry$sigma
</pre>


<pre class="example">
[1] 3.881832
</pre>


<p>
For the <code>trees</code> data we find \(s\approx  3.882 \).
</p>
</div>
</div>

</div>

<div id="outline-container-sub-mlr-interval-est-params" class="outline-4">
<h4 id="sub-mlr-interval-est-params"><a name="sec-12-2-4" id="sec-12-2-4"></a><span class="section-number-4">12.2.4</span> Interval Estimates of the Parameters</h4>
<div class="outline-text-4" id="text-sub-mlr-interval-est-params">


<p>
We showed in Section <a href="#sec-12-2-1">MLR Parameter Estimates</a> that \(\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}\), which is really just a big matrix &ndash; namely \(\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\) &ndash; multiplied by \(\mathbf{Y}\). It stands to reason that the sampling distribution of \(\mathbf{b}\) would be intimately related to the distribution of \(\mathbf{Y}\), which we assumed to be
\begin{equation}
\mathbf{Y}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{X}\upbeta,\,\mathtt{sigma}=\sigma^{2}\mathbf{I}\right).
\end{equation}
Now recall Theorem <a href="#thm-mvnorm-dist-matrix-prod">thm-mvnorm-dist-matrix-prod</a> that we said we were going to need eventually (the time is now). That proposition guarantees that
\begin{equation}
\mathbf{b}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\upbeta,\,\mathtt{sigma}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\right),
\end{equation}
<a name="eq-distn-b-mlr" id="eq-distn-b-mlr"></a>
since
\begin{equation}
\mathbb{E}\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}(\mathbf{X}\upbeta)=\upbeta,
\end{equation}
and
\begin{equation}
\mbox{Var}(\mathbf{b})=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}(\sigma^{2}\mathbf{I})\mathbf{X}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1},
\end{equation}
the first equality following because the matrix \(\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\) is symmetric.
</p>
<p>
There is a lot that we can glean from Equation <a href="#eq-distn-b-mlr">eq-distn-b-mlr</a>. First, it follows that the estimator \(\mathbf{b}\) is unbiased (see Section <a href="#sec-9-1">Point Estimation 1</a>). Second, the variances of \(b_{0}\), \(b_{1}\), &hellip;, \(b_{n}\) are exactly the diagonal elements of \(\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\), which is completely known except for that pesky parameter \(\sigma^{2}\). Third, we can estimate the standard error of \(b_{i}\) (denoted \(S_{b_{i}}\)) with the mean square error \(S\) (defined in the previous section) multiplied by the corresponding diagonal element of \(\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\). Finally, given estimates of the standard errors we may construct confidence intervals for \(\beta_{i}\) with an interval that looks like
\begin{equation}
b_{i}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-p-1)S_{b_{i}}.
\end{equation}
The degrees of freedom for the Student's \(t\) distribution
are the same as the denominator of \(S^{2}\). 
</p>

</div>

<div id="outline-container-12-2-4-1" class="outline-5">
<h5 id="sec-12-2-4-1"><span class="section-number-5">12.2.4.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-2-4-1">


<p>
To get confidence intervals for the parameters we need only use <code>confint</code>\index{confint@\texttt{confint}}:
</p>



<pre class="src src-R">confint(trees.lm)
</pre>


<pre class="example">
                   2.5 %      97.5 %
(Intercept) -75.68226247 -40.2930554
Girth         4.16683899   5.2494820
Height        0.07264863   0.6058538
</pre>




<p>
For example, using the calculations above we say that for the regression model <code>Volume ~ Girth + Height</code> we are 95% confident that the parameter \(\beta_{1}\) lies somewhere in the interval \( [  4.2,  5.2 ] \).
</p>
</div>
</div>

</div>

<div id="outline-container-12-2-5" class="outline-4">
<h4 id="sec-12-2-5"><span class="section-number-4">12.2.5</span> Confidence and Prediction Intervals</h4>
<div class="outline-text-4" id="text-12-2-5">


<p>
We saw in Section <a href="#sec-12-2-2">MLR Estimate Regsurface</a> how to make point estimates of the mean value of additional observations and predict values of future observations, but how good are our estimates? We need confidence and prediction intervals to gauge their accuracy, and lucky for us the formulas look similar to the ones we saw in SLR.
</p>
<p>
In Equation <a href="#eq-mlr-single-yhat-matrix">eq-mlr-single-yhat-matrix</a> we wrote \( \hat{Y}(\mathbf{x}_{0})=\mathbf{x}_{0}^{\mathrm{T}}\mathbf{b} \), and in Equation <a href="#eq-distn-b-mlr">eq-distn-b-mlr</a> we saw that
\begin{equation}
\mathbf{b}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\upbeta,\,\mathtt{sigma}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\right).
\end{equation}
The following is therefore immediate from Theorem <a href="#thm-mvnorm-dist-matrix-prod">thm-mvnorm-dist-matrix-prod</a>:
\begin{equation}
\hat{Y}(\mathbf{x}_{0})\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{x}_{0}^{\mathrm{T}}\upbeta,\,\mathtt{sigma}=\sigma^{2}\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}\right).
\end{equation}
It should be no surprise that confidence intervals for the mean value of a future observation at the location \(\mathbf{x}_{0}=\begin{bmatrix}x_{10} &amp; x_{20} &amp; \ldots &amp; x_{p0}\end{bmatrix}^{\mathrm{T}}\) are given by
\begin{equation}
\hat{Y}(\mathbf{x}_{0})\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-p-1)\, S\sqrt{\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}}.
\end{equation}
Intuitively, \(\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}\) measures the distance of \(\mathbf{x}_{0}\) from the center of the data. The degrees of freedom in the Student's \(t\) critical value are \(n-(p+1)\) because we need to estimate \(p+1\) parameters.
</p>
<p>
Prediction intervals for a new observation at \(\mathbf{x}_{0}\) are given by
\begin{equation}
\hat{Y}(\mathbf{x}_{0})\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-p-1)\, S\sqrt{1+\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}}.
\end{equation}
The prediction intervals are wider than the confidence intervals, just as in Section <a href="#sec-11-2-5">SLR Interval Estimate Regline</a>.
</p>

</div>

<div id="outline-container-12-2-5-1" class="outline-5">
<h5 id="sec-12-2-5-1"><span class="section-number-5">12.2.5.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-2-5-1">


<p>
The syntax is identical to that used in SLR, with the proviso that we need to specify values of the independent variables in the data frame <code>new</code> as we did in Section <a href="#sec-11-2-5">SLR Interval Estimate Regline</a> (which we repeat here for illustration).
</p>



<pre class="src src-R">new <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
</pre>


<p>
Confidence intervals are given by
</p>



<pre class="src src-R">predict(trees.lm, newdata = new, interval = <span style="font-style: italic;">"confidence"</span>)
</pre>


<pre class="example">
        fit      lwr      upr
1  8.264937  5.77240 10.75747
2 21.731594 20.11110 23.35208
3 30.379205 26.90964 33.84877
</pre>




<p>
Prediction intervals are given by
</p>



<pre class="src src-R">predict(trees.lm, newdata = new, interval = <span style="font-style: italic;">"prediction"</span>)
</pre>


<pre class="example">
        fit         lwr      upr
1  8.264937 -0.06814444 16.59802
2 21.731594 13.61657775 29.84661
3 30.379205 21.70364103 39.05477
</pre>




<p>
As before, the interval type is decided by the <code>interval</code> argument and the default confidence level is 95% (which can be changed with the <code>level</code> argument).
</p>

<div class="exampletoo">
<p>Using the <code>trees</code> data, 
</p>
<ol>
<li>Report a 95% confidence interval for the mean <code>Volume</code> of a tree of <code>Girth</code> 9.1 in and <code>Height</code> 69 ft.

<p>
   The 95% CI is given by \( [ SRC_R{treesCI[1, 2]}, SRC_R{treesCI[1, 3]} ] \), so with 95% confidence the mean <code>Volume</code> lies somewhere between \( SRC_R{treesCI[1, 2]} \) cubic feet and \( SRC_R{treesCI[1, 3]} \) cubic feet.
</p>
</li>
<li>Report a 95% prediction interval for the <code>Volume</code> of a hypothetical tree of <code>Girth</code> 12.5 in and <code>Height</code> 87 ft.

<p>
   The 95% prediction interval is given by \( [ SRC_R{treesCI[3, 2]}, SRC_R{treesCI[3, 3]} ] \), so with 95% confidence we may assert that the hypothetical <code>Volume</code> of a tree of <code>Girth</code> 12.5 in and <code>Height</code> 87 ft would lie somewhere between \( SRC_R{treesCI[3, 2]} \) cubic feet and \( SRC_R{treesCI[3, 3]} \) feet.
</p></li>
</ol>



</div>

</div>
</div>
</div>

</div>

<div id="outline-container-sec-Model-Utility-and-MLR" class="outline-3">
<h3 id="sec-Model-Utility-and-MLR"><a name="sec-12-3" id="sec-12-3"></a><span class="section-number-3">12.3</span> Model Utility and Inference</h3>
<div class="outline-text-3" id="text-sec-Model-Utility-and-MLR">



</div>

<div id="outline-container-12-3-1" class="outline-4">
<h4 id="sec-12-3-1"><span class="section-number-4">12.3.1</span> Multiple Coefficient of Determination</h4>
<div class="outline-text-4" id="text-12-3-1">


<p>
We saw in Section <a href="#sec-12-2-3">MLR MSE SE</a> that the error sum of squares \(SSE\) can be conveniently written in MLR as 
\begin{equation}
SSE=\mathbf{Y}^{\mathrm{T}}(\mathbf{I}-\mathbf{H})\mathbf{Y}.
\end{equation}
<a name="eq-mlr-sse-matrix" id="eq-mlr-sse-matrix"></a>
It turns out that there are equally convenient formulas for the total sum of squares \(SSTO\) and the regression sum of squares \(SSR\). They are:
\begin{alignat}{1}
SSTO= & \mathbf{Y}^{\mathrm{T}}\left(\mathbf{I}-\frac{1}{n}\mathbf{J}\right)\mathbf{Y}
\end{alignat}
<a name="eq-mlr-ssto-matrix" id="eq-mlr-ssto-matrix"></a>
and
\begin{alignat}{1}
SSR= & \mathbf{Y}^{\mathrm{T}}\left(\mathbf{H}-\frac{1}{n}\mathbf{J}\right)\mathbf{Y}.
\end{alignat}
<a name="eq-mlr-ssr-matrix" id="eq-mlr-ssr-matrix"></a>
(The matrix \(\mathbf{J}\) is defined in Appendix <a href="#sec-21-5">Linear Algebra</a>.) Immediately from Equations <a href="#eq-mlr-sse-matrix">eq-mlr-sse-matrix</a>, <a href="#eq-mlr-ssto-matrix">eq-mlr-ssto-matrix</a>, and <a href="#eq-mlr-ssr-matrix">eq-mlr-ssr-matrix</a> we get the <i>Anova Equality</i>
\begin{equation} 
SSTO=SSE+SSR.
\end{equation}
(See Exercise <a href="#xca-anova-equality">xca-anova-equality</a>.) We define the <i>multiple coefficient of determination</i> by the formula
\begin{equation} 
R^{2}=1-\frac{SSE}{SSTO}.
\end{equation}

We interpret \(R^{2}\) as the proportion of total variation that is explained by the multiple regression model. In MLR we must be careful, however, because the value of \(R^{2}\) can be artificially inflated by the addition of explanatory variables to the model, regardless of whether or not the added variables are useful with respect to prediction of the response variable. In fact, it can be proved that the addition of a single explanatory variable to a regression model will increase the value of \(R^{2}\), <i>no matter how worthless</i> the explanatory variable is. We could model the height of the ocean tides, then add a variable for the length of cheetah tongues on the Serengeti plain, and our \(R^{2}\) would inevitably increase. 
</p>
<p>
This is a problem, because as the philosopher, Occam, once said: ``causes should not be multiplied beyond necessity''. We address the problem by penalizing \(R^{2}\) when parameters are added to the model. The result is an <i>adjusted</i> \(R^{2}\) which we denote by \(\overline{R}^{2}\).
\begin{equation}
\overline{R}^{2}=\left(R^{2}-\frac{p}{n-1}\right)\left(\frac{n-1}{n-p-1}\right).
\end{equation}
It is good practice for the statistician to weigh both \(R^{2}\) and \(\overline{R}^{2}\) during assessment of model utility. In many cases their values will be very close to each other. If their values differ substantially, or if one changes dramatically when an explanatory variable is added, then (s)he should take a closer look at the explanatory variables in the model.
</p>

</div>

<div id="outline-container-12-3-1-1" class="outline-5">
<h5 id="sec-12-3-1-1"><span class="section-number-5">12.3.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-3-1-1">

<p>For the <code>trees</code> data, we can get \(R^{2}\) and \(\overline{R}^{2}\) from the <code>summary</code> output or access the values directly by name as shown (recall that we stored the <code>summary</code> object in <code>treesumry</code>).
</p>



<pre class="src src-R">treesumry$r.squared
</pre>


<pre class="example">
[1] 0.94795
</pre>





<pre class="src src-R">treesumry$adj.r.squared
</pre>


<pre class="example">
[1] 0.9442322
</pre>


<p>
High values of \(R^{2}\) and \( \overline{R}^2 \) such as these indicate that the model fits very well, which agrees with what we saw in Figure <a href="#fig-3D-scatterplot-trees">3D-scatterplot-trees</a>.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-mlr-Overall-F-Test" class="outline-4">
<h4 id="sub-mlr-Overall-F-Test"><a name="sec-12-3-2" id="sec-12-3-2"></a><span class="section-number-4">12.3.2</span> Overall <i>F</i>-Test</h4>
<div class="outline-text-4" id="text-sub-mlr-Overall-F-Test">


<p>
Another way to assess the model's utility is to to test the hypothesis
\[
H_{0}:\beta_{1}=\beta_{2}=\cdots=\beta_{p}=0\mbox{ versus }H_{1}:\mbox{ at least one $\beta_{i}\neq0$}.
\]
The idea is that if all \(\beta_{i}\)'s were zero, then the explanatory variables \(X_{1},\ldots,X_{p}\) would be worthless predictors for the response variable \(Y\). We can test the above hypothesis with the overall \(F\) statistic, which in MLR is defined by
\begin{equation}
F=\frac{SSR/p}{SSE/(n-p-1)}.
\end{equation}
When the regression assumptions hold and under \(H_{0}\), it can be shown that \(F\sim\mathsf{f}(\mathtt{df1}=p,\,\mathtt{df2}=n-p-1)\). We reject \(H_{0}\) when \(F\) is large, that is, when the explained variation is large relative to the unexplained variation.
</p>

</div>

<div id="outline-container-12-3-2-1" class="outline-5">
<h5 id="sec-12-3-2-1"><span class="section-number-5">12.3.2.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-3-2-1">


<p>
The overall \(F\) statistic and its associated <i>p</i>-value is listed at the bottom of the <code>summary</code> output, or we can access it directly by name; it is stored in the <code>fstatistic</code> component of the <code>summary</code> object. 
</p>



<pre class="src src-R">treesumry$fstatistic
</pre>


<pre class="example">
   value    numdf    dendf 
254.9723   2.0000  28.0000
</pre>


<p>
For the <code>trees</code> data, we see that \( F =  254.972337410669 \) with a <i>p</i>-value <code>&lt; 2.2e-16</code>. Consequently we reject \(H_{0}\), that is, the data provide strong evidence that not all \(\beta_{i}\)'s are zero.
</p>
</div>
</div>

</div>

<div id="outline-container-sub-mlr-Student-s-t-Tests" class="outline-4">
<h4 id="sub-mlr-Student-s-t-Tests"><a name="sec-12-3-3" id="sec-12-3-3"></a><span class="section-number-4">12.3.3</span> Student's <i>t</i> Tests</h4>
<div class="outline-text-4" id="text-sub-mlr-Student-s-t-Tests">


<p>
We know that
\begin{equation}
\mathbf{b}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\upbeta,\,\mathtt{sigma}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\right)
\end{equation}
and we have seen how to test the hypothesis \(H_{0}:\beta_{1}=\beta_{2}=\cdots=\beta_{p}=0\), but let us now consider the test
\begin{equation}
H_{0}:\beta_{i}=0\mbox{ versus }H_{1}:\beta_{i}\neq0,
\end{equation}
where \(\beta_{i}\) is the coefficient for the \(i^{\textrm{th}}\) independent variable. We test the hypothesis by calculating a statistic, examining it's null distribution, and rejecting \(H_{0}\) if the <i>p-value</i> is small. If \(H_{0}\) is rejected, then we conclude that there is a significant relationship between \(Y\) and \(x_{i}\) <i>in the regression model</i> \(Y\sim(x_{1},\ldots,x_{p})\). This last part of the sentence is very important because the significance of the variable \(x_{i}\) sometimes depends on the presence of other independent variables in the model
</p>
<p>
To test the hypothesis we go to find the sampling distribution of \( b_{i} \), the estimator of the corresponding parameter \( \beta_{i} \), when the null hypothesis is true. We saw in Section <a href="#sec-12-2-4">MLR Interval Estimate Parameters</a> that 
\begin{equation}
T_{i}=\frac{b_{i}-\beta_{i}}{S_{b_{i}}}
\end{equation}
has a Student's \(t\) distribution with \(n-(p+1)\) degrees of freedom. (Remember, we are estimating \(p+1\) parameters.) Consequently, under the null hypothesis \(H_{0}:\beta_{i}=0\) the statistic \(t_{i}=b_{i}/S_{b_{i}}\) has a \(\mathsf{t}(\mathtt{df}=n-p-1)\) distribution.
</p>

</div>

<div id="outline-container-12-3-3-1" class="outline-5">
<h5 id="sec-12-3-3-1"><span class="section-number-5">12.3.3.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-3-3-1">


<p>
The Student's \(t\) tests for significance of the individual explanatory variables are shown in the <code>summary</code> output.
</p>



<pre class="src src-R">treesumry
</pre>



<pre class="example">
Call:
lm(formula = Volume ~ Girth + Height, data = trees)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.4065 -2.6493 -0.2876  2.2003  8.4847 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***
Girth         4.7082     0.2643  17.816  &lt; 2e-16 ***
Height        0.3393     0.1302   2.607   0.0145 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 3.882 on 28 degrees of freedom
Multiple R-squared: 0.948,	Adjusted R-squared: 0.9442 
F-statistic:   255 on 2 and 28 DF,  p-value: &lt; 2.2e-16
</pre>


<p>
We see from the <i>p-values</i> that there is a significant linear relationship between <code>Volume</code> and <code>Girth</code> and between <code>Volume</code> and <code>Height</code> in the regression model <code>Volume ~ Girth + Height</code>. Further, it appears that the <code>Intercept</code> is significant in the aforementioned model.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Polynomial-Regression" class="outline-3">
<h3 id="sec-Polynomial-Regression"><a name="sec-12-4" id="sec-12-4"></a><span class="section-number-3">12.4</span> Polynomial Regression</h3>
<div class="outline-text-3" id="text-sec-Polynomial-Regression">



</div>

<div id="outline-container-12-4-1" class="outline-4">
<h4 id="sec-12-4-1"><span class="section-number-4">12.4.1</span> Quadratic Regression Model</h4>
<div class="outline-text-4" id="text-12-4-1">


<p>
In each of the previous sections we assumed that \(\mu\) was a linear function of the explanatory variables. For example, in SLR we assumed that \(\mu(x)=\beta_{0}+\beta_{1}x\), and in our previous MLR examples we assumed \(\mu(x_{1},x_{2})=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}\). In every case the scatterplots indicated that our assumption was reasonable. Sometimes, however, plots of the data suggest that the linear model is incomplete and should be modified.
</p>



<pre class="src src-R">qplot(Girth, Volume, data = trees)
</pre>







<div id="fig-Scatterplot-Volume-Girth-trees" class="figure">
  <p><img src="svg/mlr/Scatterplot-Volume-Girth-trees.svg" width=500 alt="svg/mlr/Scatterplot-Volume-Girth-trees.svg" /></p>
  <p>A scatterplot of <code>Volume</code> versus <code>Girth</code> for the <code>trees</code> data.</p>
</div>

<p>
For example, let us examine a scatterplot of <code>Volume</code> versus <code>Girth</code> a little more closely. See Figure <a href="#fig-Scatterplot-Volume-Girth-trees">Scatterplot-Volume-Girth-trees</a>. There might be a slight curvature to the data; the volume curves ever so slightly upward as the girth increases. After looking at the plot we might try to capture the curvature with a mean response such as 
\begin{equation}
\mu(x_{1})=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{1}^{2}.
\end{equation}
The model associated with this choice of \(\mu\) is
\begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{1}^{2}+\epsilon.
\end{equation}
The regression assumptions are the same. Almost everything indeed is the same. In fact, it is still called a ``linear regression model'', since the mean response \(\mu\) is linear <i>in the parameters</i> \(\beta_{0}\), \(\beta_{1}\), and \(\beta_{2}\). 
</p>
<p>
<b>However, there is one important difference.</b> When we introduce the squared variable in the model we inadvertently also introduce strong dependence between the terms which can cause significant numerical problems when it comes time to calculate the parameter estimates. Therefore, we should usually rescale the independent variable to have mean zero (and even variance one if we wish) <b>before</b> fitting the model. That is, we replace the \(x_{i}\)'s with \(x_{i}-\overline{x}\) (or \((x_{i}-\overline{x})/s\)) before fitting the model
</p>

</div>

<div id="outline-container-12-4-1-1" class="outline-5">
<h5 id="sec-12-4-1-1"><span class="section-number-5">12.4.1.1</span> How to do it with \(\mathsf{R}\)</h5>
<div class="outline-text-5" id="text-12-4-1-1">


<p>
There are multiple ways to fit a quadratic model to the variables <code>Volume</code> and <code>Girth</code> using \(\mathsf{R}\).
</p><ol>
<li>One way would be to square the values for <code>Girth</code> and save them in a vector <code>Girthsq</code>. Next, fit the linear model <code>Volume ~ Girth + Girthsq</code>. 
</li>
<li>A second way would be to use the <i>insulate</i> function in \(\mathsf{R}\), denoted by <code>I</code>:
<pre class="example">
Volume ~ Girth + I(Girth^2)
</pre>

</li>
</ol>

<p>The second method is shorter than the first but the end result is the same. And once we calculate and store the fitted model (in, say, <code>treesquad.lm</code>) all of the previous comments regarding \(\mathsf{R}\) apply.  
</p><ol>
<li>A third and ``right'' way to do it is with orthogonal polynomials:
<pre class="example">
 Volume ~ poly(Girth, degree = 2)
</pre>

<p>   See <code>?poly</code> and <code>?cars</code> for more information. Note that we can recover the approach in 2 with <code>poly(Girth, degree = 2, raw = TRUE)</code>.
</p></li>
</ol>



<div class="exampletoo">
<p>We will fit the quadratic model to the <code>trees</code> data and display the results with <code>summary</code>, being careful to rescale the data before fitting the model. We may rescale the <code>Girth</code> variable to have zero mean and unit variance on-the-fly with the <code>scale</code> function.
</p>



<pre class="src src-R">treesquad.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ scale(Girth) + I(scale(Girth)^2),                    data = trees)
summary(treesquad.lm)
</pre>


<p>
We see that the \(F\) statistic indicates the overall model including <code>Girth</code> and <code>Girth^2</code> is significant. Further, there is strong evidence that both <code>Girth</code> and <code>Girth^2</code> are significantly related to <code>Volume</code>. We may examine a scatterplot together with the fitted quadratic function using the <code>lines</code> function, which adds a line to the plot tracing the estimated mean response.
</p>



<pre class="src src-R">a <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> ggplot(trees, aes(scale(Girth), Volume))
a + stat_smooth(method = lm, formula = y ~ poly(x, 2)) + geom_point()
</pre>



<pre class="src src-R">  &lt;&lt;Fitting-the-Quadratic&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;Fitting-the-Quadratic&gt;&gt;
</pre>



<div id="fig-Fitting-the-Quadratic" class="figure">
  <p><img src="svg/mlr/Fitting-the-Quadratic.svg" width=500 alt="svg/mlr/Fitting-the-Quadratic.svg" /></p>
  <p>A quadratic model for the <code>trees</code> data.</p>
</div>

<p>
The plot is shown in Figure <a href="#fig-Fitting-the-Quadratic">Fitting-the-Quadratic</a>. Pay attention to the scale on the \(x\)-axis: it is on the scale of the transformed <code>Girth</code> data and not on the original scale.
</p>

</div>



<div class="rem">
<p>When a model includes a quadratic term for an independent variable, it is customary to also include the linear term in the model. The principle is called <i>parsimony</i>. More generally, if the researcher decides to include \(x^{m}\) as a term in the model, then (s)he should also include all lower order terms \(x\), \(x^{2}\), &hellip;,\(x^{m-1}\) in the model.
</p>
</div>

<p>
We do estimation/prediction the same way that we did in Section <a href="#sec-12-2-2">MLR Point Estimation Regsurface</a>, except we do not need a <code>Height</code> column in the dataframe <code>new</code> since the variable is not included in the quadratic model.
</p>



<pre class="src src-R">new <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(Girth = c(9.1, 11.6, 12.5))
predict(treesquad.lm, newdata = new, interval = <span style="font-style: italic;">"prediction"</span>)
</pre>



<p>
The predictions and intervals are slightly different from what they were previously. Notice that it was not necessary to rescale the <code>Girth</code> prediction data before input to the <code>predict</code> function; the model did the rescaling for us automatically.
</p>

<div class="rem">
<p>We have mentioned on several occasions that it is important to rescale the explanatory variables for polynomial regression. Watch what happens if we ignore this advice:
</p>



<pre class="src src-R">summary(lm(Volume ~ Girth + I(Girth^2), data = trees))
</pre>


<p>
Now nothing is significant in the model except <code>Girth^2</code>. We could delete the <code>Intercept</code> and <code>Girth</code> from the model, but the model would no longer be <i>parsimonious</i>. A novice may see the output and be confused about how to proceed, while the seasoned statistician recognizes immediately that <code>Girth</code> and <code>Girth^2</code> are highly correlated (see Section <a href="#sec-12-9-3">Multicollinearity</a>). The only remedy to this ailment is to rescale <code>Girth</code>, which we should have done in the first place.
</p>
<p>
In Example <a href="#exa-mlr-trees-poly-no-rescale">exa-mlr-trees-poly-no-rescale</a> of Section <a href="#sec-12-7">Partial F Statistic</a> we investigate this issue further.
</p>

</div>

</div>
</div>
</div>

</div>

<div id="outline-container-sec-Interaction" class="outline-3">
<h3 id="sec-Interaction"><a name="sec-12-5" id="sec-12-5"></a><span class="section-number-3">12.5</span> Interaction</h3>
<div class="outline-text-3" id="text-sec-Interaction">


<p>
In our model for tree volume there have been two independent variables: <code>Girth</code> and <code>Height</code>. We may suspect that the independent variables are related, that is, values of one variable may tend to influence values of the other. It may be desirable to include an additional term in our model to try and capture the dependence between the variables. Interaction terms are formed by multiplying one (or more) explanatory variable(s) by another. 
</p>


<div class="exampletoo">
<p>Perhaps the <code>Girth</code> and <code>Height</code> of the tree interact to influence the its <code>Volume</code>; we would like to investigate whether the model (<code>Girth</code> = \(x_{1}\) and <code>Height</code> = \(x_{2}\)) 
\begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\epsilon
\end{equation}
would be significantly improved by the model
\begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\beta_{1:2}x_{1}x_{2}+\epsilon,
\end{equation}
where the subscript \(1:2\) denotes that \(\beta_{1:2}\) is a coefficient
of an interaction term between \(x{}_{1}\) and \(x_{2}\). 
</p>

</div>


</div>

<div id="outline-container-12-5-1" class="outline-4">
<h4 id="sec-12-5-1"><span class="section-number-4">12.5.1</span> What does it mean?</h4>
<div class="outline-text-4" id="text-12-5-1">


<p>
Consider the mean response \(\mu(x_{1},x_{2})\) as a function of \(x_{2}\):
\begin{equation}
\mu(x_{2})=(\beta_{0}+\beta_{1}x_{1})+\beta_{2}x_{2}.
\end{equation}
This is a linear function of \(x_{2}\) with slope \(\beta_{2}\). As \(x_{1}\) changes, the \(y\)-intercept of the mean response in \(x_{2}\) changes, but the slope remains the same. Therefore, the mean response in \(x_{2}\) is represented by a collection of parallel lines all with common slope \(\beta_{2}\).
</p>
<p>
Now think about what happens when the interaction term \(\beta_{1:2}x_{1}x_{2}\) is included. The mean response in \(x_{2}\) now looks like
\begin{equation}
\mu(x_{2})=(\beta_{0}+\beta_{1}x_{1})+(\beta_{2}+\beta_{1:2}x_{1})x_{2}.
\end{equation}
In this case we see that not only the \(y\)-intercept changes when \(x_{1}\) varies, but the slope also changes in \(x_{1}\). Thus, the interaction term allows the slope of the mean response in \(x_{2}\) to increase and decrease as \(x_{1}\) varies. 
</p>
</div>

</div>

<div id="outline-container-12-5-2" class="outline-4">
<h4 id="sec-12-5-2"><span class="section-number-4">12.5.2</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-12-5-2">


<p>
There are several ways to introduce an interaction term into the model.
</p><ol>
<li>Make a new variable <code>prod &lt;- Girth * Height</code>, then include <code>prod</code> in the model formula <code>Volume ~ Girth + Height + prod</code>. This method is perhaps the most transparent, but it also reserves memory space unnecessarily.
</li>
<li>Construct an interaction term directly in \(\mathsf{R}\) with a colon <code>:</code>. For this example, the model formula would look like 
<pre class="example">
Volume ~ Girth + Height + Girth:Height 
</pre>

</li>
</ol>


<p>
For the <code>trees</code> data, we fit the model with the interaction using method two and see if it is significant:
</p>



<pre class="src src-R">treesint.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ Girth + Height + Girth:Height, data = trees)
summary(treesint.lm)
</pre>



<pre class="example">
Call:
lm(formula = Volume ~ Girth + Height + Girth:Height, data = trees)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.5821 -1.0673  0.3026  1.5641  4.6649 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  69.39632   23.83575   2.911  0.00713 ** 
Girth        -5.85585    1.92134  -3.048  0.00511 ** 
Height       -1.29708    0.30984  -4.186  0.00027 ***
Girth:Height  0.13465    0.02438   5.524 7.48e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.709 on 27 degrees of freedom
Multiple R-squared: 0.9756,	Adjusted R-squared: 0.9728 
F-statistic: 359.3 on 3 and 27 DF,  p-value: &lt; 2.2e-16
</pre>


<p>
We can see from the output that the interaction term is highly significant. Further, the estimate \(b_{1:2}\) is positive. This means that the slope of \(\mu(x_{2})\) is steeper for bigger values of <code>Girth</code>. Keep in mind: the same interpretation holds for \(\mu(x_{1})\); that is, the slope of \(\mu(x_{1})\) is steeper for bigger values of <code>Height</code>.
</p>
<p>
For the sake of completeness we calculate confidence intervals for the parameters and do prediction as before.
</p>



<pre class="src src-R">confint(treesint.lm)
</pre>


<pre class="example">
                   2.5 %      97.5 %
(Intercept)  20.48938699 118.3032441
Girth        -9.79810354  -1.9135923
Height       -1.93282845  -0.6613383
Girth:Height  0.08463628   0.1846725
</pre>





<pre class="src src-R">new <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
predict(treesint.lm, newdata = new, interval = <span style="font-style: italic;">"prediction"</span>)
</pre>


<pre class="example">
       fit       lwr      upr
1 11.15884  5.236341 17.08134
2 21.07164 15.394628 26.74866
3 29.78862 23.721155 35.85608
</pre>



<div class="rem">
<p>There are two other ways to include interaction terms in model formulas. For example, we could have written <code>Girth * Height</code> or even <code>(Girth + Height)^2</code> and both would be the same as <code>Girth + Height + Girth:Height</code>. 
</p>
</div>

<p>
These examples can be generalized to more than two independent variables, say three, four, or even more. We may be interested in seeing whether any pairwise interactions are significant. We do this with a model formula that looks something like <code>y ~ (x1 + x2 + x3 + x4)^2</code>.  
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Qualitative-Explanatory-Variables" class="outline-3">
<h3 id="sec-Qualitative-Explanatory-Variables"><a name="sec-12-6" id="sec-12-6"></a><span class="section-number-3">12.6</span> Qualitative Explanatory Variables</h3>
<div class="outline-text-3" id="text-sec-Qualitative-Explanatory-Variables">


<p>
We have so far been concerned with numerical independent variables taking values in a subset of real numbers. In this section, we extend our treatment to include the case in which one of the explanatory variables is qualitative, that is, a <i>factor</i>. Qualitative variables take values in a set of <i>levels</i>, which may or may not be ordered. See Section <a href="#sec-3-1-3">Qualitative Data</a>.
</p>
<p>
<b>Note:</b>
The <code>trees</code> data do not have any qualitative explanatory variables, so we will construct one for illustrative purposes
We will leave the <code>Girth</code> variable alone, but we will replace the variable <code>Height</code> by a new variable <code>Tall</code> which indicates whether or not the cherry tree is taller than a certain threshold (which for the sake of argument will be the sample median height of 76 ft). That is, <code>Tall</code> will be defined by
\begin{equation}
\mathtt{Tall}=
\begin{cases}
\mathtt{yes}, & \mbox{if }\mathtt{Height}>76,\\
\mathtt{no}, & \mbox{if }\mathtt{Height}\leq76.
\end{cases}
\end{equation}

We can construct <code>Tall</code> very quickly in \(\mathsf{R}\) with the <code>cut</code> function:
</p>



<pre class="src src-R">trees$Tall <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cut(trees$Height, breaks = c(-<span style="font-weight: bold; text-decoration: underline;">Inf</span>, 76, <span style="font-weight: bold; text-decoration: underline;">Inf</span>), 
                  labels = c(<span style="font-style: italic;">"no"</span>,<span style="font-style: italic;">"yes"</span>))
trees$Tall[1:5]
</pre>


<pre class="example">
[1] no  no  no  no  yes
Levels: no yes
</pre>


<p>
Note that <code>Tall</code> is automatically generated to be a factor with the labels in the correct order. See <code>?cut</code> for more. 
</p>

<p>
Once we have <code>Tall</code>, we include it in the regression model just like we would any other variable. It is handled internally in a special way. Define a ``dummy variable'' <code>Tallyes</code> that takes values
\begin{equation}
\mathtt{Tallyes}=
\begin{cases}
1, & \mbox{if }\mathtt{Tall}=\mathtt{yes},\\
0, & \mbox{otherwise.}
\end{cases}
\end{equation}
That is, <code>Tallyes</code> is an <i>indicator variable</i> which indicates when a respective tree is tall. The model may now be written as 
\begin{equation}
\mathtt{Volume}=\beta_{0}+\beta_{1}\mathtt{Girth}+\beta_{2}\mathtt{Tallyes}+\epsilon.
\end{equation}
Let us take a look at what this definition does to the mean response. Trees with <code>Tall = yes</code> will have the mean response
\begin{equation}
\mu(\mathtt{Girth})=(\beta_{0}+\beta_{2})+\beta_{1}\mathtt{Girth},
\end{equation}
while trees with <code>Tall = no</code> will have the mean response
\begin{equation} 
\mu(\mathtt{Girth})=\beta_{0}+\beta_{1}\mathtt{Girth}.
\end{equation}
In essence, we are fitting two regression lines: one for tall trees, and one for short trees. The regression lines have the same slope but they have different \(y\) intercepts (which are exactly \(|\beta_{2}|\) far apart).
</p>

</div>

<div id="outline-container-12-6-1" class="outline-4">
<h4 id="sec-12-6-1"><span class="section-number-4">12.6.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-12-6-1">


<p>
The important thing is to double check that the qualitative variable in question is stored as a factor. The way to check is with the <code>class</code> command. For example,
</p>



<pre class="src src-R">class(trees$Tall)
</pre>


<pre class="example">
[1] "factor"
</pre>


<p>
If the qualitative variable is not yet stored as a factor then we may convert it to one with the <code>factor</code> command. See Section <a href="#sec-3-1-3">Qualitative Data</a>. Other than this we perform MLR as we normally would.
</p>



<pre class="src src-R">treesdummy.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ Girth + Tall, data = trees)
summary(treesdummy.lm)
</pre>



<pre class="example">
Call:
lm(formula = Volume ~ Girth + Tall, data = trees)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7788 -3.1710  0.4888  2.6737 10.0619 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -34.1652     3.2438  -10.53 3.02e-11 ***
Girth         4.6988     0.2652   17.72  &lt; 2e-16 ***
Tall[T.yes]   4.3072     1.6380    2.63   0.0137 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 3.875 on 28 degrees of freedom
Multiple R-squared: 0.9481,	Adjusted R-squared: 0.9444 
F-statistic: 255.9 on 2 and 28 DF,  p-value: &lt; 2.2e-16
</pre>


<p>
From the output we see that all parameter estimates are statistically significant and we conclude that the mean response differs for trees with <code>Tall = yes</code> and trees with <code>Tall = no</code>.
</p>

<div class="rem">
<p>We were somewhat disingenuous when we defined the dummy variable <code>Tallyes</code> because, in truth, \(\mathsf{R}\) defines <code>Tallyes</code> automatically without input from the user
Indeed, the author fit the model beforehand and wrote the discussion afterward with the knowledge of what \(\mathsf{R}\) would do so that the output the reader saw would match what (s)he had previously read. The way that \(\mathsf{R}\) handles factors internally is part of a much larger topic concerning <i>contrasts</i>, which falls outside the scope of this book. The interested reader should see Neter et al \cite{Neter1996} or Fox \cite{Fox1997} for more. 
</p>
</div>


<div class="rem">
<p>In general, if an explanatory variable <code>foo</code> is qualitative with \(n\) levels <code>bar1</code>, <code>bar2</code>, &hellip;, <code>barn</code> then \(\mathsf{R}\) will by default automatically define \(n-1\) indicator variables in the following way:
\begin{eqnarray*}
\mathtt{foobar2} & = & \begin{cases}
1, & \mbox{if }\mathtt{foo}=\mathtt{"bar2"},\\
0, & \mbox{otherwise.}\end{cases},\,\ldots,\,\mathtt{foobarn}=\begin{cases}
1, & \mbox{if }\mathtt{foo}=\mathtt{"barn"},\\
0, & \mbox{otherwise.}\end{cases}
\end{eqnarray*}
The level <code>bar1</code> is represented by \(\mathtt{foobar2}=\cdots=\mathtt{foobarn}=0\). We just need to make sure that <code>foo</code> is stored as a factor and \(\mathsf{R}\) will take care of the rest. 
</p>
</div>

</div>

</div>

<div id="outline-container-12-6-2" class="outline-4">
<h4 id="sec-12-6-2"><span class="section-number-4">12.6.2</span> Graphing the Regression Lines</h4>
<div class="outline-text-4" id="text-12-6-2">


<p>
We can see a plot of the two regression lines with the following mouthful of code.
</p>









<div id="fig-dummy-variable-trees" class="figure">
  <p><img src="svg/mlr/dummy-variable-trees.svg" width=500 alt="svg/mlr/dummy-variable-trees.svg" /></p>
  <p>A dummy variable model for the <code>trees</code> data.</p>
</div>

<p>
It may look intimidating but there is reason to the madness. First we <code>split</code> the <code>trees</code> data into two pieces, with groups determined by the <code>Tall</code> variable. Next we add the fitted values to each piece via <code>predict</code>. Then we set up a <code>plot</code> for the variables <code>Volume</code> versus <code>Girth</code>, but we do not plot anything yet (<code>type = n</code>) because we want to use different symbols for the two groups. Next we add <code>points</code> to the plot for the <code>Tall = yes</code> trees and use an open circle for a plot character (<code>pch = 1</code>), followed by <code>points</code> for the <code>Tall = no</code> trees with a triangle character (<code>pch = 2</code>). Finally, we add regression <code>lines</code> to the plot, one for each group.
</p>
<p>
There are other &ndash; shorter &ndash; ways to plot regression lines by groups, namely the <code>scatterplot</code> function in the <code>car</code> \cite{car} package and the <code>xyplot</code> function in the <code>lattice</code> package. We elected to introduce the reader to the above approach since many advanced plots in \(\mathsf{R}\) are done in a similar, consecutive fashion.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Partial-F-Statistic" class="outline-3">
<h3 id="sec-Partial-F-Statistic"><a name="sec-12-7" id="sec-12-7"></a><span class="section-number-3">12.7</span> Partial <i>F</i> Statistic</h3>
<div class="outline-text-3" id="text-sec-Partial-F-Statistic">


<p>
We saw in Section <a href="#sec-12-3-2">MLR Overall F</a> how to test \(H_{0}:\beta_{0}=\beta_{1}=\cdots=\beta_{p}=0\) with the overall \(F\) statistic and we saw in Section <a href="#sub-mlr-Student-s-t-Tests">MLR Student's t Tests</a> how to test \(H_{0}:\beta_{i}=0\) that a particular coefficient \(\beta_{i}\) is zero. Sometimes, however, we would like to test whether a certain part of the model is significant. Consider the regression model
\begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{j}x_{j}+\beta_{j+1}x_{j+1}+\cdots+\beta_{p}x_{p}+\epsilon,
\end{equation}
where \(j\geq1\) and \(p\geq2\). Now we wish to test the hypothesis
\begin{equation}
H_{0}:\beta_{j+1}=\beta_{j+2}=\cdots=\beta_{p}=0
\end{equation}
versus the alternative 
\begin{equation}
H_{1}:\mbox{at least one of $\beta_{j+1},\ \beta_{j+2},\ ,\ldots,\beta_{p}\neq0$}.
\end{equation}

The interpretation of \(H_{0}\) is that none of the variables \(x_{j+1}\), &hellip;,\(x_{p}\) is significantly related to \(Y\) and the interpretation of \(H_{1}\) is that at least one of \(x_{j+1}\), &hellip;,\(x_{p}\) is significantly related to \(Y\). In essence, for this hypothesis test there are two competing models under consideration:
\begin{align}
\mbox{the full model:} & \quad y=\beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{p}x_{p}+\epsilon,\\
\mbox{the reduced model:} & \quad y=\beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{j}x_{j}+\epsilon,
\end{align}

Of course, the full model will always explain the data <i>better</i> than the reduced model, but does the full model explain the data <i>significantly better</i> than the reduced model? This question is exactly what the partial \(F\) statistic is designed to answer.
</p>
<p>
We first calculate \(SSE_{f}\), the unexplained variation in the full model, and \(SSE_{r}\), the unexplained variation in the reduced model. We base our test on the difference \(SSE_{r}-SSE_{f}\) which measures the reduction in unexplained variation attributable to the variables \(x_{j+1}\), &hellip;, \(x_{p}\). In the full model there are \(p+1\) parameters and in the reduced model there are \(j+1\) parameters, which gives a difference of \(p-j\) parameters (hence degrees of freedom). The partial <i>F</i> statistic is 
\begin{equation}
F=\frac{(SSE_{r}-SSE_{f})/(p-j)}{SSE_{f}/(n-p-1)}.
\end{equation}
It can be shown when the regression assumptions hold under \(H_{0}\) that the partial \(F\) statistic has an \(\mathsf{f}(\mathtt{df1}=p-j,\,\mathtt{df2}=n-p-1)\) distribution. We calculate the \(p\)-value of the observed partial \(F\) statistic and reject \(H_{0}\) if the \(p\)-value is small. 
</p>

</div>

<div id="outline-container-12-7-1" class="outline-4">
<h4 id="sec-12-7-1"><span class="section-number-4">12.7.1</span> How to do it with \(\mathsf{R}\)</h4>
<div class="outline-text-4" id="text-12-7-1">


<p>
The key ingredient above is that the two competing models are <i>nested</i> in the sense that the reduced model is entirely contained within the complete model. The way to test whether the improvement is significant is to compute <code>lm</code> objects both for the complete model and the reduced model then compare the answers with the <code>anova</code> function.
</p>

<div class="exampletoo">
<p><a name="exa-mlr-trees-poly-no-rescale" id="exa-mlr-trees-poly-no-rescale"></a>
</p>
<p>
For the <code>trees</code> data, let us fit a polynomial regression model and for the sake of argument we will ignore our own good advice and fail to rescale the explanatory variables. 
</p>



<pre class="src src-R">treesfull.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ Girth + I(Girth^2) + Height + 
                   I(Height^2), data = trees)
summary(treesfull.lm)
</pre>


<p>
In this ill-formed model nothing is significant except <code>Girth</code> and <code>Girth^2</code>. Let us continue down this path and suppose that we would like to try a reduced model which contains nothing but <code>Girth</code> and <code>Girth^2</code> (not even an <code>Intercept</code>). Our two models are now
\begin{align*} 
\mbox{the full model:} & \quad Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{1}^{2}+\beta_{3}x_{2}+\beta_{4}x_{2}^{2}+\epsilon,\\
\mbox{the reduced model:} & \quad Y=\beta_{1}x_{1}+\beta_{2}x_{1}^{2}+\epsilon,
\end{align*}
We fit the reduced model with <code>lm</code> and store the results:
</p>



<pre class="src src-R">treesreduced.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ -1 + Girth + I(Girth^2), data = trees)
</pre>


<p>
To delete the intercept from the model we used <code>-1</code> in the model formula. Next we compare the two models with the <code>anova</code> function. The convention is to list the models from smallest to largest.
</p>



<pre class="src src-R">anova(treesreduced.lm, treesfull.lm)
</pre>


<p>
We see from the output that the complete model is highly significant compared to the model that does not incorporate <code>Height</code> or the <code>Intercept</code>. We wonder (with our tongue in our cheek) if the <code>Height^2</code> term in the full model is causing all of the trouble. We will fit an alternative reduced model that only deletes <code>Height^2</code>. 
</p>



<pre class="src src-R">treesreduced2.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(Volume ~ Girth + I(Girth^2) + Height, 
                       data = trees)
anova(treesreduced2.lm, treesfull.lm)
</pre>


<p>
In this case, the improvement to the reduced model that is attributable to <code>Height^2</code> is not significant, so we can delete <code>Height^2</code> from the model with a clear conscience. We notice that the <i>p-value</i> for this latest partial \(F\) test is 0.8865, which seems to be remarkably close to the <i>p-value</i> we saw for the univariate <i>t</i> test of <code>Height^2</code> at the beginning of this example. In fact, the <i>p-values</i> are <i>exactly</i> the same. Perhaps now we gain some insight into the true meaning of the univariate tests.
</p>

</div>

</div>
</div>

</div>

<div id="outline-container-sec-Residual-Analysis-MLR" class="outline-3">
<h3 id="sec-Residual-Analysis-MLR"><a name="sec-12-8" id="sec-12-8"></a><span class="section-number-3">12.8</span> Residual Analysis and Diagnostic Tools</h3>
<div class="outline-text-3" id="text-sec-Residual-Analysis-MLR">


<p>
We encountered many, many diagnostic measures for simple linear regression in Sections <a href="#sec-11-4">SLR Residual Analysis</a> and <a href="#sec-11-5">SLR Other Diagnostic Tools</a>. All of these are valid in multiple linear regression, too, but there are some slight changes that we need to make for the multivariate case. We list these below, and apply them to the trees example.  
</p>
<dl>
<dt>Shapiro-Wilk, Breusch-Pagan, Durbin-Watson:</dt><dd>unchanged from SLR, but we are now equipped to talk about the Shapiro-Wilk test statistic for the residuals. It is defined by the formula 
   \begin{equation}
   W=\frac{\mathbf{a}^{\mathrm{T}}\mathbf{E}^{\ast}}{\mathbf{E}^{\mathrm{T}}\mathbf{E}},
   \end{equation}
   where \(\mathbf{E}^{\ast}\) is the sorted residuals and \(\mathbf{a}_{1\times\mathrm{n}}\) is defined by 
   \begin{equation}
   \mathbf{a}=\frac{\mathbf{m}^{\mathrm{T}}\mathbf{V}^{-1}}{\sqrt{\mathbf{m}^{\mathrm{T}}\mathbf{V}^{-1}\mathbf{V}^{-1}\mathbf{m}}},
   \end{equation}
   where \(\mathbf{m}_{\mathrm{n}\times1}\) and \(\mathbf{V}_{\mathrm{n}\times\mathrm{n}}\) are the mean and covariance matrix, respectively, of the order statistics from an \(\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{0},\,\mathtt{sigma}=\mathbf{I}\right)\) distribution. 
</dd>
<dt>Leverages:</dt><dd>are defined to be the diagonal entries of the hat matrix \(\mathbf{H}\) (which is why we called them \(h_{ii}\) in Section <a href="#sec-12-2-2">MLR Point Estimation Regsurface</a>). The sum of the leverages is \(\mbox{tr}(\mathbf{H})=p+1\). One rule of thumb considers a leverage extreme if it is larger than double the mean leverage value, which is \(2(p+1)/n\), and another rule of thumb considers leverages bigger than 0.5 to indicate high leverage, while values between 0.3 and 0.5 indicate moderate leverage.
</dd>
<dt>Standardized residuals:</dt><dd>unchanged. Considered extreme if \(|R_{i}|&gt;2\). 
</dd>
<dt>Studentized residuals:</dt><dd>compared to a \(\mathsf{t}(\mathtt{df}=n-p-2)\) distribution.  
</dd>
<dt>DFBETAS:</dt><dd>The formula is generalized to
   \begin{equation}
   (DFBETAS)_{j(i)}=\frac{b_{j}-b_{j(i)}}{S_{(i)}\sqrt{c_{jj}}},\quad j=0,\ldots p,\ i=1,\ldots,n,
   \end{equation}
   where \(c_{jj}\) is the \(j^{\mathrm{th}}\) diagonal entry of \((\mathbf{X}^{\mathrm{T}}\mathbf{X})^{-1}\). Values larger than one for small data sets or \(2/\sqrt{n}\) for large data sets should be investigated.
</dd>
<dt>DFFITS:</dt><dd>unchanged. Larger than one in absolute value is considered extreme.
</dd>
<dt>Cook's D:</dt><dd>compared to an \(\mathsf{f}(\mathtt{df1}=p+1,\,\mathtt{df2}=n-p-1)\) distribution. Observations falling higher than the 50\(^{\textrm{th}}\) percentile are extreme. 
</dd>
</dl>

<p>Note that plugging the value \(p=1\) into the formulas will recover all of the ones we saw in Chapter <a href="#sec-11">Simple Linear Regression</a>.
</p>
</div>

</div>

<div id="outline-container-sec-Additional-Topics-MLR" class="outline-3">
<h3 id="sec-Additional-Topics-MLR"><a name="sec-12-9" id="sec-12-9"></a><span class="section-number-3">12.9</span> Additional Topics</h3>
<div class="outline-text-3" id="text-sec-Additional-Topics-MLR">



</div>

<div id="outline-container-12-9-1" class="outline-4">
<h4 id="sec-12-9-1"><span class="section-number-4">12.9.1</span> Nonlinear Regression</h4>
<div class="outline-text-4" id="text-12-9-1">


<p>
We spent the entire chapter talking about the <code>trees</code> data, and all of our models looked like <code>Volume ~ Girth + Height</code> or a variant of this model. But let us think again: we know from elementary school that the volume of a rectangle is \(V=lwh\) and the volume of a cylinder (which is closer to what a black cherry tree looks like) is
\begin{equation}
V=\pi r^{2}h\quad \mbox{or}\quad V=4\pi dh,
\end{equation}
where \(r\) and \(d\) represent the radius and diameter of the tree, respectively. With this in mind, it would seem that a more appropriate model for \(\mu\) might be
\begin{equation}
\mu(x_{1},x_{2})=\beta_{0}x_{1}^{\beta_{1}}x_{2}^{\beta_{2}},
\end{equation}
<a name="eq-trees-nonlin-reg" id="eq-trees-nonlin-reg"></a>
where \(\beta_{1}\) and \(\beta_{2}\) are parameters to adjust for the fact that a black cherry tree is not a perfect cylinder.
</p>
<p>
How can we fit this model? The model is not linear in the parameters any more, so our linear regression methods will not work&hellip; or will they? In the <code>trees</code> example we may take the logarithm of both sides of Equation <a href="#eq-trees-nonlin-reg">eq-trees-nonlin-reg</a> to get
\begin{equation}
\mu^{\ast}(x_{1},x_{2})=\ln\left[\mu(x_{1},x_{2})\right]=\ln\beta_{0}+\beta_{1}\ln x_{1}+\beta_{2}\ln x_{2},
\end{equation}
and this new model \(\mu^{\ast}\) is linear in the parameters \(\beta_{0}^{\ast}=\ln\beta_{0}\), \(\beta_{1}^{\ast}=\beta_{1}\) and \(\beta_{2}^{\ast}=\beta_{2}\). We can use what we have learned to fit a linear model <code>log(Volume) ~ log(Girth) + log(Height)</code>, and everything will proceed as before, with one exception: we will need to be mindful when it comes time to make predictions because the model will have been fit on the log scale, and we will need to transform our predictions back to the original scale (by exponentiating with <code>exp</code>) to make sense.
</p>



<pre class="src src-R">treesNonlin.lm <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> lm(log(Volume) ~ log(Girth) + log(Height), 
                     data = trees)
summary(treesNonlin.lm)
</pre>



<pre class="example"> 
Call:
lm(formula = log(Volume) ~ log(Girth) + log(Height), data = trees)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.168561 -0.048488  0.002431  0.063637  0.129223 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -6.63162    0.79979  -8.292 5.06e-09 ***
log(Girth)   1.98265    0.07501  26.432  &lt; 2e-16 ***
log(Height)  1.11712    0.20444   5.464 7.81e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 0.08139 on 28 degrees of freedom
Multiple R-squared: 0.9777,	Adjusted R-squared: 0.9761 
F-statistic: 613.2 on 2 and 28 DF,  p-value: &lt; 2.2e-16
</pre>


<p>
This is our best model yet (judging by \(R^{2}\) and \(\overline{R}^{2}\)), all of the parameters are significant, it is simpler than the quadratic or interaction models, and it even makes theoretical sense. It rarely gets any better than that.
</p>
<p>
We may get confidence intervals for the parameters, but remember that it is usually better to transform back to the original scale for interpretation purposes :
</p>



<pre class="src src-R">exp(confint(treesNonlin.lm))
</pre>


<pre class="example">
                   2.5 %      97.5 %
(Intercept) 0.0002561078 0.006783093
log(Girth)  6.2276411645 8.468066317
log(Height) 2.0104387829 4.645475188
</pre>


<p>
(Note that we did not update the row labels of the matrix to show that we exponentiated and so they are misleading as written.) We do predictions just as before. Remember to transform the response variable back to the original scale after prediction. 
</p>



<pre class="src src-R">new <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
exp(predict(treesNonlin.lm, newdata = new, interval = <span style="font-style: italic;">"confidence"</span>))
</pre>


<pre class="example">
       fit      lwr      upr
1 11.90117 11.25908 12.57989
2 20.82261 20.14652 21.52139
3 28.93317 27.03755 30.96169
</pre>


<p>
The predictions and intervals are slightly different from those calculated earlier, but they are close. Note that we did not need to transform the <code>Girth</code> and <code>Height</code> arguments in the dataframe <code>new</code>. All transformations are done for us automatically.
</p>
</div>

</div>

<div id="outline-container-12-9-2" class="outline-4">
<h4 id="sec-12-9-2"><span class="section-number-4">12.9.2</span> Real Nonlinear Regression</h4>
<div class="outline-text-4" id="text-12-9-2">


<p>
We saw with the <code>trees</code> data that a nonlinear model might be more appropriate for the data based on theoretical considerations, and we were lucky because the functional form of \(\mu\) allowed us to take logarithms to transform the nonlinear model to a linear one. The same trick will not work in other circumstances, however. We need techniques to fit general models of the form
\begin{equation}
\mathbf{Y}=\mu(\mathbf{X})+\epsilon,
\end{equation}
where \(\mu\) is some crazy function that does not lend itself to linear transformations.
</p>
<p>
There are a host of methods to address problems like these which are studied in advanced regression classes. The interested reader should see Neter <i>et al</i> \cite{Neter1996} or Tabachnick and Fidell \cite{Tabachnick2006}. 
</p>
<p>
It turns out that John Fox has posted an Appendix to his book \cite{Fox2002} which discusses some of the methods and issues associated with nonlinear regression; see <a href="http://cran.r-project.org/doc/contrib/Fox-Companion/appendix.html">here</a> for more.  Here is an example of how it works, based on a question from R-help.
</p>



<pre class="src src-R"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">fake data </span>
set.seed(1) 
x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> seq(from = 0, to = 1000, length.out = 200) 
y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 1 + 2*(sin((2*pi*x/360) - 3))^2 + rnorm(200, sd = 2)
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">plot(x, y)</span>
acc.nls <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> nls(y ~ a + b*(sin((2*pi*x/360) - c))^2, 
               start = list(a = 0.9, b = 2.3, c = 2.9))
summary(acc.nls)
<span style="font-weight: bold; font-style: italic;">#</span><span style="font-weight: bold; font-style: italic;">plot(x, fitted(acc.nls))</span>
</pre>



<pre class="example"> 
Formula: y ~ a + b * (sin((2 * pi * x/360) - c))^2

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)    
a  0.95884    0.23097   4.151 4.92e-05 ***
b  2.22868    0.37114   6.005 9.07e-09 ***
c  3.04343    0.08434  36.084  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.865 on 197 degrees of freedom

Number of iterations to convergence: 3 
Achieved convergence tolerance: 6.546e-08
</pre>


</div>

</div>

<div id="outline-container-sub-Multicollinearity" class="outline-4">
<h4 id="sub-Multicollinearity"><a name="sec-12-9-3" id="sec-12-9-3"></a><span class="section-number-4">12.9.3</span> Multicollinearity</h4>
<div class="outline-text-4" id="text-sub-Multicollinearity">


<p>
A multiple regression model exhibits <i>multicollinearity</i> when two or more of the explanatory variables are substantially correlated with each other. We can measure multicollinearity by having one of the explanatory play the role of ``dependent variable'' and regress it on the remaining explanatory variables. The the \(R^{2}\) of the resulting model is near one, then we say that the model is multicollinear or shows multicollinearity.
</p>
<p>
Multicollinearity is a problem because it causes instability in the regression model. The instability is a consequence of redundancy in the explanatory variables: a high \(R^{2}\) indicates a strong dependence between the selected independent variable and the others. The redundant information inflates the variance of the parameter estimates which can cause them to be statistically insignificant when they would have been significant otherwise. To wit, multicollinearity is usually measured by what are called <i>variance inflation factors</i>.
</p>
<p>
Once multicollinearity has been diagnosed there are several approaches to remediate it. Here are a couple of important ones. 
</p><dl>
<dt>Principal Components Analysis.</dt><dd>This approach casts out two or more of the original explanatory variables and replaces them with new variables, derived from the original ones, that are by design uncorrelated with one another. The redundancy is thus eliminated and we may proceed as usual with the new variables in hand. Principal Components Analysis is important for other reasons, too, not just for fixing multicollinearity problems.
</dd>
<dt>Ridge Regression.</dt><dd>The idea of this approach is to replace the original parameter estimates with a different type of parameter estimate which is more stable under multicollinearity. The estimators are not found by ordinary least squares but rather a different optimization procedure which incorporates the variance inflation factor information. 
</dd>
</dl>


<p>
We decided to omit a thorough discussion of multicollinearity because we are not equipped to handle the mathematical details. Perhaps the topic will receive more attention in a later edition.
</p>
<ul>
<li>What to do when data are not normal
<ul>
<li>Bootstrap (see Chapter <a href="#sec-13">Resampling Methods</a>).
</li>
</ul>

</li>
</ul>


</div>

</div>

<div id="outline-container-12-9-4" class="outline-4">
<h4 id="sec-12-9-4"><span class="section-number-4">12.9.4</span> Akaike's Information Criterion</h4>
<div class="outline-text-4" id="text-12-9-4">




\[
AIC=-2\ln L+2(p+1)
\]



</div>
</div>

</div>

<div id="outline-container-12-10" class="outline-3">
<h3 id="sec-12-10"><span class="section-number-3">12.10</span> Exercises</h3>
<div class="outline-text-3" id="text-12-10">




<div class="xca">
<p><a name="xca-anova-equality" id="xca-anova-equality"></a>
Use Equations <a href="#eq-mlr-sse-matrix">eq-mlr-sse-matrix</a>, <a href="#eq-mlr-ssto-matrix">eq-mlr-ssto-matrix</a>, and <a href="#eq-mlr-ssr-matrix">eq-mlr-ssr-matrix</a> to prove the Anova Equality:
\[
SSTO=SSE+SSR.
\]
</p>
</div>

</div>
</div>

</div>

<div id="outline-container-cha-resampling-methods" class="outline-2">
<h2 id="cha-resampling-methods"><a name="sec-13" id="sec-13"></a><span class="section-number-2">13</span> Resampling Methods</h2>
<div class="outline-text-2" id="text-cha-resampling-methods">




<p>
Computers have changed the face of statistics. Their quick computational speed and flawless accuracy, coupled with large data sets acquired by the researcher, make them indispensable for many modern analyses. In particular, resampling methods (due in large part to Bradley Efron) have gained prominence in the modern statistician's repertoire. We first look at a classical problem to get some insight why. 
</p>
<p>
I have seen <i>Statistical Computing with \(\mathsf{R}\)</i> by Rizzo \cite{Rizzo2008} and I recommend it to those looking for a more advanced treatment with additional topics. I believe that <i>Monte Carlo Statistical Methods</i> by Robert and Casella \cite{Robert2004} has a new edition that integrates \(\mathsf{R}\) into the narrative.
</p>
<p>
<b>What do I want them to know?</b>
</p><ul>
<li>basic philosophy of resampling and why it is important
</li>
<li>resampling for standard errors and confidence intervals
</li>
<li>resampling for hypothesis tests (permutation tests)
</li>
</ul>



</div>

<div id="outline-container-sec-Introduction-Resampling" class="outline-3">
<h3 id="sec-Introduction-Resampling"><a name="sec-13-1" id="sec-13-1"></a><span class="section-number-3">13.1</span> Introduction</h3>
<div class="outline-text-3" id="text-sec-Introduction-Resampling">


<dl>
<dt>Classical question</dt><dd>Given a population of interest, how may we effectively learn some of its salient features, <i>e.g.</i>, the population's mean? One way is through representative random sampling. Given a random sample, we summarize the information contained therein by calculating a reasonable statistic, <i>e.g.</i>, the sample mean. Given a value of a statistic, how do we know whether that value is significantly different from that which was expected? We don't; we look at the <i>sampling distribution</i> of the statistic, and we try to make probabilistic assertions based on a confidence level or other consideration. For example, we may find ourselves saying things like, "With 95% confidence, the true population mean is greater than zero".

</dd>
<dt>Problem</dt><dd>Unfortunately, in most cases the sampling distribution is <i>unknown</i>. Thus, in the past, in efforts to say something useful, statisticians have been obligated to place some restrictive assumptions on the underlying population. For example, if we suppose that the population has a normal distribution, then we can say that the distribution of \(\overline{X}\) is normal, too, with the same mean (and a smaller standard deviation). It is then easy to draw conclusions, make inferences, and go on about our business. 

</dd>
<dt>Alternative</dt><dd>We don't know what the underlying population distributions is, so let us <i>estimate</i> it, just like we would with any other parameter. The statistic we use is the <i>empirical CDF</i>, that is, the function that places mass \(1/n\) at each of the observed data points \(x_{1},\ldots,x_{n}\) (see Section <a href="#sec-5-5">Empirical Distribution</a>). As the sample size increases, we would expect the approximation to get better and better (with IID observations, it does, and there is a wonderful theorem by Glivenko and Cantelli that proves it). And now that we have an (estimated) population distribution, it is easy to find the sampling distribution of any statistic we like: just <b>sample</b> from the empirical CDF many, many times, calculate the statistic each time, and make a histogram. Done! Of course, the number of samples needed to get a representative histogram is prohibitively large&hellip; human beings are simply too slow (and clumsy) to do this tedious procedure.
</dd>
</dl>


<p>
Fortunately, computers are very skilled at doing simple, repetitive tasks very quickly and accurately. So we employ them to give us a reasonable idea about the sampling distribution of our statistic, and we use the generated sampling distribution to guide our inferences and draw our conclusions. If we would like to have a better approximation for the sampling distribution (within the confines of the information contained in the original sample), we merely tell the computer to sample more. In this (restricted) sense, we are limited only by our current computational speed and pocket book.
</p>
<p>
In short, here are some of the benefits that the advent of resampling methods has given us:
</p><dl>
<dt>Fewer assumptions.</dt><dd>We are no longer required to assume the population is normal or the sample size is large (though, as before, the larger the sample the better). 
</dd>
<dt>Greater accuracy.</dt><dd>Many classical methods are based on rough upper bounds or Taylor expansions. The bootstrap procedures can be iterated long enough to give results accurate to several decimal places, often beating classical approximations.  
</dd>
<dt>Generality.</dt><dd>Resampling methods are easy to understand and apply to a large class of seemingly unrelated procedures. One no longer needs to memorize long complicated formulas and algorithms.
</dd>
</dl>



<div class="rem">
<p>Due to the special structure of the empirical CDF, to get an IID sample we just need to take a random sample of size \(n\), with replacement, from the observed data \(x_{1},\ldots,x_{n}\). Repeats are expected and acceptable. Since we already sampled to get the original data, the term <i>resampling</i> is used to describe the procedure.
</p>
</div>


</div>

<div id="outline-container-13-1-1" class="outline-4">
<h4 id="sec-13-1-1"><span class="section-number-4">13.1.1</span> General bootstrap procedure.</h4>
<div class="outline-text-4" id="text-13-1-1">


<p>
The above discussion leads us to the following general procedure to approximate the sampling distribution of a statistic \(S=S(x_{1},x_{2},\ldots,x_{n})\) based on an observed simple random sample \(\mathbf{x}=(x_{1},x_{2},\ldots,x_{n})\) of size \(n\): 
</p>
<ol>
<li>Create many many samples \(\mathbf{x}_{1}^{\ast},\ldots,\mathbf{x}_{M}^{\ast}\), called <i>resamples</i>, by sampling with replacement from the data. 

</li>
<li>Calculate the statistic of interest \(S(\mathbf{x}_{1}^{\ast}),\ldots,S(\mathbf{x}_{M}^{\ast})\) for each resample. The distribution of the resample statistics is called a <i>bootstrap distribution</i>.

</li>
<li>The bootstrap distribution gives information about the sampling distribution of the original statistic \(S\). In particular, the bootstrap distribution gives us some idea about the center, spread, and shape of the sampling distribution of \(S\).
</li>
</ol>


</div>
</div>

</div>

<div id="outline-container-sec-Bootstrap-Standard-Errors" class="outline-3">
<h3 id="sec-Bootstrap-Standard-Errors"><a name="sec-13-2" id="sec-13-2"></a><span class="section-number-3">13.2</span> Bootstrap Standard Errors</h3>
<div class="outline-text-3" id="text-sec-Bootstrap-Standard-Errors">


<p>
Since the bootstrap distribution gives us information about a statistic's sampling distribution, we can use the bootstrap distribution to estimate properties of the statistic. We will illustrate the bootstrap procedure in the special case that the statistic \(S\) is a standard error. 
</p>

<div class="exampletoo">
<p><a name="exa-Bootstrap-se-mean" id="exa-Bootstrap-se-mean"></a>
</p>
<p>
<b>Standard error of the mean.</b>  In this example we illustrate the bootstrap by estimating the standard error of the sample meanand we will do it in the special case that the underlying population is \(\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=1)\).  
</p>
<p>
Of course, we do not really need a bootstrap distribution here because from Section <a href="#sec-8-2">Sampling from Normal</a> we know that \(\overline{X}\sim\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=1/\sqrt{n})\), but we proceed anyway to investigate how the bootstrap performs when we know what the answer should be ahead of time.
</p>
<p>
We will take a random sample of size \(n=25\) from the population. Then we will <i>resample</i> the data 1000 times to get 1000 resamples of size 25. We will calculate the sample mean of each of the resamples, and will study the data distribution of the 1000 values of \(\overline{x}\).
</p>



<pre class="src src-R">srs <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> rnorm(25, mean = 3)
resamps <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> replicate(1000, sample(srs, 25, <span style="font-weight: bold; text-decoration: underline;">TRUE</span>), simplify = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
xbarstar <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sapply(resamps, mean, simplify = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<p>
A histogram of the 1000 values of \(\overline{x}\) is shown in Figure <a href="#fig-Bootstrap-se-mean">Bootstrap-se-mean</a>, and was produced by the following code.
</p>



<pre class="src src-R">hist(xbarstar, breaks = 40, prob = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
curve(dnorm(x, 3, 0.2), add = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>) <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">overlay true normal density</span>
</pre>



<pre class="src src-R">  &lt;&lt;Bootstrap-se-mean&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;Bootstrap-se-mean&gt;&gt;
</pre>



<div id="fig-Bootstrap-se-mean" class="figure">
  <p><img src="svg/resamp/Bootstrap-se-mean.svg" width=500 alt="svg/resamp/Bootstrap-se-mean.svg" /></p>
  <p>Bootstrapping the standard error of the mean, simulated data.</p>
</div>

<p>
We have overlain what we know to be the true sampling distribution of \(\overline{X}\), namely, a \(\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=1/\sqrt{25})\) distribution. The histogram matches the true sampling distribution pretty well with respect to shape and spread&hellip; but notice how the histogram is off-center a little bit. This is not a coincidence &ndash; in fact, it can be shown that the mean of the bootstrap distribution is exactly the mean of the original sample, that is, the value of the statistic that we originally observed. Let us calculate the mean of the bootstrap distribution and compare it to the mean of the original sample:
</p>



<pre class="src src-R">mean(xbarstar)
mean(srs)
mean(xbarstar) - mean(srs)
</pre>



</div>

<p>
Notice how close the two values are. The difference between them is an estimate of how biased the original statistic is, the so-called <i>bootstrap estimate of bias</i>. Since the estimate is so small we would expect our original statistic (\(\overline{X}\)) to have small bias, but this is no surprise to us because we already knew from Section <a href="#sec-8-1">Simple Random Samples</a> that \(\overline{X}\) is an unbiased estimator of the population mean.
</p>
<p>
Now back to our original problem, we would like to estimate the standard error of \(\overline{X}\). Looking at the histogram, we see that the spread of the bootstrap distribution is similar to the spread of the sampling distribution. Therefore, it stands to reason that we could estimate the standard error of \(\overline{X}\) with the sample standard deviation of the resample statistics. Let us try and see.
</p>



<pre class="src src-R">sd(xbarstar)
</pre>



<p>
We know from theory that the true standard error is \(1/\sqrt{25}=0.20\). Our bootstrap estimate is not very far from the theoretical value. 
</p>

<div class="rem">
<p>What would happen if we take more resamples? Instead of 1000 resamples, we could increase to, say, 2000, 3000, or even 4000&hellip; would it help? The answer is both yes and no. Keep in mind that with resampling methods there are two sources of randomness: that from the original sample, and that from the subsequent resampling procedure. An increased number of resamples would reduce the variation due to the second part, but would do nothing to reduce the variation due to the first part.
</p>
<p>
We only took an original sample of size \(n=25\), and resampling more and more would never generate more information about the population than was already there. In this sense, the statistician is limited by the information contained in the original sample. 
</p>
</div>


<div class="exampletoo">
<p><a name="exa-Bootstrap-se-median" id="exa-Bootstrap-se-median"></a>
</p>
<p>
<b>Standard error of the median.</b> We look at one where we do not know the answer ahead of time. This example uses the <code>rivers</code>\index{Data sets!rivers@\texttt{rivers}} data set. Recall the stemplot on page \vpageref{ite-stemplot-rivers} that we made for these data which shows them to be markedly right-skewed, so a natural estimate of center would be the sample median. Unfortunately, its sampling distribution falls out of our reach. We use the bootstrap to help us with this problem, and the modifications to the last example are trivial.
</p>



<pre class="src src-R">resamps <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> replicate(1000, sample(rivers, 141, <span style="font-weight: bold; text-decoration: underline;">TRUE</span>), simplify = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
medstar <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sapply(resamps, median, simplify = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
sd(medstar)
</pre>



<pre class="src src-R">hist(medstar, breaks = 40, prob = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>



<pre class="src src-R">  &lt;&lt;Bootstrapping-se-median&gt;&gt;
</pre>



<pre class="src src-R">  &lt;&lt;Bootstrapping-se-median&gt;&gt;
</pre>



<div id="fig-Bootstrapping-se-median" class="figure">
  <p><img src="svg/resamp/Bootstrapping-se-median.svg" width=500 alt="svg/resamp/Bootstrapping-se-median.svg" /></p>
  <p>Bootstrapping the standard error of the median for the <code>rivers</code> data.</p>
</div>

<p>
The graph is shown in Figure <a href="#fig-Bootstrapping-se-median">Bootstrapping-se-median</a>, and was produced by the following code.
</p>



<pre class="src src-R">hist(medstar, breaks = 40, prob = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>



<pre class="src src-R">median(rivers)
mean(medstar)
mean(medstar) - median(rivers)
</pre>



</div>


<div class="exampletoo">
<p><b>The boot package in R</b>. It turns out that there are many bootstrap procedures and commands already built into base \(\mathsf{R}\), in the <code>boot</code> package. Further, inside the <code>boot</code> package there is even a function called <code>boot</code>\index{boot@\texttt{boot}}. The basic syntax is of the form:
</p>
<pre class="example">
 boot(data, statistic, R)
</pre>



</div>
<p> Here, <code>data</code> is a vector (or matrix) containing the data to be resampled, <code>statistic</code> is a defined function, <i>of two arguments</i>, that tells which statistic should be computed, and the parameter \(\mathsf{R}\) specifies how many resamples should be taken.
</p>
<p>
For the standard error of the mean (Example <a href="#exa-Bootstrap-se-mean">exa-Bootstrap-se-mean</a>):
</p>



<pre class="src src-R"><span style="font-weight: bold;">mean_fun</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x, indices) mean(x[indices])
boot(data = srs, statistic = mean_fun, R = 1000)
</pre>



<p>
For the standard error of the median (Example <a href="#exa-Bootstrap-se-median">exa-Bootstrap-se-median</a>):
</p>



<pre class="src src-R"><span style="font-weight: bold;">median_fun</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x, indices) median(x[indices])
boot(data = rivers, statistic = median_fun, R = 1000)
</pre>



<pre class="example">
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = rivers, statistic = median_fun, R = 1000)


Bootstrap Statistics :
    original  bias    std. error
t1*      425   1.772    25.17292
</pre>


<p>
We notice that the output from both methods of estimating the standard errors produced similar results. In fact, the <code>boot</code> procedure is to be preferred since it invisibly returns much more information (which we will use later) than our naive script and it is much quicker in its computations.
</p>

<div class="rem">
<p>Some things to keep in mind about the bootstrap:
</p>
<ul>
<li>For many statistics, the bootstrap distribution closely resembles the sampling distribution with respect to spread and shape. However, the bootstrap will not have the same center as the true sampling distribution. While the sampling distribution is centered at the population mean (plus any bias), the bootstrap distribution is centered at the original value of the statistic (plus any bias). The <code>boot</code> function gives an empirical estimate of the bias of the statistic as part of its output. 

</li>
<li>We tried to estimate the standard error, but we could have (in principle) tried to estimate something else. Note from the previous remark, however, that it would be useless to estimate the population mean \(\mu\) using the bootstrap since the mean of the bootstrap distribution is the observed \(\overline{x}\).  

</li>
<li>You don't get something from nothing. We have seen that we can take a random sample from a population and use bootstrap methods to get a very good idea about standard errors, bias, and the like. However, one must not get lured into believing that by doing some random resampling somehow one gets more information about the parameters than that which was contained in the original sample. Indeed, there is some uncertainty about the parameter due to the randomness of the original sample, and there is even more uncertainty introduced by resampling. One should think of the bootstrap as just another estimation method, nothing more, nothing less.
</li>
</ul>



</div>

</div>

</div>

<div id="outline-container-sec-Bootstrap-Confidence-Intervals" class="outline-3">
<h3 id="sec-Bootstrap-Confidence-Intervals"><a name="sec-13-3" id="sec-13-3"></a><span class="section-number-3">13.3</span> Bootstrap Confidence Intervals</h3>
<div class="outline-text-3" id="text-sec-Bootstrap-Confidence-Intervals">



</div>

<div id="outline-container-13-3-1" class="outline-4">
<h4 id="sec-13-3-1"><span class="section-number-4">13.3.1</span> Percentile Confidence Intervals</h4>
<div class="outline-text-4" id="text-13-3-1">


<p>
As a first try, we want to obtain a 95% confidence interval for a parameter. Typically the statistic we use to estimate the parameter is centered at (or at least close by) the parameter; in such cases a 95% confidence interval for the parameter is nothing more than a 95% confidence interval for the statistic. And to find a 95% confidence interval for the statistic we need only go to its sampling distribution to find an interval that contains 95% of the area. (The most popular choice is the equal-tailed interval with 2.5% in each tail.)
</p>
<p>
This is incredibly easy to accomplish with the bootstrap. We need only to take a bunch of bootstrap resamples, order them, and choose the \(\alpha/2\)th and \((1-\alpha)\)th percentiles. There is a function <code>boot.ci</code>\index{boot.ci@\texttt{boot.ci}} in \(\mathsf{R}\) already created to do just this. Note that in order  to use the function <code>boot.ci</code> we must first run the <code>boot</code> function and save the output in a variable, for example, <code>data.boot</code>. We then plug <code>data.boot</code> into the function <code>boot.ci</code>.
</p>


<div class="exampletoo">
<p><a name="exa-percentile-interval-median-first" id="exa-percentile-interval-median-first"></a>
</p>
<p>
<b>Percentile interval for the expected value of the median.</b> We will try the naive approach where we generate the resamples and calculate the percentile interval by hand.
</p>



<pre class="src src-R">btsamps <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> replicate(2000, sample(stack.loss, 21, <span style="font-weight: bold; text-decoration: underline;">TRUE</span>), simplify = <span style="font-weight: bold; text-decoration: underline;">FALSE</span>)
thetast <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> sapply(btsamps, median, simplify = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
mean(thetast)
median(stack.loss)
quantile(thetast, c(0.025, 0.975))
</pre>



</div>


<div class="exampletoo">
<p><b>Confidence interval for expected value of the median, second try.</b>  Now we will do it the right way with the <code>boot</code> function.
</p>



<pre class="src src-R"><span style="font-weight: bold;">med_fun</span> <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> <span style="font-weight: bold;">function</span>(x, ind) median(x[ind])
med_boot <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> boot(stack.loss, med_fun, R = 2000)
boot.ci(med_boot, type = c(<span style="font-style: italic;">"perc"</span>, <span style="font-style: italic;">"norm"</span>, <span style="font-style: italic;">"bca"</span>))
</pre>



</div>

</div>

</div>

<div id="outline-container-13-3-2" class="outline-4">
<h4 id="sec-13-3-2"><span class="section-number-4">13.3.2</span> Student's \(t\) intervals (``normal intervals'')</h4>
<div class="outline-text-4" id="text-13-3-2">


<p>
The idea is to use confidence intervals that we already know and let the bootstrap help us when we get into trouble. We know that a \(100(1-\alpha)\%\) confidence interval for the mean of a \(SRS(n)\) from a normal distribution is 
\begin{equation} 
\overline{X}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\frac{S}{\sqrt{n}},
\end{equation} 
where \(\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\) is the appropriate critical value from Student's \(t\) distribution, and we remember that an estimate for the standard error of \(\overline{X}\) is \(S/\sqrt{n}\). Of course, the estimate for the standard error will change when the underlying population distribution is not normal, or when we use a statistic more complicated than \(\overline{X}\). In those situations the bootstrap will give us quite reasonable estimates for the standard error. And as long as the sampling distribution of our statistic is approximately bell-shaped with small bias, the interval 
\begin{equation}
\mbox{statistic}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)*\mathrm{SE}(\mbox{statistic})
\end{equation}
 will have approximately \(100(1-\alpha)\%\) confidence of containing \(\mathbb{E}(\mathrm{statistic})\). 
</p>

<div class="exampletoo">
<p>We will use the t-interval method to find the bootstrap CI for the median. We have looked at the bootstrap distribution; it appears to be symmetric and approximately mound shaped. Further, we may check that the bias is approximately 40, which on the scale of these data is practically negligible. Thus, we may consider looking at the \(t\)-intervals. Note that, since our sample is so large, instead of \(t\)-intervals we will essentially be using \(z\)-intervals. 
</p>
</div>

<p>
We see that, considering the scale of the data, the confidence intervals compare with each other quite well.
</p>

<div class="rem">
<p>We have seen two methods for bootstrapping confidence intervals for a statistic. Which method should we use? If the bias of the bootstrap distribution is small and if the distribution is close to normal, then the percentile and \(t\)-intervals will closely agree. If the intervals are noticeably different, then it should be considered evidence that the normality and bias conditions are not met. In this case, <i>neither</i> interval should be used.
</p>
</div>

<ul>
<li>\(BC_{a}\): bias-corrected and accelerated
<ul>
<li>transformation invariant
</li>
<li>more correct and accurate
</li>
<li>not monotone in coverage level?
</li>
</ul>

</li>
<li>\(t\)-intervals
<ul>
<li>more natural
</li>
<li>numerically unstable
</li>
</ul>

</li>
<li>Can do things like transform scales, compute confidence intervals, and then transform back.
</li>
<li>Studentized bootstrap confidence intervals where is the Studentized version of is the  order statistic of the simulation
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-sec-Resampling-in-Hypothesis" class="outline-3">
<h3 id="sec-Resampling-in-Hypothesis"><a name="sec-13-4" id="sec-13-4"></a><span class="section-number-3">13.4</span> Resampling in Hypothesis Tests</h3>
<div class="outline-text-3" id="text-sec-Resampling-in-Hypothesis">


<p>
The classical two-sample problem can be stated as follows: given two groups of interest, we would like to know whether these two groups are significantly different from one another or whether the groups are reasonably similar. The standard way to decide is to 
</p><ol>
<li>Go collect some information from the two groups and calculate an associated statistic, for example, \(\overline{X}_{1}-\overline{X}_{2}\). 
</li>
<li>Suppose that there is no difference in the groups, and find the distribution of the statistic in 1. 
</li>
<li>Locate the observed value of the statistic with respect to the distribution found in 2. A value in the main body of the distribution is not spectacular, it could reasonably have occurred by chance. A value in the tail of the distribution is unlikely, and hence provides evidence <i>against</i> the null hypothesis that the population distributions are the same.  
</li>
</ol>


<p>
Of course, we usually compute a <i>p-value</i>, defined to be the probability of the observed value of the statistic or more extreme when the null hypothesis is true. Small \(p\)-values are evidence against the null hypothesis. It is not immediately obvious how to use resampling methods here, so we discuss an example.
</p>

<div class="exampletoo">
<p>A study concerned differing dosages of the antiretroviral drug AZT. The common dosage is 300mg daily. Higher doses cause more side affects, but are they significantly higher? We examine for a 600mg dose. The data are as follows: We compare the scores from the two groups by computing the difference in their sample means. The 300mg data were entered in x1 and the 600mg data were entered into x2. The observed difference was
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="right" /><col class="right" /><col class="right" /><col class="right" /><col class="right" /><col class="right" /><col class="right" /><col class="right" /><col class="right" /><col class="right" />
</colgroup>
<tbody>
<tr><td class="left">300mg</td><td class="right">284</td><td class="right">279</td><td class="right">289</td><td class="right">292</td><td class="right">287</td><td class="right">295</td><td class="right">285</td><td class="right">279</td><td class="right">306</td><td class="right">298</td></tr>
<tr><td class="left">600mg</td><td class="right">298</td><td class="right">307</td><td class="right">297</td><td class="right">279</td><td class="right">291</td><td class="right">335</td><td class="right">299</td><td class="right">300</td><td class="right">306</td><td class="right">291</td></tr>
</tbody>
</table>

The average amounts can be found:
<pre class="example">
&gt; mean(x1)
[1] 289.4
&gt; mean(x2)
[1] 300.3
</pre>


<p>
with an observed difference of <code>mean(x2) - mean(x1) = 10.9</code>. As expected, the 600 mg measurements seem to have a higher average, and we might be interested in trying to decide if the average amounts are <code>significantly</code> different. The null hypothesis should be that there is no difference in the amounts, that is, the groups are more or less the same. If the null hypothesis were true, then the two groups would indeed be the same, or just one big group. In that case, the observed difference in the sample means just reflects the random assignment into the arbitrary <code>x1</code> and <code>x2</code> categories. It is now clear how we may resample, consistent with the null hypothesis.
</p>
</div>



</div>

<div id="outline-container-13-4-1" class="outline-4">
<h4 id="sec-13-4-1"><span class="section-number-4">13.4.1</span> Procedure:</h4>
<div class="outline-text-4" id="text-13-4-1">


<ol>
<li>Randomly resample 10 scores from the combined scores of <code>x1</code> and <code>x2</code>, and assign then to the <code>x1</code> group. The rest will then be in the <code>x2</code> group. Calculate the difference in (re)sampled means, and store that value.  
</li>
<li>Repeat this procedure many, many times and draw a histogram of the resampled statistics, called the <i>permutation distribution</i>. Locate the observed difference 10.9 on the histogram to get the \(p\)-value. If the \(p\)-value is small, then we consider that evidence against the hypothesis that the groups are the same. 
</li>
</ol>



<div class="rem">
<p>In calculating the permutation test <i>p-value</i>, the formula is essentially the proportion of resample statistics that are greater than or equal to the observed value. Of course, this is merely an <i>estimate</i> of the true \(p\)-value. As it turns out, an adjustment of \(+1\) to both the numerator and denominator of the proportion improves the performance of the estimated \(p\)-value, and this adjustment is implemented in the <code>ts.perm</code> function.
</p>
</div>




<pre class="src src-R">oneway_test(len ~ supp, data = ToothGrowth)
</pre>


<pre class="example">

	Asymptotic 2-Sample Permutation Test

data:  len by supp (OJ, VC) 
Z = 1.8734, p-value = 0.06102
alternative hypothesis: true mu is not equal to 0
</pre>


</div>

</div>

<div id="outline-container-13-4-2" class="outline-4">
<h4 id="sec-13-4-2"><span class="section-number-4">13.4.2</span> Comparison with the Two Sample <i>t</i> test</h4>
<div class="outline-text-4" id="text-13-4-2">


<p>
We know from Chapter <a href="#sec-10">Hypothesis Testing</a> to use the two-sample \(t\)-test to tell whether there is an improvement as a result of taking the intervention class. Note that the \(t\)-test assumes normal underlying populations, with unknown variance, and small sample \(n=10\). What does the \(t\)-test say? Below is the output. 
</p>



<pre class="src src-R">t.test(len ~ supp, data = ToothGrowth, 
       alt = <span style="font-style: italic;">"greater"</span>, var.equal = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>



<pre class="example">
	Two Sample t-test

data:  len by supp 
t = 1.9153, df = 58, p-value = 0.0302
alternative hypothesis: true difference in means is greater than 0 
95 percent confidence interval:
 0.4708204       Inf 
sample estimates:
mean in group OJ mean in group VC 
        20.66333         16.96333
</pre>




<p>
The \(p\)-value for the \(t\)-test was \(  0.03 \), while the permutation test \(p\)-value was \(  0.061 \). Note that there is an underlying normality assumption for the \(t\)-test, which isn't present in the permutation test. If the normality assumption may be questionable, then the permutation test would be more reasonable. We see what can happen when using a test in a situation where the assumptions are not met: smaller \(p\)-values. In situations where the normality assumptions are not met, for example, small sample scenarios, the permutation test is to be preferred. In particular, if accuracy is very important then we should use the permutation test. 
</p>

<div class="rem">
<p>Here are some things about permutation tests to keep in mind.
</p><ul>
<li>While the permutation test does not require normality of the populations (as contrasted with the \(t\)-test), nevertheless it still requires that the two groups are exchangeable; see Section <a href="#sec-7-5">Exchangeable Random Variables</a>. In particular, this means that they must be identically distributed under the null hypothesis. They must have not only the same means, but they must also have the same spread, shape, and everything else. This assumption may or may not be true in a given example, but it will rarely cause the \(t\)-test to outperform the permutation test, because even if the sample standard deviations are markedly different it does not mean that the population standard deviations are different. In many situations the permutation test will also carry over to the \(t\)-test.
</li>
<li>If the distribution of the groups is close to normal, then the \(t\)-test \(p\)-value and the bootstrap \(p\)-value will be approximately equal. If they differ markedly, then this should be considered evidence that the normality assumptions do not hold.  
</li>
<li>The generality of the permutation test is such that one can use all kinds of statistics to compare the two groups. One could compare the difference in variances or the difference in (just about anything). Alternatively, one could compare the ratio of sample means, \(\overline{X}_{1}/\overline{X}_{2}\). Of course, under the null hypothesis this last quantity should be near 1. 
</li>
<li>Just as with the bootstrap, the answer we get is subject to variability due to the inherent randomness of resampling from the data. We can make the variability as small as we like by taking sufficiently many resamples. How many? If the conclusion is very important (that is, if lots of money is at stake), then take thousands. For point estimation problems typically, \(R=1000\) resamples, or so, is enough. In general, if the true \(p\)-value is \(p\) then the standard error of the estimated \(p\)-value is \(\sqrt{p(1-p)/R}\). You can choose \(R\) to get whatever accuracy desired.
</li>
</ul>



</div>

<ul>
<li>Other possible testing designs:
<ul>
<li>Matched Pairs Designs. 
</li>
<li>Relationship between two variables. 
</li>
</ul>

</li>
</ul>



</div>
</div>

</div>

<div id="outline-container-13-5" class="outline-3">
<h3 id="sec-13-5"><span class="section-number-3">13.5</span> Exercises</h3>
<div class="outline-text-3" id="text-13-5">


</div>
</div>

</div>

<div id="outline-container-cha-Nonparametric-Statistics" class="outline-2">
<h2 id="cha-Nonparametric-Statistics"><a name="sec-14" id="sec-14"></a><span class="section-number-2">14</span> Nonparametric Statistics</h2>
<div class="outline-text-2" id="text-cha-Nonparametric-Statistics">




<p>
This chapter is still under substantial revision. At any time you can preview any released drafts with the development version of the <code>IPSUR</code> package which is available from \(\mathsf{R}\)-Forge:
</p>



<pre class="src src-R">install.packages(<span style="font-style: italic;">"IPSUR"</span>, repos=<span style="font-style: italic;">"http://R-Forge.R-project.org"</span>)
<span style="font-weight: bold; text-decoration: underline;">library</span>(<span style="font-style: italic;">"IPSUR"</span>)
read(IPSUR)
</pre>


</div>

</div>

<div id="outline-container-cha-Categorical-Data-Analysis" class="outline-2">
<h2 id="cha-Categorical-Data-Analysis"><a name="sec-15" id="sec-15"></a><span class="section-number-2">15</span> Categorical Data Analysis</h2>
<div class="outline-text-2" id="text-cha-Categorical-Data-Analysis">




<p>
This chapter is still under substantial revision. At any time you can preview any released drafts with the development version of the <code>IPSUR</code> package which is available from \(\mathsf{R}\)-Forge:
</p>



<pre class="src src-R">install.packages(<span style="font-style: italic;">"IPSUR"</span>, repos=<span style="font-style: italic;">"http://R-Forge.R-project.org"</span>)
<span style="font-weight: bold; text-decoration: underline;">library</span>(<span style="font-style: italic;">"IPSUR"</span>)
read(IPSUR)
</pre>


</div>

</div>

<div id="outline-container-cha-Time-Series" class="outline-2">
<h2 id="cha-Time-Series"><a name="sec-16" id="sec-16"></a><span class="section-number-2">16</span> Time Series</h2>
<div class="outline-text-2" id="text-cha-Time-Series">




<p>
This chapter is still under substantial revision. At any time you can preview any released drafts with the development version of the <code>IPSUR</code> package which is available from \(\mathsf{R}\)-Forge:
</p>



<pre class="src src-R">install.packages(<span style="font-style: italic;">"IPSUR"</span>, repos=<span style="font-style: italic;">"http://R-Forge.R-project.org"</span>)
<span style="font-weight: bold; text-decoration: underline;">library</span>(<span style="font-style: italic;">"IPSUR"</span>)
read(IPSUR)
</pre>




</div>

</div>

<div id="outline-container-cha-R-Session-Information" class="outline-2">
<h2 id="cha-R-Session-Information"><a name="sec-17" id="sec-17"></a><span class="section-number-2">17</span> R Session Information</h2>
<div class="outline-text-2" id="text-cha-R-Session-Information">


<p>
If you ever write the \(\mathsf{R}\) help mailing list with a question, then you should include your session information in the email; it makes the reader's job easier and is requested by the Posting Guide. Here is how to do that, and below is what the output looks like.
</p>



<pre class="src src-R">sessionInfo()
</pre>



<pre class="example">R version 2.14.0 (2011-10-31)
Platform: i686-pc-linux-gnu (32-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
 [1] grid      stats4    splines   tcltk     stats    
 [6] graphics  grDevices utils     datasets  methods  
[11] base     

other attached packages:
 [1] TeachingDemos_2.7       scatterplot3d_0.3-33   
 [3] RcmdrPlugin.IPSUR_0.1-7 Rcmdr_1.7-0            
 [5] car_2.0-11              nnet_7.3-1             
 [7] qcc_2.2                 MASS_7.3-16            
 [9] prob_0.9-2              lmtest_0.9-29          
[11] zoo_1.7-6               Hmisc_3.9-0            
[13] HH_2.1-32               leaps_2.9              
[15] multcomp_1.2-8          lattice_0.20-0         
[17] ggplot2_0.8.9           proto_0.3-9.2          
[19] reshape_0.8.4           plyr_1.6               
[21] e1071_1.5-26            class_7.3-3            
[23] distrEx_2.3             evd_2.2-4              
[25] distr_2.3.2             SweaveListingUtils_0.5 
[27] sfsmisc_1.0-16          startupmsg_0.7.1       
[29] diagram_1.5.2           shape_1.3.1            
[31] combinat_0.0-8          coin_1.0-18            
[33] modeltools_0.2-17       mvtnorm_0.9-9991       
[35] survival_2.36-9         boot_1.3-3             
[37] aplpack_1.2.3           actuar_1.1-2           

loaded via a namespace (and not attached):
[1] cluster_1.14.1 tools_2.14.0
</pre>



</div>

</div>

<div id="outline-container-cha-GNU-Free-Documentation" class="outline-2">
<h2 id="cha-GNU-Free-Documentation"><a name="sec-18" id="sec-18"></a><span class="section-number-2">18</span> GNU Free Documentation License</h2>
<div class="outline-text-2" id="text-cha-GNU-Free-Documentation">



<p>
Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.
</p>

</div>

<div id="outline-container-18-1" class="outline-3">
<h3 id="sec-18-1"><span class="section-number-3">18.1</span> 0. PREAMBLE</h3>
<div class="outline-text-3" id="text-18-1">


<p>
The purpose of this License is to make a manual, textbook, or other functional and useful document free  in the sense of freedom: to assure everyone the effective freedom to copy and redistribute it, with or without modifying it, either commercially or noncommercially. Secondarily, this License preserves for the author and publisher a way to get credit for their work, while not being considered responsible for modifications made by others.
</p>
<p>
This License is a kind of copyleft, which means that derivative works of the document must themselves be free in the same sense. It complements the GNU General Public License, which is a copyleft license designed for free software.
</p>
<p>
We have designed this License in order to use it for manuals for free software, because free software needs free documentation: a free program should come with manuals providing the same freedoms that the software does. But this License is not limited to software manuals; it can be used for any textual work, regardless of subject matter or whether it is published as a printed book. We recommend this License principally for works whose purpose is instruction or reference.
</p>
</div>

</div>

<div id="outline-container-18-2" class="outline-3">
<h3 id="sec-18-2"><span class="section-number-3">18.2</span> 1. APPLICABILITY AND DEFINITIONS</h3>
<div class="outline-text-3" id="text-18-2">


<p>
This License applies to any manual or other work, in any medium, that contains a notice placed by the copyright holder saying it can be distributed under the terms of this License. Such a notice grants a world-wide, royalty-free license, unlimited in duration, to use that work under the conditions stated herein. The Document, below, refers to any such manual or work. Any member of the public is a licensee, and is addressed as you. You accept the license if you copy, modify or distribute the work in a way requiring permission under copyright law.
</p>
<p>
A Modified Version of the Document means any work containing the Document or a portion of it, either copied verbatim, or with modifications and/or translated into another language.
</p>
<p>
A Secondary Section is a named appendix or a front-matter section of the Document that deals exclusively with the relationship of the publishers or authors of the Document to the Document's overall subject (or to related matters) and contains nothing that could fall directly within that overall subject. (Thus, if the Document is in part a textbook of mathematics, a Secondary Section may not explain any mathematics.) The relationship could be a matter of historical connection with the subject or with related matters, or of legal, commercial, philosophical, ethical or political position regarding them.
</p>
<p>
The Invariant Sections are certain Secondary Sections whose titles are designated, as being those of Invariant Sections, in the notice that says that the Document is released under this License. If a section does not fit the above definition of Secondary then it is not allowed to be designated as Invariant. The Document may contain zero Invariant Sections. If the Document does not identify any Invariant Sections then there are none.
</p>
<p>
The Cover Texts are certain short passages of text that are listed, as Front-Cover Texts or Back-Cover Texts, in the notice that says that the Document is released under this License. A Front-Cover Text may be at most 5 words, and a Back-Cover Text may be at most 25 words.
</p>
<p>
A Transparent copy of the Document means a machine-readable copy, represented in a format whose specification is available to the general public, that is suitable for revising the document straightforwardly with generic text editors or (for images composed of pixels) generic paint programs or (for drawings) some widely available drawing editor, and that is suitable for input to text formatters or for automatic translation to a variety of formats suitable for input to text formatters. A copy made in an otherwise Transparent file format whose markup, or absence of markup, has been arranged to thwart or discourage subsequent modification by readers is not Transparent. An image format is not Transparent if used for any substantial amount of text. A copy that is not Transparent is called Opaque.
</p>
<p>
Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo input format, \LaTeX{} input format, SGML or XML using a publicly available DTD, and standard-conforming simple HTML, PostScript or PDF designed for human modification. Examples of transparent image formats include PNG, XCF and JPG. Opaque formats include proprietary formats that can be read and edited only by proprietary word processors, SGML or XML for which the DTD and/or processing tools are not generally available, and the machine-generated HTML, PostScript or PDF produced by some word processors for output purposes only.
</p>
<p>
The Title Page means, for a printed book, the title page itself, plus such following pages as are needed to hold, legibly, the material this License requires to appear in the title page. For works in formats which do not have any title page as such, Title Page means the text near the most prominent appearance of the work's title, preceding the beginning of the body of the text.
</p>
<p>
The publisher means any person or entity that distributes copies of the Document to the public.  A section Entitled XYZ means a named subunit of the Document whose title either is precisely XYZ or contains XYZ in parentheses following text that translates XYZ in another language. (Here XYZ stands for a specific section name mentioned below, such as Acknowledgements, Dedications, Endorsements, or History.) To Preserve the Title of such a section when you modify the Document means that it remains a section Entitled XYZ according to this definition.
</p>
<p>
The Document may include Warranty Disclaimers next to the notice which states that this License applies to the Document. These Warranty Disclaimers are considered to be included by reference in this License, but only as regards disclaiming warranties: any other implication that these Warranty Disclaimers may have is void and has no effect on the meaning of this License.
</p>
</div>

</div>

<div id="outline-container-18-3" class="outline-3">
<h3 id="sec-18-3"><span class="section-number-3">18.3</span> 2. VERBATIM COPYING</h3>
<div class="outline-text-3" id="text-18-3">


<p>
You may copy and distribute the Document in any medium, either commercially or noncommercially, provided that this License, the copyright notices, and the license notice saying this License applies to the Document are reproduced in all copies, and that you add no other conditions whatsoever to those of this License. You may not use technical measures to obstruct or control the reading or further copying of the copies you make or distribute. However, you may accept compensation in exchange for copies. If you distribute a large enough number of copies you must also follow the conditions in section 3.
</p>
<p>
You may also lend copies, under the same conditions stated above, and you may publicly display copies.
</p>
</div>

</div>

<div id="outline-container-18-4" class="outline-3">
<h3 id="sec-18-4"><span class="section-number-3">18.4</span> 3. COPYING IN QUANTITY</h3>
<div class="outline-text-3" id="text-18-4">


<p>
If you publish printed copies (or copies in media that commonly have printed covers) of the Document, numbering more than 100, and the Document's license notice requires Cover Texts, you must enclose the copies in covers that carry, clearly and legibly, all these Cover Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on the back cover. Both covers must also clearly and legibly identify you as the publisher of these copies. The front cover must present the full title with all words of the title equally prominent and visible. You may add other material on the covers in addition. Copying with changes limited to the covers, as long as they preserve the title of the Document and satisfy these conditions, can be treated as verbatim copying in other respects.
</p>
<p>
If the required texts for either cover are too voluminous to fit legibly, you should put the first ones listed (as many as fit reasonably) on the actual cover, and continue the rest onto adjacent pages.
</p>
<p>
If you publish or distribute Opaque copies of the Document numbering more than 100, you must either include a machine-readable Transparent copy along with each Opaque copy, or state in or with each Opaque copy a computer-network location from which the general network-using public has access to download using public-standard network protocols a complete Transparent copy of the Document, free of added material. If you use the latter option, you must take reasonably prudent steps, when you begin distribution of Opaque copies in quantity, to ensure that this Transparent copy will remain thus accessible at the stated location until at least one year after the last time you distribute an Opaque copy (directly or through your agents or retailers) of that edition to the public.
</p>
<p>
It is requested, but not required, that you contact the authors of the Document well before redistributing any large number of copies, to give them a chance to provide you with an updated version of the Document.
</p>
</div>

</div>

<div id="outline-container-18-5" class="outline-3">
<h3 id="sec-18-5"><span class="section-number-3">18.5</span> 4. MODIFICATIONS</h3>
<div class="outline-text-3" id="text-18-5">


<p>
You may copy and distribute a Modified Version of the Document under the conditions of sections 2 and 3 above, provided that you release the Modified Version under precisely this License, with the Modified Version filling the role of the Document, thus licensing distribution and modification of the Modified Version to whoever possesses a copy of it. In addition, you must do these things in the Modified Version:
</p>
<p>
A. Use in the Title Page (and on the covers, if any) a title distinct from that of the Document, and from those of previous versions (which should, if there were any, be listed in the History section of the Document). You may use the same title as a previous version if the original publisher of that version gives permission. 
</p>
<p>
B. List on the Title Page, as authors, one or more persons or entities responsible for authorship of the modifications in the Modified Version, together with at least five of the principal authors of the Document (all of its principal authors, if it has fewer than five), unless they release you from this requirement. 
</p>
<p>
C. State on the Title page the name of the publisher of the Modified Version, as the publisher. 
</p>
<p>
D. Preserve all the copyright notices of the Document. 
</p>
<p>
E. Add an appropriate copyright notice for your modifications adjacent to the other copyright notices. 
</p>
<p>
F. Include, immediately after the copyright notices, a license notice giving the public permission to use the Modified Version under the terms of this License, in the form shown in the Addendum below.  
</p>
<p>
G. Preserve in that license notice the full lists of Invariant Sections and required Cover Texts given in the Document's license notice. 
</p>
<p>
H. Include an unaltered copy of this License. 
</p>
<p>
I. Preserve the section Entitled History, Preserve its Title, and add to it an item stating at least the title, year, new authors, and publisher of the Modified Version as given on the Title Page. If there is no section Entitled History in the Document, create one stating the title, year, authors, and publisher of the Document as given on its Title Page, then add an item describing the Modified Version as stated in the previous sentence. 
</p>
<p>
J. Preserve the network location, if any, given in the Document for public access to a Transparent copy of the Document, and likewise the network locations given in the Document for previous versions it was based on. These may be placed in the History section. You may omit a network location for a work that was published at least four years before the Document itself, or if the original publisher of the version it refers to gives permission. 
</p>
<p>
K. For any section Entitled Acknowledgements or Dedications, Preserve the Title of the section, and preserve in the section all the substance and tone of each of the contributor acknowledgements and/or dedications given therein. 
L. Preserve all the Invariant Sections of the Document, unaltered in their text and in their titles. Section numbers or the equivalent are not considered part of the section titles. 
</p>
<p>
M. Delete any section Entitled Endorsements. Such a section may not be included in the Modified Version. 
</p>
<p>
N. Do not retitle any existing section to be Entitled Endorsements or to conflict in title with any Invariant Section. 
</p>
<p>
O. Preserve any Warranty Disclaimers.
</p>
<p>
If the Modified Version includes new front-matter sections or appendices that qualify as Secondary Sections and contain no material copied from the Document, you may at your option designate some or all of these sections as invariant. To do this, add their titles to the list of Invariant Sections in the Modified Version's license notice. These titles must be distinct from any other section titles.
</p>
<p>
You may add a section Entitled Endorsements, provided it contains nothing but endorsements of your Modified Version by various parties&ndash;for example, statements of peer review or that the text has been approved by an organization as the authoritative definition of a standard.
</p>
<p>
You may add a passage of up to five words as a Front-Cover Text, and a passage of up to 25 words as a Back-Cover Text, to the end of the list of Cover Texts in the Modified Version. Only one passage of Front-Cover Text and one of Back-Cover Text may be added by (or through arrangements made by) any one entity. If the Document already includes a cover text for the same cover, previously added by you or by arrangement made by the same entity you are acting on behalf of, you may not add another; but you may replace the old one, on explicit permission from the previous publisher that added the old one.
</p>
<p>
The author(s) and publisher(s) of the Document do not by this License give permission to use their names for publicity for or to assert or imply endorsement of any Modified Version.
</p>
</div>

</div>

<div id="outline-container-18-6" class="outline-3">
<h3 id="sec-18-6"><span class="section-number-3">18.6</span> 5. COMBINING DOCUMENTS</h3>
<div class="outline-text-3" id="text-18-6">


<p>
You may combine the Document with other documents released under this License, under the terms defined in section 4 above for modified versions, provided that you include in the combination all of the Invariant Sections of all of the original documents, unmodified, and list them all as Invariant Sections of your combined work in its license notice, and that you preserve all their Warranty Disclaimers.
</p>
<p>
The combined work need only contain one copy of this License, and multiple identical Invariant Sections may be replaced with a single copy. If there are multiple Invariant Sections with the same name but different contents, make the title of each such section unique by adding at the end of it, in parentheses, the name of the original author or publisher of that section if known, or else a unique number. Make the same adjustment to the section titles in the list of Invariant Sections in the license notice of the combined work.
</p>
<p>
In the combination, you must combine any sections Entitled History in the various original documents, forming one section Entitled History;
likewise combine any sections Entitled Acknowledgements, and any sections Entitled Dedications. You must delete all sections Entitled Endorsements.
</p>
</div>

</div>

<div id="outline-container-18-7" class="outline-3">
<h3 id="sec-18-7"><span class="section-number-3">18.7</span> 6. COLLECTIONS OF DOCUMENTS</h3>
<div class="outline-text-3" id="text-18-7">


<p>
You may make a collection consisting of the Document and other documents released under this License, and replace the individual copies of this License in the various documents with a single copy that is included in the collection, provided that you follow the rules of this License for verbatim copying of each of the documents in all other respects. 
</p>
<p>
You may extract a single document from such a collection, and distribute it individually under this License, provided you insert a copy of this License into the extracted document, and follow this License in all other respects regarding verbatim copying of that document.
</p>
</div>

</div>

<div id="outline-container-18-8" class="outline-3">
<h3 id="sec-18-8"><span class="section-number-3">18.8</span> 7. AGGREGATION WITH INDEPENDENT WORKS</h3>
<div class="outline-text-3" id="text-18-8">


<p>
A compilation of the Document or its derivatives with other separate and independent documents or works, in or on a volume of a storage or distribution medium, is called an aggregate if the copyright resulting from the compilation is not used to limit the legal rights of the compilation's users beyond what the individual works permit. When the Document is included in an aggregate, this License does not apply to the other works in the aggregate which are not themselves derivative works of the Document.
</p>
<p>
If the Cover Text requirement of section 3 is applicable to these copies of the Document, then if the Document is less than one half of the entire aggregate, the Document's Cover Texts may be placed on covers that bracket the Document within the aggregate, or the electronic equivalent of covers if the Document is in electronic form. Otherwise they must appear on printed covers that bracket the whole aggregate.
</p>
</div>

</div>

<div id="outline-container-18-9" class="outline-3">
<h3 id="sec-18-9"><span class="section-number-3">18.9</span> 8. TRANSLATION</h3>
<div class="outline-text-3" id="text-18-9">


<p>
Translation is considered a kind of modification, so you may distribute translations of the Document under the terms of section 4. Replacing Invariant Sections with translations requires special permission from their copyright holders, but you may include translations of some or all Invariant Sections in addition to the original versions of these Invariant Sections. You may include a translation of this License, and all the license notices in the Document, and any Warranty Disclaimers, provided that you also include the original English version of this License and the original versions of those notices and disclaimers. In case of a disagreement between the translation and the original version of this License or a notice or disclaimer, the original version will prevail.
</p>
<p>
If a section in the Document is Entitled Acknowledgements, Dedications, or History, the requirement (section 4) to Preserve its Title (section 1) will typically require changing the actual title.
</p>
</div>

</div>

<div id="outline-container-18-10" class="outline-3">
<h3 id="sec-18-10"><span class="section-number-3">18.10</span> 9. TERMINATION</h3>
<div class="outline-text-3" id="text-18-10">


<p>
You may not copy, modify, sublicense, or distribute the Document except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, or distribute it is void, and will automatically terminate your rights under this License.
</p>
<p>
However, if you cease all violation of this License, then your license from a particular copyright holder is reinstated (a) provisionally, unless and until the copyright holder explicitly and finally terminates your license, and (b) permanently, if the copyright holder fails to notify you of the violation by some reasonable means prior to 60 days after the cessation.
</p>
<p>
Moreover, your license from a particular copyright holder is reinstated permanently if the copyright holder notifies you of the violation by some reasonable means, this is the first time you have received notice of violation of this License (for any work) from that copyright holder, and you cure the violation prior to 30 days after your receipt of the notice. 
</p>
<p>
Termination of your rights under this section does not terminate the licenses of parties who have received copies or rights from you under this License. If your rights have been terminated and not permanently reinstated, receipt of a copy of some or all of the same material does not give you any rights to use it.
</p>
</div>

</div>

<div id="outline-container-18-11" class="outline-3">
<h3 id="sec-18-11"><span class="section-number-3">18.11</span> 10. FUTURE REVISIONS OF THIS LICENSE</h3>
<div class="outline-text-3" id="text-18-11">


<p>
The Free Software Foundation may publish new, revised versions of the GNU Free Documentation License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns. See <a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.
</p>
<p>
Each version of the License is given a distinguishing version number. If the Document specifies that a particular numbered version of this License or any later version applies to it, you have the option of following the terms and conditions either of that specified version or of any later version that has been published (not as a draft) by the Free Software Foundation. If the Document does not specify a version number of this License, you may choose any version ever published (not as a draft) by the Free Software Foundation. If the Document specifies that a proxy can decide which future versions of this License can be used, that proxy's public statement of acceptance of a version permanently authorizes you to choose that version for the Document.
</p>
</div>

</div>

<div id="outline-container-18-12" class="outline-3">
<h3 id="sec-18-12"><span class="section-number-3">18.12</span> 11. RELICENSING</h3>
<div class="outline-text-3" id="text-18-12">


<p>
Massive Multiauthor Collaboration Site (or MMC Site) means any World Wide Web server that publishes copyrightable works and also provides prominent facilities for anybody to edit those works. A public wiki that anybody can edit is an example of such a server. A Massive Multiauthor Collaboration (or MMC) contained in the site means any set of copyrightable works thus published on the MMC site.
</p>
<p>
CC-BY-SA means the Creative Commons Attribution-Share Alike 3.0 license published by Creative Commons Corporation, a not-for-profit corporation with a principal place of business in San Francisco, California, as well as future copyleft versions of that license published by that same organization.
</p>
<p>
Incorporate means to publish or republish a Document, in whole or in part, as part of another Document.
</p>
<p>
An MMC is eligible for relicensing if it is licensed under this License, and if all works that were first published under this License somewhere other than this MMC, and subsequently incorporated in whole or in part into the MMC, (1) had no cover texts or invariant sections, and (2) were thus incorporated prior to November 1, 2008.
</p>
<p>
The operator of an MMC Site may republish an MMC contained in the site under CC-BY-SA on the same site at any time before August 1, 2009, provided the MMC is eligible for relicensing.
</p>
</div>

</div>

<div id="outline-container-18-13" class="outline-3">
<h3 id="sec-18-13"><span class="section-number-3">18.13</span> ADDENDUM: How to use this License for your documents</h3>
<div class="outline-text-3" id="text-18-13">


<p>
To use this License in a document you have written, include a copy of the License in the document and put the following copyright and license notices just after the title page: 
</p>
<blockquote>

<p>Copyright (c) YEAR YOUR NAME. Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts. A copy of the license is included in the section entitled GNU Free Documentation License.
</p>
</blockquote>


<p>
If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts, replace the with&hellip;Texts. line with this:
</p>
<blockquote>

<p>with the Invariant Sections being LIST THEIR TITLES, with the Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.
</p>
</blockquote>


<p>
If you have Invariant Sections without Cover Texts, or some other combination of the three, merge those two alternatives to suit the situation.
</p>
<p>
If your document contains nontrivial examples of program code, we recommend releasing these examples in parallel under your choice of free software license, such as the GNU General Public License, to permit their use in free software. 
</p>
</div>
</div>

</div>

<div id="outline-container-cha-History" class="outline-2">
<h2 id="cha-History"><a name="sec-19" id="sec-19"></a><span class="section-number-2">19</span> History</h2>
<div class="outline-text-2" id="text-cha-History">


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">Title:</td><td class="left">Introduction to Probability and Statistics Using \(\mathsf{R}\), Second Edition</td></tr>
<tr><td class="left">Year:</td><td class="left">2011</td></tr>
<tr><td class="left">Authors:</td><td class="left">G. Jay Kerns</td></tr>
<tr><td class="left">Publisher:</td><td class="left">G. Jay Kerns</td></tr>
</tbody>
</table>



<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">Title:</td><td class="left">Introduction to Probability and Statistics Using \(\mathsf{R}\), First Edition</td></tr>
<tr><td class="left">Year:</td><td class="left">2010</td></tr>
<tr><td class="left">Authors:</td><td class="left">G. Jay Kerns</td></tr>
<tr><td class="left">Publisher:</td><td class="left">G. Jay Kerns</td></tr>
</tbody>
</table>


</div>

</div>

<div id="outline-container-cha-data" class="outline-2">
<h2 id="cha-data"><a name="sec-20" id="sec-20"></a><span class="section-number-2">20</span> Data</h2>
<div class="outline-text-2" id="text-cha-data">


<p>
This appendix is a reference of sorts regarding some of the data structures a statistician is likely to encounter. We discuss their salient features and idiosyncrasies.
</p>

</div>

<div id="outline-container-sec-Data-Structures" class="outline-3">
<h3 id="sec-Data-Structures"><a name="sec-20-1" id="sec-20-1"></a><span class="section-number-3">20.1</span> Data Structures</h3>
<div class="outline-text-3" id="text-sec-Data-Structures">



</div>

<div id="outline-container-20-1-1" class="outline-4">
<h4 id="sec-20-1-1"><span class="section-number-4">20.1.1</span> Vectors</h4>
<div class="outline-text-4" id="text-20-1-1">


<p>
See the ``Vectors and Assignment'' section of <i>An Introduction to</i> \(\mathsf{R}\). A vector is an ordered sequence of elements, such as numbers, characters, or logical values, and there may be <code>NA</code>'s present. We usually make vectors with the assignment operator <code>&lt;-</code>.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(3, 5, 9)
</pre>



<p>
Vectors are atomic in the sense that if you try to mix and match elements of different modes then all elements will be coerced to the most convenient common mode.
</p>



<pre class="src src-R">y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(3, <span style="font-style: italic;">"5"</span>, <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>



<p>
In the example all elements were coerced to <i>character</i> mode. We can test whether a given object is a vector with <code>is.vector</code> and can coerce an object (if possible) to a vector with <code>as.vector</code>.
</p>
</div>

</div>

<div id="outline-container-20-1-2" class="outline-4">
<h4 id="sec-20-1-2"><span class="section-number-4">20.1.2</span> Matrices and Arrays</h4>
<div class="outline-text-4" id="text-20-1-2">


<p>
See the ``Arrays and Matrices'' section of <i>An Introduction to</i> \(\mathsf{R}\). Loosely speaking, a matrix is a vector that has been reshaped into rectangular form, and an array is a multidimensional matrix. Strictly speaking, it is the other way around: an array is a data vector with a dimension attribute (<code>dim</code>), and a matrix is the special case of an array with only two dimensions. We can construct a matrix with the <code>matrix</code> function. 
</p>



<pre class="src src-R">matrix(letters[1:6], nrow = 2, ncol = 3)
</pre>


<pre class="example">
     [,1] [,2] [,3]
[1,] "a"  "c"  "e" 
[2,] "b"  "d"  "f"
</pre>


<p>
Notice the order of the matrix entries, which shows how the matrix is populated by default. We can change this with the <code>byrow</code> argument:
</p>



<pre class="src src-R">matrix(letters[1:6], nrow = 2, ncol = 3, byrow = <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
</pre>


<pre class="example">
     [,1] [,2] [,3]
[1,] "a"  "b"  "c" 
[2,] "d"  "e"  "f"
</pre>


<p>
We can test whether a given object is a matrix with <code>is.matrix</code> and can coerce an object (if possible) to a matrix with <code>as.matrix</code>. As a final example watch what happens when we mix and match types in the first argument:
</p>



<pre class="src src-R">matrix(c(1,<span style="font-style: italic;">"2"</span>,<span style="font-weight: bold; text-decoration: underline;">NA</span>, <span style="font-weight: bold; text-decoration: underline;">FALSE</span>), nrow = 2, ncol = 3)
</pre>


<pre class="example">
     [,1] [,2]    [,3]
[1,] "1"  NA      "1" 
[2,] "2"  "FALSE" "2"
</pre>


<p>
Notice how all of the entries were coerced to character for the final result (except <code>NA</code>). Also notice how the four values were <i>recycled</i> to fill up the six entries of the matrix.
</p>
<p>
The standard arithmetic operations work element-wise with matrices.
</p>



<pre class="src src-R">A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> matrix(1:6, 2, 3)
B <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> matrix(2:7, 2, 3)
A + B
A * B
</pre>


<pre class="example">
     [,1] [,2] [,3]
[1,]    3    7   11
[2,]    5    9   13
     [,1] [,2] [,3]
[1,]    2   12   30
[2,]    6   20   42
</pre>


<p>
If you want the standard definition of matrix multiplication then use the <code>%*%</code> function. If we were to try <code>A %*% B</code> we would get an error because the dimensions do not match correctly, but for fun, we could transpose <code>B</code> to get conformable matrices. The transpose function <code>t</code> only works for matrices (and data frames).
</p>



<pre class="src src-R">try(A * B)     <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">an error</span>
A %*% t(B)     <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">this is alright</span>
</pre>


<pre class="example">
     [,1] [,2] [,3]
[1,]    2   12   30
[2,]    6   20   42
     [,1] [,2]
[1,]   44   53
[2,]   56   68
</pre>


<p>
To get the ordinary matrix inverse use the <code>solve</code> function: 
</p>



<pre class="src src-R">solve(A %*% t(B))     <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">input matrix must be square</span>
</pre>


<pre class="example">
          [,1]      [,2]
[1,]  2.833333 -2.208333
[2,] -2.333333  1.833333
</pre>


<p>
Arrays more general than matrices, and some functions (like transpose) do not work for the more general array. Here is what an array looks like: 
</p>



<pre class="src src-R">array(LETTERS[1:24], dim = c(3,4,2))
</pre>



<pre class="example">, , 1

     [,1] [,2] [,3] [,4]
[1,] "A"  "D"  "G"  "J" 
[2,] "B"  "E"  "H"  "K" 
[3,] "C"  "F"  "I"  "L" 

, , 2

     [,1] [,2] [,3] [,4]
[1,] "M"  "P"  "S"  "V" 
[2,] "N"  "Q"  "T"  "W" 
[3,] "O"  "R"  "U"  "X"
</pre>


<p>
We can test with <code>is.array</code> and may coerce with <code>as.array</code>.
</p>
</div>

</div>

<div id="outline-container-20-1-3" class="outline-4">
<h4 id="sec-20-1-3"><span class="section-number-4">20.1.3</span> Data Frames</h4>
<div class="outline-text-4" id="text-20-1-3">


<p>
A data frame is a rectangular array of information with a special status in \(\mathsf{R}\). It is used as the fundamental data structure by many of the modeling functions. It is like a matrix in that all of the columns must be the same length, but it is more general than a matrix in that columns are allowed to have different modes.
</p>



<pre class="src src-R">x <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(1.3, 5.2, 6)
y <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> letters[1:3]
z <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(<span style="font-weight: bold; text-decoration: underline;">TRUE</span>, <span style="font-weight: bold; text-decoration: underline;">FALSE</span>, <span style="font-weight: bold; text-decoration: underline;">TRUE</span>)
A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> data.frame(x, y, z)
A
</pre>


<pre class="example">
    x y     z
1 1.3 a  TRUE
2 5.2 b FALSE
3 6.0 c  TRUE
</pre>


<p>
Notice the <code>names</code> on the columns of <code>A</code>. We can change those with the <code>names</code> function.
</p>



<pre class="src src-R">names(A) <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(<span style="font-style: italic;">"Fred"</span>,<span style="font-style: italic;">"Mary"</span>,<span style="font-style: italic;">"Sue"</span>)
A
</pre>


<pre class="example">
  Fred Mary   Sue
1  1.3    a  TRUE
2  5.2    b FALSE
3  6.0    c  TRUE
</pre>


<p>
Basic command is <code>data.frame</code>. You can test with <code>is.data.frame</code> and you can coerce with <code>as.data.frame</code>.
</p>
</div>

</div>

<div id="outline-container-20-1-4" class="outline-4">
<h4 id="sec-20-1-4"><span class="section-number-4">20.1.4</span> Lists</h4>
<div class="outline-text-4" id="text-20-1-4">

<p>A list is more general than a data frame.
</p>
</div>

</div>

<div id="outline-container-20-1-5" class="outline-4">
<h4 id="sec-20-1-5"><span class="section-number-4">20.1.5</span> Tables</h4>
<div class="outline-text-4" id="text-20-1-5">

<p>The word ``table'' has a special meaning in \(\mathsf{R}\). More precisely, a contingency table is an object of class <code>table</code> which is an array.
</p>
<p>
Suppose you have a contingency table and would like to do descriptive or inferential statistics on it. The default form of the table is usually inconvenient to use unless we are working with a function specially tailored for tables. Here is how to transform your data to a more manageable form, namely, the raw data used to make the table.
</p>
<p>
First, we coerce the table to a data frame with: 
</p>



<pre class="src src-R">A <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> as.data.frame(Titanic)
head(A)
</pre>


<pre class="example">
  Class    Sex   Age Survived Freq
1   1st   Male Child       No    0
2   2nd   Male Child       No    0
3   3rd   Male Child       No   35
4  Crew   Male Child       No    0
5   1st Female Child       No    0
6   2nd Female Child       No    0
</pre>


<p>
Note that there are as many preliminary columns of <code>A</code> as there are dimensions to the table. The rows of <code>A</code> contain every possible combination of levels from each of the dimensions. There is also a <code>Freq</code> column, which shows how many observations there were at that particular combination of levels. 
</p>
<p>
The form of <code>A</code> is often sufficient for our purposes, but more often we need to do more work: we would usually like to repeat each row of <code>A</code> exactly the number of times shown in the <code>Freq</code> column. The <code>reshape</code> package \cite{Wickhamreshape} has the function <code>untable</code> designed for that very purpose: 
</p>



<pre class="src src-R">B <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> with(A, untable(A, Freq))
head(B)
</pre>


<pre class="example">
    Class  Sex   Age Survived Freq
3     3rd Male Child       No   35
3.1   3rd Male Child       No   35
3.2   3rd Male Child       No   35
3.3   3rd Male Child       No   35
3.4   3rd Male Child       No   35
3.5   3rd Male Child       No   35
</pre>


<p>
Now, this is more like it. Note that we slipped in a call to the <code>with</code> function, which was done to make the call to <code>untable</code> more pretty; we could just as easily have done
</p><pre class="example">
 untable(TitanicDF, A$Freq)
</pre>



<p>
The only fly in the ointment is the lingering <code>Freq</code> column which has repeated values that do not have any meaning any more. We could just ignore it, but it would be better to get rid of the meaningless column so that it does not cause trouble later. While we are at it, we could clean up the <code>rownames</code>, too.
</p>



<pre class="src src-R">C <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> B[, -5]
rownames(C) <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> 1:dim(C)[1]
head(C)
</pre>


<pre class="example">
  Class  Sex   Age Survived
1   3rd Male Child       No
2   3rd Male Child       No
3   3rd Male Child       No
4   3rd Male Child       No
5   3rd Male Child       No
6   3rd Male Child       No
</pre>


</div>

</div>

<div id="outline-container-20-1-6" class="outline-4">
<h4 id="sec-20-1-6"><span class="section-number-4">20.1.6</span> More about Tables</h4>
<div class="outline-text-4" id="text-20-1-6">

<p>Suppose you want to make a table that looks like this:
</p>
<p>
There are at least two ways to do it.
</p>
<ul>
<li>Using a matrix:
</li>
</ul>




<pre class="src src-R">  tab <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> matrix(1:6, nrow = 2, ncol = 3)
  rownames(tab) <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(<span style="font-style: italic;">'first'</span>, <span style="font-style: italic;">'second'</span>)
  colnames(tab) <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(<span style="font-style: italic;">'A'</span>, <span style="font-style: italic;">'B'</span>, <span style="font-style: italic;">'C'</span>)
  tab  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Counts</span>
</pre>


<pre class="example">
       A B C
first  1 3 5
second 2 4 6
</pre>


<ul>
<li>note that the columns are filled in consecutively by default. If you want to fill the data in by rows then do <code>byrow = TRUE</code> in the <code>matrix</code> command.

</li>
<li>Using a dataframe
</li>
</ul>




<pre class="src src-R">  p <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(<span style="font-style: italic;">"milk"</span>,<span style="font-style: italic;">"tea"</span>)
  g <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(<span style="font-style: italic;">"milk"</span>,<span style="font-style: italic;">"tea"</span>)
  catgs <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> expand.grid(poured = p, guessed = g)
  cnts <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> c(3, 1, 1, 3)
  D <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> cbind(catgs, count = cnts)
  xtabs(count ~ poured + guessed, data = D)
</pre>


<pre class="example">
      guessed
poured milk tea
  milk    3   1
  tea     1   3
</pre>


<ul>
<li>again, the data are filled in column-wise.
</li>
<li>the object is a dataframe
</li>
<li>if you want to store it as a table then do <code>A &lt;- xtabs(count ~ poured + guessed, data = D)</code>
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-sec-Importing-A-Data" class="outline-3">
<h3 id="sec-Importing-A-Data"><a name="sec-20-2" id="sec-20-2"></a><span class="section-number-3">20.2</span> Importing Data</h3>
<div class="outline-text-3" id="text-sec-Importing-A-Data">


<p>
Statistics is the study of data, so the statistician's first step is usually to obtain data from somewhere or another and read them into \(\mathsf{R}\). In this section we describe some of the most common sources of data and how to get data from those sources into a running \(\mathsf{R}\) session.
</p>
<p>
For more information please refer to the \(\mathsf{R}\) <i>Data Import/Export Manual</i>, \cite{rstatenv} and <i>An Introduction to</i> \(\mathsf{R}\), \cite{Venables2010}.
</p>

</div>

<div id="outline-container-20-2-1" class="outline-4">
<h4 id="sec-20-2-1"><span class="section-number-4">20.2.1</span> Data in Packages</h4>
<div class="outline-text-4" id="text-20-2-1">


<p>
There are many data sets stored in the <code>datasets</code> package of base \(\mathsf{R}\). To see a list of them all issue the command <code>data(package = "datasets")</code>. The output is omitted here because the list is so long. The names of the data sets are listed in the left column. Any data set in that list is already on the search path by default, which means that a user can use it immediately without any additional work. 
</p>
<p>
There are many other data sets available in the thousands of contributed packages. To see the data sets available in those packages that are currently loaded into memory issue the single command <code>data()</code>. If you would like to see all of the data sets that are available in all packages that are installed on your computer (but not necessarily loaded), issue the command 
</p>
<pre class="example">
 data(package = .packages(all.available = TRUE))
</pre>


<p>
To load the data set <code>foo</code> in the contributed package <code>bar</code> issue the commands <code>library("bar")</code> followed by <code>data(foo)</code>, or just the single command  
</p>
<pre class="example">
 data(foo, package = "bar")
</pre>


</div>

</div>

<div id="outline-container-20-2-2" class="outline-4">
<h4 id="sec-20-2-2"><span class="section-number-4">20.2.2</span> Text Files</h4>
<div class="outline-text-4" id="text-20-2-2">

<p>Many sources of data are simple text files. The entries in the file are separated by delimeters such as TABS (tab-delimeted), commas (comma separated values, or <code>.csv</code>, for short) or even just white space (no special name). A lot of data on the Internet are stored with text files, and even if they are not, a person can copy-paste information from a web page to a text file, save it on the computer, and read it into \(\mathsf{R}\). 
</p>
</div>

</div>

<div id="outline-container-20-2-3" class="outline-4">
<h4 id="sec-20-2-3"><span class="section-number-4">20.2.3</span> Other Software Files</h4>
<div class="outline-text-4" id="text-20-2-3">

<p>Often the data set of interest is stored in some other, proprietary, format by third-party software such as Minitab, SAS, or SPSS. The <code>foreign</code> package supports import/conversion from many of these formats. Please note, however, that data sets from other software sometimes have properties with no direct analogue in \(\mathsf{R}\). In those cases the conversion process may lose some information which will need to be reentered manually from within \(\mathsf{R}\). See the <i>Data Import/Export Manual</i>.
</p>
<p>
As an example, suppose the data are stored in the SPSS file <code>foo.sav</code> which the user has copied to the working directory; it can be imported with the commands
</p>



<pre class="src src-R"><span style="font-weight: bold; text-decoration: underline;">library</span>(<span style="font-style: italic;">"foreign"</span>)
read.spss(<span style="font-style: italic;">"foo.sav"</span>)
</pre>


<p>
See <code>?read.spss</code> for the available options to customize the file import. Note that the \(\mathsf{R}\) Commander will import many of the common file types with a menu driven interface.
</p>
</div>

</div>

<div id="outline-container-20-2-4" class="outline-4">
<h4 id="sec-20-2-4"><span class="section-number-4">20.2.4</span> Importing a Data Frame</h4>
<div class="outline-text-4" id="text-20-2-4">


<p>
The basic command is <code>read.table</code>.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Creating-New-Data" class="outline-3">
<h3 id="sec-Creating-New-Data"><a name="sec-20-3" id="sec-20-3"></a><span class="section-number-3">20.3</span> Creating New Data Sets</h3>
<div class="outline-text-3" id="text-sec-Creating-New-Data">


<p>
Using <code>c</code>
Using <code>scan</code>
Using the \(\mathsf{R}\) Commander.
</p>
</div>

</div>

<div id="outline-container-sec-Editing-Data-Sets" class="outline-3">
<h3 id="sec-Editing-Data-Sets"><a name="sec-20-4" id="sec-20-4"></a><span class="section-number-3">20.4</span> Editing Data</h3>
<div class="outline-text-3" id="text-sec-Editing-Data-Sets">



</div>

<div id="outline-container-20-4-1" class="outline-4">
<h4 id="sec-20-4-1"><span class="section-number-4">20.4.1</span> Editing Data Values</h4>
<div class="outline-text-4" id="text-20-4-1">

</div>

</div>

<div id="outline-container-20-4-2" class="outline-4">
<h4 id="sec-20-4-2"><span class="section-number-4">20.4.2</span> Inserting Rows and Columns</h4>
<div class="outline-text-4" id="text-20-4-2">

</div>

</div>

<div id="outline-container-20-4-3" class="outline-4">
<h4 id="sec-20-4-3"><span class="section-number-4">20.4.3</span> Deleting Rows and Columns</h4>
<div class="outline-text-4" id="text-20-4-3">

</div>

</div>

<div id="outline-container-20-4-4" class="outline-4">
<h4 id="sec-20-4-4"><span class="section-number-4">20.4.4</span> Sorting Data</h4>
<div class="outline-text-4" id="text-20-4-4">


<p>
We can sort a vector with the <code>sort</code> function. Normally we have a data frame of several columns (variables) and many, many rows (observations). The goal is to shuffle the rows so that they are ordered by the values of one or more columns. This is done with the <code>order</code> function. 
</p>
<p>
For example, we may sort all of the rows of the <code>Puromycin</code> data (in ascending order) by the variable <code>conc</code> with the following: 
</p>



<pre class="src src-R">Tmp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> Puromycin[order(Puromycin$conc), ]
head(Tmp)
</pre>


<pre class="example">
   conc rate     state
1  0.02   76   treated
2  0.02   47   treated
13 0.02   67 untreated
14 0.02   51 untreated
3  0.06   97   treated
4  0.06  107   treated
</pre>


<p>
We can accomplish the same thing with the command 
</p>



<pre class="src src-R">with(Puromycin, Puromycin[order(conc), ])
</pre>


<p>
We can sort by more than one variable. To sort first by <code>state</code> and next by <code>conc</code> do 
</p>



<pre class="src src-R">with(Puromycin, Puromycin[order(state, conc), ])
</pre>


<p>
If we would like to sort a numeric variable in descending order then we put a minus sign in front of it. 
</p>



<pre class="src src-R">Tmp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> with(Puromycin, Puromycin[order(-conc), ])
head(Tmp)
</pre>


<pre class="example">
   conc rate     state
11 1.10  207   treated
12 1.10  200   treated
23 1.10  160 untreated
9  0.56  191   treated
10 0.56  201   treated
21 0.56  144 untreated
</pre>


<p>
If we would like to sort by a character (or factor) in decreasing order then we can use the <code>xtfrm</code> function which produces a numeric vector in the same order as the character vector.
</p>



<pre class="src src-R">Tmp <span style="font-weight: bold; text-decoration: underline;">&lt;-</span> with(Puromycin, Puromycin[order(-xtfrm(state)), ])
head(Tmp)
</pre>


<pre class="example">
   conc rate     state
13 0.02   67 untreated
14 0.02   51 untreated
15 0.06   84 untreated
16 0.06   86 untreated
17 0.11   98 untreated
18 0.11  115 untreated
</pre>


</div>
</div>

</div>

<div id="outline-container-sec-Exporting-a-Data" class="outline-3">
<h3 id="sec-Exporting-a-Data"><a name="sec-20-5" id="sec-20-5"></a><span class="section-number-3">20.5</span> Exporting Data</h3>
<div class="outline-text-3" id="text-sec-Exporting-a-Data">


<p>
The basic function is <code>write.table</code>. The <code>MASS</code> package also has a <code>write.matrix</code> function.
</p>
</div>

</div>

<div id="outline-container-sec-Reshaping-a-Data" class="outline-3">
<h3 id="sec-Reshaping-a-Data"><a name="sec-20-6" id="sec-20-6"></a><span class="section-number-3">20.6</span> Reshaping Data</h3>
<div class="outline-text-3" id="text-sec-Reshaping-a-Data">


<ul>
<li>Aggregation
</li>
<li>Convert Tables to data frames and back
</li>
</ul>


<p>
<code>rbind</code>, <code>cbind</code>
<code>ab[order(ab[,1]),]</code>
<code>complete.cases</code>
<code>aggregate</code>
<code>stack</code>
</p>
</div>
</div>

</div>

<div id="outline-container-cha-Mathematical-Machinery" class="outline-2">
<h2 id="cha-Mathematical-Machinery"><a name="sec-21" id="sec-21"></a><span class="section-number-2">21</span> Mathematical Machinery</h2>
<div class="outline-text-2" id="text-cha-Mathematical-Machinery">


<p>
This appendix houses many of the standard definitions and theorems that are used at some point during the narrative. It is targeted for someone reading the book who forgets the precise definition of something and would like a quick reminder of an exact statement. No proofs are given, and the interested reader should consult a good text on Calculus (say, Stewart \cite{Stewart2008} or Apostol \cite{Apostol1967,ApostolI1967}), Linear Algebra (say, Strang \cite{Strang1988} and Magnus \cite{Magnus1999}), Real Analysis (say, Folland \cite{Folland1999}, or Carothers \cite{Carothers2000}), or Measure Theory (Billingsley \cite{Billingsley1995}, Ash \cite{Ash2000}, Resnick \cite{Resnick1999}) for details. 
</p>

</div>

<div id="outline-container-sec-The-Algebra-of" class="outline-3">
<h3 id="sec-The-Algebra-of"><a name="sec-21-1" id="sec-21-1"></a><span class="section-number-3">21.1</span> Set Algebra</h3>
<div class="outline-text-3" id="text-sec-The-Algebra-of">



<p>
We denote sets by capital letters, \(A\), \(B\), \(C\), <i>etc</i>. The letter \(S\) is reserved for the sample space, also known as the universe or universal set, the set which contains all possible elements. The symbol \(\emptyset\) represents the empty set, the set with no elements. 
</p>

</div>

<div id="outline-container-21-1-1" class="outline-4">
<h4 id="sec-21-1-1"><span class="section-number-4">21.1.1</span> Set Union, Intersection, and Difference</h4>
<div class="outline-text-4" id="text-21-1-1">


<p>
Given subsets \(A\) and \(B\), we may manipulate them in an algebraic fashion. To this end, we have three set operations at our disposal: union, intersection, and difference. Below is a table summarizing the pertinent information about these operations.
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-Set-Operations">
<caption>Set operations.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">Name</th><th scope="col" class="left">Denoted</th><th scope="col" class="left">Defined by elements</th><th scope="col" class="left">\(\mathsf{R}\) syntax</th></tr>
</thead>
<tbody>
<tr><td class="left">Union</td><td class="left">\(A\cup B\)</td><td class="left">in \(A\) or \(B\) or both</td><td class="left"><code>union(A, B)</code></td></tr>
<tr><td class="left">Intersection</td><td class="left">\(A\cap B\)</td><td class="left">in both \(A\) and \(B\)</td><td class="left"><code>intersect(A, B)</code></td></tr>
<tr><td class="left">Difference</td><td class="left">\(A\backslash B\)</td><td class="left">in \(A\) but not in \(B\)</td><td class="left"><code>setdiff(A, B)</code></td></tr>
<tr><td class="left">Complement</td><td class="left">\(A^{c}\)</td><td class="left">in \(S\) but not in \(A\)</td><td class="left"><code>setdiff(S, A)</code></td></tr>
</tbody>
</table>


</div>

</div>

<div id="outline-container-21-1-2" class="outline-4">
<h4 id="sec-21-1-2"><span class="section-number-4">21.1.2</span> Identities and Properties</h4>
<div class="outline-text-4" id="text-21-1-2">


<ol>
<li>\(A\cup\emptyset=A,\quad A\cap\emptyset=\emptyset\)
</li>
<li>\(A\cup S=S,\quad A\cap S=A\)
</li>
<li>\(A\cup A^{c}=S\), \(A\cap A^{c}=\emptyset\)
</li>
<li>\((A{}^{c})^{c}=A\)
</li>
<li>The Commutative Property: 
   \begin{equation}
   A \cup B = B\cup A,\quad A\cap B = B\cap A
   \end{equation}
</li>
<li>The Associative Property: 
   \begin{equation}
   (A\cup B)\cup C=A\cup(B\cup C),\quad (A\cap B)\cap C=A\cap(B\cap C)
   \end{equation}
</li>
<li>The Distributive Property: 
   \begin{equation}
   A\cup(B\cap C)=(A\cup B)\cap(A\cup B),\quad A\cap(B\cup C)=(A\cap B)\cup(A\cap B)
   \end{equation}
</li>
<li>DeMorgan's Laws
   \begin{equation}
   (A\cup B)^{c}=A^{c}\cap B^{c}\quad \mbox{and}\quad (A\cap B)^{c}=A^{c}\cup B^{c},
   \end{equation}
   or more generally,
   \begin{equation}
   \left(\bigcup_{\alpha}A_{\alpha}\right)^{c}=\bigcap_{\alpha}A_{\alpha}^{c},\quad \mbox{and}\quad \left(\bigcap_{\alpha}A_{\alpha}\right)^{c}=\bigcup_{\alpha}A_{\alpha}^{c}
   \end{equation}
</li>
</ol>


</div>
</div>

</div>

<div id="outline-container-sec-Differential-and-Integral" class="outline-3">
<h3 id="sec-Differential-and-Integral"><a name="sec-21-2" id="sec-21-2"></a><span class="section-number-3">21.2</span> Differential and Integral Calculus</h3>
<div class="outline-text-3" id="text-sec-Differential-and-Integral">


<p>
A function \(f\) of one variable is said to be one-to-one if no two distinct \(x\) values are mapped to the same \(y=f(x)\) value. To show that a function is one-to-one we can either use the horizontal line test or we may start with the equation \(f(x_{1}) = f(x_{2})\) and use algebra to show that it implies \(x_{1} = x_{2}\).
</p>

</div>

<div id="outline-container-21-2-1" class="outline-4">
<h4 id="sec-21-2-1"><span class="section-number-4">21.2.1</span> Limits and Continuity</h4>
<div class="outline-text-4" id="text-21-2-1">


<div class="defn">
<p>Let \(f\) be a function defined on some open interval that contains the number \(a\), except possibly at \(a\) itself. Then we say the <i>limit of</i> \(f(x)\) <i>as</i> \(x\) <i>approaches</i> \(a\) <i>is</i> \(L\), and we write 
\begin{equation}
\lim_{x \to a}f(x) = L,
\end{equation}
if for every \(\epsilon &gt; 0\) there exists a number \(\delta &gt; 0\) such that \(0 &lt; |x-a| &lt; \delta\) implies \(|f(x) - L| &lt; \epsilon\).
</p>
</div>


<div class="defn">
<p>A function \(f\) is <i>continuous at a number</i> \(a\) if 
\begin{equation}
\lim_{x \to a} f(x) = f(a).
\end{equation}
The function \(f\) is <i>right-continuous at the number</i> \(a\) if \(\lim_{x\to a^{+}}f(x)=f(a)\), and <i>left-continuous</i> at \(a\) if \(\lim_{x\to a^{-}}f(x)=f(a)\). Finally, the function \(f\) is <i>continuous on an interval</i> \(I\) if it is continuous at every number in the interval. 
</p>
</div>

</div>

</div>

<div id="outline-container-21-2-2" class="outline-4">
<h4 id="sec-21-2-2"><span class="section-number-4">21.2.2</span> Differentiation</h4>
<div class="outline-text-4" id="text-21-2-2">


<div class="defn">
<p>The <i>derivative of a function</i> \(f\) <i>at a number</i> \(a\), denoted by \(f'(a)\), is
\begin{equation}
f'(a)=\lim_{h\to0}\frac{f(a+h)-f(a)}{h},
\end{equation}
provided this limit exists.
A function is <i>differentiable at</i> \(a\) if \(f'(a)\) exists. It is <i>differentiable on an open interval</i> \((a,b)\) if it is differentiable at every number in the interval.
</p>
</div>


</div>

<div id="outline-container-21-2-2-1" class="outline-5">
<h5 id="sec-21-2-2-1"><span class="section-number-5">21.2.2.1</span> Differentiation Rules</h5>
<div class="outline-text-5" id="text-21-2-2-1">

<p>In the table that follows, \(f\) and \(g\) are differentiable functions and \(c\) is a constant.
</p>
<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-Differentiation-Rules">
<caption>Differentiation rules.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}c=0\)</td><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}x^{n}=nx^{n-1}\)</td><td class="left">\((cf)'=cf'\)</td></tr>
<tr><td class="left">\((f\pm g)'=f'\pm g'\)</td><td class="left">\((fg)'=f'g+fg'\)</td><td class="left">\(\left(\frac{f}{g}\right)'=\frac{f'g-fg'}{g^{2}}\)</td></tr>
</tbody>
</table>



<div class="thm">
<p>Chain Rule: If \(f\) and \(g\) are both differentiable and \(F=f\circ g\) is the composite function defined by \(F(x)=f[g(x)]\), then \(F\) is differentiable and \(F'(x) = f'[ g(x) ] \cdot g'(x)\).  
</p>
</div>

</div>

</div>

<div id="outline-container-21-2-2-2" class="outline-5">
<h5 id="sec-21-2-2-2"><span class="section-number-5">21.2.2.2</span> Useful Derivatives</h5>
<div class="outline-text-5" id="text-21-2-2-2">



<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-Useful-Derivatives">
<caption>Some derivatives.</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}\mathrm{e}^{x}=\mathrm{e}^{x}\)</td><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}\ln x=x^{-1}\)</td><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}\sin x=\cos x\)</td></tr>
<tr><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}\cos x=-\sin x\)</td><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}\tan x=\sec^{2}x\)</td><td class="left">\(\frac{\mathrm{d}}{\mathrm{d} x}\tan^{-1}x=(1+x^{2})^{-1}\)</td></tr>
</tbody>
</table>


</div>
</div>

</div>

<div id="outline-container-21-2-3" class="outline-4">
<h4 id="sec-21-2-3"><span class="section-number-4">21.2.3</span> Optimization</h4>
<div class="outline-text-4" id="text-21-2-3">


<div class="defn">
<p>A <i>critical number</i> of the function \(f\) is a value \(x^{\ast}\) for which \(f'(x^{\ast})=0\) or for which \(f'(x^{\ast})\) does not exist.
</p>
</div>


<div class="thm">
<p><a name="thm-First-Derivative-Test" id="thm-First-Derivative-Test"></a>
First Derivative Test. If \(f\) is differentiable and if \(x^{\ast}\) is a critical number of \(f\) and if \(f'(x)\geq0\) for \(x\leq x^{\ast}\) and \(f'(x)\leq0\) for \(x\geq x^{\ast}\), then \(x^{\ast}\) is a local maximum of \(f\). If \(f'(x)\leq0\) for \(x\leq x^{\ast}\) and \(f'(x)\geq0\) for \(x\geq x^{\ast}\) , then \(x^{\ast}\) is a local minimum of \(f\).
</p>
</div>


<div class="thm">
<p>Second Derivative Test. If \(f\) is twice differentiable and if \(x^{\ast}\) is a critical number of \(f\), then \(x^{\ast}\) is a local maximum of \(f\) if \(f''(x^{\ast})&lt;0\) and \(x^{\ast}\) is a local minimum of \(f\) if \(f''(x^{\ast})&gt;0\).
</p>
</div>

</div>

</div>

<div id="outline-container-21-2-4" class="outline-4">
<h4 id="sec-21-2-4"><span class="section-number-4">21.2.4</span> Integration</h4>
<div class="outline-text-4" id="text-21-2-4">

<p>As it turns out, there are all sorts of things called ``integrals'', each defined in its own idiosyncratic way. There are <i>Riemann</i> integrals, <i>Lebesgue</i> integrals, variants of these called <i>Stieltjes</i> integrals, <i>Daniell</i> integrals, <i>Ito</i> integrals, and the list continues. Given that this is an introductory book, we will use the Riemannian integral with the caveat that the Riemann integral is <i>not</i> the integral that will be used in more advanced study.
</p>

<div class="defn">
<p>Let \(f\) be defined on \([a,b]\), a closed interval of the real line. For each \(n\), divide \([a,b]\) into subintervals \([x_{i},x_{i+1}]\), \(i=0,1,\ldots,n-1\), of length \(\Delta x_{i}=(b-a)/n\) where \(x_{0}=a\) and \(x_{n}=b\), and let \(x_{i}^{\ast}\) be any points chosen from the respective subintervals. Then the <i>definite integral</i> of \(f\) from \(a\) to \(b\) is defined by
\begin{equation}
\int_{a}^{b}f(x)\,\mathrm{d} x=\lim_{n\to\infty}\sum_{i=0}^{n-1}f(x_{i}^{\ast})\,\Delta x_{i},
\end{equation}
provided the limit exists, and in that case, we say that \(f\) is <i>integrable</i> from \(a\) to \(b\). 
</p>
</div>


<div class="thm">
<p>The Fundamental Theorem of Calculus. Suppose \(f\) is continuous on \([a,b]\). Then
</p><ol>
<li>the function \(g\) defined by \(g(x)=\int_{a}^{x}f(t)\:\mathrm{d} t\), \(a\leq x\leq b\), is continuous on \([a,b]\) and differentiable on \((a,b)\) with \(g'(x)=f(x)\).
</li>
<li>\(\int_{a}^{b}f(x)\,\mathrm{d} x=F(b)-F(a)\), where \(F\) is any <i>antiderivative</i> of \(f\), that is, any function \(F\) satisfying \(F'=f\).
</li>
</ol>



</div>


</div>

<div id="outline-container-21-2-4-1" class="outline-5">
<h5 id="sec-21-2-4-1"><span class="section-number-5">21.2.4.1</span> Change of Variables</h5>
<div class="outline-text-5" id="text-21-2-4-1">


<div class="thm">
<p>If \(g\) is a differentiable function whose range is the interval \([a,b]\) and if both \(f\) and \(g'\) are continuous on the range of \(u = g(x)\), then
\begin{equation}
\int_{g(a)}^{g(b)}f(u)\:\mathrm{d} u=\int_{a}^{b}f[g(x)]\: g'(x)\:\mathrm{d} x.
\end{equation}
</p>
</div>

</div>

</div>

<div id="outline-container-21-2-4-2" class="outline-5">
<h5 id="sec-21-2-4-2"><span class="section-number-5">21.2.4.2</span> Useful Integrals</h5>
<div class="outline-text-5" id="text-21-2-4-2">



<table  border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="tab-Useful-Integrals">
<caption>Some integrals (constants of integration omitted).</caption>
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">\(\int x^{n}\,\mathrm{d} x=x^{n+1}/(n+1),\ n\neq-1\)</td><td class="left">\(\int\mathrm{e}^{x}\,\mathrm{d} x=\mathrm{e}^{x}\)</td><td class="left">\(\int x^{-1}\,\mathrm{d} x=\ln \mathrm{abs}(x) \)</td></tr>
<tr><td class="left">\(\int\tan x\:\mathrm{d} x=\ln \mathrm{abs}(\sec x)\)</td><td class="left">\(\int a^{x}\,\mathrm{d} x=a^{x}/\ln a\)</td><td class="left">\(\int(x^{2}+1)^{-1}\,\mathrm{d} x=\tan^{-1}x\)</td></tr>
</tbody>
</table>


</div>

</div>

<div id="outline-container-21-2-4-3" class="outline-5">
<h5 id="sec-21-2-4-3"><span class="section-number-5">21.2.4.3</span> Integration by Parts</h5>
<div class="outline-text-5" id="text-21-2-4-3">




\begin{equation}
\int u\:\mathrm{d} v=uv-\int v\:\mathrm{d} u
\end{equation}

<div class="thm">
<p>L'H^ opital's Rule. Suppose \(f\) and \(g\) are differentiable and \(g'(x)\neq0\) near \(a\), except possibly at \(a\). Suppose that the limit 
\begin{equation}
\lim_{x\to a}\frac{f(x)}{g(x)}
\end{equation}
is an indeterminate form of type \(\frac{0}{0}\) or \(\infty/\infty\). Then
\begin{equation}
\lim_{x\to a}\frac{f(x)}{g(x)}=\lim_{x\to a}\frac{f'(x)}{g'(x)},
\end{equation}
provided the limit on the right-hand side exists or is infinite.
</p>
</div>

</div>

</div>

<div id="outline-container-21-2-4-4" class="outline-5">
<h5 id="sec-21-2-4-4"><span class="section-number-5">21.2.4.4</span> Improper Integrals</h5>
<div class="outline-text-5" id="text-21-2-4-4">


<p>
If \(\int_{a}^{t}f(x)\mathrm{d} x\) exists for every number \(t\geq a\), then we define 
\begin{equation}
\int_{a}^{\infty}f(x)\,\mathrm{d} x=\lim_{t\to\infty}\int_{a}^{t}f(x)\,\mathrm{d} x,
\end{equation}
provided this limit exists as a finite number, and in that case we say that \(\int_{a}^{\infty}f(x)\,\mathrm{d} x\) is <i>convergent</i>. Otherwise, we say that the improper integral is <i>divergent</i>.
</p>
<p>
If \(\int_{t}^{b}f(x)\,\mathrm{d} x\) exists for every number \(t\leq b\), then we define
\begin{equation}
\int_{-\infty}^{b}f(x)\,\mathrm{d} x=\lim_{t\to-\infty}\int_{t}^{b}f(x)\,\mathrm{d} x,
\end{equation}
provided this limit exists as a finite number, and in that case we say that \(\int_{-\infty}^{b}f(x)\,\mathrm{d} x\) is <i>convergent</i>. Otherwise, we say that the improper integral is <i>divergent</i>.
</p>
<p>
If both \(\int_{a}^{\infty}f(x)\,\mathrm{d} x\) and \(\int_{-\infty}^{a}f(x)\,\mathrm{d} x\) are convergent, then we define
\begin{equation}
\int_{-\infty}^{\infty}f(x)\,\mathrm{d} x=\int_{-\infty}^{a}f(x)\,\mathrm{d} x+\int_{a}^{\infty}f(x)\mathrm{d} x,
\end{equation}
and we say that \(\int_{-\infty}^{\infty}f(x)\,\mathrm{d} x\) is <i>convergent</i>. Otherwise, we say that the improper integral is <i>divergent</i>.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-sec-Sequences-and-Series" class="outline-3">
<h3 id="sec-Sequences-and-Series"><a name="sec-21-3" id="sec-21-3"></a><span class="section-number-3">21.3</span> Sequences and Series</h3>
<div class="outline-text-3" id="text-sec-Sequences-and-Series">


<p>
A <i>sequence</i> is an ordered list of numbers, \(a_{1}\), \(a_{2}\), \(a_{3}\), &hellip;, \(a_{n} =\left(a_{k}\right)_{k=1}^{n}\). A sequence may be finite or infinite. In the latter case we write \(a_{1}\), \(a_{2}\), \(a_{3}\), &hellip; \( =\left(a_{k}\right)_{k=1}^{\infty}\). We say that <i>the infinite sequence</i> \(\left(a_{k}\right)_{k=1}^{\infty}\) <i>converges to the finite limit</i> L, and we write
\begin{equation}
\lim_{k\to\infty}a_{k} = L,
\end{equation}
if for every \(\epsilon &gt; 0\) there exists an integer \(N \geq 1\) such that \(|a_{k} - L| &lt; \epsilon\) for all \(k \geq N\). We say that <i>the infinite sequence</i> \(\left(a_{k}\right)_{k=1}^{\infty}\) <i>diverges to</i> \(+\infty\) (or \( -\infty\)) if for every \(M\geq0\) there exists an integer \(N\geq1\) such that \(a_{k} \geq M\) for all \(k \geq N\) (or \(a_{k} \leq - M\) for all \(k \geq N\)).
</p>

</div>

<div id="outline-container-21-3-1" class="outline-4">
<h4 id="sec-21-3-1"><span class="section-number-4">21.3.1</span> Finite Series</h4>
<div class="outline-text-4" id="text-21-3-1">




\begin{equation}
\sum_{k=1}^{n}k=1+2+\cdots+n=\frac{n(n+1)}{2}
\end{equation}
<p>
<a name="eq-gauss-series" id="eq-gauss-series"></a>
\begin{equation}
\sum_{k=1}^{n}k^{2}=1^{2}+2^{2}+\cdots+n^{2}=\frac{n(n+1)(2n+3)}{6}
\end{equation}
<a name="eq-gauss-series-sq" id="eq-gauss-series-sq"></a>
</p>

</div>

<div id="outline-container-21-3-1-1" class="outline-5">
<h5 id="sec-21-3-1-1"><span class="section-number-5">21.3.1.1</span> The Binomial Series</h5>
<div class="outline-text-5" id="text-21-3-1-1">


\begin{equation}
\sum_{k=0}^{n}{n \choose k}\, a^{n-k}b^{k}=(a+b)^{n}
\end{equation}
<p>
<a name="eq-binom-series" id="eq-binom-series"></a>
</p>
</div>
</div>

</div>

<div id="outline-container-21-3-2" class="outline-4">
<h4 id="sec-21-3-2"><span class="section-number-4">21.3.2</span> Infinite Series</h4>
<div class="outline-text-4" id="text-21-3-2">


<p>
Given an infinite sequence of numbers \(a_{1}\), \(a_{2}\), \(a_{3}\), &hellip;\(=\left(a_{k}\right)_{k=1}^{\infty}\), let \(s_{n}\) denote the <i>partial sum</i> of the first \(n\) terms:
\begin{equation}
s_{n}=\sum_{k=1}^{n}a_{k}=a_{1}+a_{2}+\cdots+a_{n}.
\end{equation}
If the sequence \(\left(s_{n}\right)_{n=1}^{\infty}\) converges to a finite number \(S\) then we say that the infinite series \(\sum_{k}a_{k}\) is <i>convergent</i> and write
\begin{equation}
\sum_{k=1}^{\infty}a_{k}=S.
\end{equation}
Otherwise we say the infinite series is <i>divergent</i>.
</p>
</div>

</div>

<div id="outline-container-21-3-3" class="outline-4">
<h4 id="sec-21-3-3"><span class="section-number-4">21.3.3</span> Rules for Series</h4>
<div class="outline-text-4" id="text-21-3-3">


<p>
Let \(\left(a_{k}\right)_{k=1}^{\infty}\) and \(\left(b_{k}\right)_{k=1}^{\infty}\) be infinite sequences and let \(c\) be a constant.
</p>


\begin{equation}
\sum_{k=1}^{\infty}ca_{k}=c\sum_{k=1}^{\infty}a_{k}
\end{equation}
\begin{equation}
\sum_{k=1}^{\infty}(a_{k}\pm b_{k})=\sum_{k=1}^{\infty}a_{k}\pm\sum_{k=1}^{\infty}b_{k}
\end{equation}

<p>
In both of the above the series on the left is convergent if the series on the right is (are) convergent.
</p>

</div>

<div id="outline-container-21-3-3-1" class="outline-5">
<h5 id="sec-21-3-3-1"><span class="section-number-5">21.3.3.1</span> The Geometric Series</h5>
<div class="outline-text-5" id="text-21-3-3-1">


\begin{equation}
\sum_{k=0}^{\infty} x^{k} = \frac{1}{1 - x},\quad |x| < 1.
\end{equation}
<p>
<a name="eq-geom-series" id="eq-geom-series"></a>
</p>
</div>

</div>

<div id="outline-container-21-3-3-2" class="outline-5">
<h5 id="sec-21-3-3-2"><span class="section-number-5">21.3.3.2</span> The Exponential Series</h5>
<div class="outline-text-5" id="text-21-3-3-2">


\begin{equation}
\sum_{k=0}^{\infty}\frac{x^{k}}{k!} = \mathrm{e}^{x},\quad -\infty < x < \infty.
\end{equation}
<p>
<a name="eq-exp-series" id="eq-exp-series"></a>
</p>
<p>
Other Series
\begin{equation}
\sum_{k=0}^{\infty}{m+k-1 \choose m-1}x^{k}=\frac{1}{(1-x)^{m}},\quad |x|<1.
\end{equation}
<a name="eq-negbin-series" id="eq-negbin-series"></a>
\begin{equation}
-\sum_{k=1}^{\infty}\frac{x^{n}}{n}=\ln(1-x),\quad |x| < 1.
\end{equation}
<a name="eq-log-series" id="eq-log-series"></a>
\begin{equation}
\sum_{k=0}^{\infty}{n \choose k}x^{k}=(1+x)^{n},\quad |x| < 1.
\end{equation}
<a name="eq-binom-series-infinite" id="eq-binom-series-infinite"></a>
</p>
</div>
</div>

</div>

<div id="outline-container-21-3-4" class="outline-4">
<h4 id="sec-21-3-4"><span class="section-number-4">21.3.4</span> Taylor Series</h4>
<div class="outline-text-4" id="text-21-3-4">


<p>
If the function \(f\) has a <i>power series</i> representation at the point \(a\) with radius of convergence \(R&gt;0\), that is, if
\begin{equation}
f(x)=\sum_{k=0}^{\infty}c_{k}(x-a)^{k},\quad |x - a| < R,
\end{equation}
for some constants \(\left(c_{k}\right)_{k=0}^{\infty}\), then \(c_{k}\) must be
\begin{equation}
c_{k}=\frac{f^{(k)}(a)}{k!},\quad k=0,1,2,\ldots
\end{equation}
Furthermore, the function \(f\) is differentiable on the open interval \((a-R,\, a+R)\) with
\begin{equation}
f'(x)=\sum_{k=1}^{\infty}kc_{k}(x-a)^{k-1},\quad |x-a| < R,
\end{equation}
\begin{equation}
\int f(x)\,\mathrm{d} x=C+\sum_{k=0}^{\infty}c_{k}\frac{(x-a)^{k+1}}{k+1},\quad |x-a| < R,
\end{equation}
in which case both of the above series have radius of convergence \(R\).
</p>
</div>
</div>

</div>

<div id="outline-container-sec-The-Gamma-Function" class="outline-3">
<h3 id="sec-The-Gamma-Function"><a name="sec-21-4" id="sec-21-4"></a><span class="section-number-3">21.4</span> The Gamma Function</h3>
<div class="outline-text-3" id="text-sec-The-Gamma-Function">


<p>
The <i>Gamma function</i> \(\Gamma\) will be defined in this book according to the formula
\begin{equation}
\Gamma(\alpha)=\int_{0}^{\infty}x^{\alpha-1}\mathrm{e}^{-x}\:\mathrm{d} x,\quad \mbox{for }\alpha > 0.
\end{equation}

</p>
<div class="fact">
<p>Properties of the Gamma Function:
</p><ul>
<li>\(\Gamma(\alpha)=(\alpha - 1)\Gamma(\alpha - 1)\) for any \(\alpha &gt; 1\), and so \(\Gamma(n)=(n-1)!\) for any positive integer \(n\).
</li>
<li>\(\Gamma(1/2)=\sqrt{\pi}\).
</li>
</ul>



</div>

</div>

</div>

<div id="outline-container-sec-Linear-Algebra" class="outline-3">
<h3 id="sec-Linear-Algebra"><a name="sec-21-5" id="sec-21-5"></a><span class="section-number-3">21.5</span> Linear Algebra</h3>
<div class="outline-text-3" id="text-sec-Linear-Algebra">



</div>

<div id="outline-container-21-5-1" class="outline-4">
<h4 id="sec-21-5-1"><span class="section-number-4">21.5.1</span> Matrices</h4>
<div class="outline-text-4" id="text-21-5-1">

<p>A <i>matrix</i> is an ordered array of numbers or expressions; typically we write \(\mathbf{A}=\begin{pmatrix}a_{ij}\end{pmatrix}\) or \(\mathbf{A}=\begin{bmatrix}a_{ij}\end{bmatrix}\). If \(\mathbf{A}\) has \(m\) rows and \(n\) columns then we write
\begin{equation}
\mathbf{A}_{\mathrm{m}\times\mathrm{n}}=\begin{bmatrix}a_{11} & a_{12} & \cdots & a_{1n}\\
a_{21} & a_{22} & \cdots & a_{2n}\\
\vdots & \vdots & \ddots & \vdots\\
a_{m1} & a_{m2} & \cdots & a_{mn}\end{bmatrix}.
\end{equation}
The <i>identity matrix</i> \(\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\) is an \(\mathrm{n}\times\mathrm{n}\) matrix with zeros everywhere except for 1's along the main diagonal: 
\begin{equation}
\mathbf{I}_{\mathrm{n}\times\mathrm{n}}=\begin{bmatrix}1 & 0 & \cdots & 0\\
0 & 1 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \cdots & 1\end{bmatrix}.
\end{equation}
and the matrix with ones everywhere is denoted \(\mathbf{J}_{\mathrm{n}\times\mathrm{n}}\):
\begin{equation}
\mathbf{J}_{\mathrm{n}\times\mathrm{n}}=\begin{bmatrix}1 & 1 & \cdots & 1\\
1 & 1 & \cdots & 1\\
\vdots & \vdots & \ddots & \vdots\\
1 & 1 & \cdots & 1\end{bmatrix}.
\end{equation}

A <i>vector</i> is a matrix with one of the dimensions equal to one, such as \(\mathbf{A}_{\mathrm{m}\times1}\) (a column vector) or \(\mathbf{A}_{\mathrm{1}\times\mathrm{n}}\) (a row vector). The <i>zero vector</i> \(\mathbf{0}_{\mathrm{n}\times1}\)
is an \(\mathrm{n}\times1\) matrix of zeros:
\begin{equation}
\mathbf{0}_{\mathrm{n}\times1}=\begin{bmatrix}0 & 0 & \cdots & 0\end{bmatrix}^{\mathrm{T}}.
\end{equation}

The <i>transpose</i> of a matrix \(\mathbf{A}=\begin{pmatrix}a_{ij}\end{pmatrix}\) is the matrix \(\mathbf{A}^{\mathrm{T}}=\begin{pmatrix}a_{ji}\end{pmatrix}\), which is just like \(\mathbf{A}\) except the rows are columns and the columns are rows. The matrix \(\mathbf{A}\) is said to be <i>symmetric</i> if \(\mathbf{A}^{\mathrm{T}}=\mathbf{A}\). Note that \(\left(\mathbf{A}\mathbf{B}\right)^{\mathrm{T}}=\mathbf{B}^{\mathrm{T}}\mathbf{A}^{\mathrm{T}}\).
</p>
<p>
The <i>trace</i> of a square matrix \(\mathbf{A}\) is the sum of its diagonal elements: \(\mathrm{tr}(\mathbf{A})=\sum_{i}a_{ii}\). 
</p>
<p>
The <i>inverse</i> of a square matrix \(\mathbf{A}_{\mathrm{n}\times\mathrm{n}}\) (when it exists) is the unique matrix denoted \(\mathbf{A}^{-1}\) which satisfies \(\mathbf{A}\mathbf{A}^{-1}=\mathbf{A}^{-1}\mathbf{A}=\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\). If \(\mathbf{A}^{-1}\) exists then we say \(\mathbf{A}\) is <i>invertible</i>, or <i>nonsingular</i>. Note that \(\left(\mathbf{A}^{\mathrm{T}}\right)^{-1}=\left(\mathbf{A}^{\mathrm{-1}}\right)^{\mathrm{T}}\).
</p>
<div class="fact">
<p>The inverse of the \(2\times2\) matrix
\begin{equation}
\mathbf{A}=\begin{bmatrix}a & b\\
c & d\end{bmatrix}\quad \mbox{is}\quad \mathbf{A}^{-1}=\frac{1}{ad-bc}\begin{bmatrix}d & -b\\
-c & a\end{bmatrix},
\end{equation}
provided \(ad-bc\neq0\).
</p>
</div>

</div>

</div>

<div id="outline-container-21-5-2" class="outline-4">
<h4 id="sec-21-5-2"><span class="section-number-4">21.5.2</span> Determinants</h4>
<div class="outline-text-4" id="text-21-5-2">


<div class="defn">
<p>The <i>determinant</i> of a square matrix \(\mathbf{A}_{\mathrm{n}\times n}\) is denoted \(\mathrm{det}(\mathbf{A})\) or \(|\mathbf{A}|\) and is defined recursively by
\begin{equation}
\mathrm{det}(\mathbf{A})=\sum_{i=1}^{n}(-1)^{i+j}a_{ij}\,\mathrm{det}(\mathbf{M}_{ij}),
\end{equation}
where \(\mathbf{M}_{ij}\) is the submatrix formed by deleting the \(i^{\mathrm{th}}\) row and \(j^{\mathrm{th}}\) column of \(\mathbf{A}\). We may choose any fixed \(1\leq j\leq n\) we wish to compute the determinant; the final result is independent of the \(j\) chosen.
</p>
</div>

<div class="fact">
<p>The determinant of the \(2\times2\) matrix
\begin{equation}
\mathbf{A}=\begin{bmatrix}a & b\\
c & d\end{bmatrix}\quad \mbox{is} \quad |\mathbf{A}|=ad-bc.
\end{equation}
</p>
</div>


<div class="fact">
<p>A square matrix \(\mathbf{A}\) is nonsingular if and only if \(\mathrm{det}(\mathbf{A})\neq0\).
</p>
</div>

</div>

</div>

<div id="outline-container-21-5-3" class="outline-4">
<h4 id="sec-21-5-3"><span class="section-number-4">21.5.3</span> Positive (Semi)Definite</h4>
<div class="outline-text-4" id="text-21-5-3">

<p>If the matrix \(\mathbf{A}\) satisfies \(\mathbf{x^{\mathrm{T}}}\mathbf{A}\mathbf{x}\geq0\) for all vectors \(\mathbf{x}\neq\mathbf{0}\), then we say that \(\mathbf{A}\) is <i>positive semidefinite</i>. If strict inequality holds for all \(\mathbf{x}\neq\mathbf{0}\), then \(\mathbf{A}\) is <i>positive definite</i>. The connection to statistics is that covariance matrices (see Chapter <a href="#sec-7">Multivariate Distributions</a>) are always positive semidefinite, and many of them are even positive definite.
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Multivariable-Calculus" class="outline-3">
<h3 id="sec-Multivariable-Calculus"><a name="sec-21-6" id="sec-21-6"></a><span class="section-number-3">21.6</span> Multivariable Calculus</h3>
<div class="outline-text-3" id="text-sec-Multivariable-Calculus">



</div>

<div id="outline-container-21-6-1" class="outline-4">
<h4 id="sec-21-6-1"><span class="section-number-4">21.6.1</span> Partial Derivatives</h4>
<div class="outline-text-4" id="text-21-6-1">

<p>If \(f\) is a function of two variables, its <i>first-order partial derivatives</i> are defined by
\begin{equation}
\frac{\partial f}{\partial x}=\frac{\partial}{\partial x}f(x,y)=\lim_{h\to0}\frac{f(x+h,\, y)-f(x,y)}{h}
\end{equation}
and
\begin{equation}
\frac{\partial f}{\partial y}=\frac{\partial}{\partial y}f(x,y)=\lim_{h\to0}\frac{f(x,\, y+h)-f(x,y)}{h},
\end{equation}
provided these limits exist. The <i>second-order partial derivatives</i> of \(f\) are defined by
\begin{equation}
\frac{\partial^{2}f}{\partial x^{2}}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial x}\right),\quad \frac{\partial^{2}f}{\partial y^{2}}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial y}\right),\quad \frac{\partial^{2}f}{\partial x\partial y}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial y}\right),\quad \frac{\partial^{2}f}{\partial y\partial x}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial x}\right).
\end{equation}
In many cases (and for all cases in this book) it is true that
\begin{equation}
\frac{\partial^{2}f}{\partial x\partial y}=\frac{\partial^{2}f}{\partial y\partial x}.
\end{equation}

</p></div>

</div>

<div id="outline-container-21-6-2" class="outline-4">
<h4 id="sec-21-6-2"><span class="section-number-4">21.6.2</span> Optimization</h4>
<div class="outline-text-4" id="text-21-6-2">

<p>An function \(f\) of two variables has a <i>local maximum</i> at \((a,b)\) if \(f(x,y)\geq f(a,b)\) for all points \((x,y)\) near \((a,b)\), that is, for all points in an open disk centered at \((a,b)\). The number \(f(a,b)\) is then called a <i>local maximum value</i> of \(f\). The function \(f\) has a <i>local minimum</i> if the same thing happens with the inequality reversed.
</p>
<p>
Suppose the point \((a,b)\) is a <i>critical point</i> of \(f\), that is, suppose \((a,b)\) satisfies 
\begin{equation}
\frac{\partial f}{\partial x}(a,b)=\frac{\partial f}{\partial y}(a,b)=0.
\end{equation}
Further suppose \(\frac{\partial^{2}f}{\partial x^{2}}\) and \(\frac{\partial^{2}f}{\partial y^{2}}\) are continuous near \((a,b)\). Let the <i>Hessian matrix</i> \(H\) (not to be confused with the <i>hat matrix</i> \(\mathbf{H}\) of Chapter <a href="#sec-12">Multiple Linear Regression</a>) be defined by
\begin{equation}
H = 
\begin{bmatrix}
\frac{\partial^{2}f}{\partial x^{2}} & \frac{\partial^{2}f}{\partial x\partial y}\\
\frac{\partial^{2}f}{\partial y\partial x} & \frac{\partial^{2}f}{\partial y^{2}}
\end{bmatrix}.
\end{equation}
We use the following rules to decide whether \((a,b)\) is an <i>extremum</i> (that is, a local minimum or local maximum) of \(f\).
</p><ul>
<li>If \(\mbox{det}(H)&gt;0\) and \(\frac{\partial^{2}f}{\partial x^{2}}(a,b)&gt;0\), then \((a,b)\) is a local minimum of \(f\).
</li>
<li>If \(\mbox{det}(H)&gt;0\) and \(\frac{\partial^{2}f}{\partial x^{2}}(a,b)&lt;0\), then \((a,b)\) is a local maximum of \(f\).
</li>
<li>If \(\mbox{det}(H)&lt;0\), then \((a,b)\) is a <i>saddle point</i> of \(f\) and so is not an extremum of \(f\).
</li>
<li>If \(\mbox{det}(H)=0\), then we do not know the status of \((a,b)\); it might be an extremum or it might not be.
</li>
</ul>


</div>

</div>

<div id="outline-container-21-6-3" class="outline-4">
<h4 id="sec-21-6-3"><span class="section-number-4">21.6.3</span> Double and Multiple Integrals</h4>
<div class="outline-text-4" id="text-21-6-3">

<p>Let \(f\) be defined on a rectangle \(R=[a,b]\times[c,d]\), and for each \(m\) and \(n\) divide \([a,b]\) (respectively \([c,d]\)) into subintervals \([x_{j},x_{j+1}]\), \(i=0,1,\ldots,m-1\) (respectively \([y_{i},y_{i+1}]\)) of length \(\Delta x_{j}=(b-a)/m\) (respectively \(\Delta y_{i}=(d-c)/n\)) where \(x_{0}=a\) and \(x_{m}=b\) (and \(y_{0}=c\) and \(y_{n}=d\) ), and let \(x_{j}^{\ast}\) (\(y_{i}^{\ast}\)) be any points chosen from their respective subintervals. Then the <i>double integral</i> of \(f\) over the rectangle \(R\) is
\begin{equation}
\iintop_{R}f(x,y)\,\mathrm{d} A=\intop_{c}^{d}\!\!\!\intop_{a}^{b}f(x,y)\,\mathrm{d} x\mathrm{d} y=\lim_{m,n\to\infty}\sum_{i=1}^{n}\sum_{j=1}^{m}f(x_{j}^{\ast},y_{i}^{\ast})\Delta x_{j}\Delta y_{i},
\end{equation}
provided this limit exists. Multiple integrals are defined in the same way just with more letters and sums.
</p>
</div>

</div>

<div id="outline-container-21-6-4" class="outline-4">
<h4 id="sec-21-6-4"><span class="section-number-4">21.6.4</span> Bivariate and Multivariate Change of Variables</h4>
<div class="outline-text-4" id="text-21-6-4">

<p>Suppose we have a transformation
\(T\) that maps points \((u,v)\) in a set \(A\) to points \((x,y)\) in a set \(B\). We typically write \(x=x(u,v)\) and \(y=y(u,v)\), and we assume that \(x\) and \(y\) have continuous first-order partial derivatives. We say that \(T\) is <i>one-to-one</i> if no two distinct \((u,v)\) pairs get mapped to the same \((x,y)\) pair; in this book, all of our multivariate transformations \(T\) are one-to-one.
</p>
<p>
The <i>Jacobian</i> (pronounced ``yah-KOH-bee-uhn'') of \(T\) is denoted by \(\partial(x,y)/\partial(u,v)\) and is defined by the determinant of the following matrix of partial derivatives:
\begin{equation}
\frac{\partial(x,y)}{\partial(u,v)}=\left|
\begin{array}{cc}
\frac{\partial x}{\partial u} & \frac{\partial x}{\partial v}\\
\frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}
\end{array}
\right|=\frac{\partial x}{\partial u}\frac{\partial y}{\partial v}-\frac{\partial x}{\partial v}\frac{\partial y}{\partial u}.
\end{equation}

If the function \(f\) is continuous on \(A\) and if the Jacobian of \(T\) is nonzero except perhaps on the boundary of \(A\), then 
\begin{equation}
\iint_{B}f(x,y)\,\mathrm{d} x\,\mathrm{d} y=\iint_{A}f\left[x(u,v),\, y(u,v)\right]\ \left|\frac{\partial(x,y)}{\partial(u,v)}\right|\mathrm{d} u\,\mathrm{d} v.
\end{equation} 

A multivariate change of variables is defined in an analogous way: the one-to-one transformation \(T\) maps points \((u_{1},u_{2},\ldots,u_{n})\) to points \((x_{1},x_{2},\ldots,x_{n})\), the Jacobian is the determinant of the \(\mathrm{n}\times\mathrm{n}\) matrix of first-order partial derivatives of \(T\) (lined up in the natural manner), and instead of a double integral we have a multiple integral over multidimensional sets \(A\) and \(B\).
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-cha-Writing-Reports-with" class="outline-2">
<h2 id="cha-Writing-Reports-with"><a name="sec-22" id="sec-22"></a><span class="section-number-2">22</span> Writing Reports with \(\mathsf{R}\)</h2>
<div class="outline-text-2" id="text-cha-Writing-Reports-with">


<p>
Perhaps the most important part of a statistician's job once the analysis is complete is to communicate the results to others. This is usually done with some type of report that is delivered to the client, manager, or administrator. Other situations that call for reports include term papers, final projects, thesis work, <i>etc</i>. This chapter is designed to pass along some tips about writing reports once the work is completed with \(\mathsf{R}\).
</p>

</div>

<div id="outline-container-sec-What-to-Write" class="outline-3">
<h3 id="sec-What-to-Write"><a name="sec-22-1" id="sec-22-1"></a><span class="section-number-3">22.1</span> What to Write</h3>
<div class="outline-text-3" id="text-sec-What-to-Write">


<p>
It is possible to summarize this entire appendix with only one sentence: <i>the statistician's goal is to communicate with others</i>. To this end, there are some general guidelines that I give to students which are based on an outline originally written and shared with me by Dr. G. Andy Chang.
</p>

</div>

<div id="outline-container-22-1-1" class="outline-4">
<h4 id="sec-22-1-1"><span class="section-number-4">22.1.1</span> Basic Outline for a Statistical Report</h4>
<div class="outline-text-4" id="text-22-1-1">

<ol>
<li>Executive Summary (a one page description of the study and conclusion) 
</li>
<li>Introduction 
<ol>
<li>What is the question, and why is it important?
</li>
<li>Is the study observational or experimental?
</li>
<li>What are the hypotheses of interest to the researcher?
</li>
<li>What are the types of analyses employed? (one sample \(t\)-test, paired-sample \(t\)-test, ANOVA, chi-square test, regression, &hellip;) 
</li>
</ol>

</li>
<li>Data Collection 
<ol>
<li>Describe how the data were collected in detail.
</li>
<li>Identify all variable types: quantitative, qualitative, ordered or nominal (with levels), discrete, continuous.
</li>
<li>Discuss any limitations of the data collection procedure. Look carefully for any sources of bias.
</li>
</ol>

</li>
<li>Summary Information
<ol>
<li>Give numeric summaries of all variables of interest.
<ol>
<li>Discrete: (relative) frequencies, contingency tables, odds ratios, <i>etc</i>. 
</li>
<li>Continuous: measures of center, spread, shape.
</li>
</ol>

</li>
<li>Give visual summaries of all variables of interest.
<ol>
<li>Side-by-side boxplots, scatterplots, histograms, <i>etc</i>.
</li>
</ol>

</li>
<li>Discuss any unusual features of the data (outliers, clusters, granularity, <i>etc</i>.)
</li>
<li>Report any missing data and identify any potential problems or bias.
</li>
</ol>

</li>
<li>Analysis 
<ol>
<li>State any hypotheses employed, and check the assumptions. 
</li>
<li>Report test statistics, <i>p</i>-values, and confidence intervals. 
</li>
<li>Interpret the results in the context of the study.
</li>
<li>Attach (labeled) tables and/or graphs and make reference to them in the report as needed. 
</li>
</ol>

</li>
<li>Conclusion
<ol>
<li>Summarize the results of the study. What did you learn? 
</li>
<li>Discuss any limitations of the study or inferences.
</li>
<li>Discuss avenues of future research suggested by the study. 
</li>
</ol>

</li>
</ol>


</div>
</div>

</div>

<div id="outline-container-sec-How-to-Write" class="outline-3">
<h3 id="sec-How-to-Write"><a name="sec-22-2" id="sec-22-2"></a><span class="section-number-3">22.2</span> How to Write It with R</h3>
<div class="outline-text-3" id="text-sec-How-to-Write">


<p>
Once the decision has been made what to write, the next task is to typeset the information to be shared. To do this the author will need to select software to use to write the documents. There are many options available, and choosing one over another is sometimes a matter of taste. But not all software were created equal, and \(\mathsf{R}\) plays better with some applications than it does with others. 
In short, \(\mathsf{R}\) does great with \LaTeX{} and there are many resources available to make writing a document with \(\mathsf{R}\) and \LaTeX{} easier. But \LaTeX{} is not for the beginner, and there are other word processors which may be acceptable depending on the circumstances.
</p>

</div>

<div id="outline-container-22-2-1" class="outline-4">
<h4 id="sec-22-2-1"><span class="section-number-4">22.2.1</span> Microsoft\(\circledR\) Word</h4>
<div class="outline-text-4" id="text-22-2-1">

<p>It is a fact of life that Microsoft\(\circledR\) Windows is currently the most prevalent desktop operating system on the planet. Those who own Windows also typically own some version of Microsoft Office, thus Microsoft Word is the default word processor for many, many people.  
</p>
<p>
The standard way to write an \(\mathsf{R}\) report with Microsoft\(\circledR\) Word is to generate material with \(\mathsf{R}\) and then copy-paste the material at selected places in a Word document. An advantage to this approach is that Word is nicely designed to make it easy to copy-and-paste from <code>RGui</code> to the Word document.
</p>
<p>
A disadvantage to this approach is that the R input/output needs to be edited manually by the author to make it readable for others. Another disadvantage is that the approach does not work on all operating systems (not on Linux, in particular). Yet another disadvantage is that Microsoft\(\circledR\) Word is proprietary, and as a result, \(\mathsf{R}\) does not communicate with Microsoft\(\circledR\) Word as well as it does with other software as we shall soon see.
</p>
<p>
Nevertheless, if you are going to write a report with Word there are some steps that you can take to make the report more amenable to the reader. 
</p>
<ol>
<li>Copy and paste graphs into the document. You can do this by right clicking on the graph and selecting <code>Copy as bitmap</code>, or <code>Copy as metafile</code>, or one of the other options. Then move the cursor to the document where you want the picture, right-click, and select <code>Paste</code>.
</li>
<li>Resize (most) pictures so that they take up no more than 1/2 page. You may want to put graphs side by side; do this by inserting a table and placing the graphs inside the cells.
</li>
<li>Copy selected \(\mathsf{R}\) input and output to the Word document. All code should be separated from the rest of the writing, except when specifically mentioning a function or object in a sentence.
</li>
<li>The font of \(\mathsf{R}\) input/output should be Courier New, or some other monowidth font (not Times New Roman or Calibri); the default font size of <code>12</code> is usually too big for \(\mathsf{R}\) code and should be reduced to, for example, <code>10pt</code>.
</li>
</ol>


<p>
It is also possible to communicate with \(\mathsf{R}\) through OpenOffice.org, which can export to the proprietary (<code>.doc</code>) format.
</p>
</div>

</div>

<div id="outline-container-22-2-2" class="outline-4">
<h4 id="sec-22-2-2"><span class="section-number-4">22.2.2</span> OpenOffice.org and \texttt{odfWeave}</h4>
<div class="outline-text-4" id="text-22-2-2">

<p>OpenOffice.org (OO.o) is an open source desktop productivity suite which mirrors Microsoft\(\circledR\) Office. It is especially nice because it works on all operating systems. OO.o can read most document formats, and in particular, it will read <code>.doc</code> files. The standard OO.o file extension for documents is <code>.odt</code>, which stands for ``open document text''.
</p>
<p>
The <code>odfWeave</code>  package \cite{odfweave} provides a way to generate an <code>.odt</code> file with \(\mathsf{R}\) input and output code formatted correctly and inserted in the correct places, without any additional work. In this way, one does not need to worry about all of the trouble of typesetting \(\mathsf{R}\) output. Another advantage of <code>odfWeave</code> is that it allows you to generate the report dynamically; if the data underlying the report change or are updated, then a few clicks (or commands) will generate a brand new report.
</p>
<p>
One disadvantage is that the source <code>.odt</code>  file is not easy to read, because it is difficult to visually distinguish the noweb parts (where the \(\mathsf{R}\) code is) from the non-noweb parts. This can be fixed by manually changing the font of the noweb sections to, for instance, Courier font, size <code>10pt</code>. But it is extra work. It would be nice if a program would discriminate between the two different sections and automatically typeset the respective parts in their correct fonts. This is one of the advantages to \LyX{}.
</p>
<p>
Another advantage of OO.o is that even after you have generated the outfile, it is fully editable just like any other <code>.odt</code> document. If there are errors or formatting problems, they can be fixed at any time.
</p>
<p>
Here are the basic steps to typeset a statistical report with OO.o.
</p>
<ol>
<li>Write your report as an <code>.odt</code> document in OO.o just as you would any other document. Call this document <code>infile.odt</code>, and make sure that it is saved in your working directory. 
</li>
<li>At the places you would like to insert \(\mathsf{R}\) code in the document, write the code chunks in the following format:
   \texttt{&lt;\textcompwordmark{}&lt;&gt;\textcompwordmark{}&gt;=}~<br/>
   \texttt{x &lt;- rnorm(10)}~<br/>
   \texttt{mean(x)}~<br/>
   \texttt{@}
   or write whatever code you want between the symbols \texttt{&lt;\textcompwordmark{}&lt;&gt;\textcompwordmark{}&gt;=} and \texttt{@}.
</li>
<li>Open \(\mathsf{R}\) and type the following:
</li>
</ol>




<pre class="src src-R">   <span style="font-weight: bold; text-decoration: underline;">library</span>(<span style="font-style: italic;">"odfWeave"</span>)
   odfWeave(file = <span style="font-style: italic;">"infile.odt"</span>, dest = <span style="font-style: italic;">"outfile.odt"</span>)
</pre>

<ol>
<li>The compiled (<code>.odt</code>) file, complete with all of the \(\mathsf{R}\) output automatically inserted in the correct places, will now be the file <code>outfile.odt</code> located in the working directory. Open <code>outfile.odt</code>, examine it, modify it, and repeat if desired. 
</li>
</ol>


<p>
There are all sorts of extra things that you can do. For example, the \(\mathsf{R}\) commands can be suppressed with the tag \texttt{&lt;\textcompwordmark{}&lt;echo = FALSE&gt;\textcompwordmark{}&gt;=}, and the \(\mathsf{R}\) output may be hidden with \texttt{&lt;\textcompwordmark{}&lt;results = hide&gt;\textcompwordmark{}&gt;=}. See the <code>odfWeave</code> package documentation for details.
</p>
</div>

</div>

<div id="outline-container-22-2-3" class="outline-4">
<h4 id="sec-22-2-3"><span class="section-number-4">22.2.3</span> Sweave and \protect\LaTeX{}</h4>
<div class="outline-text-4" id="text-22-2-3">


<p>
This approach is nice because it works for all operating systems. One can quite literally typeset <i>anything</i> with \LaTeX{}. All of this power comes at a price, however. The writer must learn the \LaTeX{} language which is a nontrivial enterprise. Even given the language, if there is a single syntax error, or a single delimeter missing in the entire document, then the whole thing breaks.
</p>
<p>
\LaTeX{} can do anything, but it is relatively difficult to learn  and very grumpy about syntax errors and delimiter matching. There are however programs useful for formatting LaTeX.
</p>
<p>
A disadvantage is that you cannot see the mathematical formulas until you run the whole file with \LaTeX{}.
</p>
<p>
A disadvantage is that figures and tables are relatively difficult.
</p>
<p>
There are programs to make the process easier: AUC\TeX{}.
</p>
<p>
dev.copy2eps, also dev.copy2pdf
</p>
<p>
<a href="http://www.stat.uni-muenchen.de/~leisch/Sweave/">http://www.stat.uni-muenchen.de/~leisch/Sweave/</a>
</p>
</div>

</div>

<div id="outline-container-22-2-4" class="outline-4">
<h4 id="sec-22-2-4"><span class="section-number-4">22.2.4</span> Sweave and \protect\LyX{}</h4>
<div class="outline-text-4" id="text-22-2-4">

<p>This approach is nice because it works for all operating  systems. It gives you everything from the last section and makes it easier to use \LaTeX{}. That being said, it is better to know \LaTeX{} already when migrating to \LyX{}, because you understand all of the machinery going on under the hood.
</p>
<p>
Program Listings and the \(\mathsf{R}\) language
<a href="http://gregor.gorjanc.googlepages.com/lyx-sweave">http://gregor.gorjanc.googlepages.com/lyx-sweave</a>
</p>
</div>
</div>

</div>

<div id="outline-container-sec-Formatting-Tables" class="outline-3">
<h3 id="sec-Formatting-Tables"><a name="sec-22-3" id="sec-22-3"></a><span class="section-number-3">22.3</span> Formatting Tables</h3>
<div class="outline-text-3" id="text-sec-Formatting-Tables">


<p>
The prettyR package 
</p>
<p>
The Hmisc package
</p>



<pre class="src src-R">summary(cbind(Sepal.Length, Sepal.Width) ~ Species, data = iris)
</pre>



<pre class="example">cbind(Sepal.Length, Sepal.Width)    N=150
-------+----------+---+------------+-----------+
|       |          |N  |Sepal.Length|Sepal.Width|
-------+----------+---+------------+-----------+
|Species|setosa    | 50|5.006000    |3.428000   |
|       |versicolor| 50|5.936000    |2.770000   |
|       |virginica | 50|6.588000    |2.974000   |
-------+----------+---+------------+-----------+
|Overall|          |150|5.843333    |3.057333   |
-------+----------+---+------------+-----------+
</pre>


<p>
There is a <code>method</code> argument to <code>summary</code>, which is set to \texttt{method = "response"} by default. There are two other methods for summarizing data: <code>reverse</code> and <code>cross</code>. See <code>?summary.formula</code> or the <a href="http://biostat.mc.vanderbilt.edu/twiki/bin/view/Main/StatReport">following document</a> from Frank Harrell for more details.
</p>
</div>

</div>

<div id="outline-container-sec-Other-Formats" class="outline-3">
<h3 id="sec-Other-Formats"><a name="sec-22-4" id="sec-22-4"></a><span class="section-number-3">22.4</span> Other Formats</h3>
<div class="outline-text-3" id="text-sec-Other-Formats">


<p>
HTML and prettyR
R2HTML
</p>
</div>
</div>

</div>

<div id="outline-container-cha-Instructions-for-Instructors" class="outline-2">
<h2 id="cha-Instructions-for-Instructors"><a name="sec-23" id="sec-23"></a><span class="section-number-2">23</span> Instructions for Instructors</h2>
<div class="outline-text-2" id="text-cha-Instructions-for-Instructors">


<p>
\noun{WARNING: this appendix is not applicable until the exercises
have been written.} 
</p>


<p>
Probably this <i>book</i> could more accurately be described as <i>software</i>. The reason is that the document is one big random variable, one observation realized out of millions. It is electronically distributed under the GNU FDL, and ``free'' in both senses: speech and beer.  
</p>
<p>
There are four components to \IPSUR: the Document, the Program used to generate it, the \(\mathsf{R}\) package that holds the Program, and the Ancillaries that accompany it.
</p>
<p>
The majority of the data and exercises have been designed to be randomly generated. Different realizations of this book will have different graphs and exercises throughout. The advantage of this approach is that a teacher, say, can generate a unique version to be used in his/her class. Students can do the exercises and the teacher will have the answers to all of the problems in their own, unique solutions manual. Students may download a different solutions manual online somewhere else, but none of the answers will match the teacher's copy. 
</p>
<p>
Then next semester, the teacher can generate a <i>new</i> book and the problems will be more or less identical, except the numbers will be changed. This means that students from different sections of the same class will not be able to copy from one another quite so easily. The same will be true for similar classes at different institutions. Indeed, as long as the instructor protects his/her <i>key</i> used to generate the book, it will be difficult for students to crack the code. And if they are industrious enough at this level to find a way to (a) download and decipher my version's source code, (b) hack the teacher's password somehow, and (c) generate the teacher's book with all of the answers, then they probably should be testing out of an ``Introduction to Probability and Statistics'' course, anyway. 
</p>
<p>
The book that you are reading was created with a random seed which was set at the beginning. The original seed is 42. You can choose your own seed, and generate a new book with brand new data for the text and exercises, complete with updated manuals. A method I recommend for finding a seed is to look down at your watch at this very moment and record the 6 digit hour, minute, and second (say, 9:52:59am): choose that for a seed
This method already provides for over 43,000 books, without taking military time into account. An alternative would be to go to \(\mathsf{R}\) and type 
</p>


<p>
0.217012941138819
</p>
<p>
Now choose \(  2170129411388188.0 \)as your secret seed&hellip; write it down in a safe place and do not share it with anyone. Next generate the book with your seed using \LyX{}-Sweave or Sweave-\LaTeX{}. You may wish to also generate Student and Instructor Solution Manuals. Guidance regarding this is given below in the How to Use This Document section.
</p>

</div>

<div id="outline-container-sec-Generating-This-Document" class="outline-3">
<h3 id="sec-Generating-This-Document"><a name="sec-23-1" id="sec-23-1"></a><span class="section-number-3">23.1</span> Generating This Document</h3>
<div class="outline-text-3" id="text-sec-Generating-This-Document">


<p>
You will need three (3) things to generate this document for yourself, in addition to a current \(\mathsf{R}\) distribution which at the time of this writing is \texttt{  R version 2.14.0 (2011-10-31) } :
</p><ol>
<li>a LaTeX distribution,
</li>
<li>Sweave (which comes with \(\mathsf{R}\) automatically), and 
</li>
<li>\LyX (optional, but recommended).
</li>
</ol>


<p>
We will discuss each of these in turn.
</p>
<dl>
<dt>LaTeX:</dt><dd>The distribution used by the present author was \TeX{} Live (\url{<a href="http://www.tug.org/texlive/">http://www.tug.org/texlive/</a>}). There are plenty of other perfectly suitable LaTeX distributions depending on your operating system, one such alternative being <a href="http://miktex.org/">MikTeX</a> for Microsoft Windows. 
</dd>
<dt>Sweave:</dt><dd>If you have \(\mathsf{R}\) installed, then the required Sweave files are already on your system&hellip; somewhere. The only problems that you may have are likely associated with making sure that your LaTeX distribution knows where to find the <code>Sweave.sty</code> file. See the Sweave Homepage (\url{<a href="http://www.statistik.lmu.de/~leisch/Sweave/">http://www.statistik.lmu.de/~leisch/Sweave/</a>}) for guidance on how to get it working on your particular operating system.
</dd>
<dt>LyX:</dt><dd>Strictly speaking, LyX is not needed to generate this document. But this document was written stem to stern with LyX, taking full advantage of all of the bells and whistles that LyX has to offer over plain \LaTeX{} editors. And it's free. See the LyX homepage (\url{<a href="http://www.lyx.org/">http://www.lyx.org/</a>}) for additional information. If you decide to give LyX a try, then you will need to complete some extra steps to coordinate Sweave and LyX with each other. Luckily, Gregor Gorjanc has a website and an \(\mathsf{R}\) News article \cite{Gorjanc2008} to help you do exactly that. See the LyX-Sweave homepage (\url{<a href="http://gregor.gorjanc.googlepages.com/lyx-sweave">http://gregor.gorjanc.googlepages.com/lyx-sweave</a>}) for details.
</dd>
</dl>


<p>
An attempt was made to not be extravagant with fonts or packages so that a person would not need the entire <code>CTAN</code> (or <code>CRAN</code>) installed on their personal computer to generate the book. Nevertheless, there are a few extra packages required. These packages are listed in the <code>preamble</code> of <code>IPSUR.Rnw</code>, <code>IPSUR.tex</code>, and <code>IPSUR.lyx</code>.
</p>
</div>

</div>

<div id="outline-container-sec-How-to-Use-Document" class="outline-3">
<h3 id="sec-How-to-Use-Document"><a name="sec-23-2" id="sec-23-2"></a><span class="section-number-3">23.2</span> How to Use This Document</h3>
<div class="outline-text-3" id="text-sec-How-to-Use-Document">


<p>
The easiest way to use this document is to install the <code>IPSUR</code> package from <code>CRAN</code> and be all done. This way would be acceptable if there is another, primary, text being used for the course and \IPSUR\ is only meant to play a supplementary role.
</p>
<p>
If you plan for \IPSUR\ to serve as the primary text for your course, then it would be wise to generate your own version of the document. You will need the source code for the Program which can be downloaded from <code>CRAN</code> or the \IPSUR\ website. Once the source is obtained there are four (4) basic steps to generating your own copy.
</p>
<ol>
<li>Randomly select a secret ``seed'' of integers and replace my seed of 42 with your own seed. 
</li>
<li>Make sure that the <code>maintext</code> branch is turned <code>ON</code> and also make sure that both the <code>solutions</code> branch and the <code>answers</code> branch are turned <code>OFF</code>. Use LyX or your LaTeX editor with Sweave to generate your unique PDF copy of the book and distribute this copy to your students. (See the LyX User's Guide to learn more about branches; the ones referenced above can be found under <code>Document</code> \(\triangleright\) <code>Settings</code> \(\triangleright\) <code>Branches</code>.)
</li>
<li>Turn the <code>maintext</code> branch <code>OFF</code> and the <code>solutions</code> branch <code>ON</code>. Generate a ``Student Solutions Manual'' which has complete solutions to selected exercises and distribute the PDF to the students. 
</li>
<li>Leave the <code>solutions</code> branch <code>ON</code> and also turn the <code>answers</code> branch <code>ON</code> and generate an ``Instructor Solutions and Answers Manual'' with full solutions to some of the exercises and just answers to the remaining exercises. Do NOT distribute this to the students &ndash; unless of course you want them to have the answers to all of the problems.  
</li>
</ol>


<p>
To make it easier for those people who do not want to use LyX (or for whatever reason cannot get it working), I have included three (3) Sweave files corresponding to the main text, student solutions, and instructor answers, that are included in the \IPSUR\ source package in the <code>/tex</code> subdirectory. In principle it is possible to change the seed and generate the three parts separately with only Sweave and LaTeX. This method is not recommended by me, but is perhaps desirable for some people.
</p>

</div>

<div id="outline-container-23-2-1" class="outline-4">
<h4 id="sec-23-2-1"><span class="section-number-4">23.2.1</span> Generating Quizzes and Exams</h4>
<div class="outline-text-4" id="text-23-2-1">

<ul>
<li>You can copy-paste selected exercises from the text, put them together, and you have a quiz. Since the numbers are randomly generated you do not need to worry about different semesters. And you will have answer keys already for all of your QUIZZES and EXAMS, too. 
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-sec-Ancillary-Materials" class="outline-3">
<h3 id="sec-Ancillary-Materials"><a name="sec-23-3" id="sec-23-3"></a><span class="section-number-3">23.3</span> Ancillary Materials</h3>
<div class="outline-text-3" id="text-sec-Ancillary-Materials">


<p>
In addition to the main text, student manual, and instructor manual, there are two other ancillaries. IPSUR.R, and IPSUR.RData.
</p>
</div>

</div>

<div id="outline-container-sec-Modifying-This-Document" class="outline-3">
<h3 id="sec-Modifying-This-Document"><a name="sec-23-4" id="sec-23-4"></a><span class="section-number-3">23.4</span> Modifying This Document</h3>
<div class="outline-text-3" id="text-sec-Modifying-This-Document">


<p>
Since this document is released under the GNU-FDL, you are free to modify this document however you wish (in accordance with the license &ndash; see Appendix <a href="#sec-18">GNU FDL</a>). The immediate benefit of this is that you can generate the book, with brand new problem sets, and distribute it to your students simply as a PDF (in an email, for instance). As long as you distribute less than 100 such <i>Opaque</i> copies, you are not even required by the GNU-FDL to share your <i>Transparent</i> copy (the source code with the secret key) that you used to generate them. Next semester, choose a new key and generate a new copy to be distributed to the new class. 
</p>
<blockquote>

<p>But more generally, if you are not keen on the way I explained (or failed to explain) something, then you are <span style="text-decoration:underline;">free</span> to rewrite it. If you would like to cover more (or less) material, then you are <span style="text-decoration:underline;">free</span> to add (or delete) whatever Chapters/Sections/Paragraphs that you wish. And since you have the source code, you do not need to retype the wheel. 
</p>
</blockquote>


<p>
Some individuals will argue that the nature of a statistics textbook like this one, many of the exercises being randomly generated <i>by design</i>, does a disservice to the students because the exercises do not use real-world data. That is a valid criticism&hellip; but in my case the benefits outweighed the detriments and I moved forward to incorporate static data sets whenever it was feasible and effective. Frankly, and most humbly, the only response I have for those individuals is: ``Please refer to the preceding paragraph.''
</p>
</div>
</div>

</div>

<div id="outline-container-cha-RcmdrTestDrive-Story" class="outline-2">
<h2 id="cha-RcmdrTestDrive-Story"><a name="sec-24" id="sec-24"></a><span class="section-number-2">24</span> <code>RcmdrTestDrive</code> Story</h2>
<div class="outline-text-2" id="text-cha-RcmdrTestDrive-Story">


<p>
The goal of <code>RcmdrTestDrive</code> was to have a data set sufficiently rich in the types of data represented such that a person could load it into the \(\mathsf{R}\) Commander and be able to explore all of <code>Rcmdr</code>'s menu options at once. I decided early-on that an efficient way to do this would be to generate the data set randomly, and later add to the list of variables as more <code>Rcmdr</code> menu options became available. Generating the data was easy, but generating a story that related all of the respective variables proved to be less so.
</p>
<p>
In the Summer of 2006 I gave a version of the raw data and variable names to my STAT 3743 Probability and Statistics class and invited each of them to write a short story linking all of the variables together in a coherent narrative. No further direction was given. 
</p>
<p>
The most colorful of those I received was written by Jeffery Cornfield, submitted July 12, 2006, and is included below with his permission. It was edited slightly by the present author and updated to respond dynamically to the random generation of <code>RcmdrTestDrive</code>; otherwise, the story has been unchanged. 
</p>

</div>

<div id="outline-container-24-1" class="outline-3">
<h3 id="sec-24-1"><span class="section-number-3">24.1</span> Case File: ALU-179 ``Murder Madness in Toon Town”</h3>
<div class="outline-text-3" id="text-24-1">

<blockquote>

<p><b>WARNING</b> 
This file is not for the faint of heart, dear reader, because it is filled with horrible images that will haunt your nightmares. If you are weak of stomach, have irritable bowel syndrome, or are simply paranoid, DO NOT READ FURTHER! Otherwise, read at your own risk.
</p>
</blockquote>


<p>
One fine sunny day, Police Chief R. Runner called up the forensics department at Acme-Looney University. There had been \(  166 \) murders in the past \(  7 \) days, approximately one murder every hour, of many of the local Human workers, shop keepers, and residents of Toon Town. These alarming rates threatened to destroy the fragile balance of Toon and Human camaraderie that had developed in Toon Town. 
</p>
<p>
Professor Twee T. Bird, a world-renowned forensics specialist and a Czechoslovakian native, received the call. “Professor, we need your expertise in this field to identify the pattern of the killer or killers,” Chief Runner exclaimed. “We need to establish a link between these people to stop this massacre.” 
</p>
<p>
“Yes, Chief Runner, please give me the details of the case,” Professor Bird declared with a heavy native accent, (though, for the sake of the case file, reader, I have decided to leave out the accent due to the fact that it would obviously drive you &ndash; if you will forgive the pun &ndash; looney!) 
</p>
<p>
“All prints are wiped clean and there are no identifiable marks on the bodies of the victims. All we are able to come up with is the possibility that perhaps there is some kind of alternative method of which we are unaware. We have sent a secure e-mail with a listing of all of the victims’ <code>races</code>, <code>genders</code>, locations of the bodies, and the sequential <code>order</code> in which they were killed. We have also included other information that might be helpful,” said Chief Runner.
</p>
<p>
“Thank you very much. Perhaps I will contact my colleague in the Statistics Department here, Dr. Elmer Fudd-Einstein,” exclaimed Professor Bird. “He might be able to identify a pattern of attack with mathematics and statistics.”
</p>
<p>
“Good luck trying to find him, Professor. Last I heard, he had a bottle of scotch and was in the Hundred Acre Woods hunting rabbits,” Chief Runner declared in a manner that questioned the beloved doctor’s credibility. 
</p>
<p>
“Perhaps I will take a drive to find him. The fresh air will do me good.”
</p>
<blockquote>

<p>I will skip ahead, dear reader, for much occurred during this time. Needless to say, after a fierce battle with a mountain cat that the Toon-ology Department tagged earlier in the year as “Sylvester,” Professor Bird found Dr. Fudd-Einstein and brought him back, with much bribery of alcohol and the promise of the future slaying of those “wascally wabbits” (it would help to explain that Dr. Fudd-Einstein had a speech impediment which was only worsened during the consumption of alcohol.)
</p>
</blockquote>


<p>
Once our two heroes returned to the beautiful Acme-Looney University, and once Dr. Fudd-Einstein became sober and coherent, they set off to examine the case and begin solving these mysterious murders.
</p>
<p>
“First off,” Dr. Fudd-Einstein explained, “these people all worked at the University at some point or another. Also, there also seems to be a trend in the fact that they all had a <code>salary</code> between \(  377 \) and \(  1156 \) when they retired.” 
</p>
<p>
“That’s not really a lot to live off of,” explained Professor Bird. 
</p>
<p>
“Yes, but you forget that the Looney Currency System works differently than the rest of the American Currency System. One Looney is equivalent to Ten American Dollars. Also, these faculty members are the ones who faced a cut in their salary, as denoted by <code>reduction</code>. Some of them dropped quite substantially when the University had to fix that little <i>faux pas</i> in the Chemistry Department. You remember: when Dr. D. Duck tried to create that ‘Everlasting Elixir?’ As a result, these faculty left the university. Speaking of which, when is his memorial service?” inquired Dr. Fudd-Einstein. 
</p>
<p>
“This coming Monday. But if there were all of these killings, how in the world could one person do it? It just doesn’t seem to be possible; stay up \(  7 \) days straight and be able to kill all of these people and have the energy to continue on,” Professor Bird exclaimed, doubting the guilt of only one person. 
</p>
<p>
“Perhaps then, it was a group of people, perhaps there was more than one killer placed throughout Toon Town to commit these crimes. If I feed in these variables, along with any others that might have a pattern, the Acme Computer will give us an accurate reading of suspects, with a scant probability of error. As you know, the Acme Computer was developed entirely in house here at Acme-Looney University,” Dr. Fudd-Einstein said as he began feeding the numbers into the massive server. 
</p>
<p>
“Hey, look at this,” Professor Bird exclaimed, “What’s with this <code>before</code> and <code>after</code> information?” 
</p>
<p>
“Scroll down; it shows it as a note from the coroner’s office. Apparently Toon Town Coroner Marvin &ndash; that strange fellow from Mars, Pennsylvania &ndash; feels, in his opinion, that given the fact that the cadavers were either <code>smokers</code> or non-smokers, and given their personal health, and family medical history, that this was their life expectancy before contact with cigarettes or second-hand smoke and after,” Dr. Fudd-Einstein declared matter-of-factly. 
</p>
<p>
“Well, would race or gender have something to do with it, Elmer?” inquired Professor Bird.
</p>
<p>
“Maybe, but I would bet my money on somebody was trying to quiet these faculty before they made a big ruckus about the secret money-laundering of Old Man Acme. You know, most people think that is how the University receives most of its funds, through the mob families out of Chicago. And I would be willing to bet that these faculty figured out the connection and were ready to tell the Looney Police.” Dr. Fudd-Einstein spoke lower, fearing that somebody would overhear their conversation.  
</p>
<p>
Dr. Fudd-Einstein then pressed <code>Enter</code> on the keyboard and waited for the results. The massive computer roared to life&hellip; and when I say roared, I mean it literally <i>roared</i>. All the hidden bells, whistles, and alarm clocks in its secret compartments came out and created such a loud racket that classes across the university had to come to a stand-still until it finished computing. 
</p>
<p>
Once it was completed, the computer listed 4 names:
</p>



<pre class="example">****************************SUSPECTS****************************
- Yosemite Sam (“Looney” Insane Asylum) 
- Wile E. Coyote (deceased) 
- Foghorn Leghorn (whereabouts unknown) 
- Granny (1313 Mockingbird Lane, Toon Town USA)
</pre>


<p>
Dr. Fudd-Einstein and Professor Bird looked on in silence. They could not believe their eyes. The greatest computer on the Gulf of Mexico seaboard just released the most obscure results imaginable.
</p>
<p>
“There seems to be a mistake. Perhaps something is off,” Professor Bird asked, still unable to believe the results.
</p>
<p>
“Not possible; the Acme Computer takes into account every kind of connection available. It considers affiliations to groups, and affiliations those groups have to other groups. It checks the FBI, CIA, British intelligence, NAACP, AARP, NSA, JAG, TWA, EPA, FDA, USWA, \(\mathsf{R}\), MAPLE, SPSS, SAS, and Ben &amp; Jerry’s files to identify possible links, creating the most powerful computer in the world&hellip; with a tweak of Toon fanaticism,” Dr. Fudd-Einstein proclaimed, being a proud co-founder of the Acme Computer Technology.
</p>
<p>
“Wait a minute, Ben &amp; Jerry? What would eating ice cream have to do with anything?” Professor Bird inquired.
</p>
<p>
“It is in the works now, but a few of my fellow statistician colleagues are trying to find a mathematical model to link the type of ice cream consumed to the type of person they might become. Assassins always ate vanilla with chocolate sprinkles, a little known fact they would tell you about Oswald and Booth,” Dr. Fudd-Einstein declared.
</p>
<p>
“I’ve heard about this. My forensics graduate students are trying to identify car thieves with either rocky road or mint chocolate chip… so far, the pattern is showing a clear trend with chocolate chip,” Professor Bird declared. 
“Well, what do we know about these suspects, Twee?” Dr. Fudd-Einstein asked.
</p>
<p>
“Yosemite Sam was locked up after trying to rob that bank in the West Borough. Apparently his guns were switched and he was sent the Acme Kids Joke Gun and they blew up in his face. The containers of peroxide they contained turned all of his facial hair red. Some little child is running around Toon Town with a pair of .38’s to this day. 
</p>
<p>
“Wile E. Coyote was that psychopath working for the Yahtzee - the fanatics who believed that Toons were superior to Humans. He strapped sticks of Acme Dynamite to his chest to be a martyr for the cause, but before he got to the middle of Toon Town, this defective TNT blew him up. Not a single other person &ndash; Toon or Human &ndash; was even close.
</p>
<p>
“Foghorn Leghorn is the most infamous Dog Kidnapper of all times. He goes to the homes of prominent Dog citizens and holds one of their relatives for ransom. If they refuse to pay, he sends them to the pound. Either way, they’re sure stuck in the dog house,” Professor Bird laughed. Dr. Fudd-Einstein didn’t seem amused, so Professor Bird continued. 
</p>
<p>
“Granny is the most beloved alumnus of Acme-Looney University. She was in the first graduating class and gives graciously each year to the university. Without her continued financial support, we wouldn’t have the jobs we do. She worked as a parking attendant at the University lots&hellip; wait a minute, take a look at this,” Professor Bird said as he scrolled down in the police information. “Granny’s signature is on each of these faculty members’ <code>parking</code> tickets. Kind of odd, considering the Chief-of-Parking signed each personally. The deceased had from as few as \(  1 \) ticket to as many as \(  8 \). All tickets were unpaid.
</p>
<p>
“And look at this, Granny married Old Man Acme after graduation. He was a resident of Chicago and rumored to be a consigliere to one of the most prominent crime families in Chicago, the Chuck Jones/Warner Crime Family,” Professor Bird read from the screen as a cold feeling of terror rose from the pit of his stomach. 
</p>
<p>
“Say, don’t you live at her house? Wow, you’re living under the same roof as one of the greatest criminals/murderers of all time!” Dr. Fudd-Einstein said in awe and sarcasm.
</p>
<p>
“I would never have suspected her, but I guess it makes sense. She is older, so she doesn’t need near the amount of sleep as a younger person. She has access to all of the vehicles so she can copy license plate numbers and follow them to their houses. She has the finances to pay for this kind of massive campaign on behalf of the Mob, and she hates anyone that even remotely smells like smoke,” Professor Bird explained, wishing to have his hit of nicotine at this time.
</p>
<p>
“Well, I guess there is nothing left to do but to call Police Chief Runner and have him arrest her,” Dr. Fudd-Einstein explained as he began dialing. “What I can’t understand is how in the world the Police Chief sent me all of this information and somehow seemed to screw it up.”
</p>
<p>
“What do you mean?” inquired Professor Bird.
</p>
<p>
“Well, look here. The data file from the Chief's email shows \(  168 \) murders, but there have only been \(  166 \). This doesn’t make any sense. I’ll have to straighten it out. Hey, wait a minute. Look at this, Person number \(  167 \) and Person number \(  168 \) seem to match our stats. But how can that be?”
</p>
<p>
It was at this moment that our two heroes were shot from behind and fell over the computer, dead. The killer hit <code>Delete</code> on the computer and walked out slowly (considering they had arthritis) and cackling loudly in the now quiet computer lab.  
</p>
<p>
And so, I guess my question to you the reader is, did Granny murder \(  168 \) people, or did the murderer slip through the cracks of justice? You be the statistician and come to your own conclusion. 
</p>
<p>
Detective Pyork E. Pig 
</p>
<pre class="example">
***End File***
</pre>











</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2011-12-20 22:24:09 EST</p>
<p class="author">Author: G. Jay Kerns</p>
<p class="creator">Org version 7.8.02 with Emacs version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
